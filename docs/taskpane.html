<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>SheetOS AI</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><main id="app-body" style="display:none"><header class="app-header"><div class="brand"><h1>SheetOS <span class="highlight-text">AI</span></h1></div><div class="header-actions"><button id="docs-toggle" class="btn-icon" title="What can I do?"></button> <button id="settings-toggle" class="btn-icon" title="Settings"></button></div></header><div id="docs-panel" class="panel" style="display:none"><h3>What can SheetOS AI do?</h3><div class="docs-grid"><div class="doc-item"><span class="doc-icon" data-icon="paintbrush"></span><div><strong>Smart Formatter</strong><p>Say "make this professional" and get instant clean formatting, spacing, fonts, colors, alignment</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="formula"></span><div><strong>Formula Generator</strong><p>Describe what you need in plain English ‚Äî get VLOOKUP, SUMIF, INDEX/MATCH, any formula</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="barChart"></span><div><strong>Report Automation</strong><p>Generate monthly sales, financial, or performance reports with charts in one click</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="table"></span><div><strong>Tables & Charts</strong><p>Create formatted tables, column/bar/line/pie charts, dashboards</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="sortAsc"></span><div><strong>Sort & Filter</strong><p>Sort by any column, apply AutoFilter, multi-column sorting</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="checkSquare"></span><div><strong>Validation</strong><p>Dropdown lists, number constraints, date limits, error alerts</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="trendUp"></span><div><strong>Conditional Formatting</strong><p>Color scales, data bars, icon sets, highlight rules</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="eraser"></span><div><strong>Data Cleanup</strong><p>Remove duplicates, trim spaces, fix formats, standardize case</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="snowflake"></span><div><strong>Freeze & Protect</strong><p>Freeze header rows, protect sheets with custom permissions</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="columns"></span><div><strong>Worksheets</strong><p>Add, rename, delete, copy sheets, change tab colors</p></div></div><div class="doc-item"><span class="doc-icon" data-icon="fileTemplate"></span><div><strong>Templates</strong><p>Budget trackers, invoices, employee lists, project trackers, grade books</p></div></div></div><p class="docs-hint">Just describe what you need in plain English ‚Äî SheetOS handles the rest.</p></div><div id="settings-panel" class="panel" style="display:none"><h3>AI Provider</h3><div class="form-group"><label for="setting-provider">Provider</label> <select id="setting-provider" class="form-input"><option value="groq">Groq (Llama)</option><option value="gemini">Google Gemini</option><option value="openai">OpenAI (GPT-4)</option><option value="anthropic">Anthropic (Claude)</option><option value="openrouter">OpenRouter</option><option value="local">Ollama (Local)</option></select></div><div id="groq-fields"><div class="form-group"><label for="setting-api-key">Groq API Key</label> <input id="setting-api-key" type="password" class="form-input" placeholder="gsk_..."/></div><div class="form-group"><label for="setting-groq-model">Model</label> <select id="setting-groq-model" class="form-input"><option value="llama-3.1-8b-instant" selected="selected">Llama 3.1 8B ‚Äî Fast (131K TPM)</option><option value="llama-3.3-70b-versatile">Llama 3.3 70B ‚Äî Smart (12K TPM)</option><option value="gemma2-9b-it">Gemma 2 9B (15K TPM)</option><option value="mixtral-8x7b-32768">Mixtral 8x7B (5K TPM)</option></select></div></div><div id="gemini-fields" style="display:none"><div class="form-group"><label for="setting-gemini-key">Gemini API Key</label> <input id="setting-gemini-key" type="password" class="form-input" placeholder="AIzaSy..."/><div style="font-size:10px;color:var(--text-3);margin-top:4px">Get free key at <a href="https://aistudio.google.com/app/apikey" target="_blank">aistudio.google.com</a></div></div><div class="form-group"><label for="setting-gemini-model">Model</label> <select id="setting-gemini-model" class="form-input"><option value="gemini-1.5-flash" selected="selected">Gemini 1.5 Flash (Latest)</option><option value="gemini-1.5-flash-001">Gemini 1.5 Flash-001</option><option value="gemini-1.5-flash-002">Gemini 1.5 Flash-002</option><option value="gemini-1.5-flash-8b">Gemini 1.5 Flash-8B</option><option value="gemini-1.5-pro">Gemini 1.5 Pro</option></select></div></div><div id="openai-fields" style="display:none"><div class="form-group"><label for="setting-openai-key">OpenAI API Key</label> <input id="setting-openai-key" type="password" class="form-input" placeholder="sk-..."/></div><div class="form-group"><label for="setting-openai-model">Model</label> <select id="setting-openai-model" class="form-input"><option value="gpt-4o-mini" selected="selected">GPT-4o Mini (Fast)</option><option value="gpt-4o">GPT-4o (Smart)</option><option value="gpt-3.5-turbo">GPT-3.5 Turbo</option></select></div></div><div id="anthropic-fields" style="display:none"><div class="form-group"><label for="setting-anthropic-key">Anthropic API Key</label> <input id="setting-anthropic-key" type="password" class="form-input" placeholder="sk-ant-..."/></div><div class="form-group"><label for="setting-anthropic-model">Model</label> <select id="setting-anthropic-model" class="form-input"><option value="claude-3-5-sonnet-20241022" selected="selected">Claude 3.5 Sonnet (Best for Code)</option><option value="claude-3-5-haiku-20241022">Claude 3.5 Haiku (Fast)</option><option value="claude-3-opus-20240229">Claude 3 Opus</option></select></div></div><div id="openrouter-fields" style="display:none"><div class="form-group"><label for="setting-openrouter-key">OpenRouter API Key</label> <input id="setting-openrouter-key" type="password" class="form-input" placeholder="sk-or-v1-..."/></div><div class="form-group"><label for="setting-openrouter-model">Model</label> <select id="setting-openrouter-model" class="form-input"><option value="anthropic/claude-3.5-sonnet:beta" selected="selected">Claude 3.5 Sonnet</option><option value="google/gemini-2.5-pro">Gemini 2.5 Pro</option><option value="openai/gpt-4o">GPT-4o</option><option value="meta-llama/llama-3.3-70b-instruct">Llama 3.3 70B</option></select></div></div><div id="local-fields" style="display:none"><div class="form-group"><label for="setting-base-url">Ollama Host</label> <input id="setting-base-url" class="form-input" placeholder="http://localhost:11434"/></div><div class="form-group"><label>Model</label><div class="model-select-wrapper"><select id="setting-local-model" class="form-input"><option value="" disabled="disabled" selected="selected">Click refresh ‚Üí</option></select> <button id="refresh-models" class="btn-icon btn-refresh" title="Refresh models"></button></div><div id="model-status" class="model-status"></div></div></div><button id="save-settings" class="btn-primary btn-save">Save</button></div><div class="mode-toggle"><button id="mode-planning" class="mode-tab active" data-mode="planning"><span id="mode-planning-icon"></span> <span>Planning</span></button> <button id="mode-agent" class="mode-tab" data-mode="agent"><span id="mode-agent-icon"></span> <span>Agent</span></button><div class="mode-indicator" id="mode-indicator"></div></div><div id="planning-mode" class="mode-content active"><div style="position:relative;flex:1;display:flex;flex-direction:column;overflow:hidden"><div id="chat-messages" class="chat-messages"><div class="chat-welcome"><img src="assets/icon-80-v2.png" alt="SheetOS Logo" style="width:64px;height:64px;margin-bottom:16px"><h2>What are you working on?</h2><div class="welcome-suggestions" id="chat-suggestions"></div></div></div><button id="scroll-to-bottom" class="scroll-to-bottom" title="Scroll to bottom"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg></button></div><div class="chat-input-area"><div id="file-preview-list" class="file-preview-list"></div><div class="chat-input-card"><input type="file" id="file-input" accept="image/png, image/jpeg, application/pdf" multiple="multiple" style="display:none"/> <button id="file-upload-btn" class="btn-clip" title="Attach Images or PDFs"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg></button> <textarea id="chat-input" placeholder="Ask or upload file..." rows="1" spellcheck="false"></textarea> <button id="chat-send" class="btn-send" title="Send message"><span id="chat-send-icon"></span></button></div><div class="chat-footer"><button id="chat-clear" class="btn-text" title="Clear conversation"><span id="chat-clear-icon"></span> <span>Clear</span></button></div></div></div><div id="agent-mode" class="mode-content"><div class="content-wrapper"><div class="input-card"><textarea id="prompt-input" placeholder="Describe what you want to do in Excel..." spellcheck="false"></textarea><div id="agent-file-preview-list" class="file-preview-list"></div><div id="batch-extraction-panel" class="batch-panel" style="display:none"><div class="batch-panel-header"><span class="batch-panel-title">üß† Batch PDF Extraction</span> <span id="batch-file-count" class="batch-file-count">0 PDFs</span></div><textarea id="batch-instruction" class="batch-instruction" placeholder="Describe what to extract, e.g: These are resumes. Extract Name, Email, Phone, Skills, and Experience." rows="2"></textarea> <button id="batch-extract-btn" class="btn-primary btn-batch-extract"><span id="batch-icon">üöÄ</span> <span id="batch-btn-text">Extract All PDFs</span></button><div id="batch-progress-wrap" class="batch-progress-wrap" style="display:none"><div class="batch-progress-bar-track"><div id="batch-progress-bar" class="batch-progress-bar" style="width:0%"></div></div><div id="batch-progress-label" class="batch-progress-label">0 / 0</div></div><div id="batch-log" class="batch-log"></div></div><div class="card-footer"><div class="footer-left"><input type="file" id="agent-file-input" accept="image/png, image/jpeg, application/pdf" multiple="multiple" style="display:none"/> <button id="agent-file-btn" class="btn-clip" title="Extract from Images/PDFs"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg></button> <span id="cache-badge" class="cache-badge" style="display:none">‚ö° cached</span></div><span class="kbd-hint">Ctrl+‚Üµ</span> <button id="run" class="btn-primary"><span id="run-text">Execute</span> <span id="run-icon"></span></button></div></div><div class="agent-scroll-area"><div class="action-categories" id="action-categories"><button class="category-tab active" data-category="cleanup"><span class="cat-icon" data-icon="broom"></span> <span>Cleanup</span></button> <button class="category-tab" data-category="formulas"><span class="cat-icon" data-icon="formula"></span> <span>Formulas</span></button> <button class="category-tab" data-category="format"><span class="cat-icon" data-icon="palette"></span> <span>Format</span></button> <button class="category-tab" data-category="reports"><span class="cat-icon" data-icon="barChart"></span> <span>Reports</span></button> <button class="category-tab" data-category="templates"><span class="cat-icon" data-icon="fileTemplate"></span> <span>Templates</span></button> <button class="category-tab" data-category="analysis"><span class="cat-icon" data-icon="trendUp"></span> <span>Analysis</span></button> <button class="category-tab" data-category="extract"><span class="cat-icon" data-icon="upload"></span> <span>Extract</span></button> <button class="category-tab" data-category="smart"><span class="cat-icon" data-icon="brain"></span> <span>Smart Tools</span></button></div><div id="schema-info" class="schema-info" style="display:none"><div class="schema-icon">üìã</div><div class="schema-text"><strong>Schema-Aware Mode</strong> <span>Data will only be extracted for columns defined in Row 1 of your sheet</span></div><button id="detect-columns-btn" class="btn-detect" title="Detect column headers">üîç Detect</button></div><div id="detected-columns" class="detected-columns" style="display:none"><div class="detected-header"><span class="detected-label">Detected Columns:</span> <span id="column-count" class="column-count">0</span></div><div id="column-chips" class="column-chips"></div></div><div id="quick-actions" class="quick-actions"></div><div id="skeleton" class="skeleton-container" style="display:none"><div class="skeleton-pill"></div><div class="skeleton-line w80"></div><div class="skeleton-line w60"></div></div><div id="status-message" class="status-pill"></div><div id="debug-section"><details><summary><span id="chevron-icon"></span> <span>Generated Code</span></summary><pre id="debug-code"></pre></details></div></div></div></div><div id="toast-container" class="toast-container"></div></main><section id="sideload-msg" class="sideload-container"><div class="sideload-skeleton"><div class="sk-header"><div class="sk-brand"><div class="sk-logo sk-shimmer"></div><div class="sk-title sk-shimmer"></div></div><div class="sk-header-actions"><div class="sk-icon-btn sk-shimmer"></div><div class="sk-icon-btn sk-shimmer"></div></div></div><div style="padding:0 16px"><div class="sk-mode-toggle"><div class="sk-mode-tab sk-shimmer"></div><div class="sk-mode-tab sk-shimmer"></div></div></div><div class="sk-welcome"><div class="sk-welcome-icon sk-shimmer"></div><div class="sk-welcome-title sk-shimmer"></div><div class="sk-welcome-desc sk-shimmer"></div><div class="sk-welcome-desc short sk-shimmer"></div></div><div class="sk-suggestions"><div class="sk-suggestion sk-shimmer"></div><div class="sk-suggestion sk-shimmer"></div><div class="sk-suggestion sk-shimmer"></div></div><div class="sk-input-area"><div style="padding:0 16px"><div class="sk-input sk-shimmer"></div></div></div><div class="sideload-status"><div class="sideload-pulse"></div><span id="loading-status">Initializing SheetOS AI...</span></div></div><div id="debug-fallback" style="display:none;position:fixed;inset:0;background:rgba(255,255,255,.98);padding:30px;z-index:10000;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-family:'Segoe UI',system-ui,sans-serif"><div style="background:#fff5f5;border:1px solid #ffd1d1;padding:24px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.05);max-width:320px"><div style="font-size:48px;margin-bottom:16px">üåê</div><h3 style="color:#e53e3e;margin:0 0 12px;font-size:18px">Connection Blocked</h3><p style="color:#718096;font-size:13px;line-height:1.6;margin-bottom:20px">Windows is preventing the Add-in from connecting to the local server.</p><div style="text-align:left;background:#fff;padding:12px;border-radius:8px;border:1px solid #edf2f7;font-size:12px;margin-bottom:20px"><strong style="color:#2d3748;display:block;margin-bottom:8px">Quick Fix:</strong><ol style="margin:0;padding-left:20px;color:#4a5568"><li style="margin-bottom:6px">Open <b>PowerShell</b> as Admin</li><li style="margin-bottom:6px">Paste and run this:</li></ol><code style="display:block;background:#f4f4f4;padding:8px;border-radius:4px;font-size:10px;word-break:break-all;margin-top:8px;color:#c53030;border:1px solid #e2e8f0">npx office-addin-dev-settings loopback --add 5552d631-21e7-4926-b20c-84c6c296efd5</code></div><a href="https://localhost:3000/taskpane.html" target="_blank" style="display:block;background:#e53e3e;color:#fff;text-decoration:none;padding:10px;border-radius:8px;font-weight:600;font-size:13px;margin-bottom:12px">Open Debug & Trust Cert </a><button onclick="location.reload()" style="background:0 0;border:none;color:#718096;font-size:12px;cursor:pointer;text-decoration:underline">Try Refreshing</button></div></div></section><template id="chat-skeleton-template"><div class="chat-msg ai skeleton-msg"><div class="chat-bubble skeleton-bubble"><div class="skeleton-line w80 sk-shimmer"></div><div class="skeleton-line w60 sk-shimmer"></div><div class="skeleton-line w40 sk-shimmer"></div></div></div></template><script>setTimeout(function(){var e=document.getElementById("app-body"),t=document.getElementById("debug-fallback");e&&"none"!==e.style.display||!t||(t.style.display="block")},3e4)</script></body></html>
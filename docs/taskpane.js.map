{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://sheetos-ai/webpack/runtime/chunk loaded","webpack://sheetos-ai/./src/taskpane/taskpane.css?9c07","webpack://sheetos-ai/./src/services/llm.service.ts","webpack://sheetos-ai/./src/services/prompt.ts","webpack://sheetos-ai/./src/services/cache.ts","webpack://sheetos-ai/./src/services/document-extractor.ts","webpack://sheetos-ai/./src/services/pdfService.ts","webpack://sheetos-ai/./src/services/agent-orchestrator.ts","webpack://sheetos-ai/./src/services/icons.ts","webpack://sheetos-ai/./src/taskpane/taskpane.ts","webpack://sheetos-ai/./src/services/chat-prompt.ts","webpack://sheetos-ai/./src/taskpane/taskpane.css","webpack://sheetos-ai/./src/taskpane/taskpane.html","webpack://sheetos-ai/webpack/bootstrap","webpack://sheetos-ai/webpack/runtime/compat get default export","webpack://sheetos-ai/webpack/runtime/define property getters","webpack://sheetos-ai/webpack/runtime/global","webpack://sheetos-ai/webpack/runtime/hasOwnProperty shorthand","webpack://sheetos-ai/webpack/runtime/publicPath","webpack://sheetos-ai/webpack/runtime/jsonp chunk loading","webpack://sheetos-ai/webpack/runtime/nonce","webpack://sheetos-ai/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./taskpane.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./taskpane.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * LLM Service  Abstraction layer for AI providers.\r\n * Stores separate model configs per provider to avoid cross-contamination.\r\n * Includes auto-retry with backoff for 429 rate limits.\r\n */\r\n\r\nexport interface LLMConfig {\r\n  provider: \"groq\" | \"local\" | \"gemini\" | \"openai\" | \"anthropic\" | \"openrouter\";\r\n  apiKey?: string;        // Storage for Groq Key (legacy name)\r\n  geminiKey?: string;     // Storage for Gemini Key\r\n  openaiKey?: string;     // Storage for OpenAI Key\r\n  anthropicKey?: string;  // Storage for Anthropic Key\r\n  openrouterKey?: string; // Storage for OpenRouter Key\r\n  baseUrl?: string;\r\n  model?: string;\r\n  groqModel?: string;\r\n  localModel?: string;\r\n  geminiModel?: string;\r\n  openaiModel?: string;\r\n  anthropicModel?: string;\r\n  openrouterModel?: string;\r\n}\r\n\r\ninterface ChatContentPart {\r\n  type: \"text\" | \"image_url\";\r\n  text?: string;\r\n  image_url?: { url: string };\r\n}\r\n\r\ninterface ChatMessage {\r\n  role: \"system\" | \"user\" | \"assistant\";\r\n  content: string | ChatContentPart[];\r\n}\r\n\r\nconst DEFAULT_GROQ_URL = \"https://api.groq.com/openai/v1/chat/completions\";\r\nconst DEFAULT_LOCAL_URL = \"http://localhost:11434/v1/chat/completions\";\r\nconst DEFAULT_GROQ_MODEL = \"llama-3.3-70b-versatile\";\r\n\r\n// Valid Groq models (guaranteed to work)\r\nexport const GROQ_MODELS = [\r\n  { id: \"llama-3.3-70b-versatile\", label: \"Llama 3.3 70B (Smart, Text-Only)\" },\r\n  { id: \"meta-llama/llama-4-maverick-17b-128e-instruct\", label: \"Llama 4 Maverick (Vision)\" },\r\n  { id: \"gemma2-9b-it\", label: \"Gemma 2 9B (15K TPM)\" },\r\n  { id: \"mixtral-8x7b-32768\", label: \"Mixtral 8x7B (5K TPM)\" },\r\n];\r\n\r\nexport const GEMINI_MODELS = [\r\n  { id: \"gemini-1.5-flash\", label: \"Gemini 1.5 Flash (Fast, Free)\" },\r\n  { id: \"gemini-1.5-pro\", label: \"Gemini 1.5 Pro (Smarter)\" },\r\n];\r\n\r\nexport const OPENAI_MODELS = [\r\n  { id: \"gpt-4o-mini\", label: \"GPT-4o Mini (Fast)\" },\r\n  { id: \"gpt-4o\", label: \"GPT-4o (Smart)\" },\r\n];\r\n\r\nexport const ANTHROPIC_MODELS = [\r\n  { id: \"claude-3-5-sonnet-20241022\", label: \"Claude 3.5 Sonnet (Best for Code)\" },\r\n  { id: \"claude-3-5-haiku-20241022\", label: \"Claude 3.5 Haiku (Fast)\" },\r\n];\r\n\r\nexport const OPENROUTER_MODELS = [\r\n  { id: \"anthropic/claude-3.5-sonnet:beta\", label: \"Claude 3.5 Sonnet\" },\r\n  { id: \"google/gemini-2.5-pro\", label: \"Gemini 2.5 Pro\" },\r\n  { id: \"openai/gpt-4o\", label: \"GPT-4o\" },\r\n  { id: \"meta-llama/llama-3.3-70b-instruct\", label: \"Llama 3.3 70B\" },\r\n];\r\n\r\nconst MAX_RETRIES = 3;\r\nconst BASE_DELAY_MS = 2000;\r\n\r\n/**\r\n * Get saved config from localStorage.\r\n */\r\nexport function getConfig(): LLMConfig {\r\n  try {\r\n    const saved = localStorage.getItem(\"sheetcraft_llm_config\");\r\n    if (saved) return JSON.parse(saved);\r\n  } catch (e) {\r\n    console.warn(\"Failed to load LLM config:\", e);\r\n  }\r\n  return {\r\n    provider: \"groq\",\r\n    apiKey: (typeof process !== \"undefined\" && process.env && process.env.GROQ_API_KEY) || \"\",\r\n    groqModel: \"llama-3.3-70b-versatile\",\r\n    localModel: \"qwen2.5-coder:7b\",\r\n  };\r\n}\r\n\r\n/**\r\n * Save config to localStorage.\r\n */\r\nexport function saveConfig(config: LLMConfig): void {\r\n  localStorage.setItem(\"sheetcraft_llm_config\", JSON.stringify(config));\r\n}\r\n\r\nfunction sleep(ms: number): Promise<void> {\r\n  return new Promise((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\n/**\r\n * Resolve the correct model for the active provider.\r\n * Automatically handles Vision model selection.\r\n */\r\nfunction resolveModel(cfg: LLMConfig, hasImages: boolean = false): string {\r\n  if (cfg.provider === \"groq\") {\r\n    if (hasImages) return \"meta-llama/llama-4-maverick-17b-128e-instruct\";\r\n    let model = cfg.groqModel || \"llama-3.3-70b-versatile\";\r\n    if (model.includes(\"llama-3.2\") && (model.includes(\"vision\") || model.includes(\"preview\"))) return \"llama-3.3-70b-versatile\";\r\n    if (model.includes(\":\")) return \"llama-3.3-70b-versatile\";\r\n    return model;\r\n  } else if (cfg.provider === \"gemini\") {\r\n    return cfg.geminiModel || \"gemini-1.5-flash\";\r\n  } else if (cfg.provider === \"openai\") {\r\n    return cfg.openaiModel || \"gpt-4o\";\r\n  } else if (cfg.provider === \"anthropic\") {\r\n    return cfg.anthropicModel || \"claude-3-5-sonnet-20241022\";\r\n  } else if (cfg.provider === \"openrouter\") {\r\n    return cfg.openrouterModel || \"anthropic/claude-3.5-sonnet:beta\";\r\n  } else {\r\n    return cfg.localModel || cfg.model || \"llama3\";\r\n  }\r\n}\r\n\r\nasync function callGemini(messages: ChatMessage[], model: string, apiKey: string, signal?: AbortSignal): Promise<string> {\r\n  const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;\r\n\r\n  const contents: any[] = [];\r\n  const systemParts: any[] = [];\r\n\r\n  messages.forEach(msg => {\r\n    if (msg.role === \"system\") {\r\n      const text = Array.isArray(msg.content)\r\n        ? msg.content.map(c => (c.type === \"text\" ? c.text : \"\")).join(\"\")\r\n        : msg.content;\r\n      if (text) systemParts.push({ text });\r\n    } else {\r\n      const role = msg.role === \"assistant\" ? \"model\" : \"user\";\r\n      const parts: any[] = [];\r\n\r\n      if (typeof msg.content === \"string\") {\r\n        if (msg.content) parts.push({ text: msg.content });\r\n      } else {\r\n        msg.content.forEach(c => {\r\n          if (c.type === \"text\" && c.text) parts.push({ text: c.text });\r\n          if (c.type === \"image_url\" && c.image_url) {\r\n            const base64 = c.image_url.url.split(\",\")[1]; // Remove data:image/png;base64,\r\n            if (base64) {\r\n              parts.push({ inline_data: { mime_type: \"image/png\", data: base64 } });\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      if (parts.length > 0) {\r\n        // Gemini requirement: roles must alternate. Merge consecutive same-role messages.\r\n        if (contents.length > 0 && contents[contents.length - 1].role === role) {\r\n          contents[contents.length - 1].parts.push(...parts);\r\n        } else {\r\n          contents.push({ role, parts });\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  // Gemini requirement: contents must start with user and end with user (for non-stream)\r\n  // Actually, it just needs to start with user. If it ends with model, it's fine for continuation.\r\n  // But we MUST have at least one message in contents if we don't have system_instruction.\r\n\r\n  const payload: any = {\r\n    contents,\r\n    generationConfig: { temperature: 0, topP: 1, maxOutputTokens: 4096 }\r\n  };\r\n\r\n  if (systemParts.length > 0) {\r\n    payload.system_instruction = { parts: systemParts };\r\n  }\r\n\r\n  // Final check: If no contents but we have system instructions, we need a dummy user message\r\n  if (contents.length === 0) {\r\n    contents.push({ role: \"user\", parts: [{ text: \"Hello. Please acknowledge system instructions.\" }] });\r\n  }\r\n\r\n  const response = await fetch(url, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(payload),\r\n    signal\r\n  });\r\n\r\n  if (!response.ok) {\r\n    const err = await response.text();\r\n    throw new Error(`Gemini Error (${response.status}): ${err}`);\r\n  }\r\n\r\n  const data = await response.json();\r\n  const text = data.candidates?.[0]?.content?.parts?.[0]?.text;\r\n  if (!text) throw new Error(\"Gemini returned empty response.\");\r\n  return text;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Core LLM dispatcher with automatic failover and retry logic.\r\n */\r\nexport async function callLLM(messages: ChatMessage[], config?: LLMConfig, signal?: AbortSignal): Promise<string> {\r\n  const primaryConfig = config || getConfig();\r\n  let currentConfig = { ...primaryConfig };\r\n  let failoverOccurred = false;\r\n\r\n  const hasImages = messages.some(m =>\r\n    Array.isArray(m.content) && m.content.some(p => p.type === \"image_url\")\r\n  );\r\n\r\n  for (let attempt = 0; attempt <= MAX_RETRIES; attempt++) {\r\n    try {\r\n      const model = resolveModel(currentConfig, hasImages);\r\n      let content = \"\";\r\n\r\n      // Route to appropriate provider handler\r\n      if (currentConfig.provider === \"gemini\") {\r\n        if (!currentConfig.geminiKey) throw new Error(\"Missing Gemini API Key\");\r\n        content = await callGemini(messages, model, currentConfig.geminiKey, signal);\r\n      }\r\n      else if (currentConfig.provider === \"openai\") {\r\n        if (!currentConfig.openaiKey) throw new Error(\"Missing OpenAI API Key\");\r\n        const resp = await fetch(\"https://api.openai.com/v1/chat/completions\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\", \"Authorization\": `Bearer ${currentConfig.openaiKey}` },\r\n          body: JSON.stringify({ messages, model, temperature: 0, top_p: 1, max_tokens: 4096 }),\r\n          signal\r\n        });\r\n        const data = await resp.json();\r\n        content = data.choices?.[0]?.message?.content || \"\";\r\n      }\r\n      else if (currentConfig.provider === \"anthropic\") {\r\n        if (!currentConfig.anthropicKey) throw new Error(\"Missing Anthropic API Key\");\r\n\r\n        // Anthropic requires a different payload structure, separating system messages\r\n        let systemPrompt = \"\";\r\n        const anthropicMessages: any[] = [];\r\n\r\n        messages.forEach(m => {\r\n          if (m.role === \"system\") {\r\n            systemPrompt = typeof m.content === \"string\" ? m.content : m.content.map(c => c.text || \"\").join(\"\");\r\n          } else {\r\n            anthropicMessages.push({\r\n              role: m.role,\r\n              content: typeof m.content === \"string\" ? m.content : m.content.map(c => {\r\n                if (c.type === \"text\") return { type: \"text\", text: c.text };\r\n                if (c.type === \"image_url\" && c.image_url) {\r\n                  const base64 = c.image_url.url.split(\",\")[1];\r\n                  return { type: \"image\", source: { type: \"base64\", media_type: \"image/png\", data: base64 } };\r\n                }\r\n                return { type: \"text\", text: \"\" };\r\n              }).filter(c => c.type === \"text\" ? c.text : true)\r\n            });\r\n          }\r\n        });\r\n\r\n        const resp = await fetch(\"https://api.anthropic.com/v1/messages\", {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            \"x-api-key\": currentConfig.anthropicKey,\r\n            \"anthropic-version\": \"2023-06-01\",\r\n            \"anthropic-dangerous-direct-browser-access\": \"true\"\r\n          },\r\n          body: JSON.stringify({\r\n            messages: anthropicMessages,\r\n            system: systemPrompt ? systemPrompt : undefined,\r\n            model,\r\n            max_tokens: 4096,\r\n            temperature: 0\r\n          }),\r\n          signal\r\n        });\r\n\r\n        if (!resp.ok) {\r\n          const errText = await resp.text();\r\n          if (resp.status === 429) throw new Error(\"RATE_LIMIT\");\r\n          throw new Error(`Anthropic Error (${resp.status}): ${errText.substring(0, 100)}`);\r\n        }\r\n\r\n        const data = await resp.json();\r\n        content = data.content?.[0]?.text || \"\";\r\n      }\r\n      else if (currentConfig.provider === \"openrouter\") {\r\n        if (!currentConfig.openrouterKey) throw new Error(\"Missing OpenRouter API Key\");\r\n        const resp = await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            \"Authorization\": `Bearer ${currentConfig.openrouterKey}`,\r\n            \"HTTP-Referer\": window.location.origin,\r\n            \"X-Title\": \"SheetOS AI Plugin\"\r\n          },\r\n          body: JSON.stringify({ messages, model, temperature: 0, top_p: 1, max_tokens: 4096 }),\r\n          signal\r\n        });\r\n\r\n        if (!resp.ok) {\r\n          const errText = await resp.text();\r\n          if (resp.status === 429) throw new Error(\"RATE_LIMIT\");\r\n          throw new Error(`OpenRouter Error (${resp.status}): ${errText.substring(0, 100)}`);\r\n        }\r\n\r\n        const data = await resp.json();\r\n        content = data.choices?.[0]?.message?.content || \"\";\r\n      }\r\n      else {\r\n        // Groq or Local\r\n        const url = currentConfig.provider === \"groq\" ? DEFAULT_GROQ_URL : (currentConfig.baseUrl || DEFAULT_LOCAL_URL);\r\n        const headers: Record<string, string> = { \"Content-Type\": \"application/json\" };\r\n        if (currentConfig.apiKey) headers[\"Authorization\"] = `Bearer ${currentConfig.apiKey}`;\r\n\r\n        const resp = await fetch(url, {\r\n          method: \"POST\",\r\n          headers,\r\n          body: JSON.stringify({ messages, model, temperature: 0, top_p: 1, max_tokens: 4096 }),\r\n          signal\r\n        });\r\n\r\n        if (!resp.ok) {\r\n          const errText = await resp.text();\r\n          const status = resp.status;\r\n\r\n          if (status === 429) throw new Error(\"RATE_LIMIT\");\r\n          throw new Error(`AI Error (${status}): ${errText.substring(0, 100)}`);\r\n        }\r\n\r\n        const data = await resp.json();\r\n        content = data.choices?.[0]?.message?.content || \"\";\r\n      }\r\n\r\n      // SHARED CLEANUP (Ensures no hallucinations/formatting issues across models)\r\n      if (!content) throw new Error(\"Empty response from AI\");\r\n\r\n      let cleanContent = content.trim();\r\n      cleanContent = cleanContent.replace(/^```(?:javascript|js|typescript|ts)?\\n?/i, \"\");\r\n      cleanContent = cleanContent.replace(/\\n?```$/i, \"\");\r\n      cleanContent = cleanContent.trim();\r\n      cleanContent = cleanContent.replace(/(?:const|let|var)\\s+sheet\\s*=\\s*.*?;/g, \"// sheet redeclaration removed\");\r\n\r\n      return cleanContent;\r\n\r\n    } catch (err: any) {\r\n      if (err.message === \"RATE_LIMIT\" || err.message.includes(\"429\")) {\r\n        if (attempt < MAX_RETRIES) {\r\n          const waitMs = BASE_DELAY_MS * Math.pow(2, attempt);\r\n          console.warn(`Rate limit retry ${attempt + 1}/${MAX_RETRIES} in ${waitMs}ms...`);\r\n          await sleep(waitMs);\r\n          continue;\r\n        }\r\n      }\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  throw new Error(\"Failed after maximum retries and possible failover.\");\r\n}\r\n\r\n/**\r\n * Fetch locally available Ollama models.\r\n */\r\nexport interface OllamaModel {\r\n  name: string;\r\n  size: number;\r\n  modified_at: string;\r\n}\r\n\r\nexport async function fetchOllamaModels(baseHost?: string): Promise<OllamaModel[]> {\r\n  const host = baseHost || \"http://localhost:11434\";\r\n  try {\r\n    const response = await fetch(`${host}/api/tags`, { method: \"GET\" });\r\n    if (!response.ok) throw new Error(`Ollama returned ${response.status}`);\r\n    const data = await response.json();\r\n    return (data.models || []).map((m: any) => ({\r\n      name: m.name,\r\n      size: m.size || 0,\r\n      modified_at: m.modified_at || \"\",\r\n    }));\r\n  } catch (e) {\r\n    console.warn(\"Could not fetch Ollama models:\", e);\r\n    return [];\r\n  }\r\n}\r\n","/**\r\n * SheetOS AI  Bulletproof System Prompt v2.0\r\n * Optimized for zero hallucination + production reliability.\r\n * \r\n * Key improvements:\r\n * - Explicit API whitelist and blacklist\r\n * - More examples for common patterns\r\n * - Better error prevention\r\n * - Anti-hallucination guards\r\n */\r\nexport const SYSTEM_PROMPT = `You are SheetOS AI, an Excel JavaScript API expert. Generate ONLY executable JS code.\r\n\r\n\r\nENVIRONMENT (Already available  DO NOT redeclare these):\r\n\r\n- context: Excel.RequestContext (ready to use)\r\n- sheet: Active worksheet (already loaded)\r\n- Excel: Namespace for enums (Excel.ChartType, Excel.BorderLineStyle, etc.)\r\n\r\n\r\nCRITICAL RULES (MUST FOLLOW):\r\n\r\n1. OUTPUT: Raw executable JavaScript ONLY. No markdown, no explanations.\r\n2. NO REDECLARATIONS: Never write \"const context = ...\" or \"const sheet = ...\"\r\n3. LOAD BEFORE READ: Properties like .values, .rowCount require .load() + await context.sync()\r\n4. 2D ARRAYS: range.values and range.formulas MUST be 2D arrays: [[value]]\r\n5. SYNC OFTEN: Call await context.sync() after every .load() before accessing properties\r\n6. SAFETY: Always check if range/data exists before operating on it\r\n\r\n\r\nBANNED PATTERNS (WILL CRASH  NEVER USE):\r\n\r\n .getValues()          Use: range.load(\"values\"); await context.sync(); range.values\r\n .getRowCount()        Use: range.load(\"rowCount\"); await context.sync(); range.rowCount\r\n .getColumnCount()     Use: range.load(\"columnCount\"); await context.sync(); range.columnCount\r\n .getAddress()         Use: range.load(\"address\"); await context.sync(); range.address\r\n .getText()            Use: range.load(\"text\"); await context.sync(); range.text\r\n .setValues(x)         Use: range.values = [[x]]\r\n .setFormula(x)        Use: range.formulas = [[\"=SUM(A:A)\"]]\r\n .setValue(x)          Use: range.values = [[x]]\r\n range.font.bold       Use: range.format.font.bold\r\n range.alignment       Use: range.format.horizontalAlignment\r\n chart.setTitle(x)     Use: chart.title.text = x\r\n chart.add()           Use: sheet.charts.add()\r\n range.getItem()       Use: range.getCell(row, col)\r\n range.select()        REMOVE (causes performance issues)\r\n range.activate()      REMOVE (not needed)\r\n SpreadsheetApp        WRONG PLATFORM (this is Google Apps Script)\r\n Logger.log()          REMOVE or use console.log\r\n Browser.msgBox()      REMOVE (not available)\r\n alert() / confirm()   REMOVE (blocked in add-ins)\r\n message.alert()       REMOVE (doesn't exist)\r\n getRange(\"A0\")        Row 0 doesn't exist. Use A1 or higher.\r\n const context = ...   ALREADY DECLARED\r\n const sheet = ...     ALREADY DECLARED\r\n\r\n\r\nCORRECT PATTERNS (COPY THESE):\r\n\r\n\r\n//  Read Data from Sheet \r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"values,rowCount,columnCount\");\r\nawait context.sync();\r\nconst data = usedRange.values; // Now accessible\r\nconst rows = usedRange.rowCount;\r\nconst cols = usedRange.columnCount;\r\n\r\n//  Write Data (Single Cell) \r\nsheet.getRange(\"A1\").values = [[\"Hello World\"]];\r\n\r\n//  Write Data (Multiple Cells) \r\nsheet.getRange(\"A1:C2\").values = [\r\n  [\"Name\", \"Age\", \"City\"],\r\n  [\"John\", 25, \"NYC\"]\r\n];\r\n\r\n//  Formulas \r\nsheet.getRange(\"D2\").formulas = [[\"=SUM(B2:C2)\"]];\r\n// Multiple formulas:\r\nsheet.getRange(\"D2:D5\").formulas = [\r\n  [\"=SUM(B2:C2)\"],\r\n  [\"=SUM(B3:C3)\"],\r\n  [\"=SUM(B4:C4)\"],\r\n  [\"=SUM(B5:C5)\"]\r\n];\r\n\r\n//  Formatting \r\nconst r = sheet.getRange(\"A1:D1\");\r\nr.format.font.bold = true;\r\nr.format.font.color = \"#FFFFFF\";\r\nr.format.fill.color = \"#4472C4\";\r\nr.format.horizontalAlignment = \"Center\";\r\nr.format.verticalAlignment = \"Center\";\r\nr.format.rowHeight = 28;\r\n\r\n//  Borders \r\nconst range = sheet.getRange(\"A1:D10\");\r\nrange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nrange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nrange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nrange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nrange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nrange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\n\r\n//  Charts \r\nconst chartRange = sheet.getRange(\"A1:B5\");\r\nconst chart = sheet.charts.add(Excel.ChartType.columnClustered, chartRange, Excel.ChartSeriesBy.auto);\r\nchart.title.text = \"Sales Report\";\r\nchart.setPosition(\"E2\", \"L15\");\r\n\r\n//  Tables \r\nconst tableRange = sheet.getRange(\"A1:D10\");\r\nconst table = sheet.tables.add(tableRange, true);\r\ntable.name = \"SalesTable\";\r\ntable.style = \"TableStyleMedium9\";\r\n\r\n//  Conditional Formatting \r\nconst cfRange = sheet.getRange(\"C2:C100\");\r\nconst cf = cfRange.conditionalFormats.add(Excel.ConditionalFormatType.cellValue);\r\ncf.cellValue.format.fill.color = \"#92D050\";\r\ncf.cellValue.rule = { formula1: \"=50\", operator: \"GreaterThan\" };\r\n\r\n//  Data Validation (Dropdown) \r\nsheet.getRange(\"E2:E100\").dataValidation.rule = {\r\n  list: { inCellDropDown: true, source: \"Yes,No,Maybe\" }\r\n};\r\n\r\n//  Sort \r\nsheet.getUsedRange().sort.apply([{ key: 0, ascending: true }]);\r\n\r\n//  Filter \r\nconst filterRange = sheet.getUsedRange();\r\nfilterRange.autoFilter.apply(filterRange, 0);\r\n\r\n//  Freeze Panes \r\nsheet.freezePanes.freezeRows(1);\r\n\r\n//  Number Format \r\nsheet.getRange(\"B2:B100\").numberFormat = [[\"$#,##0.00\"]];\r\nsheet.getRange(\"C2:C100\").numberFormat = [[\"0.0%\"]];\r\n\r\n//  Clear Contents \r\nsheet.getUsedRange().clear(Excel.ClearApplyTo.Contents);\r\n\r\n//  New Worksheet \r\nconst newSheet = context.workbook.worksheets.add(\"Report\");\r\nnewSheet.activate();\r\n\r\n//  Autofit Columns (ALWAYS DO THIS AT END) \r\nsheet.getUsedRange().format.autofitColumns();\r\n\r\n//  Data Cleanup (Trim Whitespace) \r\nconst range = sheet.getUsedRange();\r\nrange.load(\"values\");\r\nawait context.sync();\r\nconst cleanValues = range.values.map(row => \r\n  row.map(cell => (typeof cell === \"string\" ? cell.trim() : cell))\r\n);\r\nrange.values = cleanValues;\r\nawait context.sync();\r\n\r\n//  Data Cleanup (Remove Empty Rows) \r\nconst rangeToClean = sheet.getUsedRange();\r\nrangeToClean.load(\"values,rowCount\");\r\nawait context.sync();\r\nfor (let i = rangeToClean.rowCount - 1; i >= 0; i--) {\r\n  const rowVals = rangeToClean.values[i];\r\n  if (rowVals.every(v => v === null || v === \"\")) {\r\n    sheet.getRange((i + 1) + \":\" + (i + 1)).delete(Excel.DeleteShiftDirection.up);\r\n  }\r\n}\r\nawait context.sync();\r\n\r\n\r\nMANDATORY writeData HELPER (Include this for any data writing):\r\n\r\nfunction writeData(sheet, startCell, data) {\r\n  if (!data || data.length === 0) return null;\r\n  const rows = data.length;\r\n  const cols = Math.max(...data.map(r => r ? r.length : 0));\r\n  if (cols === 0) return null;\r\n  const normalized = data.map(r => {\r\n    const row = r ? [...r] : [];\r\n    while (row.length < cols) row.push(\"\");\r\n    return row;\r\n  });\r\n  const range = sheet.getRange(startCell).getResizedRange(rows - 1, cols - 1);\r\n  range.values = normalized;\r\n  range.format.autofitColumns();\r\n  return range;\r\n}\r\n\r\n\r\nANTI-HALLUCINATION RULES (For Document/PDF Extraction):\r\n\r\n1. EXTRACT ONLY WHAT YOU SEE: Never invent data that isn't in the image/PDF\r\n2. EMPTY IF MISSING: If a field (phone, email, etc.) isn't visible, use \"\" not \"N/A\"\r\n3. NO GUESSING: Don't make up names, numbers, or dates\r\n4. PRESERVE EXACT TEXT: Copy text exactly as shown (don't \"fix\" typos unless asked)\r\n5. ONE ROW PER DOCUMENT: Each PDF/resume = exactly one data row\r\n6. MATCH SCHEMA: If column headers exist, ONLY extract data for those columns\r\n\r\n\r\nDESIGN BEST PRACTICES:\r\n\r\n1. HEADERS: Bold, dark background (#1B4D3E or #2D6A4F), white text\r\n2. NUMBERS: Currency \"$#,##0.00\", Percentage \"0.0%\", Integer \"#,##0\"\r\n3. DATES: Format as \"Short Date\" or \"YYYY-MM-DD\" string\r\n4. COLORS: Professional muted tones  no neon, no pure red/blue\r\n5. ZEBRA STRIPES: White and light gray (#F5F5F5) alternating rows\r\n6. ROW HEIGHT: Headers 28px, Data 20px\r\n7. ALWAYS: End with sheet.getUsedRange().format.autofitColumns()\r\n\r\n\r\nSCHEMA-AWARE EXTRACTION (When EXISTING_COLUMNS provided):\r\n\r\nWhen given \"EXISTING_COLUMNS: [...]\":\r\n1. Extract ONLY data matching those columns\r\n2. Use intelligent matching: \"Phone\" = \"Mobile No\" = \"Contact Number\"\r\n3. Leave cells empty (\"\") if data not found  NEVER write \"Not Found\"\r\n4. Append to first empty row after existing data\r\n\r\nUser Prompt:\r\n`;\r\n\r\n","/**\r\n * Simple prompt-response cache using localStorage.\r\n * Avoids redundant API calls for identical prompts.\r\n */\r\n\r\nconst CACHE_KEY = \"sheetcraft_cache\";\r\nconst CACHE_VERSION_KEY = \"sheetcraft_cache_ver\";\r\nconst CACHE_VERSION = 2; // Bump this when prompt changes significantly\r\nconst MAX_ENTRIES = 50;\r\n\r\n// Auto-clear cache if version changed (prompt was updated)\r\nfunction ensureCacheVersion(): void {\r\n  try {\r\n    const ver = localStorage.getItem(CACHE_VERSION_KEY);\r\n    if (ver !== String(CACHE_VERSION)) {\r\n      localStorage.removeItem(CACHE_KEY);\r\n      localStorage.setItem(CACHE_VERSION_KEY, String(CACHE_VERSION));\r\n    }\r\n  } catch {}\r\n}\r\n\r\ninterface CacheEntry {\r\n  prompt: string;\r\n  response: string;\r\n  timestamp: number;\r\n}\r\n\r\nfunction getCache(): CacheEntry[] {\r\n  try {\r\n    const raw = localStorage.getItem(CACHE_KEY);\r\n    return raw ? JSON.parse(raw) : [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nfunction setCache(entries: CacheEntry[]): void {\r\n  // Keep only the most recent entries\r\n  const trimmed = entries.slice(-MAX_ENTRIES);\r\n  localStorage.setItem(CACHE_KEY, JSON.stringify(trimmed));\r\n}\r\n\r\n/**\r\n * Look up a cached response for the given prompt.\r\n * Returns null if not found or expired (>1 hour).\r\n */\r\nexport function getCachedResponse(prompt: string): string | null {\r\n  ensureCacheVersion();\r\n  const entries = getCache();\r\n  const key = prompt.trim().toLowerCase();\r\n  const match = entries.find((e) => e.prompt === key);\r\n\r\n  if (!match) return null;\r\n\r\n  // Expire after 1 hour\r\n  const ONE_HOUR = 60 * 60 * 1000;\r\n  if (Date.now() - match.timestamp > ONE_HOUR) return null;\r\n\r\n  return match.response;\r\n}\r\n\r\n/**\r\n * Store a prompt-response pair in the cache.\r\n */\r\nexport function cacheResponse(prompt: string, response: string): void {\r\n  const entries = getCache();\r\n  const key = prompt.trim().toLowerCase();\r\n\r\n  // Remove existing entry for same prompt\r\n  const filtered = entries.filter((e) => e.prompt !== key);\r\n  filtered.push({ prompt: key, response, timestamp: Date.now() });\r\n\r\n  setCache(filtered);\r\n}\r\n\r\n/**\r\n * Clear the entire cache.\r\n */\r\nexport function clearCache(): void {\r\n  localStorage.removeItem(CACHE_KEY);\r\n}\r\n","/**\r\n * Document Extractor Service\r\n * Schema-aware extraction from PDFs/CVs that only extracts data for specified columns.\r\n * NO HALLUCINATION - if data doesn't exist, leave it blank.\r\n */\r\n\r\nexport interface ExtractionSchema {\r\n  columns: string[];\r\n  strict: boolean; // If true, only extract these columns. If false, suggest additional columns.\r\n}\r\n\r\nexport interface ExtractedRow {\r\n  [key: string]: string;\r\n}\r\n\r\nexport interface ExtractionResult {\r\n  success: boolean;\r\n  data: ExtractedRow[];\r\n  warnings: string[];\r\n  unmappedFields: string[];\r\n}\r\n\r\n/**\r\n * Get the schema-aware extraction prompt\r\n */\r\nexport function getSchemaExtractionPrompt(schema: ExtractionSchema): string {\r\n  const columnList = schema.columns.map((c, i) => `${i + 1}. \"${c}\"`).join(\"\\n\");\r\n  \r\n  return `You are a PRECISION DATA EXTRACTOR. Your job is to extract information from documents with ZERO hallucination.\r\n\r\n\r\nCRITICAL RULES  MEMORIZE THESE:\r\n\r\n\r\n1. **SCHEMA LOCKED**: The user has predefined these columns in Excel. You MUST ONLY extract data for these columns:\r\n${columnList}\r\n\r\n2. **NO FABRICATION**: If a piece of information is NOT explicitly present in the document, return an EMPTY STRING (\"\"). Do NOT guess, infer, or make up data.\r\n\r\n3. **EXACT MATCHING**: \r\n   - \"Name\"  Look for full name (first + last)\r\n   - \"Email\"  Look for @email patterns\r\n   - \"Phone\" / \"Mobile\" / \"Contact\"  Look for phone numbers\r\n   - \"Age\"  Look for age OR calculate from DOB if present\r\n   - \"Address\"  Full address if available\r\n   - \"Skills\"  Technical skills, languages, tools\r\n   - \"Experience\"  Years or job titles\r\n   - \"Education\"  Degrees, institutions\r\n   - \"LinkedIn\"  LinkedIn URLs only\r\n\r\n4. **DATA CLEANING**:\r\n   - Names: Proper Case (John Smith, not JOHN SMITH)\r\n   - Phones: Keep original format or standardize to +1-XXX-XXX-XXXX\r\n   - Emails: Lowercase\r\n   - Dates: Keep as found (Jan 2020 - Dec 2022)\r\n\r\n5. **ONE ROW PER DOCUMENT**: Each uploaded PDF/image represents ONE candidate/record. Output exactly one row of data per document.\r\n\r\n\r\nOUTPUT FORMAT:\r\n\r\n\r\nReturn a JSON array of objects. Each object has keys matching the column names EXACTLY.\r\n\r\nExample for columns [\"Name\", \"Email\", \"Phone\", \"Skills\"]:\r\n[\r\n  {\"Name\": \"John Smith\", \"Email\": \"john@email.com\", \"Phone\": \"+1-555-123-4567\", \"Skills\": \"Python, Excel, SQL\"},\r\n  {\"Name\": \"Jane Doe\", \"Email\": \"jane.doe@company.com\", \"Phone\": \"\", \"Skills\": \"JavaScript, React\"}\r\n]\r\n\r\nNote: Jane Doe had no phone number visible in her resume, so it's left as \"\".\r\n\r\n\r\nWHAT NOT TO DO:\r\n\r\n\r\n Do NOT add columns that aren't in the schema\r\n Do NOT guess email addresses (e.g., firstname.lastname@company.com)\r\n Do NOT fabricate phone numbers\r\n Do NOT hallucinate skills or experience not mentioned\r\n Do NOT include \"N/A\", \"Not Found\", \"Unknown\"  use \"\" instead\r\n Do NOT include markdown formatting  ONLY raw JSON\r\n\r\n\r\nNOW EXTRACT FROM THE ATTACHED DOCUMENTS:\r\n\r\n`;\r\n}\r\n\r\n/**\r\n * Generate Excel code that writes extracted data to the sheet\r\n */\r\nexport function generateExcelCode(columns: string[], data: ExtractedRow[]): string {\r\n  // Serialize data for JS injection\r\n  const serializedData = JSON.stringify(data, null, 2);\r\n  const serializedColumns = JSON.stringify(columns);\r\n\r\n  return `\r\n//  Schema-Aware Resume Extraction \r\n// Columns: ${columns.join(\", \")}\r\n// Records: ${data.length}\r\n\r\nfunction writeData(sheet, startCell, data) {\r\n    if (!data || data.length === 0) return null;\r\n    const rows = data.length;\r\n    const cols = Math.max(...data.map(r => r ? r.length : 0)); \r\n    if (cols === 0) return null;\r\n    const normalized = data.map(r => {\r\n        const row = r ? [...r] : [];\r\n        while (row.length < cols) row.push(\"\");\r\n        return row;\r\n    });\r\n    try {\r\n        const range = sheet.getRange(startCell).getResizedRange(rows - 1, cols - 1);\r\n        range.values = normalized;\r\n        range.format.font.name = \"Segoe UI\";\r\n        range.format.font.size = 10;\r\n        range.format.verticalAlignment = \"Center\";\r\n        range.format.autofitColumns();\r\n        return range;\r\n    } catch (e) {\r\n        console.error(\"writeData error:\", e);\r\n        return null;\r\n    }\r\n}\r\n\r\n// Extracted Data\r\nconst columns = ${serializedColumns};\r\nconst extractedData = ${serializedData};\r\n\r\n// Check if headers exist (row 1)\r\nconst headerRange = sheet.getRange(\"A1\").getResizedRange(0, columns.length - 1);\r\nheaderRange.load(\"values\");\r\nawait context.sync();\r\n\r\nconst existingHeaders = headerRange.values[0];\r\nconst hasHeaders = existingHeaders.some(h => h && h.toString().trim() !== \"\");\r\n\r\nlet startRow = 2; // Default: after headers\r\n\r\nif (!hasHeaders) {\r\n    // No headers  write them first\r\n    const headerData = [columns];\r\n    const headerWriteRange = writeData(sheet, \"A1\", headerData);\r\n    if (headerWriteRange) {\r\n        headerWriteRange.format.font.bold = true;\r\n        headerWriteRange.format.fill.color = \"#2D6A4F\";\r\n        headerWriteRange.format.font.color = \"#FFFFFF\";\r\n        headerWriteRange.format.rowHeight = 28;\r\n    }\r\n} else {\r\n    // Headers exist  find the last row with data\r\n    const usedRange = sheet.getUsedRange();\r\n    usedRange.load(\"rowCount\");\r\n    await context.sync();\r\n    startRow = usedRange.rowCount + 1;\r\n}\r\n\r\n// Convert extracted objects to 2D array matching column order\r\nconst dataRows = extractedData.map(record => {\r\n    return columns.map(col => {\r\n        const value = record[col];\r\n        return value !== undefined && value !== null ? String(value) : \"\";\r\n    });\r\n});\r\n\r\nif (dataRows.length > 0) {\r\n    const dataRange = writeData(sheet, \"A\" + startRow, dataRows);\r\n    \r\n    if (dataRange) {\r\n        // Apply alternating row colors\r\n        for (let i = 0; i < dataRows.length; i++) {\r\n            const row = dataRange.getRow(i);\r\n            if (i % 2 === 0) {\r\n                row.format.fill.color = \"#F0FAF5\";\r\n            }\r\n        }\r\n        \r\n        // Apply borders\r\n        const borderStyle = \"Thin\";\r\n        dataRange.format.borders.getItem(\"InsideHorizontal\").style = borderStyle;\r\n        dataRange.format.borders.getItem(\"InsideVertical\").style = borderStyle;\r\n        dataRange.format.borders.getItem(\"EdgeTop\").style = borderStyle;\r\n        dataRange.format.borders.getItem(\"EdgeBottom\").style = borderStyle;\r\n        dataRange.format.borders.getItem(\"EdgeLeft\").style = borderStyle;\r\n        dataRange.format.borders.getItem(\"EdgeRight\").style = borderStyle;\r\n    }\r\n}\r\n\r\n// Final autofit\r\nsheet.getUsedRange().format.autofitColumns();\r\n`;\r\n}\r\n\r\n/**\r\n * Parse LLM response to extract JSON data\r\n */\r\nexport function parseExtractionResponse(response: string): ExtractedRow[] {\r\n  // Clean the response - remove markdown code blocks\r\n  let cleaned = response.trim();\r\n  cleaned = cleaned.replace(/^```json?\\s*/i, \"\");\r\n  cleaned = cleaned.replace(/\\s*```$/i, \"\");\r\n  cleaned = cleaned.trim();\r\n  \r\n  // Try to find JSON array in the response\r\n  const jsonMatch = cleaned.match(/\\[[\\s\\S]*\\]/);\r\n  if (!jsonMatch) {\r\n    console.warn(\"No JSON array found in response:\", cleaned.substring(0, 200));\r\n    return [];\r\n  }\r\n  \r\n  try {\r\n    const parsed = JSON.parse(jsonMatch[0]);\r\n    if (!Array.isArray(parsed)) {\r\n      console.warn(\"Parsed result is not an array\");\r\n      return [];\r\n    }\r\n    return parsed as ExtractedRow[];\r\n  } catch (e) {\r\n    console.error(\"JSON parse error:\", e);\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * Validate extracted data against schema\r\n */\r\nexport function validateExtraction(data: ExtractedRow[], schema: ExtractionSchema): ExtractionResult {\r\n  const warnings: string[] = [];\r\n  const unmappedFields: string[] = [];\r\n  \r\n  // Check each row for unmapped fields\r\n  data.forEach((row, index) => {\r\n    Object.keys(row).forEach(key => {\r\n      if (!schema.columns.includes(key) && !unmappedFields.includes(key)) {\r\n        unmappedFields.push(key);\r\n      }\r\n    });\r\n    \r\n    // Check for empty required fields\r\n    schema.columns.forEach(col => {\r\n      if (!row[col] || row[col].toString().trim() === \"\") {\r\n        warnings.push(`Row ${index + 1}: \"${col}\" is empty`);\r\n      }\r\n    });\r\n  });\r\n  \r\n  if (unmappedFields.length > 0) {\r\n    warnings.push(`Found data for columns not in schema: ${unmappedFields.join(\", \")}`);\r\n  }\r\n  \r\n  return {\r\n    success: data.length > 0,\r\n    data,\r\n    warnings,\r\n    unmappedFields\r\n  };\r\n}\r\n\r\n/**\r\n * Common column name mappings for intelligent matching\r\n */\r\nexport const COLUMN_ALIASES: Record<string, string[]> = {\r\n  \"Name\": [\"Full Name\", \"Candidate Name\", \"Applicant Name\", \"First Name\", \"First\", \"Naam\"],\r\n  \"Email\": [\"E-mail\", \"Email Address\", \"E-Mail\", \"Mail\", \"Contact Email\"],\r\n  \"Phone\": [\"Mobile\", \"Mobile No\", \"Mobile Number\", \"Contact\", \"Contact No\", \"Phone Number\", \"Tel\", \"Telephone\"],\r\n  \"Age\": [\"Years\", \"DOB\", \"Date of Birth\", \"Birth Date\"],\r\n  \"Address\": [\"Location\", \"City\", \"Current Location\", \"Residence\"],\r\n  \"Skills\": [\"Technical Skills\", \"Key Skills\", \"Skillset\", \"Expertise\", \"Technologies\"],\r\n  \"Experience\": [\"Work Experience\", \"Total Experience\", \"Years of Experience\", \"Professional Experience\"],\r\n  \"Education\": [\"Qualification\", \"Degree\", \"Academic\", \"Educational Qualification\"],\r\n  \"LinkedIn\": [\"LinkedIn URL\", \"LinkedIn Profile\", \"Profile URL\"],\r\n  \"Company\": [\"Current Company\", \"Organization\", \"Employer\", \"Current Employer\"],\r\n  \"Position\": [\"Role\", \"Job Title\", \"Designation\", \"Current Role\", \"Title\"],\r\n  \"Summary\": [\"Profile Summary\", \"About\", \"Objective\", \"Career Objective\"],\r\n};\r\n\r\n/**\r\n * Normalize column name to standard form\r\n */\r\nexport function normalizeColumnName(columnName: string): string {\r\n  const normalized = columnName.trim();\r\n  \r\n  // Check direct match first\r\n  if (COLUMN_ALIASES[normalized]) {\r\n    return normalized;\r\n  }\r\n  \r\n  // Check aliases\r\n  for (const [standard, aliases] of Object.entries(COLUMN_ALIASES)) {\r\n    if (aliases.some(alias => alias.toLowerCase() === normalized.toLowerCase())) {\r\n      return standard;\r\n    }\r\n  }\r\n  \r\n  return normalized;\r\n}\r\n\r\n/**\r\n * Build extraction prompt with column aliases for better matching\r\n */\r\nexport function buildEnhancedPrompt(columns: string[]): string {\r\n  const columnDetails = columns.map(col => {\r\n    const aliases = COLUMN_ALIASES[col] || [];\r\n    const aliasHint = aliases.length > 0 ? ` (also look for: ${aliases.slice(0, 3).join(\", \")})` : \"\";\r\n    return ` \"${col}\"${aliasHint}`;\r\n  }).join(\"\\n\");\r\n  \r\n  return `\r\nCOLUMNS TO EXTRACT:\r\n${columnDetails}\r\n\r\nRemember: If you cannot find data for a column, return \"\". Never guess or fabricate.\r\n`;\r\n}","/**\r\n * PDF Service - Extracts plain text from PDFs using pdf-parse\r\n * This provides clean text extraction before LLM processing\r\n */\r\n\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\nimport { PDFExtractionResult } from \"./types\";\r\n\r\n// Configure PDF.js worker\r\npdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n\r\n/**\r\n * Extract text from a PDF file using PDF.js (browser-compatible)\r\n * @param fileBuffer - ArrayBuffer of the PDF file\r\n * @returns Extracted text and metadata\r\n */\r\nexport async function extractTextFromPDF(fileBuffer: ArrayBuffer): Promise<PDFExtractionResult> {\r\n  try {\r\n    const loadingTask = pdfjsLib.getDocument({ data: fileBuffer });\r\n    const pdf = await loadingTask.promise;\r\n\r\n    const totalPages = pdf.numPages;\r\n    let fullText = \"\";\r\n\r\n    // Extract text from each page\r\n    for (let pageNum = 1; pageNum <= totalPages; pageNum++) {\r\n      const page = await pdf.getPage(pageNum);\r\n      const textContent = await page.getTextContent();\r\n      \r\n      // Combine text items with proper spacing\r\n      const pageText = textContent.items\r\n        .map((item: any) => item.str)\r\n        .join(\" \");\r\n      \r\n      fullText += pageText + \"\\n\\n\";\r\n    }\r\n\r\n    // Extract metadata\r\n    const metadata = await pdf.getMetadata();\r\n    const info = metadata.info as any;\r\n    \r\n    return {\r\n      text: cleanExtractedText(fullText),\r\n      pages: totalPages,\r\n      metadata: {\r\n        title: info?.Title,\r\n        author: info?.Author,\r\n        subject: info?.Subject,\r\n        creator: info?.Creator,\r\n      },\r\n    };\r\n  } catch (error) {\r\n    throw new Error(`PDF extraction failed: ${error instanceof Error ? error.message : String(error)}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Extract text from a PDF file (File object from input)\r\n * @param file - File object from file input\r\n * @returns Extracted text and metadata\r\n */\r\nexport async function extractTextFromPDFFile(file: File): Promise<PDFExtractionResult> {\r\n  const arrayBuffer = await file.arrayBuffer();\r\n  return extractTextFromPDF(arrayBuffer);\r\n}\r\n\r\n/**\r\n * Extract text from a base64-encoded PDF string\r\n * @param base64String - Base64-encoded PDF data\r\n * @returns Extracted text and metadata\r\n */\r\nexport async function extractTextFromBase64PDF(base64String: string): Promise<PDFExtractionResult> {\r\n  // Remove data URL prefix if present\r\n  const base64Data = base64String.replace(/^data:application\\/pdf;base64,/, \"\");\r\n  \r\n  // Convert base64 to ArrayBuffer\r\n  const binaryString = atob(base64Data);\r\n  const bytes = new Uint8Array(binaryString.length);\r\n  for (let i = 0; i < binaryString.length; i++) {\r\n    bytes[i] = binaryString.charCodeAt(i);\r\n  }\r\n  \r\n  return extractTextFromPDF(bytes.buffer);\r\n}\r\n\r\n/**\r\n * Clean and normalize extracted text\r\n * @param text - Raw extracted text\r\n * @returns Cleaned text\r\n */\r\nfunction cleanExtractedText(text: string): string {\r\n  return text\r\n    // Remove excessive whitespace\r\n    .replace(/\\s+/g, \" \")\r\n    // Remove control characters except newlines\r\n    .replace(/[\\x00-\\x08\\x0B-\\x0C\\x0E-\\x1F\\x7F]/g, \"\")\r\n    // Normalize line breaks\r\n    .replace(/\\r\\n/g, \"\\n\")\r\n    .replace(/\\r/g, \"\\n\")\r\n    // Remove multiple consecutive newlines (keep max 2)\r\n    .replace(/\\n{3,}/g, \"\\n\\n\")\r\n    // Trim leading/trailing whitespace\r\n    .trim();\r\n}\r\n\r\n/**\r\n * Validate if a buffer is a valid PDF\r\n * @param buffer - ArrayBuffer to validate\r\n * @returns True if valid PDF\r\n */\r\nexport function isValidPDF(buffer: ArrayBuffer): boolean {\r\n  const uint8Array = new Uint8Array(buffer);\r\n  // PDF files start with %PDF-\r\n  return (\r\n    uint8Array.length >= 5 &&\r\n    uint8Array[0] === 0x25 && // %\r\n    uint8Array[1] === 0x50 && // P\r\n    uint8Array[2] === 0x44 && // D\r\n    uint8Array[3] === 0x46 && // F\r\n    uint8Array[4] === 0x2d    // -\r\n  );\r\n}\r\n\r\n/**\r\n * Extract text from multiple PDFs in parallel\r\n * @param files - Array of File objects\r\n * @param maxConcurrency - Maximum parallel extractions\r\n * @returns Array of extraction results\r\n */\r\nexport async function extractTextFromMultiplePDFs(\r\n  files: File[],\r\n  maxConcurrency: number = 5\r\n): Promise<Array<{ file: File; result?: PDFExtractionResult; error?: string }>> {\r\n  const results: Array<{ file: File; result?: PDFExtractionResult; error?: string }> = [];\r\n  \r\n  for (let i = 0; i < files.length; i += maxConcurrency) {\r\n    const batch = files.slice(i, i + maxConcurrency);\r\n    \r\n    const batchResults = await Promise.allSettled(\r\n      batch.map(async (file) => {\r\n        try {\r\n          const result = await extractTextFromPDFFile(file);\r\n          return { file, result };\r\n        } catch (error) {\r\n          return {\r\n            file,\r\n            error: error instanceof Error ? error.message : String(error),\r\n          };\r\n        }\r\n      })\r\n    );\r\n    \r\n    batchResults.forEach((settled) => {\r\n      if (settled.status === \"fulfilled\") {\r\n        results.push(settled.value);\r\n      } else {\r\n        results.push({\r\n          file: batch[results.length % maxConcurrency],\r\n          error: settled.reason,\r\n        });\r\n      }\r\n    });\r\n  }\r\n  \r\n  return results;\r\n}\r\n","/**\r\n * SheetOS AI  Agent Orchestrator\r\n * LangChain-inspired intelligent agent system for bulletproof Excel automation.\r\n * \r\n * Architecture:\r\n * 1. PLANNER - Analyzes task and creates execution plan\r\n * 2. CODER - Generates Excel JavaScript API code\r\n * 3. VALIDATOR - Validates code syntax and API usage\r\n * 4. EXECUTOR - Executes code with sandboxing\r\n * 5. FIXER - Recovers from errors with context\r\n * \r\n * Anti-Hallucination Strategy:\r\n * - Strict API whitelist\r\n * - Banned pattern detection\r\n * - Syntax validation before execution\r\n * - Structured output parsing\r\n */\r\n\r\nimport { callLLM, getConfig } from \"./llm.service\";\r\n\r\n// \r\n// TYPES & INTERFACES\r\n// \r\n\r\nexport interface AgentState {\r\n  task: string;\r\n  plan: TaskPlan | null;\r\n  code: string;\r\n  validationResult: ValidationResult | null;\r\n  executionResult: ExecutionResult | null;\r\n  retryCount: number;\r\n  conversationHistory: ConversationMessage[];\r\n  sheetContext: SheetContext | null;\r\n  attachedFiles: AttachedFile[];\r\n}\r\n\r\nexport interface TaskPlan {\r\n  understanding: string;\r\n  steps: string[];\r\n  dataNeeded: string[];\r\n  expectedOutput: string;\r\n  complexity: \"simple\" | \"moderate\" | \"complex\";\r\n  warnings: string[];\r\n}\r\n\r\nexport interface ValidationResult {\r\n  isValid: boolean;\r\n  errors: ValidationError[];\r\n  warnings: string[];\r\n  sanitizedCode: string;\r\n  apiCallsDetected: string[];\r\n}\r\n\r\nexport interface ValidationError {\r\n  type: \"syntax\" | \"banned_api\" | \"missing_sync\" | \"unsafe_pattern\" | \"type_error\";\r\n  message: string;\r\n  line?: number;\r\n  suggestion: string;\r\n}\r\n\r\nexport interface ExecutionResult {\r\n  success: boolean;\r\n  error?: string;\r\n  errorType?: \"runtime\" | \"api_error\" | \"timeout\" | \"unknown\";\r\n  duration: number;\r\n}\r\n\r\nexport interface ConversationMessage {\r\n  role: \"system\" | \"user\" | \"assistant\" | \"error\";\r\n  content: string;\r\n  timestamp: number;\r\n}\r\n\r\nexport interface SheetContext {\r\n  sheetName: string;\r\n  rowCount: number;\r\n  columnCount: number;\r\n  headers: string[];\r\n  sampleData: any[][];\r\n  dataTypes: string[];\r\n  hasData: boolean;\r\n}\r\n\r\nexport interface AttachedFile {\r\n  name: string;\r\n  type: \"image\" | \"pdf\";\r\n  data: string[];\r\n}\r\n\r\n// \r\n// BANNED PATTERNS  These cause runtime errors in Excel JS API\r\n// \r\n\r\nconst BANNED_PATTERNS: { pattern: RegExp; message: string; fix: string }[] = [\r\n  // Method calls that don't exist\r\n  { pattern: /\\.getColumnCount\\s*\\(\\s*\\)/g, message: \"getColumnCount() doesn't exist\", fix: \"load('columnCount') then use .columnCount property\" },\r\n  { pattern: /\\.getRowCount\\s*\\(\\s*\\)/g, message: \"getRowCount() doesn't exist\", fix: \"load('rowCount') then use .rowCount property\" },\r\n  { pattern: /\\.getAddress\\s*\\(\\s*\\)/g, message: \"getAddress() doesn't exist\", fix: \"load('address') then use .address property\" },\r\n  { pattern: /\\.getValues\\s*\\(\\s*\\)/g, message: \"getValues() doesn't exist\", fix: \"load('values') then use .values property\" },\r\n  { pattern: /\\.getText\\s*\\(\\s*\\)/g, message: \"getText() doesn't exist\", fix: \"load('text') then use .text property\" },\r\n  { pattern: /\\.setValues\\s*\\(/g, message: \"setValues() doesn't exist\", fix: \"Use range.values = [[...]] assignment\" },\r\n  { pattern: /\\.setFormula\\s*\\(/g, message: \"setFormula() doesn't exist\", fix: \"Use range.formulas = [[...]] assignment\" },\r\n  { pattern: /\\.setValue\\s*\\(/g, message: \"setValue() doesn't exist\", fix: \"Use range.values = [[value]] assignment\" },\r\n  { pattern: /\\.clearFormat\\s*\\(\\s*\\)/g, message: \"clearFormat() doesn't exist\", fix: \"Use .clear(Excel.ClearApplyTo.Formats)\" },\r\n  { pattern: /\\.clearFormats\\s*\\(\\s*\\)/g, message: \"clearFormats() doesn't exist\", fix: \"Use .clear(Excel.ClearApplyTo.Formats)\" },\r\n  { pattern: /\\.clearValue\\s*\\(\\s*\\)/g, message: \"clearValue() doesn't exist\", fix: \"Use .clear(Excel.ClearApplyTo.Contents)\" },\r\n  { pattern: /\\.clearValues\\s*\\(\\s*\\)/g, message: \"clearValues() doesn't exist\", fix: \"Use .clear(Excel.ClearApplyTo.Contents)\" },\r\n\r\n  // Google Apps Script contamination\r\n  { pattern: /SpreadsheetApp/g, message: \"SpreadsheetApp is Google Apps Script, not Excel\", fix: \"Use Excel JavaScript API (sheet, context, Excel namespace)\" },\r\n  { pattern: /Logger\\.log/g, message: \"Logger.log is Google Apps Script\", fix: \"Use console.log or remove logging\" },\r\n  { pattern: /Browser\\.msgBox/g, message: \"Browser.msgBox is Google Apps Script\", fix: \"Remove - UI dialogs not supported in Excel Add-ins\" },\r\n  { pattern: /Utilities\\./g, message: \"Utilities is Google Apps Script\", fix: \"Use native JavaScript methods\" },\r\n\r\n  // Wrong chart API\r\n  { pattern: /chart\\.setTitle\\s*\\(/g, message: \"chart.setTitle() doesn't exist\", fix: \"Use chart.title.text = '...'\" },\r\n  { pattern: /chart\\.add\\s*\\(/g, message: \"chart.add() doesn't exist\", fix: \"Use sheet.charts.add()\" },\r\n\r\n  // Wrong range methods\r\n  { pattern: /range\\.getItem\\s*\\(/g, message: \"range.getItem() doesn't exist\", fix: \"Use range.getCell(row, col)\" },\r\n  { pattern: /range\\.select\\s*\\(\\s*\\)/g, message: \"range.select() causes performance issues\", fix: \"Remove - selection not needed for automation\" },\r\n  { pattern: /range\\.activate\\s*\\(\\s*\\)/g, message: \"range.activate() causes performance issues\", fix: \"Remove - activation not needed for automation\" },\r\n\r\n  // Wrong format paths\r\n  { pattern: /range\\.font\\.bold/g, message: \"range.font.bold path is wrong\", fix: \"Use range.format.font.bold\" },\r\n  { pattern: /range\\.alignment/g, message: \"range.alignment doesn't exist\", fix: \"Use range.format.horizontalAlignment or range.format.verticalAlignment\" },\r\n  { pattern: /range\\.format\\.alignment/g, message: \"range.format.alignment object doesn't exist\", fix: \"Use range.format.horizontalAlignment directly\" },\r\n  { pattern: /range\\.horizontal/g, message: \"range.horizontal doesn't exist\", fix: \"Use range.format.horizontalAlignment\" },\r\n\r\n  // UI methods that don't work in add-ins\r\n  { pattern: /message\\.alert\\s*\\(/g, message: \"message.alert() doesn't exist in add-ins\", fix: \"Remove - use status messages in add-in UI instead\" },\r\n  { pattern: /alert\\s*\\(/g, message: \"alert() doesn't work in add-ins\", fix: \"Remove - JavaScript alert blocked in Office Add-ins\" },\r\n  { pattern: /confirm\\s*\\(/g, message: \"confirm() doesn't work in add-ins\", fix: \"Remove - JavaScript confirm blocked in Office Add-ins\" },\r\n  { pattern: /prompt\\s*\\(/g, message: \"prompt() doesn't work in add-ins\", fix: \"Remove - JavaScript prompt blocked in Office Add-ins\" },\r\n\r\n  // Variable redeclaration (context and sheet are pre-declared)\r\n  { pattern: /(?:const|let|var)\\s+context\\s*=/g, message: \"context is already declared\", fix: \"Remove declaration - context is provided\" },\r\n  { pattern: /(?:const|let|var)\\s+sheet\\s*=\\s*context\\.workbook/g, message: \"sheet is already declared\", fix: \"Remove declaration - sheet is provided\" },\r\n\r\n  // Invalid range references\r\n  { pattern: /getRange\\s*\\(\\s*[\"']?[A-Z]0[\"']?\\s*\\)/gi, message: \"Row 0 doesn't exist in Excel\", fix: \"Use row 1 or higher (e.g., A1, B1)\" },\r\n  { pattern: /getCell\\s*\\(\\s*-?\\d+\\s*,\\s*-?\\d+\\s*\\)/g, message: \"Negative cell indices are invalid\", fix: \"Use 0 or positive indices\" },\r\n\r\n];\r\n\r\n// \r\n// ALLOWED API WHITELIST  Only these Excel JS API calls are safe\r\n// \r\n\r\nconst ALLOWED_API_PATTERNS = [\r\n  // Core objects\r\n  /context\\.workbook/,\r\n  /context\\.sync\\(\\)/,\r\n  /sheet\\./,\r\n  /Excel\\./,\r\n\r\n  // Range operations\r\n  /\\.getRange\\(/,\r\n  /\\.getUsedRange\\(/,\r\n  /\\.getCell\\(/,\r\n  /\\.getRow\\(/,\r\n  /\\.getColumn\\(/,\r\n  /\\.getResizedRange\\(/,\r\n  /\\.getOffsetRange\\(/,\r\n  /\\.getEntireRow\\(/,\r\n  /\\.getEntireColumn\\(/,\r\n  /\\.getLastCell\\(/,\r\n  /\\.getLastRow\\(/,\r\n  /\\.getLastColumn\\(/,\r\n  /\\.getBoundingRect\\(/,\r\n  /\\.getIntersection\\(/,\r\n\r\n  // Load operations\r\n  /\\.load\\(/,\r\n\r\n  // Value assignment (via property)\r\n  /\\.values\\s*=/,\r\n  /\\.formulas\\s*=/,\r\n  /\\.numberFormat\\s*=/,\r\n\r\n  // Format operations\r\n  /\\.format\\./,\r\n  /\\.autofitColumns\\(/,\r\n  /\\.autofitRows\\(/,\r\n\r\n  // Table operations\r\n  /\\.tables\\./,\r\n\r\n  // Chart operations\r\n  /\\.charts\\./,\r\n\r\n  // Data operations\r\n  /\\.sort\\./,\r\n  /\\.autoFilter\\./,\r\n  /\\.dataValidation\\./,\r\n  /\\.conditionalFormats\\./,\r\n\r\n  // Worksheet operations\r\n  /\\.worksheets\\./,\r\n  /\\.freezePanes\\./,\r\n\r\n  // Clear operations\r\n  /\\.clear\\(/,\r\n  /\\.delete\\(/,\r\n  /\\.insert\\(/,\r\n\r\n  // Borders\r\n  /\\.borders\\./,\r\n];\r\n\r\n// \r\n// CODE VALIDATOR\r\n// \r\n\r\nexport function validateCode(code: string): ValidationResult {\r\n  const errors: ValidationError[] = [];\r\n  const warnings: string[] = [];\r\n  const apiCallsDetected: string[] = [];\r\n  let sanitizedCode = code;\r\n\r\n  // 1. Remove markdown fences if present\r\n  sanitizedCode = sanitizedCode.replace(/^```(?:javascript|js|typescript|ts)?\\n?/gi, \"\");\r\n  sanitizedCode = sanitizedCode.replace(/\\n?```$/gi, \"\");\r\n  sanitizedCode = sanitizedCode.trim();\r\n\r\n  // 2. Check for banned patterns and apply auto-fixes\r\n  for (const banned of BANNED_PATTERNS) {\r\n    const matches = sanitizedCode.match(banned.pattern);\r\n    if (matches) {\r\n      // Priority fixes (Auto-replace common hallucinations)\r\n      if (banned.message.includes(\"clearFormats\")) {\r\n        sanitizedCode = sanitizedCode.replace(banned.pattern, \".clear(Excel.ClearApplyTo.Formats)\");\r\n      } else if (banned.message.includes(\"clearValue\")) {\r\n        sanitizedCode = sanitizedCode.replace(banned.pattern, \".clear(Excel.ClearApplyTo.Contents)\");\r\n      } else if (banned.pattern.source.includes(\"redeclare\")) {\r\n        sanitizedCode = sanitizedCode.replace(banned.pattern, \"// [REMOVED] \");\r\n      } else {\r\n        // Only add error if we couldn't auto-fix it\r\n        errors.push({\r\n          type: \"banned_api\",\r\n          message: banned.message,\r\n          suggestion: banned.fix,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  // 3. Check for missing context.sync() calls\r\n  const loadCalls = (sanitizedCode.match(/\\.load\\s*\\(/g) || []).length;\r\n  const syncCalls = (sanitizedCode.match(/context\\.sync\\s*\\(\\s*\\)/g) || []).length;\r\n\r\n  if (loadCalls > 0 && syncCalls === 0) {\r\n    errors.push({\r\n      type: \"missing_sync\",\r\n      message: \"Code loads properties but never calls context.sync()\",\r\n      suggestion: \"Add 'await context.sync();' after .load() calls before accessing loaded properties\",\r\n    });\r\n  }\r\n\r\n  if (loadCalls > syncCalls * 2) {\r\n    warnings.push(\"Multiple .load() calls - consider batching with a single context.sync() for performance\");\r\n  }\r\n\r\n  // 4. Check for basic syntax errors\r\n  try {\r\n    // Try to parse as function body\r\n    new Function(\"context\", \"sheet\", \"Excel\", `return (async () => { ${sanitizedCode} })();`);\r\n  } catch (syntaxError: any) {\r\n    errors.push({\r\n      type: \"syntax\",\r\n      message: syntaxError.message,\r\n      suggestion: \"Check for missing brackets, semicolons, or typos\",\r\n    });\r\n  }\r\n\r\n  // 5. Detect API calls being used\r\n  for (const pattern of ALLOWED_API_PATTERNS) {\r\n    const match = sanitizedCode.match(pattern);\r\n    if (match) {\r\n      apiCallsDetected.push(match[0]);\r\n    }\r\n  }\r\n\r\n  // 6. Check for dangerous patterns\r\n  if (/eval\\s*\\(/i.test(sanitizedCode)) {\r\n    errors.push({\r\n      type: \"unsafe_pattern\",\r\n      message: \"eval() is not allowed for security reasons\",\r\n      suggestion: \"Remove eval() call\",\r\n    });\r\n  }\r\n\r\n  if (/Function\\s*\\(/i.test(sanitizedCode) && !/new\\s+Function/.test(sanitizedCode)) {\r\n    warnings.push(\"Direct Function constructor usage detected - ensure it's intentional\");\r\n  }\r\n\r\n  // 7. Check for common AI mistakes with formulas\r\n  if (/formulas\\s*=\\s*[^[]/i.test(sanitizedCode)) {\r\n    errors.push({\r\n      type: \"type_error\",\r\n      message: \"formulas must be a 2D array\",\r\n      suggestion: \"Use range.formulas = [[\\\"=SUM(A1:A10)\\\"]] (2D array)\",\r\n    });\r\n  }\r\n\r\n  if (/values\\s*=\\s*[^[]/i.test(sanitizedCode) && !/values\\s*=\\s*\\[\\[/i.test(sanitizedCode)) {\r\n    const match = sanitizedCode.match(/values\\s*=\\s*(\"[^\"]*\"|'[^']*'|\\d+)/);\r\n    if (match) {\r\n      errors.push({\r\n        type: \"type_error\",\r\n        message: \"values must be a 2D array\",\r\n        suggestion: `Use range.values = [[${match[1]}]] (2D array)`,\r\n      });\r\n    }\r\n  }\r\n\r\n  // 8. Auto-fix sheet redeclarations\r\n  sanitizedCode = sanitizedCode.replace(\r\n    /(?:const|let|var)\\s+sheet\\s*=\\s*context\\.workbook\\.worksheets\\.getActiveWorksheet\\(\\)\\s*;?/g,\r\n    \"// sheet already available\"\r\n  );\r\n\r\n  return {\r\n    isValid: errors.length === 0,\r\n    errors,\r\n    warnings,\r\n    sanitizedCode,\r\n    apiCallsDetected,\r\n  };\r\n}\r\n\r\n// \r\n// PLANNER  Analyzes task and creates execution plan\r\n// \r\n\r\nconst PLANNER_PROMPT = `You are an Excel automation planning expert. Analyze the user's request and create a brief execution plan.\r\n\r\nOUTPUT FORMAT (JSON only, no markdown):\r\n{\r\n  \"understanding\": \"One sentence summary of what user wants\",\r\n  \"steps\": [\"Step 1\", \"Step 2\", \"Step 3\"],\r\n  \"dataNeeded\": [\"What data needs to be read from sheet\"],\r\n  \"expectedOutput\": \"What the sheet should look like after\",\r\n  \"complexity\": \"simple|moderate|complex\",\r\n  \"warnings\": [\"Any potential issues or edge cases\"]\r\n}\r\n\r\nRULES:\r\n- Keep steps actionable and specific\r\n- Identify if data needs to be read first\r\n- Flag complexity based on operations needed\r\n- Note any ambiguities in the request`;\r\n\r\nexport async function createPlan(task: string, sheetContext: SheetContext | null, signal?: AbortSignal): Promise<TaskPlan> {\r\n  let contextInfo = \"\";\r\n  if (sheetContext && sheetContext.hasData) {\r\n    contextInfo = `\\n\\nCURRENT SHEET CONTEXT:\r\n- Sheet: \"${sheetContext.sheetName}\"\r\n- Size: ${sheetContext.rowCount} rows  ${sheetContext.columnCount} columns\r\n- Headers: ${sheetContext.headers.join(\", \")}\r\n- Data Types: ${sheetContext.dataTypes.join(\", \")}`;\r\n  }\r\n\r\n  const messages = [\r\n    { role: \"system\" as const, content: PLANNER_PROMPT },\r\n    { role: \"user\" as const, content: task + contextInfo },\r\n  ];\r\n\r\n  const response = await callLLM(messages, undefined, signal);\r\n\r\n  try {\r\n    // Extract JSON from response\r\n    const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\r\n    if (jsonMatch) {\r\n      return JSON.parse(jsonMatch[0]) as TaskPlan;\r\n    }\r\n  } catch (e) {\r\n    console.warn(\"Failed to parse plan:\", e);\r\n  }\r\n\r\n  // Fallback plan\r\n  return {\r\n    understanding: task,\r\n    steps: [\"Execute the requested operation\"],\r\n    dataNeeded: [],\r\n    expectedOutput: \"Modified spreadsheet\",\r\n    complexity: \"moderate\",\r\n    warnings: [],\r\n  };\r\n}\r\n\r\n// \r\n// CODER  Generates validated Excel JavaScript code\r\n// \r\n\r\nconst CODER_SYSTEM_PROMPT = `You are an Excel JavaScript API expert. Generate ONLY executable code.\r\n\r\nENVIRONMENT (pre-declared, DO NOT redeclare):\r\n- context: Excel.RequestContext\r\n- sheet: Active worksheet (already loaded)\r\n- Excel: Namespace for enums\r\n\r\nCRITICAL API RULES:\r\n1. Properties require .load() + await context.sync() before reading\r\n2. Writing: range.values = [[...]] (2D array always)\r\n3. Reading: range.load(\"values\"); await context.sync(); // then access range.values\r\n4. Formats: range.format.font.bold, range.format.fill.color, range.format.horizontalAlignment\r\n5. Always check rowCount and columnCount before using getRow or formatting\r\n6. Use context-aware formatting: adapt colors, fonts, borders, and row heights based on sheet type (office, banking, school, etc.)\r\n7. Clearing Formats ONLY: range.clear(Excel.ClearApplyTo.Formats)\r\n8. Clearing ALL: range.clear()\r\n9. Charts: sheet.charts.add(Excel.ChartType.xxx, dataRange, Excel.ChartSeriesBy.auto)\r\n10. Tables: sheet.tables.add(range, hasHeaders)\r\n11. Document Extraction: ALWAYS extract data as a flat HORIZONTAL table (Headers in row 1, data appended below). NEVER mimic vertical document layouts or create key-value lists (e.g., \"Name: Bob\" in column A). All data text must be a visible color (e.g. black).\r\n\r\nBANNED (will crash):\r\n- .getValues(), .getRowCount(), .getColumnCount(), .getAddress()  Use properties after load+sync\r\n- .setValues(), .setFormula()  Use property assignment\r\n- .clearFormats()  Use .clear(Excel.ClearApplyTo.formats)\r\n- SpreadsheetApp, Logger.log  Wrong platform\r\n- alert(), confirm(), prompt()  Blocked in add-ins\r\n- const sheet = ...  Already declared\r\n- const context = ...  Already declared\r\n\r\nMANDATORY writeData HELPER (include this in all code):\r\nfunction writeData(sheet, startCell, data) {\r\n  if (!data || data.length === 0) return null;\r\n  const rows = data.length;\r\n  const cols = Math.max(...data.map(r => r ? r.length : 0));\r\n  if (cols === 0) return null;\r\n  const normalized = data.map(r => {\r\n    const row = r ? [...r] : [];\r\n    while (row.length < cols) row.push(\"\");\r\n    // Office.js rejects null/undefined in range.values \r\n    return row.map(cell => (cell === null || cell === undefined) ? \"\" : cell);\r\n  });\r\n  const range = sheet.getRange(startCell).getResizedRange(rows - 1, cols - 1);\r\n  range.values = normalized;\r\n  range.format.autofitColumns();\r\n  return range;\r\n}\r\n\r\nSAFE FORMATTING TEMPLATE (adapt details based on sheet type):\r\n// Step 1: Get used range and load properties\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"values,rowCount,columnCount,address\");\r\nawait context.sync();\r\n\r\n// Step 2: Check if sheet has data\r\nif (!usedRange || usedRange.rowCount < 1 || usedRange.columnCount < 1) {\r\n  throw new Error(\"Sheet appears empty. Add some data first.\");\r\n}\r\n\r\nconst rowCount = usedRange.rowCount;\r\nconst colCount = usedRange.columnCount;\r\n\r\n// Step 3: Format header row (row 1)\r\nconst headerRow = usedRange.getRow(0);\r\nheaderRow.format.set({\r\n  font: { bold: true, size: 11, color: \"#FFFFFF\" },\r\n  fill: { color: \"#1B2A4A\" },\r\n  horizontalAlignment: \"Center\",\r\n  verticalAlignment: \"Center\",\r\n  rowHeight: 28\r\n});\r\n\r\n// Step 4: Format data rows with alternating colors  ALWAYS set font color to black\r\nfor (let i = 1; i < rowCount; i++) {\r\n  const row = usedRange.getRow(i);\r\n  row.format.set({\r\n    fill: { color: i % 2 === 0 ? \"#F4F5F7\" : \"#FFFFFF\" },\r\n    font: { color: \"#000000\" },\r\n    rowHeight: 22\r\n  });\r\n}\r\n\r\n// Step 5: Add borders to all cells\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\n\r\n// Step 6: Add medium bottom border under header\r\nheaderRow.format.borders.getItem(\"EdgeBottom\").style = \"Medium\";\r\nheaderRow.format.borders.getItem(\"EdgeBottom\").color = \"#1B2A4A\"; // Adapt color for sheet type\r\n\r\n// Step 7: Freeze first row\r\nsheet.freezePanes.freezeRows(1);\r\n\r\n// Step 8: Auto-fit columns\r\nusedRange.format.autofitColumns();\r\nawait context.sync();\r\n\r\nOUTPUT: Raw JavaScript code only. No markdown, no explanation.`;\r\n\r\nexport async function generateCode(\r\n  task: string,\r\n  plan: TaskPlan | null,\r\n  sheetContext: SheetContext | null,\r\n  attachedFiles: AttachedFile[],\r\n  previousError?: string,\r\n  signal?: AbortSignal\r\n): Promise<string> {\r\n  let prompt = task;\r\n\r\n  // Add plan context\r\n  // (Removed problematic template string, use only string concatenation below)\r\n\r\n  // Add plan context\r\n  if (plan) {\r\n    prompt += '\\n\\nPLAN:\\n';\r\n    for (let i = 0; i < plan.steps.length; i++) {\r\n      prompt += (i + 1) + '. ' + plan.steps[i] + '\\n';\r\n    }\r\n    if (plan.warnings.length > 0) {\r\n      prompt += '\\n\\nWATCH OUT FOR:\\n';\r\n      for (let i = 0; i < plan.warnings.length; i++) {\r\n        prompt += plan.warnings[i] + '\\n';\r\n      }\r\n    }\r\n  }\r\n\r\n  // Add sheet context\r\n  if (sheetContext && sheetContext.hasData) {\r\n    prompt += '\\n\\nSHEET DATA:\\n';\r\n    prompt += '- Headers: ' + JSON.stringify(sheetContext.headers) + '\\n';\r\n    prompt += '- Rows: ' + sheetContext.rowCount + '\\n';\r\n    prompt += '- Sample: ' + JSON.stringify(sheetContext.sampleData.slice(0, 3)) + '\\n';\r\n  }\r\n\r\n  // Add error context for retry\r\n  if (previousError) {\r\n    prompt += '\\n\\nPREVIOUS ERROR: \"' + previousError + '\"\\nFIX THIS ERROR. Output only corrected code.';\r\n  }\r\n  // Prepare LLM messages with coder system prompt\r\n  const messages: any[] = [{ role: \"system\", content: CODER_SYSTEM_PROMPT }];\r\n\r\n  if (attachedFiles.length > 0) {\r\n    const contentParts: any[] = [{ type: \"text\", text: prompt }];\r\n\r\n    attachedFiles.forEach((file) => {\r\n      file.data.slice(0, 10).forEach((imageUrl) => {\r\n        contentParts.push({ type: \"image_url\", image_url: { url: imageUrl } });\r\n      });\r\n    });\r\n\r\n    messages.push({ role: \"user\", content: contentParts });\r\n  } else {\r\n    messages.push({ role: \"user\", content: prompt });\r\n  }\r\n\r\n  let code = await callLLM(messages, undefined, signal);\r\n\r\n  // Clean up response: remove surrounding triple-backtick fences and optional language tag\r\n  if (code.startsWith('```')) {\r\n    const firstNewline = code.indexOf('\\n');\r\n    if (firstNewline >= 0) {\r\n      code = code.slice(firstNewline + 1);\r\n    } else {\r\n      code = code.slice(3);\r\n    }\r\n  }\r\n  if (code.endsWith('```')) {\r\n    code = code.slice(0, -3);\r\n  }\r\n  code = code.trim();\r\n\r\n  return code;\r\n}\r\n\r\n// \r\n// FIXER  Repairs code based on validation or runtime errors\r\n// \r\n\r\nconst FIXER_SYSTEM_PROMPT = `You are an Excel JavaScript API debugger. Fix the broken code.\r\n\r\nCOMMON FIXES:\r\n1. .getValues()  .load(\"values\") + await context.sync() + .values\r\n2. .getRowCount()  .load(\"rowCount\") + await context.sync() + .rowCount\r\n3. range.values = \"text\"  range.values = [[\"text\"]]\r\n4. const sheet = ...  REMOVE (already declared)\r\n5. SpreadsheetApp  Use sheet (Excel JS API)\r\n6. chart.setTitle()  chart.title.text = \"...\"\r\n\r\nOUTPUT: Fixed code only. No explanation, no markdown fences.`;\r\n\r\nexport async function fixCode(\r\n  originalCode: string,\r\n  errors: ValidationError[],\r\n  runtimeError?: string,\r\n  signal?: AbortSignal\r\n): Promise<string> {\r\n  let errorSummary = \"\";\r\n\r\n  if (errors.length > 0) {\r\n    errorSummary = \"VALIDATION ERRORS:\\n\" + errors.map((e) => `- ${e.message}  ${e.suggestion}`).join(\"\\n\");\r\n  }\r\n\r\n  if (runtimeError) {\r\n    errorSummary += (errorSummary ? \"\\n\\n\" : \"\") + `RUNTIME ERROR: ${runtimeError}`;\r\n  }\r\n\r\n  const messages = [\r\n    { role: \"system\" as const, content: FIXER_SYSTEM_PROMPT },\r\n    { role: \"user\" as const, content: `BROKEN CODE:\\n${originalCode}\\n\\n${errorSummary}\\n\\nFix the code:` },\r\n  ];\r\n\r\n  let fixedCode = await callLLM(messages, undefined, signal);\r\n\r\n  // Clean response\r\n  fixedCode = fixedCode.replace(/^```(?:javascript|js|typescript|ts)?\\n?/gi, \"\");\r\n  fixedCode = fixedCode.replace(/\\n?```$/gi, \"\");\r\n\r\n  return fixedCode.trim();\r\n}\r\n\r\n// \r\n// ORCHESTRATOR  Main agent loop (LangGraph-inspired)\r\n// \r\n\r\nexport interface OrchestratorConfig {\r\n  maxRetries: number;\r\n  enablePlanning: boolean;\r\n  strictValidation: boolean;\r\n  timeout: number;\r\n}\r\n\r\nconst DEFAULT_CONFIG: OrchestratorConfig = {\r\n  maxRetries: 3,\r\n  enablePlanning: true,\r\n  strictValidation: true,\r\n  timeout: 30000,\r\n};\r\n\r\nexport interface OrchestratorResult {\r\n  success: boolean;\r\n  code: string;\r\n  plan: TaskPlan | null;\r\n  validation: ValidationResult | null;\r\n  error?: string;\r\n  retries: number;\r\n  duration: number;\r\n}\r\n\r\nexport async function runAgent(\r\n  task: string,\r\n  sheetContext: SheetContext | null,\r\n  attachedFiles: AttachedFile[],\r\n  config: Partial<OrchestratorConfig> = {},\r\n  signal?: AbortSignal\r\n): Promise<OrchestratorResult> {\r\n  const cfg = { ...DEFAULT_CONFIG, ...config };\r\n  const startTime = Date.now();\r\n\r\n  let plan: TaskPlan | null = null;\r\n  let code = \"\";\r\n  let validation: ValidationResult | null = null;\r\n  let retries = 0;\r\n\r\n  try {\r\n    //  PHASE 1: PLANNING \r\n    if (cfg.enablePlanning && !attachedFiles.length) {\r\n      try {\r\n        plan = await createPlan(task, sheetContext, signal);\r\n        console.log(\"[Agent] Plan created:\", plan);\r\n      } catch (e) {\r\n        if ((e as any).name === 'AbortError') throw e;\r\n        console.warn(\"[Agent] Planning failed, proceeding without plan:\", e);\r\n      }\r\n    }\r\n\r\n    //  PHASE 2: CODE GENERATION \r\n    code = await generateCode(task, plan, sheetContext, attachedFiles, undefined, signal);\r\n    console.log(\"[Agent] Initial code generated\");\r\n\r\n    //  PHASE 3: VALIDATION LOOP \r\n    for (let attempt = 0; attempt <= cfg.maxRetries; attempt++) {\r\n      validation = validateCode(code);\r\n\r\n      if (validation.isValid) {\r\n        console.log(`[Agent] Code validated successfully on attempt ${attempt + 1}`);\r\n        break;\r\n      }\r\n\r\n      if (attempt < cfg.maxRetries) {\r\n        console.log(`[Agent] Validation failed (attempt ${attempt + 1}), fixing...`);\r\n        code = await fixCode(code, validation.errors, undefined, signal);\r\n        retries++;\r\n      }\r\n    }\r\n\r\n    // Final validation check\r\n    validation = validateCode(code);\r\n\r\n    if (!validation.isValid && cfg.strictValidation) {\r\n      throw new Error(\r\n        `Code validation failed: ${validation.errors.map((e) => e.message).join(\"; \")}`\r\n      );\r\n    }\r\n\r\n    // Use sanitized code\r\n    code = validation.sanitizedCode;\r\n\r\n    return {\r\n      success: true,\r\n      code,\r\n      plan,\r\n      validation,\r\n      retries,\r\n      duration: Date.now() - startTime,\r\n    };\r\n  } catch (error: any) {\r\n    return {\r\n      success: false,\r\n      code,\r\n      plan,\r\n      validation,\r\n      error: error.message,\r\n      retries,\r\n      duration: Date.now() - startTime,\r\n    };\r\n  }\r\n}\r\n\r\n// \r\n// EXECUTE WITH RECOVERY  Safe code execution with auto-fix\r\n// \r\n\r\nexport async function executeWithRecovery(\r\n  code: string,\r\n  executor: (code: string) => Promise<void>,\r\n  maxRetries: number = 2,\r\n  signal?: AbortSignal\r\n): Promise<{ success: boolean; error?: string; finalCode: string }> {\r\n  let currentCode = code;\r\n  let lastError = \"\";\r\n\r\n  for (let attempt = 0; attempt <= maxRetries; attempt++) {\r\n    if (signal?.aborted) {\r\n      throw new DOMException(\"Execution cancelled\", \"AbortError\");\r\n    }\r\n\r\n    try {\r\n      await executor(currentCode);\r\n      return { success: true, finalCode: currentCode };\r\n    } catch (error: any) {\r\n      lastError = error.message || String(error);\r\n      console.warn(`[Agent] Execution failed (attempt ${attempt + 1}):`, lastError);\r\n\r\n      if (attempt < maxRetries) {\r\n        // Try to fix based on runtime error\r\n        currentCode = await fixCode(currentCode, [], lastError, signal);\r\n\r\n        // Re-validate fixed code\r\n        const validation = validateCode(currentCode);\r\n        if (validation.isValid) {\r\n          currentCode = validation.sanitizedCode;\r\n        } else {\r\n          // If still invalid, try one more fix round\r\n          currentCode = await fixCode(currentCode, validation.errors, undefined, signal);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return { success: false, error: lastError, finalCode: currentCode };\r\n}\r\n\r\n// \r\n// UTILITY: Read current sheet context\r\n// \r\n\r\nexport async function readSheetContext(): Promise<SheetContext | null> {\r\n  try {\r\n    // @ts-ignore - Excel is global in Office Add-ins\r\n    return await Excel.run(async (context: any) => {\r\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n      sheet.load(\"name\");\r\n\r\n      const usedRange = sheet.getUsedRangeOrNullObject();\r\n      usedRange.load(\"values,rowCount,columnCount,isNullObject\");\r\n      await context.sync();\r\n\r\n      if (usedRange.isNullObject || usedRange.rowCount === 0 || usedRange.columnCount === 0) {\r\n        return {\r\n          sheetName: sheet.name,\r\n          rowCount: 0,\r\n          columnCount: 0,\r\n          headers: [],\r\n          sampleData: [],\r\n          dataTypes: [],\r\n          hasData: false,\r\n        };\r\n      }\r\n\r\n      const values = usedRange.values;\r\n      const headers = values[0].map((h: any) => String(h || \"\").trim());\r\n\r\n      // Detect data types\r\n      const dataTypes: string[] = [];\r\n      if (values.length > 1) {\r\n        for (let col = 0; col < usedRange.columnCount; col++) {\r\n          const colValues = values.slice(1).map((row: any[]) => row[col]).filter((v: any) => v != null && v !== \"\");\r\n          if (colValues.length === 0) {\r\n            dataTypes.push(\"empty\");\r\n          } else if (colValues.every((v: any) => !isNaN(Number(v)))) {\r\n            dataTypes.push(\"number\");\r\n          } else if (colValues.every((v: any) => /^\\d{1,4}[-\\/]\\d{1,2}[-\\/]\\d{1,4}/.test(String(v)))) {\r\n            dataTypes.push(\"date\");\r\n          } else {\r\n            dataTypes.push(\"text\");\r\n          }\r\n        }\r\n      }\r\n\r\n      return {\r\n        sheetName: sheet.name,\r\n        rowCount: usedRange.rowCount,\r\n        columnCount: usedRange.columnCount,\r\n        headers,\r\n        sampleData: values.slice(0, 10),\r\n        dataTypes,\r\n        hasData: true,\r\n      };\r\n    });\r\n  } catch (e) {\r\n    console.error(\"Failed to read sheet context:\", e);\r\n    return null;\r\n  }\r\n}\r\n","/**\r\n * SVG Icon library for SheetOS AI.\r\n * Inline Lucide-style icons  no external dependencies.\r\n */\r\n\r\nconst s = (d: string, size = 14): string =>\r\n  `<svg width=\"${size}\" height=\"${size}\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">${d}</svg>`;\r\n\r\nexport const Icons = {\r\n  // Quick Actions\r\n  chart: s('<rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"/><rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"/><rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"/><rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"/>'),\r\n  barChart: s('<line x1=\"18\" y1=\"20\" x2=\"18\" y2=\"10\"/><line x1=\"12\" y1=\"20\" x2=\"12\" y2=\"4\"/><line x1=\"6\" y1=\"20\" x2=\"6\" y2=\"14\"/>'),\r\n  table: s('<path d=\"M12 3v18\"/><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M3 9h18\"/><path d=\"M3 15h18\"/>'),\r\n  paintbrush: s('<path d=\"M18.37 2.63a2.12 2.12 0 0 1 3 3L14 13l-4 1 1-4Z\"/><path d=\"M9 14.5A3.5 3.5 0 0 0 5.5 18H3v2h7a3 3 0 0 0 0-6\"/>'),\r\n  formula: s('<path d=\"M6 2v20\"/><path d=\"M6 6h12l-6 6 6 6H6\"/>'),\r\n  sortAsc: s('<path d=\"M11 5h10\"/><path d=\"M11 9h7\"/><path d=\"M11 13h4\"/><path d=\"M3 17l3 3 3-3\"/><path d=\"M6 18V4\"/>'),\r\n  filter: s('<polygon points=\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\"/>'),\r\n  checkSquare: s('<polyline points=\"9 11 12 14 22 4\"/><path d=\"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11\"/>'),\r\n  trendUp: s('<polyline points=\"23 6 13.5 15.5 8.5 10.5 1 18\"/><polyline points=\"17 6 23 6 23 12\"/>'),\r\n  eraser: s('<path d=\"M20 20H7L3 16l9-9 9 9-4 4\"/><path d=\"M6.5 13.5l5-5\"/>'),\r\n  copy: s('<rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\"/><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"/>'),\r\n  columns: s('<rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M12 3v18\"/>'),\r\n  lock: s('<rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\"/><path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/>'),\r\n  hash: s('<line x1=\"4\" y1=\"9\" x2=\"20\" y2=\"9\"/><line x1=\"4\" y1=\"15\" x2=\"20\" y2=\"15\"/><line x1=\"10\" y1=\"3\" x2=\"8\" y2=\"21\"/><line x1=\"16\" y1=\"3\" x2=\"14\" y2=\"21\"/>'),\r\n  search: s('<circle cx=\"11\" cy=\"11\" r=\"8\"/><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/>'),\r\n  snowflake: s('<line x1=\"2\" y1=\"12\" x2=\"22\" y2=\"12\"/><line x1=\"12\" y1=\"2\" x2=\"12\" y2=\"22\"/><line x1=\"20\" y1=\"16\" x2=\"4\" y2=\"8\"/><line x1=\"20\" y1=\"8\" x2=\"4\" y2=\"16\"/>'),\r\n\r\n  // Status\r\n  check: s('<path d=\"M20 6L9 17l-5-5\"/>', 16),\r\n  alertCircle: s('<circle cx=\"12\" cy=\"12\" r=\"10\"/><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"/><line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"/>', 16),\r\n  arrowRight: s('<line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><polyline points=\"12 5 19 12 12 19\"/>', 16),\r\n\r\n  // Navigation\r\n  settings: s('<circle cx=\"12\" cy=\"12\" r=\"3\"/><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c.26.6.77 1.05 1.39 1.16V10H21a2 2 0 0 1 0 4h-.09c-.62.11-1.13.56-1.39 1.16z\"/>', 18),\r\n  helpCircle: s('<circle cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\"/><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/>', 18),\r\n  refresh: s('<polyline points=\"23 4 23 10 17 10\"/><path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\"/>', 14),\r\n  chevronDown: s('<polyline points=\"6 9 12 15 18 9\"/>', 14),\r\n  fileText: s('<path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\"/><polyline points=\"14 2 14 8 20 8\"/><path d=\"M12 12v6\"/><path d=\"M9 15h6\"/>', 20),\r\n\r\n  //  NEW: Mode Toggle Icons \r\n  messageCircle: s('<path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"/>', 16),\r\n  zap: s('<polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\"/>', 16),\r\n  send: s('<line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\"/><polygon points=\"22 2 15 22 11 13 2 9 22 2\"/>', 14),\r\n  stop: s('<rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\" fill=\"currentColor\"/>', 16),\r\n\r\n  //  NEW: Category Icons \r\n  broom: s('<path d=\"M5 21h14\"/><path d=\"M12 21V3\"/><path d=\"M7 8l5-5 5 5\"/><path d=\"M7 12l5 2 5-2\"/>', 14),\r\n  pieChart: s('<path d=\"M21.21 15.89A10 10 0 1 1 8 2.83\"/><path d=\"M22 12A10 10 0 0 0 12 2v10z\"/>', 14),\r\n  palette: s('<circle cx=\"13.5\" cy=\"6.5\" r=\"0.5\" fill=\"currentColor\"/><circle cx=\"17.5\" cy=\"10.5\" r=\"0.5\" fill=\"currentColor\"/><circle cx=\"8.5\" cy=\"7.5\" r=\"0.5\" fill=\"currentColor\"/><circle cx=\"6.5\" cy=\"12\" r=\"0.5\" fill=\"currentColor\"/><path d=\"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z\"/>', 14),\r\n  fileTemplate: s('<path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\"/><polyline points=\"14 2 14 8 20 8\"/><line x1=\"8\" y1=\"13\" x2=\"16\" y2=\"13\"/><line x1=\"8\" y1=\"17\" x2=\"12\" y2=\"17\"/>', 14),\r\n\r\n  //  NEW: Chat Actions \r\n  play: s('<polygon points=\"5 3 19 12 5 21 5 3\"/>', 14),\r\n  trash: s('<polyline points=\"3 6 5 6 21 6\"/><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/>', 14),\r\n  sparkles: s('<path d=\"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z\"/><path d=\"M5 3v4\"/><path d=\"M19 17v4\"/><path d=\"M3 5h4\"/><path d=\"M17 19h4\"/>', 14),\r\n  user: s('<path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"/><circle cx=\"12\" cy=\"7\" r=\"4\"/>', 14),\r\n  bot: s('<rect x=\"3\" y=\"11\" width=\"18\" height=\"10\" rx=\"2\"/><circle cx=\"12\" cy=\"5\" r=\"2\"/><path d=\"M12 7v4\"/><line x1=\"8\" y1=\"16\" x2=\"8\" y2=\"16\"/><line x1=\"16\" y1=\"16\" x2=\"16\" y2=\"16\"/>', 14),\r\n\r\n  //  NEW: Extract/Import Icons \r\n  upload: s('<path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"17 8 12 3 7 8\"/><line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/>', 14),\r\n  users: s('<path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"/><circle cx=\"9\" cy=\"7\" r=\"4\"/><path d=\"M22 21v-2a4 4 0 0 0-3-3.87\"/><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/>', 14),\r\n  filePlus: s('<path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\"/><polyline points=\"14 2 14 8 20 8\"/><line x1=\"12\" y1=\"18\" x2=\"12\" y2=\"12\"/><line x1=\"9\" y1=\"15\" x2=\"15\" y2=\"15\"/>', 14),\r\n  calendar: s('<rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\"/><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"/><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"/><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"/>', 14),\r\n  database: s('<ellipse cx=\"12\" cy=\"5\" rx=\"9\" ry=\"3\"/><path d=\"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3\"/><path d=\"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5\"/>', 14),\r\n  clipboardList: s('<rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\"/><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"/><path d=\"M12 11h4\"/><path d=\"M12 16h4\"/><path d=\"M8 11h.01\"/><path d=\"M8 16h.01\"/>', 14),\r\n\r\n  //  NEW: Smart Tools Icons \r\n  brain: s('<path d=\"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z\"/><path d=\"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z\"/>', 14),\r\n  crosshair: s('<circle cx=\"12\" cy=\"12\" r=\"10\"/><line x1=\"22\" y1=\"12\" x2=\"18\" y2=\"12\"/><line x1=\"6\" y1=\"12\" x2=\"2\" y2=\"12\"/><line x1=\"12\" y1=\"6\" x2=\"12\" y2=\"2\"/><line x1=\"12\" y1=\"22\" x2=\"12\" y2=\"18\"/>', 14),\r\n  dollarSign: s('<line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\"/><path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"/>', 14),\r\n  shield: s('<path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"/>', 14),\r\n  mail: s('<path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"/><polyline points=\"22,6 12,13 2,6\"/>', 14),\r\n  highlight: s('<path d=\"m9 11-6 6v3h9l3-3\"/><path d=\"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4\"/>', 14),\r\n  layers: s('<polygon points=\"12 2 2 7 12 12 22 7 12 2\"/><polyline points=\"2 17 12 22 22 17\"/><polyline points=\"2 12 12 17 22 12\"/>', 14),\r\n};\r\n","/* global console, Excel, document, window, Office */\r\nimport \"./taskpane.css\";\r\nimport { callLLM, getConfig, saveConfig, fetchOllamaModels, GROQ_MODELS, LLMConfig } from \"../services/llm.service\";\r\nimport { SYSTEM_PROMPT } from \"../services/prompt\";\r\nimport { CHAT_PROMPT } from \"../services/chat-prompt\";\r\nimport { getCachedResponse, cacheResponse } from \"../services/cache\";\r\nimport { getSchemaExtractionPrompt, parseExtractionResponse, generateExcelCode, buildEnhancedPrompt, normalizeColumnName } from \"../services/document-extractor\";\r\nimport { extractTextFromPDFFile } from \"../services/pdfService\";\r\nimport {\r\n  runAgent,\r\n  validateCode,\r\n  executeWithRecovery,\r\n  readSheetContext,\r\n  SheetContext\r\n} from \"../services/agent-orchestrator\";\r\nimport * as pdfjsLib from 'pdfjs-dist';\r\nimport { Icons } from \"../services/icons\";\r\n\r\n// Worker setup for PDF.js\r\ntry {\r\n  // @ts-ignore\r\n  pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n} catch (e) {\r\n  console.warn(\"PDF Worker setup failed:\", e);\r\n}\r\n\r\n//  Types \r\ntype Mode = \"planning\" | \"agent\";\r\ntype ActionCategory = \"cleanup\" | \"formulas\" | \"format\" | \"reports\" | \"templates\" | \"analysis\" | \"extract\" | \"smart\";\r\n\r\ninterface ChatMessage {\r\n  role: \"user\" | \"ai\";\r\n  content: string;\r\n  timestamp: number;\r\n}\r\n\r\n//  State \r\nlet currentMode: Mode = \"planning\";\r\nlet currentCategory: ActionCategory = \"cleanup\";\r\nlet schemaExtractionMode: boolean = false; // When true, use column headers from Excel\r\nconst chatHistory: ChatMessage[] = [];\r\nlet chatConversation: { role: \"system\" | \"user\" | \"assistant\"; content: string }[] = [];\r\nlet isChatBusy = false;\r\nlet attachedFiles: { name: string; type: \"image\" | \"pdf\"; data: string[] }[] = []; // Array of attached files\r\nlet chatAbortController: AbortController | null = null;\r\nlet agentAbortController: AbortController | null = null;\r\nlet rawPDFFiles: File[] = []; // Store raw File objects for text-based batch extraction\r\nlet batchAbortController: AbortController | null = null;\r\n\r\n//  Quick Actions by Category \r\nconst CATEGORIZED_ACTIONS: Record<ActionCategory, { icon: string; label: string; prompt: string }[]> = {\r\n\r\n  //  Data Cleanup \r\n  cleanup: [\r\n    { icon: \"eraser\", label: \"Smart Clean \", prompt: \"Analyze the used range. Perform 'Smart Cleaning': (1) Trim all whitespace. (2) Convert text-numbers to real numbers. (3) Standardize dates to Short Date format. (4) Remove completely empty rows. (5) Remove duplicate rows. (6) Convert text columns to Proper Case. Write a summary of changes in a new cell comment.\" },\r\n    { icon: \"eraser\", label: \"Remove Duplicates\", prompt: \"Find and remove duplicate rows from the data, keeping the first occurrence of each.\" },\r\n    { icon: \"eraser\", label: \"Trim Spaces\", prompt: \"Trim all leading and trailing whitespace from every cell in the used range.\" },\r\n    { icon: \"eraser\", label: \"Fix Empty Rows\", prompt: \"Find and delete all completely empty rows within the used data range.\" },\r\n    { icon: \"search\", label: \"Find Blanks\", prompt: \"Highlight all blank cells in the used range with a light yellow background color (#FFF3CD).\" },\r\n    { icon: \"hash\", label: \"Fix Number Format\", prompt: \"Detect columns with numbers stored as text and convert them back to proper numbers.\" },\r\n    { icon: \"eraser\", label: \"Standardize Case\", prompt: \"Convert all text in column A to proper case (first letter capitalized, rest lowercase).\" },\r\n    { icon: \"eraser\", label: \"Clear Formatting\", prompt: \"Clear all formatting from the used range while keeping data, then auto-fit all columns.\" },\r\n    { icon: \"copy\", label: \"Split Column\", prompt: \"Split the data in column A by comma delimiter into separate columns B, C, D.\" },\r\n    { icon: \"eraser\", label: \"Remove Hyperlinks\", prompt: \"Find all cells in the used range. Remove all hyperlinks while keeping the cell values. Set the font color of all cells to black and remove any underlines to ensure a consistent, professional appearance.\" },\r\n  ],\r\n\r\n  //  Natural Language Formula Generator \r\n  formulas: [\r\n    { icon: \"formula\", label: \"Formula Doctor \", prompt: \"Analyze the active cell/formula. (1) Explain the logic in a cell note. (2) If there is an error (#VALUE, #REF), FIX it and explain the fix. (3) If it's a value, suggest a formula. Expertly debug.\" },\r\n    { icon: \"formula\", label: \"Auto SUM\", prompt: \"Add a SUM formula at the bottom of each numeric column with a bold TOTAL label in column A.\" },\r\n    { icon: \"formula\", label: \"AVERAGE Row\", prompt: \"Add an AVERAGE formula at the bottom of each numeric column with a bold AVERAGE label.\" },\r\n    { icon: \"formula\", label: \"COUNT & COUNTA\", prompt: \"Add COUNT and COUNTA formulas at the bottom to count numeric and non-empty cells in each column.\" },\r\n    { icon: \"formula\", label: \"VLOOKUP Setup\", prompt: \"Analyze the data and set up a VLOOKUP section: create a lookup area to the right of the data where user can type a search value in one cell, and VLOOKUP automatically returns matching data from the table. Add labels and formatting to make it clear how to use it.\" },\r\n    { icon: \"formula\", label: \"SUMIF by Category\", prompt: \"Detect the category column (text) and numeric columns in the data. Create a summary section below the data that uses SUMIF to total each unique category. Add labels, formatting, and a bold grand total row.\" },\r\n    { icon: \"formula\", label: \"IF Conditional\", prompt: \"Add a new Status column at the end of the data. Use an IF formula to classify each row: if the last numeric column value is above the average, mark it 'Above Average', otherwise 'Below Average'. Format green for above, red for below.\" },\r\n    { icon: \"trendUp\", label: \"Running Total\", prompt: \"Add a 'Running Total' column at the end of the data that calculates a cumulative sum of the main numeric column, row by row. Format it with a subtle blue background and number format with commas.\" },\r\n    { icon: \"sortAsc\", label: \"Rank Values\", prompt: \"Add a 'Rank' column at the end of the data that ranks each row by the primary numeric column (largest = rank 1). Highlight the top 3 with gold/green backgrounds. Auto-fit all columns.\" },\r\n  ],\r\n\r\n  //  Smart Formatter (Canva for Excel) \r\n  format: [\r\n    {\r\n      icon: \"paintbrush\", label: \"Make Professional\", prompt: `Apply professional formatting to the sheet. Use this EXACT safe pattern:\r\n\r\n// Step 1: Get used range and load properties\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"values,rowCount,columnCount,address\");\r\nawait context.sync();\r\n\r\n// Step 2: Check if sheet has data\r\nif (!usedRange || usedRange.rowCount < 1 || usedRange.columnCount < 1) {\r\n  throw new Error(\"Sheet appears empty. Add some data first.\");\r\n}\r\n\r\nconst rowCount = usedRange.rowCount;\r\nconst colCount = usedRange.columnCount;\r\n\r\n// Step 3: Format header row (row 1)\r\nconst headerRow = usedRange.getRow(0);\r\nheaderRow.format.set({\r\n  font: { bold: true, size: 11, color: \"#FFFFFF\" },\r\n  fill: { color: \"#1B2A4A\" },\r\n  horizontalAlignment: \"Center\",\r\n  verticalAlignment: \"Center\",\r\n  rowHeight: 28\r\n});\r\n\r\n// Step 4: Format data rows with alternating colors\r\nfor (let i = 1; i < rowCount; i++) {\r\n  const row = usedRange.getRow(i);\r\n  row.format.set({\r\n    fill: { color: i % 2 === 0 ? \"#F4F5F7\" : \"#FFFFFF\" },\r\n    rowHeight: 22\r\n  });\r\n}\r\n\r\n// Step 5: Add borders and freeze pane\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\n\r\nheaderRow.format.borders.getItem(\"EdgeBottom\").style = \"Medium\";\r\nheaderRow.format.borders.getItem(\"EdgeBottom\").color = \"#1B2A4A\";\r\n\r\nsheet.freezePanes.freezeRows(1);\r\nusedRange.format.autofitColumns();\r\nawait context.sync();` },\r\n    {\r\n      icon: \"paintbrush\", label: \"Executive Style\", prompt: `Apply executive presentation style using this EXACT safe pattern:\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"values,rowCount,columnCount\");\r\nawait context.sync();\r\n\r\nif (!usedRange || usedRange.rowCount < 1) {\r\n  throw new Error(\"Sheet appears empty.\");\r\n}\r\n\r\nconst rowCount = usedRange.rowCount;\r\n\r\n// Header styling\r\nconst headerRow = usedRange.getRow(0);\r\nheaderRow.format.font.bold = true;\r\nheaderRow.format.font.size = 11;\r\nheaderRow.format.font.color = \"#FFFFFF\";\r\nheaderRow.format.fill.color = \"#34495E\";\r\nheaderRow.format.horizontalAlignment = \"Center\";\r\nheaderRow.format.rowHeight = 30;\r\n\r\n// Data rows with subtle alternating\r\nfor (let i = 1; i < rowCount; i++) {\r\n  const row = usedRange.getRow(i);\r\n  row.format.fill.color = i % 2 === 0 ? \"#F8F9FA\" : \"#FFFFFF\";\r\n  row.format.rowHeight = 22;\r\n}\r\n\r\n// Light gray borders\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").color = \"#DEE2E6\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").color = \"#DEE2E6\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\n\r\n// Freeze header\r\nsheet.freezePanes.freezeRows(1);\r\nusedRange.format.autofitColumns();\r\nawait context.sync();` },\r\n    {\r\n      icon: \"paintbrush\", label: \"Minimal Clean\", prompt: `Apply minimal modern formatting:\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"rowCount,columnCount\");\r\nawait context.sync();\r\n\r\nif (!usedRange || usedRange.rowCount < 1) {\r\n  throw new Error(\"Sheet appears empty.\");\r\n}\r\n\r\n// Clear existing formatting\r\nusedRange.format.fill.clear();\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"None\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"None\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"None\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"None\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"None\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"None\";\r\n\r\n// Header: bold, dark text, bottom border only\r\nconst headerRow = usedRange.getRow(0);\r\nheaderRow.format.font.bold = true;\r\nheaderRow.format.font.size = 11;\r\nheaderRow.format.font.color = \"#111827\";\r\nheaderRow.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nheaderRow.format.borders.getItem(\"EdgeBottom\").color = \"#D1D5DB\";\r\nheaderRow.format.rowHeight = 28;\r\n\r\n// Data rows: smaller font, gray text\r\nfor (let i = 1; i < usedRange.rowCount; i++) {\r\n  const row = usedRange.getRow(i);\r\n  row.format.font.size = 10;\r\n  row.format.font.color = \"#374151\";\r\n  row.format.rowHeight = 22;\r\n}\r\n\r\nusedRange.format.autofitColumns();\r\nawait context.sync();` },\r\n    {\r\n      icon: \"paintbrush\", label: \"Dark Theme\", prompt: `Apply dark theme formatting:\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"rowCount,columnCount\");\r\nawait context.sync();\r\n\r\nif (!usedRange || usedRange.rowCount < 1) {\r\n  throw new Error(\"Sheet appears empty.\");\r\n}\r\n\r\nconst rowCount = usedRange.rowCount;\r\n\r\n// All cells: dark background, light text\r\nusedRange.format.fill.color = \"#1E1E1E\";\r\nusedRange.format.font.color = \"#CCCCCC\";\r\n\r\n// Header: gold text\r\nconst headerRow = usedRange.getRow(0);\r\nheaderRow.format.fill.color = \"#2D2D2D\";\r\nheaderRow.format.font.bold = true;\r\nheaderRow.format.font.color = \"#F0C75E\";\r\nheaderRow.format.rowHeight = 28;\r\n\r\n// Alternating dark rows\r\nfor (let i = 1; i < rowCount; i++) {\r\n  const row = usedRange.getRow(i);\r\n  row.format.fill.color = i % 2 === 0 ? \"#252525\" : \"#1E1E1E\";\r\n}\r\n\r\n// Dark borders\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").color = \"#3A3A3A\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").color = \"#3A3A3A\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\n\r\nusedRange.format.autofitColumns();\r\nawait context.sync();` },\r\n    {\r\n      icon: \"paintbrush\", label: \"Colorful Teal\", prompt: `Apply colorful teal formatting:\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"rowCount\");\r\nawait context.sync();\r\n\r\nif (!usedRange || usedRange.rowCount < 1) {\r\n  throw new Error(\"Sheet appears empty.\");\r\n}\r\n\r\n// Header: teal background\r\nconst headerRow = usedRange.getRow(0);\r\nheaderRow.format.fill.color = \"#0D7377\";\r\nheaderRow.format.font.bold = true;\r\nheaderRow.format.font.color = \"#FFFFFF\";\r\nheaderRow.format.horizontalAlignment = \"Center\";\r\nheaderRow.format.rowHeight = 28;\r\n\r\n// Alternating light teal and white\r\nfor (let i = 1; i < usedRange.rowCount; i++) {\r\n  const row = usedRange.getRow(i);\r\n  row.format.fill.color = i % 2 === 0 ? \"#E8F6F3\" : \"#FFFFFF\";\r\n}\r\n\r\n// Thin borders\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\n\r\nsheet.freezePanes.freezeRows(1);\r\nusedRange.format.autofitColumns();\r\nawait context.sync();` },\r\n    {\r\n      icon: \"snowflake\", label: \"Freeze Header\", prompt: `Freeze the first row:\r\n\r\nsheet.freezePanes.freezeRows(1);\r\nawait context.sync();` },\r\n    {\r\n      icon: \"table\", label: \"Excel Table\", prompt: `Convert data to Excel Table:\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"address\");\r\nawait context.sync();\r\n\r\nif (!usedRange) {\r\n  throw new Error(\"No data found in sheet.\");\r\n}\r\n\r\nconst table = sheet.tables.add(usedRange, true);\r\ntable.style = \"TableStyleMedium9\";\r\nusedRange.format.autofitColumns();\r\nawait context.sync();` },\r\n    {\r\n      icon: \"paintbrush\", label: \"Borders All\", prompt: `Add thin borders to all cells:\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.format.borders.getItem(\"InsideHorizontal\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"InsideVertical\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeTop\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeBottom\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeLeft\").style = \"Thin\";\r\nusedRange.format.borders.getItem(\"EdgeRight\").style = \"Thin\";\r\nawait context.sync();` },\r\n    { icon: \"hash\", label: \"Currency $\", prompt: `Format numeric columns as currency. First read the data to detect numeric columns, then apply $#,##0.00 format.` },\r\n    { icon: \"hash\", label: \"Percentage %\", prompt: `Format the last numeric column as percentage (0.00%) and auto-fit columns.` },\r\n  ],\r\n\r\n  //  Report Automation Engine \r\n  reports: [\r\n    { icon: \"barChart\", label: \"Instant Dashboard \", prompt: \"Analyze the dataset. Create a new sheet 'Dashboard'. Generate 3 professional charts (Bar, Line, Pie) for key trends. Add 'Big Number' cards at top for Totals. Apply modern theme. Make it executive-ready.\" },\r\n    { icon: \"barChart\", label: \"Sales Report\", prompt: \"Generate a professional monthly sales report from the existing data. Do ALL of this: (1) Add a report title row at the top: 'Monthly Sales Report' in bold, font size 14, merged across all columns. (2) Add today's date below the title, right-aligned. (3) Format the data with professional headers (dark navy background, white bold text) and alternating row colors. (4) Add SUM, AVERAGE, MAX, and MIN summary rows at the bottom with labels. (5) Create a clustered column chart from the data showing performance by category. Position it below the summary. (6) Add thin borders throughout and auto-fit all columns.\" },\r\n    { icon: \"barChart\", label: \"Financial Summary\", prompt: \"Build a financial summary report from the data. (1) Add a 'Financial Summary' title merged at top, bold, font size 14. (2) Format headers professionally with dark green (#1B4D3E) background and white text. (3) Format all currency columns as $#,##0.00. (4) Add a TOTAL row with SUM formulas, bold, with a top border. (5) Add a 'Net' or 'Difference' calculation if applicable. (6) Apply conditional formatting: positive numbers in green, negative in red. (7) Create a pie chart showing the breakdown. (8) Auto-fit columns and freeze header row.\" },\r\n    { icon: \"trendUp\", label: \"Performance Review\", prompt: \"Create a team performance report from the data. (1) Add a 'Team Performance Report' title at top, merged, bold, font size 14. (2) Professional header formatting with indigo (#2B3A67) background, white text. (3) Add RANK column based on the primary numeric metric column. (4) Add conditional formatting: top 3 rows highlighted in light green (#E6F4EA), bottom 3 in light red (#FDE8E8). (5) Add AVERAGE, MAX, MIN summary rows at bottom. (6) Create a bar chart showing individual performance, sorted high to low. (7) Auto-fit and add borders.\" },\r\n    { icon: \"barChart\", label: \"Inventory Report\", prompt: \"Generate an inventory status report from the data. (1) Title: 'Inventory Status Report', merged, bold, size 14. (2) Professional formatting with teal (#0D7377) headers. (3) If there's a quantity column, add conditional formatting: red background for items  10 (low stock), yellow for 11-50 (medium), green for 50+ (healthy). (4) Add a status column with IF formula: 'Critical' for  10, 'Low' for 11-25, 'OK' for 26-50, 'Good' for 50+. (5) Add summary showing total items, total value (if price column exists), and count by status. (6) Create a pie chart showing stock level distribution.\" },\r\n    { icon: \"barChart\", label: \"Attendance Summary\", prompt: \"Generate an attendance summary report. (1) Title: 'Attendance Summary', merged, bold, size 14. (2) Count Present (P), Absent (A), Leave (L) for each person using COUNTIF. (3) Calculate attendance percentage. (4) Format: professional headers, alternating rows, percentage column formatted as percentage. (5) Conditional formatting on attendance %: green  90%, yellow 75-89%, red < 75%. (6) Add a column chart showing attendance by person. (7) Add class/team averages at bottom.\" },\r\n    { icon: \"fileTemplate\", label: \"Weekly Status\", prompt: \"Create a weekly status report template: (1) Title: 'Weekly Status Update  Week of [Date]', merged, bold. (2) Section 1: 'Completed This Week'  5 rows with Task, Owner, Status columns. (3) Section 2: 'In Progress'  5 rows with Task, Owner, % Complete, ETA columns. (4) Section 3: 'Blockers & Risks'  3 rows with Issue, Impact, Action Needed columns. (5) Section 4: 'Next Week Plans'  4 rows. (6) Format each section with colored headers (different subtle colors), thin borders, and auto-fit.\" },\r\n  ],\r\n\r\n  //  Ready-Made Templates \r\n  templates: [\r\n    { icon: \"fileTemplate\", label: \"Monthly Budget\", prompt: \"Create a monthly budget tracker with categories: Housing, Utilities, Food, Transport, Entertainment, Savings. Add columns for Budget, Actual, and Difference with SUM at bottom. Use professional formatting with green for under-budget and red for over-budget conditional formatting.\" },\r\n    { icon: \"fileTemplate\", label: \"Invoice\", prompt: \"Create a professional invoice template with: Company Name header, Invoice #, Date, Bill To section, items table with Description, Quantity, Unit Price, Total columns, Subtotal, Tax (10%), and Grand Total calculations. Apply clean formatting.\" },\r\n    { icon: \"fileTemplate\", label: \"Employee List\", prompt: \"Create an employee directory with 8 sample employees: Name, Department (HR/Engineering/Marketing/Sales), Email, Phone, Joining Date, Salary. Apply professional table formatting with alternating rows and currency format for salary.\" },\r\n    { icon: \"fileTemplate\", label: \"Project Tracker\", prompt: \"Create a project tracker with 6 sample tasks: Task Name, Assigned To, Priority (High/Medium/Low), Status (Not Started/In Progress/Complete), Start Date, Due Date. Add dropdown validation for Priority and Status. Use conditional formatting for status colors.\" },\r\n    { icon: \"fileTemplate\", label: \"Sales Dashboard\", prompt: \"Create a quarterly sales report with 5 products across Q1-Q4. Add Total column and row with SUM formulas. Create a column chart showing quarterly performance. Apply professional formatting.\" },\r\n    { icon: \"fileTemplate\", label: \"Attendance Sheet\", prompt: \"Create a monthly attendance sheet for 10 employees with dates as columns (1-31). Mark P for present, A for absent, L for leave. Add summary columns for Total Present, Absent, and Leave. Apply conditional formatting.\" },\r\n    { icon: \"fileTemplate\", label: \"Grade Book\", prompt: \"Create a student grade book for 8 students with 5 assignments, Midterm, Final, and Total/Grade columns. Add weighted average formulas and letter grade calculation (A/B/C/D/F). Apply professional formatting with conditional colors.\" },\r\n    { icon: \"fileTemplate\", label: \"Weekly Schedule\", prompt: \"Create a weekly schedule template with time slots from 8 AM to 6 PM (1-hour intervals) and columns for Mon-Fri. Add borders, colored header, and merge the title cell. Apply a clean, readable format.\" },\r\n  ],\r\n\r\n  //  Advanced Analysis (Master Level) \r\n  analysis: [\r\n    { icon: \"trendUp\", label: \"Pivot Analysis\", prompt: \"Create a new sheet named 'Pivot Analysis'. Select the entire current dataset. Insert a Pivot Table starting at A3. Automatically detect the categorical column for Rows and the numeric column for Values (Sum). Apply the 'PivotStyleMedium9' style.\" },\r\n    { icon: \"barChart\", label: \"Pareto Chart\", prompt: \"Create a Pareto analysis. (1) Copy the data to a new sheet 'Pareto'. (2) Sort by the numeric metric descending. (3) Calculate cumulative percentage. (4) Create a Pareto chart (combo chart: bars for values, line for cumulative %). Add data labels.\" },\r\n    { icon: \"search\", label: \"Find Outliers\", prompt: \"Analyze the numeric column. Calculate Mean and Standard Deviation. Highlight any cell that is more than 2 Standard Deviations away from the Mean in RED (#FFCCCC). Add a note to the cell 'Outlier'.\" },\r\n    { icon: \"sortAsc\", label: \"Correlation Matrix\", prompt: \"Analyze all numeric columns. Create a correlation matrix in a new sheet 'Correlations'. Calculate the correlation coefficient (CORREL) between every pair of numeric variables. Use Conditional Formatting (Color Scale) to highlight strong positive (green) and negative (red) correlations.\" },\r\n    { icon: \"calendar\", label: \"Date Intelligence\", prompt: \"Find the Date column. Insert 4 new columns to the right: Year, Quarter, Month Name, Week Number. Use formulas (=YEAR, =ROUNDUP(MONTH(.)/3,0), =TEXT(.,'mmmm'), =ISOWEEKNUM) to populate them for all rows. Copy and Paste Values to finalize.\" },\r\n    { icon: \"trendUp\", label: \"Forecast 12M\", prompt: \"Analyze the time-series data. Create a new sheet 'Forecast'. Use the FORECAST.ETS function to predict the next 12 months based on historical data. Create a Line Chart showing history (solid) and forecast (dotted) with confidence intervals.\" },\r\n    { icon: \"copy\", label: \"Transpose & Link\", prompt: \"Copy the selected table. Create a new sheet 'Transposed'. Paste the data linked/transposed (=TRANSPOSE(Original!Range)) so it updates automatically. Apply professional formatting.\" },\r\n    { icon: \"filter\", label: \"Advanced Filter\", prompt: \"Create a 'Search' area above the data. Set up a dynamic visual filter: when user types in cell B1, filter the main table rows where the text content contains that value (wildcard match). Use conditional formatting to hide non-matching rows if Filter function is not available.\" },\r\n    { icon: \"hash\", label: \"Frequency Dist\", prompt: \"Create a frequency distribution (histogram data) for the main numeric column. Create bins (groups) automatically. Count the frequency of items in each bin. Output a summary table and a Histogram chart in a new sheet.\" },\r\n    { icon: \"zap\", label: \"Regex Extract\", prompt: \"Analyze the text column. If it contains emails, extract them to a new column 'Email'. If it contains phone numbers, extract and format them. If it contains IDs (like #1234), extract them. Use Flash Fill logic or pattern matching formulas.\" },\r\n  ],\r\n\r\n  //  Document Extraction (Resume/CV Import) \r\n  extract: [\r\n    { icon: \"fileText\", label: \" Import to Schema\", prompt: \"SCHEMA_EXTRACTION_MODE: Read the column headers in row 1 of the current sheet. For each attached PDF/resume, extract ONLY the data that matches those columns. If a column's data doesn't exist in the PDF, leave it blank. Append each candidate as a new row.\" },\r\n    { icon: \"users\", label: \" Bulk Resume Import\", prompt: \"SCHEMA_EXTRACTION_MODE: Import all attached resumes/CVs. First read existing column headers. If no headers exist, create: Name, Email, Phone, Skills, Experience, Education. Extract data from each PDF and add one row per candidate. Never hallucinate  if data is missing, leave blank.\" },\r\n    { icon: \"fileTemplate\", label: \" HR Database Setup\", prompt: \"Create a professional HR candidate database template with columns: Name, Email, Phone, LinkedIn, Current Company, Current Role, Skills, Years of Experience, Highest Education, Expected Salary, Notes. Apply formatting with filters and freeze header row.\" },\r\n    { icon: \"search\", label: \" Smart Extract\", prompt: \"SCHEMA_EXTRACTION_MODE: Intelligently analyze the attached documents. Read column headers from the sheet. Match document content to columns using smart aliases (e.g., 'Mobile No' matches 'Phone' column). Only extract what exists  no guessing.\" },\r\n    { icon: \"table\", label: \" Create Schema First\", prompt: \"Before importing, set up your columns: Create header row with: Name, Email, Mobile No, Age, Address, Skills, Experience. Format as a proper table with filters. Now attach PDFs and click 'Import to Schema'.\" },\r\n    { icon: \"checkSquare\", label: \" Validate & Clean\", prompt: \"Validate the extracted data: Check for blank required fields (Name, Email). Highlight rows with missing data in yellow. Add a 'Status' column marking 'Complete' or 'Incomplete' for each row.\" },\r\n  ],\r\n\r\n  //  Smart Tools (Power User Headache Solvers) \r\n  smart: [\r\n    { icon: \"brain\", label: \"Data Profiler \", prompt: `Analyze the entire dataset and create a comprehensive Data Profile report on a NEW sheet called \"Data Profile\". For each column, calculate: (1) Column Name, (2) Data Type (text/number/date/mixed), (3) Total Count, (4) Blank Count, (5) Blank %, (6) Unique Values Count, (7) Most Common Value, (8) For numeric columns: Min, Max, Mean, Median. Create this as a formatted table with headers. Add a \"Data Quality Score\" at the top calculated as (100 - average blank %). Apply professional formatting: dark header row, alternating rows, conditional formatting on blank % (green < 5%, yellow 5-20%, red > 20%). Auto-fit all columns.` },\r\n    {\r\n      icon: \"highlight\", label: \"Highlight Duplicates\", prompt: `Find and highlight ALL duplicate values in the first data column (column A, excluding header).\r\n\r\nconst usedRange = sheet.getUsedRange();\r\nusedRange.load(\"values,rowCount,columnCount\");\r\nawait context.sync();\r\n\r\nif (!usedRange || usedRange.rowCount < 2) throw new Error(\"Need at least 2 rows of data.\");\r\n\r\nconst values = usedRange.values;\r\nconst col = 0; // Check column A\r\nconst seen = {};\r\nconst dupes = new Set();\r\n\r\n// Pass 1: find duplicates\r\nfor (let i = 1; i < values.length; i++) {\r\n  const val = String(values[i][col]).trim().toLowerCase();\r\n  if (val === \"\") continue;\r\n  if (seen[val] !== undefined) {\r\n    dupes.add(val);\r\n  }\r\n  seen[val] = i;\r\n}\r\n\r\n// Pass 2: highlight them\r\nlet count = 0;\r\nfor (let i = 1; i < values.length; i++) {\r\n  const val = String(values[i][col]).trim().toLowerCase();\r\n  if (dupes.has(val)) {\r\n    const cell = usedRange.getRow(i);\r\n    cell.format.fill.color = \"#FECACA\";\r\n    cell.format.font.color = \"#991B1B\";\r\n    count++;\r\n  }\r\n}\r\nawait context.sync();\r\n// Done: highlighted duplicates` },\r\n    { icon: \"columns\", label: \"Compare Columns\", prompt: `Compare columns A and B to find differences. For each row, if A  B, highlight both cells in light red (#FEE2E2). If they match, highlight in light green (#DCFCE7). Add a new column C with 'Match' or 'Mismatch' labels. Add a summary at the bottom showing total matches and mismatches. Format the summary row in bold.` },\r\n    { icon: \"formula\", label: \"Auto Summary Row \", prompt: `Analyze ALL columns. For each NUMERIC column, add 4 summary rows at the bottom: SUM, AVERAGE, MIN, MAX  with formula labels in column A. Make the summary section visually distinct: add a thick top border, bold labels, and light blue (#EFF6FF) background. Format numbers with commas and 2 decimal places. Auto-fit all columns.` },\r\n    { icon: \"crosshair\", label: \"Top/Bottom 5 \", prompt: `Find the main numeric column in the data. Identify the Top 5 values and highlight their entire rows in green (#DCFCE7). Identify the Bottom 5 values and highlight their rows in red (#FEE2E2). Add a 'Rank' column at the end. Sort the data by the numeric column descending. Auto-fit columns.` },\r\n    { icon: \"mail\", label: \"Extract Emails & Phones\", prompt: `Scan ALL cells in the used range. Extract any email addresses (containing @) and phone numbers (10+ digit patterns). Create a new sheet called \"Contacts\" with columns: Source Cell, Name (if adjacent), Email, Phone. Remove duplicates. Format as a professional table with filters. Auto-fit columns.` },\r\n    { icon: \"layers\", label: \"Unpivot Data\", prompt: `Convert wide-format data to long format (unpivot). Take the first column as the ID column. Treat all remaining columns as value columns. Create a new sheet \"Unpivoted\" with 3 columns: the original ID, \"Category\" (original column header), and \"Value\" (the cell value). Skip blank values. Apply professional formatting.` },\r\n    { icon: \"shield\", label: \"Data Validation Rules\", prompt: `Analyze column headers and add smart data validation rules. For columns that look like: (1) Email  add text validation requiring '@', (2) Phone  allow only numbers with length 10-15, (3) Date columns  add date validation, (4) Status/Type columns  create dropdown lists from unique existing values, (5) Numeric columns  add number validation (>= 0). Highlight validated columns with a subtle blue header to indicate protection is active.` },\r\n    { icon: \"dollarSign\", label: \"Number to Words \", prompt: `Add a new column next to the main numeric/currency column. For each row, convert the number to words in English (e.g., 1234  \"One Thousand Two Hundred Thirty Four\"). This is useful for invoices and checks. Use a helper function that handles numbers up to 999,999,999. Format the words column with proper case and auto-fit.` },\r\n    { icon: \"copy\", label: \"Smart Merge Sheets\", prompt: `Merge data from ALL worksheets in the workbook into a new sheet called \"Merged Data\". For each sheet: read the headers and data, align columns by header name (smart matching), and append all rows. Remove exact duplicate rows from the final merged data. Add a \"Source Sheet\" column to track where each row came from. Apply professional formatting with alternating rows.` },\r\n  ],\r\n};\r\n\r\n// Chat Suggestions (shown on welcome screen)\r\nconst CHAT_SUGGESTIONS = [\r\n  { icon: \"brain\", text: \"Analyze my data and tell me what's interesting\" },\r\n  { icon: \"formula\", text: \"Which formula should I use for my use case?\" },\r\n  { icon: \"paintbrush\", text: \"Make my sheet look professional in one click\" },\r\n  { icon: \"barChart\", text: \"Generate a monthly report with charts\" },\r\n  { icon: \"search\", text: \"Find all duplicates and inconsistencies\" },\r\n  { icon: \"sparkles\", text: \"What can you do? Show me your best features\" },\r\n];\r\n\r\n//  Initialization \r\n//  Global Error Handler \r\nwindow.onerror = function (msg, url, line) {\r\n  const statusEl = document.getElementById(\"loading-status\");\r\n  if (statusEl) {\r\n    statusEl.innerHTML += `<br><span style=\"color:#d32f2f;font-weight:bold;font-size:11px;\">${msg} (Line ${line})</span>`;\r\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\r\n    document.getElementById(\"app-body\").style.display = \"flex\";\r\n  }\r\n  return false;\r\n};\r\n\r\n//  Initialization \r\nOffice.onReady((info) => {\r\n  // Always show app to prevent hang\r\n  const sideloadMsg = document.getElementById(\"sideload-msg\");\r\n  const appBody = document.getElementById(\"app-body\");\r\n  if (sideloadMsg) sideloadMsg.style.display = \"none\";\r\n  if (appBody) appBody.style.display = \"flex\";\r\n\r\n  if (info.host === Office.HostType.Excel) {\r\n    console.log(\"Running in Excel\");\r\n  } else {\r\n    console.warn(\"Running outside Excel\");\r\n  }\r\n\r\n  // Inject Icons\r\n  injectIcons();\r\n  injectDocIcons();\r\n  injectCategoryIcons();\r\n\r\n  // Wire up UI Actions\r\n  document.getElementById(\"run\").onclick = runAICommand;\r\n\r\n  // Settings & Docs Toggles\r\n  document.getElementById(\"settings-toggle\").onclick = () => {\r\n    const panel = document.getElementById(\"settings-panel\");\r\n    panel.style.display = panel.style.display === \"none\" ? \"block\" : \"none\";\r\n    document.getElementById(\"docs-panel\").style.display = \"none\";\r\n  };\r\n  document.getElementById(\"docs-toggle\").onclick = () => {\r\n    const panel = document.getElementById(\"docs-panel\");\r\n    panel.style.display = panel.style.display === \"none\" ? \"block\" : \"none\";\r\n    document.getElementById(\"settings-panel\").style.display = \"none\";\r\n  };\r\n\r\n  document.getElementById(\"save-settings\").onclick = handleSaveSettings;\r\n  document.getElementById(\"refresh-models\").onclick = loadOllamaModels;\r\n\r\n  // Mode Toggles\r\n  document.getElementById(\"mode-planning\").onclick = () => switchMode(\"planning\");\r\n  document.getElementById(\"mode-agent\").onclick = () => switchMode(\"agent\");\r\n\r\n  // Chat Actions\r\n  document.getElementById(\"chat-send\").onclick = sendChatMessage;\r\n  const clearBtn = document.getElementById(\"chat-clear\");\r\n  if (clearBtn) clearBtn.onclick = clearChat;\r\n\r\n  setupChatInput();\r\n  setupScrollToBottom();\r\n  setupAgentKeyboardShortcut();\r\n  setupCharCount();\r\n\r\n  // File Upload Handlers\r\n  const bindClick = (id: string, handler: () => void) => {\r\n    const el = document.getElementById(id);\r\n    if (el) el.onclick = handler;\r\n  };\r\n  const bindChange = (id: string, handler: (e: Event) => void) => {\r\n    const el = document.getElementById(id);\r\n    if (el) el.onchange = handler;\r\n  };\r\n\r\n  bindClick(\"file-upload-btn\", () => document.getElementById(\"file-input\").click());\r\n  bindChange(\"file-input\", (e) => handleFileSelect(e, false));\r\n  bindClick(\"file-remove\", () => clearFile(false));\r\n\r\n  bindClick(\"agent-file-btn\", () => document.getElementById(\"agent-file-input\").click());\r\n  bindChange(\"agent-file-input\", (e) => handleFileSelect(e, true));\r\n  bindClick(\"agent-file-remove\", () => clearFile(true));\r\n\r\n  // Batch PDF Extraction\r\n  bindClick(\"batch-extract-btn\", runBatchPDFExtraction);\r\n\r\n  // Category Tabs\r\n  document.querySelectorAll(\".category-tab\").forEach((tab) => {\r\n    (tab as HTMLElement).onclick = () => {\r\n      const cat = (tab as HTMLElement).dataset.category as ActionCategory;\r\n      switchCategory(cat);\r\n    };\r\n  });\r\n\r\n  // Detect Columns Button (Extract Mode)\r\n  bindClick(\"detect-columns-btn\", detectAndShowColumns);\r\n\r\n  // Initial UI Build\r\n  buildQuickActions();\r\n  buildChatSuggestions();\r\n  loadSettingsUI();\r\n});\r\n\r\n//  Icon Injection \r\nfunction injectIcons(): void {\r\n  const el = (id: string, html: string) => {\r\n    const node = document.getElementById(id);\r\n    if (node) node.innerHTML = html;\r\n  };\r\n  el(\"logo-icon\", Icons.fileText);\r\n  el(\"settings-toggle\", Icons.settings);\r\n  el(\"docs-toggle\", Icons.helpCircle);\r\n  el(\"run-icon\", Icons.arrowRight);\r\n  el(\"chevron-icon\", Icons.chevronDown);\r\n  el(\"refresh-models\", Icons.refresh);\r\n  el(\"mode-planning-icon\", Icons.messageCircle);\r\n  el(\"mode-agent-icon\", Icons.zap);\r\n  el(\"chat-send-icon\", Icons.send);\r\n  el(\"chat-clear-icon\", Icons.trash);\r\n  el(\"welcome-sparkle\", Icons.sparkles);\r\n}\r\n\r\nfunction injectDocIcons(): void {\r\n  document.querySelectorAll(\".doc-icon[data-icon]\").forEach((el) => {\r\n    const key = el.getAttribute(\"data-icon\") as keyof typeof Icons;\r\n    if (Icons[key]) el.innerHTML = Icons[key];\r\n  });\r\n}\r\n\r\nfunction injectCategoryIcons(): void {\r\n  document.querySelectorAll(\".cat-icon[data-icon]\").forEach((el) => {\r\n    const key = el.getAttribute(\"data-icon\") as keyof typeof Icons;\r\n    if (Icons[key]) el.innerHTML = Icons[key];\r\n  });\r\n}\r\n\r\n//  Mode Switching \r\nfunction switchMode(mode: Mode): void {\r\n  if (mode === currentMode) return;\r\n  currentMode = mode;\r\n\r\n  // Update tabs\r\n  document.querySelectorAll(\".mode-tab\").forEach((tab) => {\r\n    tab.classList.toggle(\"active\", (tab as HTMLElement).dataset.mode === mode);\r\n  });\r\n\r\n  // Update indicator\r\n  const indicator = document.getElementById(\"mode-indicator\");\r\n  if (mode === \"agent\") {\r\n    indicator.classList.add(\"right\");\r\n  } else {\r\n    indicator.classList.remove(\"right\");\r\n  }\r\n\r\n  // Show/hide content\r\n  document.getElementById(\"planning-mode\").classList.toggle(\"active\", mode === \"planning\");\r\n  document.getElementById(\"agent-mode\").classList.toggle(\"active\", mode === \"agent\");\r\n\r\n  // Focus appropriate input\r\n  if (mode === \"planning\") {\r\n    setTimeout(() => (document.getElementById(\"chat-input\") as HTMLTextAreaElement).focus(), 200);\r\n  } else {\r\n    setTimeout(() => (document.getElementById(\"prompt-input\") as HTMLTextAreaElement).focus(), 200);\r\n  }\r\n}\r\n\r\n//  Category Switching \r\nfunction switchCategory(category: ActionCategory): void {\r\n  currentCategory = category;\r\n\r\n  document.querySelectorAll(\".category-tab\").forEach((tab) => {\r\n    tab.classList.toggle(\"active\", (tab as HTMLElement).dataset.category === category);\r\n  });\r\n\r\n  // Show/hide schema info banner for Extract mode\r\n  const schemaInfo = document.getElementById(\"schema-info\");\r\n  const detectedColumns = document.getElementById(\"detected-columns\");\r\n\r\n  if (schemaInfo) {\r\n    schemaInfo.style.display = category === \"extract\" ? \"flex\" : \"none\";\r\n  }\r\n\r\n  if (detectedColumns) {\r\n    detectedColumns.style.display = category === \"extract\" && detectedColumns.innerHTML.trim() ? \"block\" : \"none\";\r\n  }\r\n\r\n  // Update extraction mode flag\r\n  schemaExtractionMode = category === \"extract\";\r\n\r\n  buildQuickActions();\r\n  // Show/hide batch panel when switching to/from extract\r\n  showBatchPanel(category === \"extract\" && rawPDFFiles.length > 0);\r\n}\r\n\r\n//  Quick Actions (Agent Mode) \r\nfunction buildQuickActions(): void {\r\n  const container = document.getElementById(\"quick-actions\");\r\n  if (!container) return;\r\n  container.innerHTML = \"\";\r\n\r\n  const actions = CATEGORIZED_ACTIONS[currentCategory];\r\n  if (!actions) {\r\n    console.warn(`No quick actions found for category: ${currentCategory}`);\r\n    return;\r\n  }\r\n\r\n  actions.forEach((action) => {\r\n    const chip = document.createElement(\"button\");\r\n    chip.className = \"chip\";\r\n    const iconKey = action.icon as keyof typeof Icons;\r\n    chip.innerHTML = `${Icons[iconKey] || \"\"}<span>${action.label}</span>`;\r\n    chip.onclick = () => {\r\n      const input = document.getElementById(\"prompt-input\") as HTMLTextAreaElement;\r\n      if (input) {\r\n        input.value = action.prompt;\r\n        input.focus();\r\n        // Clear status when switching action\r\n        const statusEl = document.getElementById(\"status-message\");\r\n        if (statusEl) statusEl.style.display = \"none\";\r\n      }\r\n    };\r\n    container.appendChild(chip);\r\n  });\r\n}\r\n\r\n\r\n//  Chat Suggestions (Planning Mode) \r\nfunction buildChatSuggestions(): void {\r\n  const container = document.getElementById(\"chat-suggestions\");\r\n  if (!container) return;\r\n\r\n  CHAT_SUGGESTIONS.forEach((s) => {\r\n    const btn = document.createElement(\"button\");\r\n    btn.className = \"suggestion-chip\";\r\n    const iconKey = s.icon as keyof typeof Icons;\r\n    btn.innerHTML = `${Icons[iconKey] || \"\"}${s.text}`;\r\n    btn.onclick = () => {\r\n      const input = document.getElementById(\"chat-input\") as HTMLTextAreaElement;\r\n      if (input) {\r\n        input.value = s.text;\r\n        sendChatMessage();\r\n      }\r\n    };\r\n    container.appendChild(btn);\r\n  });\r\n}\r\n\r\n//  Panel Toggle \r\nfunction togglePanel(panelId: string): void {\r\n  const panel = document.getElementById(panelId);\r\n  const isHidden = panel?.style.display === \"none\" || !panel?.style.display;\r\n\r\n  document.querySelectorAll(\".panel\").forEach((p: HTMLElement) => {\r\n    p.style.display = \"none\";\r\n  });\r\n\r\n  if (isHidden && panel) {\r\n    panel.style.display = \"block\";\r\n    if (panelId === \"settings-panel\") {\r\n      const providerSelect = document.getElementById(\"setting-provider\") as HTMLSelectElement;\r\n      if (providerSelect && providerSelect.value === \"local\") loadOllamaModels();\r\n    }\r\n  }\r\n}\r\n\r\n//  Settings \r\n//  Settings \r\nfunction loadSettingsUI(): void {\r\n  const config = getConfig();\r\n  const providerSelect = document.getElementById(\"setting-provider\") as HTMLSelectElement;\r\n  if (providerSelect) {\r\n    providerSelect.value = config.provider;\r\n    providerSelect.onchange = (e) => {\r\n      const p = (e.target as HTMLSelectElement).value;\r\n      updateProviderFields(p);\r\n      if (p === \"local\") loadOllamaModels();\r\n    };\r\n  }\r\n\r\n  // Populate inputs (safe checks)\r\n  const setVal = (id: string, val: string) => {\r\n    const el = document.getElementById(id) as HTMLInputElement | HTMLSelectElement;\r\n    if (el) el.value = val || \"\";\r\n  };\r\n\r\n  setVal(\"setting-api-key\", config.apiKey); // Groq\r\n  setVal(\"setting-groq-model\", config.groqModel || \"llama-3.3-70b-versatile\");\r\n\r\n  setVal(\"setting-gemini-key\", config.geminiKey);\r\n  setVal(\"setting-gemini-model\", config.geminiModel || \"gemini-1.5-flash\");\r\n\r\n  setVal(\"setting-openai-key\", config.openaiKey);\r\n  setVal(\"setting-openai-model\", config.openaiModel || \"gpt-4o-mini\");\r\n\r\n  setVal(\"setting-anthropic-key\", config.anthropicKey);\r\n  setVal(\"setting-anthropic-model\", config.anthropicModel || \"claude-3-5-sonnet-20241022\");\r\n\r\n  setVal(\"setting-openrouter-key\", config.openrouterKey);\r\n  setVal(\"setting-openrouter-model\", config.openrouterModel || \"anthropic/claude-3.5-sonnet:beta\");\r\n\r\n  setVal(\"setting-base-url\", config.baseUrl);\r\n  // Local model is populated async\r\n\r\n  updateProviderFields(config.provider);\r\n}\r\n\r\nfunction updateProviderFields(p: string): void {\r\n  const setDisplay = (id: string, show: boolean) => {\r\n    const el = document.getElementById(id);\r\n    if (el) el.style.display = show ? \"block\" : \"none\";\r\n  };\r\n  setDisplay(\"groq-fields\", p === \"groq\");\r\n  setDisplay(\"gemini-fields\", p === \"gemini\");\r\n  setDisplay(\"openai-fields\", p === \"openai\");\r\n  setDisplay(\"anthropic-fields\", p === \"anthropic\");\r\n  setDisplay(\"openrouter-fields\", p === \"openrouter\");\r\n  setDisplay(\"local-fields\", p === \"local\");\r\n}\r\n\r\nasync function loadOllamaModels(): Promise<void> {\r\n  const select = document.getElementById(\"setting-local-model\") as HTMLSelectElement;\r\n  const statusEl = document.getElementById(\"model-status\");\r\n  const host = (document.getElementById(\"setting-base-url\") as HTMLInputElement)?.value?.trim() || \"http://localhost:11434\";\r\n\r\n  if (!select) return;\r\n\r\n  select.innerHTML = `<option value=\"\" disabled selected>Loading...</option>`;\r\n  if (statusEl) {\r\n    statusEl.textContent = \"\";\r\n    statusEl.className = \"model-status\";\r\n  }\r\n\r\n  const models = await fetchOllamaModels(host);\r\n  if (models.length === 0) {\r\n    select.innerHTML = `<option value=\"\" disabled selected>No models found</option>`;\r\n    if (statusEl) {\r\n      statusEl.textContent = \"Ollama not running or no models installed\";\r\n      statusEl.className = \"model-status model-status-warn\";\r\n    }\r\n    return;\r\n  }\r\n\r\n  const config = getConfig();\r\n  select.innerHTML = \"\";\r\n  models.forEach((m) => {\r\n    const opt = document.createElement(\"option\");\r\n    opt.value = m.name;\r\n    opt.textContent = `${m.name} (${(m.size / 1e9).toFixed(1)}GB)`;\r\n    if ((config.localModel || config.model) === m.name) opt.selected = true;\r\n    select.appendChild(opt);\r\n  });\r\n  if (statusEl) {\r\n    statusEl.textContent = `${models.length} model${models.length > 1 ? \"s\" : \"\"} found`;\r\n    statusEl.className = \"model-status model-status-ok\";\r\n  }\r\n}\r\n\r\nfunction handleSaveSettings(): void {\r\n  const provider = (document.getElementById(\"setting-provider\") as HTMLSelectElement)?.value as any;\r\n  const current = getConfig();\r\n\r\n  // Helper to read val\r\n  const getVal = (id: string) => (document.getElementById(id) as HTMLInputElement | HTMLSelectElement)?.value?.trim() || \"\";\r\n\r\n  const newConfig: LLMConfig = {\r\n    ...current,\r\n    provider: provider,\r\n\r\n    // Groq\r\n    apiKey: getVal(\"setting-api-key\"),\r\n    groqModel: getVal(\"setting-groq-model\"),\r\n\r\n    // Gemini\r\n    geminiKey: getVal(\"setting-gemini-key\"),\r\n    geminiModel: getVal(\"setting-gemini-model\"),\r\n\r\n    // OpenAI\r\n    openaiKey: getVal(\"setting-openai-key\"),\r\n    openaiModel: getVal(\"setting-openai-model\"),\r\n\r\n    // Anthropic\r\n    anthropicKey: getVal(\"setting-anthropic-key\"),\r\n    anthropicModel: getVal(\"setting-anthropic-model\"),\r\n\r\n    // OpenRouter\r\n    openrouterKey: getVal(\"setting-openrouter-key\"),\r\n    openrouterModel: getVal(\"setting-openrouter-model\"),\r\n\r\n    // Local\r\n    baseUrl: getVal(\"setting-base-url\") ? `${getVal(\"setting-base-url\").replace(/\\/v1.*$/, \"\")}/v1/chat/completions` : undefined,\r\n    localModel: getVal(\"setting-local-model\") || current.localModel\r\n  };\r\n\r\n  saveConfig(newConfig);\r\n\r\n  // Animated save feedback\r\n  const btn = document.getElementById(\"save-settings\");\r\n  if (btn) {\r\n    const originalText = btn.textContent;\r\n    btn.textContent = \" Saved\";\r\n    btn.classList.add(\"saved\");\r\n    setTimeout(() => {\r\n      btn.textContent = originalText || \"Save\";\r\n      btn.classList.remove(\"saved\");\r\n    }, 1500);\r\n  }\r\n\r\n  showToast(\"success\", \"Settings saved successfully\");\r\n\r\n  setTimeout(() => {\r\n    const panel = document.getElementById(\"settings-panel\");\r\n    if (panel) panel.style.display = \"none\";\r\n  }, 800);\r\n}\r\n\r\n\r\n// \r\n// PLANNING MODE  Chat Functions\r\n// \r\n\r\nfunction setupChatInput(): void {\r\n  const input = document.getElementById(\"chat-input\") as HTMLTextAreaElement;\r\n  if (!input) return;\r\n\r\n  // Auto-resize textarea\r\n  input.addEventListener(\"input\", () => {\r\n    input.style.height = \"auto\";\r\n    input.style.height = Math.min(input.scrollHeight, 80) + \"px\";\r\n  });\r\n\r\n  // Enter to send (Shift+Enter for newline)\r\n  input.addEventListener(\"keydown\", (e) => {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      sendChatMessage();\r\n    }\r\n  });\r\n}\r\n\r\nasync function sendChatMessage(): Promise<void> {\r\n  if (isChatBusy) {\r\n    stopChatGeneration();\r\n    return;\r\n  }\r\n\r\n  const input = document.getElementById(\"chat-input\") as HTMLTextAreaElement;\r\n  if (!input) return;\r\n  const message = input.value.trim();\r\n  if (!message) return;\r\n\r\n  // Clear welcome screen on first message\r\n  const welcome = document.querySelector(\".chat-welcome\") as HTMLElement;\r\n  if (welcome) welcome.remove();\r\n\r\n  // Add user message\r\n  addChatBubble(\"user\", message);\r\n  chatHistory.push({ role: \"user\", content: message, timestamp: Date.now() });\r\n\r\n  // Build conversation context with initial sheet overview\r\n  if (chatConversation.length === 0) {\r\n    let initialPrompt = CHAT_PROMPT;\r\n    try {\r\n      // Proactively give the AI an overview of the sheet columns at the start\r\n      const overview = await getSheetContext();\r\n      if (overview && overview.hits === 0 && overview.text.length > 20) {\r\n        initialPrompt += \"\\n\\n[INITIAL SHEET OVERVIEW]\\n\" + overview.text;\r\n      }\r\n    } catch (e) {\r\n      console.warn(\"Could not load initial sheet overview:\", e);\r\n    }\r\n    chatConversation.push({ role: \"system\", content: initialPrompt });\r\n  }\r\n\r\n  //  CONTEXT AWARENESS: Auto-detect if user is asking about their sheet or searching for data\r\n  const needsSheetContext = /\\b(this|my|current|opened?)\\s+(sheet|data|table|workbook|excel|spreadsheet|sheeet|spreadsheat)\\b|\\b(find|search|where|is|check|lookup|contains?|exist|details|about|located|who|tell|give)\\b|what\\s+(do|can|should)|improve|analyze|suggest|help|better|optimize|\\b\\d{5,}\\b|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/i.test(message) ||\r\n    /\\b[A-Z]{2,}(?:\\s+[A-Z]{2,})+\\b/.test(message) || // ALL CAPS sequences (Names/IDs)\r\n    /\\b[A-Z][a-z]+(?:\\s+[A-Z][a-z]+)+\\b/.test(message); // Title Case sequences (Names)\r\n\r\n  if (needsSheetContext) {\r\n    try {\r\n      const contextResult = await getSheetContext(message);\r\n      if (contextResult) {\r\n        const { text, hits } = contextResult;\r\n\r\n        // Add to persistent conversation context\r\n        chatConversation.push({\r\n          role: \"system\",\r\n          content: `The following data was retrieved from the user's sheet for this query:\\n${text}`\r\n        });\r\n\r\n        // Show context indicator\r\n        const lastBubble = document.querySelector('.chat-msg.user:last-child .chat-bubble');\r\n        if (lastBubble) {\r\n          const badge = document.createElement('span');\r\n          badge.className = 'context-badge';\r\n          badge.innerHTML = hits > 0 ? ` Found ${hits} search hits in sheet` : ' Sheet context loaded';\r\n          lastBubble.appendChild(badge);\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.warn('Could not load sheet context:', e);\r\n    }\r\n  }\r\n\r\n  chatConversation.push({ role: \"user\", content: message });\r\n\r\n  // Clear input\r\n  input.value = \"\";\r\n  input.style.height = \"auto\";\r\n\r\n  // Show skeleton loader\r\n  const skeletonEl = showTypingIndicator();\r\n  isChatBusy = true;\r\n\r\n  // Toggle button to Stop\r\n  const chatSendButton = document.getElementById(\"chat-send\") as HTMLButtonElement;\r\n  const chatSendIcon = document.getElementById(\"chat-send-icon\");\r\n  if (chatSendButton) {\r\n    if (chatSendIcon) chatSendIcon.innerHTML = Icons.stop;\r\n    chatSendButton.classList.add(\"is-busy\");\r\n  }\r\n\r\n  // Create AbortController\r\n  chatAbortController = new AbortController();\r\n\r\n  try {\r\n    const response = await callLLM(chatConversation, undefined, chatAbortController.signal);\r\n\r\n    // Format AI response\r\n    const formattedResponse = formatChatResponse(response);\r\n\r\n    // Create the real bubble\r\n    const newBubble = createChatBubble(\"ai\", \"\", response);\r\n\r\n    // Replace skeleton with the real bubble\r\n    if (skeletonEl) skeletonEl.replaceWith(newBubble);\r\n\r\n    // Find the content part of the new bubble to apply the typewriter effect\r\n    const bubbleContent = newBubble.querySelector('.chat-bubble') as HTMLElement;\r\n\r\n    // Stream content\r\n    if (bubbleContent) {\r\n      await typewriterEffect(bubbleContent, formattedResponse);\r\n    }\r\n\r\n    chatConversation.push({ role: \"assistant\", content: response });\r\n    chatHistory.push({ role: \"ai\", content: response, timestamp: Date.now() });\r\n\r\n  } catch (error: any) {\r\n    if (error.name === 'AbortError') {\r\n      if (skeletonEl) skeletonEl.remove();\r\n      addChatBubble(\"ai\", `<p style=\"color:var(--text-3)\"><i>Generation stopped.</i></p>`);\r\n    } else {\r\n      if (skeletonEl) skeletonEl.remove();\r\n      addChatBubble(\"ai\", `<p style=\"color:var(--error)\"> ${error.message}</p>`);\r\n      showToast(\"error\", error.message?.substring(0, 80) || \"Something went wrong\");\r\n    }\r\n  } finally {\r\n    isChatBusy = false;\r\n    chatAbortController = null;\r\n    // Reuse outer chatSendButton reference (avoid redeclaring)\r\n    if (chatSendButton) {\r\n      const sendIcon = document.getElementById(\"chat-send-icon\");\r\n      if (sendIcon) sendIcon.innerHTML = Icons.send;\r\n      chatSendButton.classList.remove(\"is-busy\");\r\n    }\r\n  }\r\n}\r\n\r\nasync function stopChatGeneration() {\r\n  if (chatAbortController) {\r\n    chatAbortController.abort();\r\n  }\r\n}\r\n\r\nasync function typewriterEffect(element: HTMLElement, html: string): Promise<void> {\r\n  // 1. Reveal element immediately\r\n  element.innerHTML = \"\";\r\n\r\n  // 2. Parse into tokens (simple tag-preserving tokenizer)\r\n  // We split by tags so we can print text content progressively, but print tags instantly.\r\n  const tokens = html.split(/(<[^>]+>)/g);\r\n\r\n  for (const token of tokens) {\r\n    if (token.startsWith(\"<\") && token.endsWith(\">\")) {\r\n      // It's a tag, append immediately\r\n      element.innerHTML += token;\r\n    } else if (token.trim().length > 0) {\r\n      // It's text, type it out word by word for speed\r\n      const words = token.split(/(\\s+)/); // Keep spaces\r\n      for (const word of words) {\r\n        element.innerHTML += word;\r\n        // Scroll to bottom\r\n        const container = document.getElementById(\"chat-messages\");\r\n        if (container) container.scrollTop = container.scrollHeight;\r\n        // Variable delay for realism\r\n        await new Promise(r => setTimeout(r, Math.random() * 10 + 5));\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction createChatBubble(role: \"user\" | \"ai\", htmlContent: string, rawContent?: string): HTMLElement {\r\n  const msgDiv = document.createElement(\"div\");\r\n  msgDiv.className = `chat-msg ${role}`;\r\n\r\n  const bubbleDiv = document.createElement(\"div\");\r\n  bubbleDiv.className = \"chat-bubble\";\r\n  bubbleDiv.innerHTML = htmlContent;\r\n\r\n  // If AI message, add action buttons\r\n  if (role === \"ai\" && rawContent) {\r\n    // Actions bar with copy + switch to agent\r\n    const actionsDiv = document.createElement(\"div\");\r\n    actionsDiv.className = \"chat-bubble-actions\";\r\n\r\n    // Copy button\r\n    const copyBtn = document.createElement(\"button\");\r\n    copyBtn.className = \"btn-copy\";\r\n    copyBtn.innerHTML = `${Icons.copy} Copy`;\r\n    copyBtn.onclick = () => {\r\n      navigator.clipboard.writeText(rawContent).then(() => {\r\n        copyBtn.innerHTML = `${Icons.check} Copied`;\r\n        copyBtn.classList.add(\"copied\");\r\n        setTimeout(() => {\r\n          copyBtn.innerHTML = `${Icons.copy} Copy`;\r\n          copyBtn.classList.remove(\"copied\");\r\n        }, 2000);\r\n      }).catch(() => {\r\n        showToast(\"error\", \"Failed to copy\");\r\n      });\r\n    };\r\n    actionsDiv.appendChild(copyBtn);\r\n\r\n    // Execute in Agent button\r\n    const execBtn = document.createElement(\"button\");\r\n    execBtn.className = \"btn-execute-from-chat\";\r\n    execBtn.innerHTML = `${Icons.zap} Switch to Agent`;\r\n    execBtn.onclick = () => {\r\n      const agentPromptInput = document.getElementById(\"prompt-input\") as HTMLTextAreaElement;\r\n      if (agentPromptInput) {\r\n        agentPromptInput.value = extractActionablePrompt(rawContent);\r\n        switchMode(\"agent\");\r\n        agentPromptInput.focus();\r\n      }\r\n    };\r\n\r\n    const actionBar = document.createElement(\"div\");\r\n    actionBar.className = \"chat-action-bar\";\r\n    actionBar.appendChild(execBtn);\r\n\r\n    bubbleDiv.appendChild(actionsDiv);\r\n    bubbleDiv.appendChild(actionBar);\r\n  }\r\n\r\n  msgDiv.appendChild(bubbleDiv);\r\n\r\n  return msgDiv;\r\n}\r\n\r\n\r\nfunction addChatBubble(role: \"user\" | \"ai\", htmlContent: string, rawContent?: string): HTMLElement {\r\n  const container = document.getElementById(\"chat-messages\");\r\n  if (!container) throw new Error(\"Chat messages container not found.\");\r\n\r\n  const msgDiv = createChatBubble(role, htmlContent, rawContent);\r\n  container.appendChild(msgDiv);\r\n\r\n  // Scroll to bottom\r\n  container.scrollTop = container.scrollHeight;\r\n\r\n  return msgDiv.querySelector('.chat-bubble'); // Return bubble for typewriter\r\n}\r\n\r\nfunction showTypingIndicator(): HTMLElement {\r\n  const container = document.getElementById(\"chat-messages\");\r\n  if (!container) throw new Error(\"Chat messages container not found.\");\r\n\r\n  const template = document.getElementById(\"chat-skeleton-template\") as HTMLTemplateElement;\r\n\r\n  // Fallback to old indicator if template is missing\r\n  if (!template) {\r\n    const oldIndicator = document.createElement(\"div\");\r\n    oldIndicator.className = \"chat-msg ai\";\r\n    oldIndicator.id = \"typing-msg\";\r\n    oldIndicator.innerHTML = `<div class=\"chat-avatar\">${Icons.bot}</div><div class=\"chat-bubble\"><div class=\"typing-indicator\"><div class=\"typing-dot\"></div><div class=\"typing-dot\"></div><div class=\"typing-dot\"></div></div></div>`;\r\n    container.appendChild(oldIndicator);\r\n    container.scrollTop = container.scrollHeight;\r\n    return oldIndicator;\r\n  }\r\n\r\n  const skeleton = template.content.cloneNode(true) as DocumentFragment;\r\n  const skeletonElement = skeleton.firstElementChild as HTMLElement;\r\n  if (skeletonElement) {\r\n    skeletonElement.id = 'typing-msg';\r\n    container.appendChild(skeletonElement);\r\n    container.scrollTop = container.scrollHeight;\r\n    return skeletonElement;\r\n  }\r\n\r\n  return null; // Should not happen\r\n}\r\n\r\nfunction formatChatResponse(text: string): string {\r\n  let html = text.trim();\r\n\r\n  // 1. Headers (### Heading)\r\n  html = html.replace(/^### (.*$)/gm, '<h3>$1</h3>');\r\n  html = html.replace(/^## (.*$)/gm, '<h2>$1</h2>');\r\n  html = html.replace(/^# (.*$)/gm, '<h1>$1</h1>');\r\n\r\n  // 2. Tables (| col | col |)\r\n  const lines = html.split('\\n');\r\n  let inTable = false;\r\n  let tableHtml = '';\r\n  const processedLines = [];\r\n\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const line = lines[i].trim();\r\n    if (line.startsWith('|') && line.endsWith('|')) {\r\n      if (!inTable) {\r\n        inTable = true;\r\n        tableHtml = '<table>';\r\n      }\r\n\r\n      // Skip separator row (|---|---|)\r\n      if (line.includes('---')) continue;\r\n\r\n      const cells = line.split('|').filter(c => c.trim() !== '' || line.indexOf('|' + c + '|') !== -1);\r\n      // Clean cells of leading/trailing pipes\r\n      const cleanCells = line.split('|').slice(1, -1).map(c => c.trim());\r\n\r\n      tableHtml += '<tr>' + cleanCells.map(c => i === 0 || (lines[i - 1] && !lines[i - 1].includes('|')) ? `<th>${c}</th>` : `<td>${c}</td>`).join('') + '</tr>';\r\n    } else {\r\n      if (inTable) {\r\n        inTable = false;\r\n        tableHtml += '</table>';\r\n        processedLines.push(tableHtml);\r\n        tableHtml = '';\r\n      }\r\n      processedLines.push(lines[i]);\r\n    }\r\n  }\r\n  if (inTable) {\r\n    tableHtml += '</table>';\r\n    processedLines.push(tableHtml);\r\n  }\r\n  html = processedLines.join('\\n');\r\n\r\n  // 3. Code blocks (``` ... ```)\r\n  html = html.replace(/```(\\w+)?\\n([\\s\\S]*?)```/g, '<pre style=\"margin:6px 0;padding:8px;background:rgba(0,0,0,0.06);border-radius:6px;font-family:var(--mono);font-size:10px;overflow-x:auto\"><code>$2</code></pre>');\r\n\r\n  // 4. Inline code (`code`)\r\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\r\n\r\n  // 5. Bold (**bold**)\r\n  html = html.replace(/\\*\\*([^*]+)\\*\\*/g, '<strong>$1</strong>');\r\n\r\n  // 5.1 Italic (*italic*)\r\n  html = html.replace(/\\*([^*]+)\\*/g, '<em>$1</em>');\r\n\r\n  // 6. Lists\r\n  // 6.1 Unordered lists (- or * or )\r\n  html = html.replace(/^[-*]\\s+(.+)$/gm, '<li>$1</li>');\r\n\r\n  // 6.2 Numbered lists (1.)\r\n  html = html.replace(/^\\d+\\.\\s+(.+)$/gm, '<li class=\"ol-item\">$1</li>');\r\n\r\n  // 6.3 Wrap consecutive li items\r\n  html = html.replace(/((?:<li>.*?<\\/li>\\n?)+)/g, '<ul>$1</ul>');\r\n  html = html.replace(/((?:<li class=\"ol-item\">.*?<\\/li>\\n?)+)/g, match => {\r\n    return `<ol>${match.replace(/ class=\"ol-item\"/g, '')}</ol>`;\r\n  });\r\n\r\n  // 7. Paragraphs\r\n  const blocks = html.split(/\\n\\n+/);\r\n  html = blocks\r\n    .map(block => {\r\n      const b = block.trim();\r\n      if (!b) return '';\r\n      // If it starts with a tag already, don't wrap in <p>\r\n      if (/^<(h1|h2|h3|ul|ol|table|pre|p|li|div)/i.test(b)) return b;\r\n      // Otherwise wrap in <p> and handle single newlines as <br>\r\n      return `<p>${b.replace(/\\n/g, '<br>')}</p>`;\r\n    })\r\n    .join('');\r\n\r\n  // 8. Visual Polish: Cleanup bullet and paragraph spacing\r\n  html = html.replace(/<p>\\s*<ul>/g, '<ul>').replace(/<\\/ul>\\s*<\\/p>/g, '</ul>');\r\n  html = html.replace(/<li>\\s*<p>/g, '<li>').replace(/<\\/p>\\s*<\\/li>/g, '</li>');\r\n\r\n  return html;\r\n}\r\n\r\nfunction extractActionablePrompt(aiResponse: string): string {\r\n  // Try to build a useful prompt from the AI's response for agent mode\r\n  // Look for formula mentions or action keywords\r\n  const lines = aiResponse.split('\\n');\r\n  for (const line of lines) {\r\n    if (line.includes('=') && line.includes('(') && !line.startsWith('#')) {\r\n      // Looks like a formula mention\r\n      return `Apply this formula: ${line.trim()}`;\r\n    }\r\n  }\r\n  // Default: use a summary\r\n  const firstSentence = aiResponse.split(/[.!?]/)[0];\r\n  return firstSentence.length > 120 ? firstSentence.substring(0, 120) : firstSentence;\r\n}\r\n\r\nfunction clearChat(): void {\r\n  const container = document.getElementById(\"chat-messages\");\r\n  container.innerHTML = \"\";\r\n  chatHistory.length = 0;\r\n  chatConversation = [];\r\n  isChatBusy = false;\r\n\r\n  // Re-add welcome screen\r\n  const welcomeHTML = `\r\n    <div class=\"chat-welcome\">\r\n      <img src=\"assets/icon-80-v2.png\" alt=\"SheetOS Logo\" style=\"width: 64px; height: 64px; margin-bottom: 16px;\">\r\n      <h2>What are you working on?</h2>\r\n      <div class=\"welcome-suggestions\" id=\"chat-suggestions\"></div>\r\n    </div>\r\n  `;\r\n  container.innerHTML = welcomeHTML;\r\n  buildChatSuggestions();\r\n}\r\n\r\n\r\n// \r\n// TOAST NOTIFICATION SYSTEM\r\n// \r\nfunction showToast(type: \"success\" | \"error\" | \"info\", message: string, duration: number = 3000): void {\r\n  const container = document.getElementById(\"toast-container\");\r\n  if (!container) return;\r\n\r\n  const toast = document.createElement(\"div\");\r\n  toast.className = `toast toast-${type}`;\r\n\r\n  const iconMap = {\r\n    success: Icons.check,\r\n    error: Icons.alertCircle,\r\n    info: Icons.helpCircle,\r\n  };\r\n\r\n  toast.innerHTML = `${iconMap[type] || \"\"}<span>${message}</span>`;\r\n  container.appendChild(toast);\r\n\r\n  // Auto-dismiss\r\n  setTimeout(() => {\r\n    toast.classList.add(\"toast-out\");\r\n    setTimeout(() => toast.remove(), 300);\r\n  }, duration);\r\n}\r\n\r\n\r\n// \r\n// SCROLL-TO-BOTTOM BUTTON\r\n// \r\nfunction setupScrollToBottom(): void {\r\n  const chatMessages = document.getElementById(\"chat-messages\");\r\n  const scrollBtn = document.getElementById(\"scroll-to-bottom\");\r\n  if (!chatMessages || !scrollBtn) return;\r\n\r\n  // Show/hide based on scroll position\r\n  chatMessages.addEventListener(\"scroll\", () => {\r\n    const isNearBottom = chatMessages.scrollHeight - chatMessages.scrollTop - chatMessages.clientHeight < 100;\r\n    scrollBtn.classList.toggle(\"visible\", !isNearBottom);\r\n  });\r\n\r\n  // Click to scroll\r\n  scrollBtn.onclick = () => {\r\n    chatMessages.scrollTo({ top: chatMessages.scrollHeight, behavior: \"smooth\" });\r\n  };\r\n}\r\n\r\n\r\n// \r\n// KEYBOARD SHORTCUTS\r\n// \r\nfunction setupAgentKeyboardShortcut(): void {\r\n  const promptInput = document.getElementById(\"prompt-input\") as HTMLTextAreaElement;\r\n  if (!promptInput) return;\r\n\r\n  promptInput.addEventListener(\"keydown\", (e) => {\r\n    // Ctrl+Enter to execute\r\n    if (e.key === \"Enter\" && (e.ctrlKey || e.metaKey)) {\r\n      e.preventDefault();\r\n      runAICommand();\r\n    }\r\n  });\r\n}\r\n\r\n\r\n// \r\n// CHARACTER COUNT INDICATOR\r\n// \r\nfunction setupCharCount(): void {\r\n  const promptInput = document.getElementById(\"prompt-input\") as HTMLTextAreaElement;\r\n  if (!promptInput) return;\r\n\r\n  // Create and insert char count element\r\n  const charCount = document.createElement(\"span\");\r\n  charCount.className = \"char-count\";\r\n  charCount.textContent = \"\";\r\n\r\n  const footerLeft = promptInput.closest(\".input-card\")?.querySelector(\".footer-left\");\r\n  if (footerLeft) {\r\n    footerLeft.appendChild(charCount);\r\n  }\r\n\r\n  promptInput.addEventListener(\"input\", () => {\r\n    const len = promptInput.value.length;\r\n    if (len === 0) {\r\n      charCount.textContent = \"\";\r\n      charCount.className = \"char-count\";\r\n    } else {\r\n      charCount.textContent = `${len}`;\r\n      if (len > 3000) {\r\n        charCount.className = \"char-count danger\";\r\n      } else if (len > 2000) {\r\n        charCount.className = \"char-count warning\";\r\n      } else {\r\n        charCount.className = \"char-count\";\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n// \r\n// CONTEXT AWARENESS  Read Excel Sheet Data\r\n// \r\n\r\n/**\r\n * Get comprehensive sheet context for AI analysis\r\n * Returns { text: string, hits: number }\r\n */\r\nasync function getSheetContext(query?: string): Promise<{ text: string, hits: number } | null> {\r\n  try {\r\n    return await Excel.run(async (context) => {\r\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n      sheet.load(\"name\");\r\n\r\n      // Use getUsedRangeOrNullObject for robustness\r\n      const usedRange = sheet.getUsedRangeOrNullObject();\r\n      usedRange.load(\"rowCount,columnCount,address,isNullObject\");\r\n      await context.sync();\r\n\r\n      if (usedRange.isNullObject || usedRange.rowCount === 0 || usedRange.columnCount === 0) {\r\n        return { text: \"Sheet is empty.\", hits: 0 };\r\n      }\r\n\r\n      // 1. Get Headers (Row 1)\r\n      const headerRange = usedRange.getRow(0);\r\n      headerRange.load(\"values\");\r\n      await context.sync();\r\n      const headers = headerRange.values[0].map(h => String(h || \"\").trim());\r\n\r\n      // 2. Perform Deep Search if query contains potential search terms\r\n      let deepSearchContext = \"\";\r\n      let hitsCount = 0;\r\n      if (query) {\r\n        const searchTerms = new Set<string>();\r\n        // 1. ALL CAPS sequences (e.g., MD PRAVEJ ALAM)\r\n        (query.match(/\\b[A-Z]{2,}(?:\\s+[A-Z]{2,})+\\b/g) || []).forEach(t => searchTerms.add(t));\r\n\r\n        // 2. Title Case sequences\r\n        (query.match(/\\b[A-Z][a-z]+(?:\\s+[A-Z][a-z]+)+\\b/g) || []).forEach(t => searchTerms.add(t));\r\n\r\n        // 3. Numbers, Quoted strings, and Emails\r\n        (query.match(/\\b\\d{5,}\\b/g) || []).forEach(t => searchTerms.add(t));\r\n        (query.match(/\"([^\"]+)\"/g) || []).forEach(t => searchTerms.add(t.replace(/\"/g, '')));\r\n        (query.match(/\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/gi) || []).forEach(t => searchTerms.add(t));\r\n\r\n        // 4. Fallback: Generic phrases\r\n        (query.match(/\\b[A-Za-z]{3,}(?:\\s+[A-Za-z]{3,}){1,2}\\b/g) || []).forEach(t => {\r\n          const commonWords = /^(this|that|sheet|data|name|about|find|search|where|exist|check|lookup|improve|analyze|suggest|help|better|optimize|what|when|where|there|from|with|tell|your|mine|ours|will|shall|should|could|would|please|show|list|their|details|contact|given|into|some|those|these)$/i;\r\n          if (!t.split(/\\s+/).every(word => commonWords.test(word))) {\r\n            searchTerms.add(t);\r\n          }\r\n        });\r\n\r\n        if (searchTerms.size > 0) {\r\n          const termsArray = Array.from(searchTerms);\r\n\r\n          for (const term of termsArray) {\r\n            // Ignore common query words\r\n            if (/^(Name|Sheet|Data|Candidate|Find|Is|This|My|Current|Column|Details|About)$/i.test(term)) continue;\r\n\r\n            let foundRange = usedRange.find(term, { completeMatch: false, matchCase: false });\r\n            foundRange.load(\"address,isNullObject\");\r\n            await context.sync();\r\n\r\n            // If full term not found, try searching for the longest word in the term\r\n            if (foundRange.isNullObject && term.includes(\" \")) {\r\n              const words = term.split(/\\s+/).sort((a, b) => b.length - a.length);\r\n              const bestWord = words[0];\r\n              if (bestWord.length > 3) {\r\n                foundRange = usedRange.find(bestWord, { completeMatch: false, matchCase: false });\r\n                foundRange.load(\"address,isNullObject\");\r\n                await context.sync();\r\n              }\r\n            }\r\n\r\n            if (!foundRange.isNullObject && hitsCount < 10) {\r\n              hitsCount++;\r\n              const row = foundRange.getEntireRow().getIntersection(usedRange);\r\n              row.load(\"values\");\r\n              await context.sync();\r\n\r\n              const rowData = row.values[0].map((v, idx) => {\r\n                const header = headers[idx] || `Col ${idx + 1}`;\r\n                const val = (v === \"\" || v === null) ? \"(empty)\" : String(v);\r\n                return `${header}: ${val}`;\r\n              }).join(\" | \");\r\n\r\n              deepSearchContext += ` MATCH [${term}] at ${foundRange.address}:\\n   >> ${rowData}\\n`;\r\n            }\r\n          }\r\n          if (hitsCount > 0) {\r\n            deepSearchContext += \"=\".repeat(40) + \"\\n\";\r\n          } else {\r\n            deepSearchContext = \"\\n(I searched the sheet for your mentioned terms, but no exact matches were found in the current sheet.)\\n\";\r\n          }\r\n        }\r\n\r\n        // 3. Sample data (max 10 rows for general context)\r\n        const sampleSize = Math.min(10, usedRange.rowCount);\r\n        const sampleRange = usedRange.getResizedRange(sampleSize - 1, 0); // Headers included\r\n        sampleRange.load(\"values\");\r\n        await context.sync();\r\n        const sampleData = sampleRange.values;\r\n\r\n        // Data type detection\r\n        const columnTypes: string[] = [];\r\n        if (sampleData.length > 1) {\r\n          for (let col = 0; col < usedRange.columnCount; col++) {\r\n            const columnValues = sampleData.slice(1).map(row => row[col]).filter(v => v !== null && v !== \"\");\r\n            if (columnValues.length === 0) {\r\n              columnTypes.push(\"empty\");\r\n            } else if (columnValues.every(v => !isNaN(Number(v)))) {\r\n              columnTypes.push(\"number\");\r\n            } else if (columnValues.every(v => /^\\d{1,4}[-\\/]\\d{1,2}[-\\/]\\d{1,4}/.test(String(v)))) {\r\n              columnTypes.push(\"date\");\r\n            } else {\r\n              columnTypes.push(\"text\");\r\n            }\r\n          }\r\n        }\r\n\r\n        // Build context string\r\n        let contextStr = \"\";\r\n        if (deepSearchContext && deepSearchContext.length > 50) {\r\n          contextStr += ` [CRITICAL DATA HIT] \\n${deepSearchContext}\\n\\n`;\r\n        }\r\n\r\n        contextStr += `--- GENERAL SHEET INFO ---\\n`;\r\n        contextStr += `Sheet: \"${sheet.name}\" (${usedRange.rowCount} rows  ${usedRange.columnCount} columns)\\n`;\r\n        contextStr += `Location: ${usedRange.address}\\n\\n`;\r\n\r\n        contextStr += `COLUMNS:\\n`;\r\n        headers.forEach((h, i) => {\r\n          const type = columnTypes[i] || \"unknown\";\r\n          contextStr += `  ${i + 1}. \"${h || `Column${i + 1}`}\" (${type})\\n`;\r\n        });\r\n\r\n        contextStr += `\\nDATA SAMPLE (First ${sampleSize} rows):\\n`;\r\n        sampleData.forEach((row, i) => {\r\n          if (i === 0) {\r\n            contextStr += `  [Headers] ${row.map(c => `\"${c}\"`).join(\" | \")}\\n`;\r\n          } else {\r\n            contextStr += `  Row ${i}: ${row.map(c => c === null || c === \"\" ? \"(empty)\" : `\"${c}\"`).join(\" | \")}\\n`;\r\n          }\r\n        });\r\n\r\n        if (usedRange.rowCount > sampleSize) {\r\n          contextStr += `  ... (${usedRange.rowCount - sampleSize} more rows not shown)\\n`;\r\n        }\r\n\r\n        return { text: contextStr, hits: hitsCount };\r\n      }\r\n\r\n      // Even without a query, return a general sheet overview\r\n      const overviewHeaders = headers.filter(h => h.length > 0);\r\n      if (overviewHeaders.length > 0) {\r\n        return {\r\n          text: `Sheet: \"${sheet.name}\" (${usedRange.rowCount} rows  ${usedRange.columnCount} columns)\\nColumns: ${overviewHeaders.join(\", \")}`,\r\n          hits: 0\r\n        };\r\n      }\r\n      return null;\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error reading sheet context:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// \r\n// SCHEMA-AWARE EXTRACTION  Read Column Headers from Excel\r\n// \r\n\r\n/**\r\n * Read existing column headers from row 1 of the active Excel sheet\r\n * Returns array of non-empty header names\r\n */\r\nasync function getExcelColumnHeaders(): Promise<string[]> {\r\n  return Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n\r\n    // Read first row (A1:Z1) for headers - covers up to 26 columns\r\n    const headerRange = sheet.getRange(\"A1:Z1\");\r\n    headerRange.load(\"values\");\r\n    await context.sync();\r\n\r\n    const headers = headerRange.values[0]\r\n      .map((cell: any) => (cell ? String(cell).trim() : \"\"))\r\n      .filter((header: string) => header !== \"\");\r\n\r\n    return headers;\r\n  });\r\n}\r\n\r\n/**\r\n * Get count of existing data rows (excluding header)\r\n */\r\nasync function getExistingDataRowCount(): Promise<number> {\r\n  return Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n    const usedRange = sheet.getUsedRange();\r\n    usedRange.load(\"rowCount\");\r\n    await context.sync();\r\n    return Math.max(0, usedRange.rowCount - 1); // Subtract header row\r\n  });\r\n}\r\n\r\n/**\r\n * Detect and display column headers in the UI\r\n */\r\nasync function detectAndShowColumns(): Promise<void> {\r\n  const btn = document.getElementById(\"detect-columns-btn\") as HTMLButtonElement;\r\n  const detectedSection = document.getElementById(\"detected-columns\");\r\n  const columnChips = document.getElementById(\"column-chips\");\r\n  const columnCount = document.getElementById(\"column-count\");\r\n\r\n  if (!detectedSection || !columnChips || !columnCount) return;\r\n\r\n  // Show loading state\r\n  if (btn) btn.innerHTML = \" Loading...\";\r\n\r\n  try {\r\n    const columns = await getExcelColumnHeaders();\r\n\r\n    if (columns.length === 0) {\r\n      // No columns found\r\n      columnChips.innerHTML = '<span class=\"column-chip empty-warning\"> No headers in Row 1  add columns first</span>';\r\n      columnCount.textContent = \"0\";\r\n      detectedSection.style.display = \"block\";\r\n    } else {\r\n      // Show detected columns as chips\r\n      columnChips.innerHTML = columns.map(col =>\r\n        `<span class=\"column-chip\">${col}</span>`\r\n      ).join(\"\");\r\n      columnCount.textContent = String(columns.length);\r\n      detectedSection.style.display = \"block\";\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Error detecting columns:\", e);\r\n    columnChips.innerHTML = '<span class=\"column-chip empty-warning\"> Error reading Excel</span>';\r\n    columnCount.textContent = \"0\";\r\n    detectedSection.style.display = \"block\";\r\n  } finally {\r\n    if (btn) btn.innerHTML = \" Detect\";\r\n  }\r\n}\r\n\r\n/**\r\n * Build the schema-aware extraction prompt with existing column headers\r\n */\r\nfunction buildSchemaExtractionDirective(columns: string[]): string {\r\n  const columnList = columns.map((c, i) => `${i + 1}. \"${c}\"`).join(\"\\n\");\r\n  const enhancedHints = buildEnhancedPrompt(columns);\r\n\r\n  return `\r\n\r\n SCHEMA-LOCKED EXTRACTION MODE  CRITICAL INSTRUCTIONS\r\n\r\n\r\nThe user has PRE-DEFINED these columns in their Excel sheet. You MUST extract data ONLY for these columns:\r\n\r\n${columnList}\r\n\r\n${enhancedHints}\r\n\r\nEXTRACTION RULES (MEMORIZE THESE):\r\n1. ONE ROW PER DOCUMENT: Each attached PDF/image represents ONE candidate/record.\r\n2. EXACT COLUMN MATCHING: Only fill data for the columns listed above.\r\n3. NO HALLUCINATION: If information for a column is NOT visible in the document, use \"\" (empty string).\r\n4. NO NEW COLUMNS: Do NOT add any columns that aren't in the list above.\r\n5. PROPER FORMATTING:\r\n   - Names: Proper Case (John Smith)\r\n   - Emails: lowercase\r\n   - Phones: Keep original format or +X-XXX-XXX-XXXX\r\n   - Skills: Comma-separated list\r\n\r\nBANNED BEHAVIORS:\r\n Guessing email addresses (e.g., firstname@company.com)\r\n Fabricating phone numbers\r\n Making up skills not explicitly listed\r\n Using \"N/A\", \"Not Found\", \"Unknown\"  use \"\" instead\r\n Adding extra columns\r\n\r\nOUTPUT: Generate Excel JS code that writes the extracted data starting from the first empty row.\r\nThe code should use the writeData helper function and format the data professionally.\r\n\r\n\r\n`;\r\n}\r\n\r\n\r\n// \r\n// AGENT MODE  Execute Functions (Enhanced with Orchestrator)\r\n// \r\n\r\nconst MAX_EXECUTION_RETRIES = 3;\r\n\r\nexport async function runAICommand(): Promise<void> {\r\n  const statusEl = document.getElementById(\"status-message\");\r\n  const debugEl = document.getElementById(\"debug-code\");\r\n  const skeletonEl = document.getElementById(\"skeleton\");\r\n  const cacheBadge = document.getElementById(\"cache-badge\");\r\n  const promptInput = document.getElementById(\"prompt-input\") as HTMLTextAreaElement;\r\n  const button = document.getElementById(\"run\") as HTMLButtonElement;\r\n\r\n  if (!statusEl || !debugEl || !skeletonEl || !cacheBadge || !promptInput || !button) {\r\n    console.error(\"Agent UI elements not found\");\r\n    return;\r\n  }\r\n\r\n  let userPrompt = promptInput.value.trim();\r\n\r\n  // Handle File Input\r\n  if (!userPrompt && attachedFiles.length === 0) {\r\n    showStatus(statusEl, \"info\", \"Please enter a command or attach a file.\");\r\n    return;\r\n  }\r\n\r\n  // Default prompt for files\r\n  if (attachedFiles.length > 0 && !userPrompt) {\r\n    userPrompt = attachedFiles.length > 1\r\n      ? `Analyze the ${attachedFiles.length} attached files. Extract and merge all tabular data into a single master table. Standardize headers and columns.`\r\n      : `Analyze the attached ${attachedFiles[0].type}. Extract all tabular data and write valid Excel JS code to populate the active sheet. Format headers and auto-fit columns.`;\r\n  }\r\n\r\n  // Detect Schema Extraction Mode\r\n  const isSchemaMode = userPrompt.includes(\"SCHEMA_EXTRACTION_MODE\") || currentCategory === \"extract\";\r\n\r\n  // Enforce table format if processing a document\r\n  if (attachedFiles.length > 0 && !isSchemaMode) {\r\n    userPrompt += `\\n\\n[FORMATTING STRICT RULE]: You are extracting data from a document. ALWAYS output the data as a clean, flat 2D HORIZONTAL table at the top of the sheet. Put Column Headers in Row A1...X1. Append the extracted data underneath. NEVER output a vertical key-value list mimicking a document. Ensure data rows have { font: { color: \"#000000\" } }.`;\r\n  }\r\n\r\n  // UI: loading\r\n  if (agentAbortController) {\r\n    agentAbortController.abort();\r\n    return;\r\n  }\r\n\r\n  agentAbortController = new AbortController();\r\n  const signal = agentAbortController.signal;\r\n\r\n  const runText = document.getElementById(\"run-text\");\r\n  const runIcon = document.getElementById(\"run-icon\");\r\n  const originalText = runText ? runText.innerText : \"Execute\";\r\n  const originalIcon = runIcon ? runIcon.innerHTML : \"\";\r\n\r\n  button.classList.add(\"is-busy\");\r\n  button.classList.add(\"btn-stop\");\r\n\r\n  if (runText) runText.innerText = \"Stop Agent\";\r\n  if (runIcon) runIcon.innerHTML = Icons.stop;\r\n\r\n  statusEl.style.display = \"none\";\r\n  skeletonEl.style.display = \"flex\";\r\n  cacheBadge.style.display = \"none\";\r\n  debugEl.innerText = \"\";\r\n\r\n  try {\r\n    let code: string;\r\n    let fromCache = false;\r\n\r\n    //  Read Sheet Context for Intelligent Assistance \r\n    let sheetContext: SheetContext | null = null;\r\n    try {\r\n      sheetContext = await readSheetContext();\r\n      if (sheetContext?.hasData) {\r\n        console.log(`[Agent] Sheet context: ${sheetContext.rowCount}x${sheetContext.columnCount}`);\r\n      }\r\n    } catch (e) {\r\n      console.warn(\"[Agent] Could not read sheet context:\", e);\r\n    }\r\n\r\n    //  Schema Extraction Mode \r\n    let existingColumns: string[] = [];\r\n    if (isSchemaMode && attachedFiles.length > 0) {\r\n      try {\r\n        existingColumns = await getExcelColumnHeaders();\r\n        console.log(\"[Agent] Schema columns detected:\", existingColumns);\r\n\r\n        if (existingColumns.length === 0) {\r\n          showStatus(statusEl, \"info\", \" No column headers found in Row 1. Add headers first or use 'HR Database Setup' to create them.\");\r\n          skeletonEl.style.display = \"none\";\r\n          return;\r\n        }\r\n\r\n        if (runText) runText.innerText = `Extracting (${existingColumns.length} cols)...`;\r\n      } catch (e) {\r\n        console.warn(\"[Agent] Could not read Excel headers:\", e);\r\n      }\r\n    }\r\n\r\n    //  Check Cache (Skip for files/schema mode) \r\n    const cached = (attachedFiles.length === 0 && !isSchemaMode) ? getCachedResponse(userPrompt) : null;\r\n\r\n    if (cached) {\r\n      code = cached;\r\n      fromCache = true;\r\n      cacheBadge.style.display = \"inline-block\";\r\n\r\n      // Still validate cached code\r\n      const validation = validateCode(code);\r\n      if (!validation.isValid) {\r\n        console.warn(\"[Agent] Cached code failed validation, regenerating...\");\r\n        fromCache = false;\r\n        code = \"\"; // Will regenerate\r\n      } else {\r\n        code = validation.sanitizedCode;\r\n      }\r\n    }\r\n\r\n    //  Generate Code (if not from cache) \r\n    if (!fromCache) {\r\n      if (isSchemaMode && attachedFiles.length > 0) {\r\n        if (runText) runText.innerText = \"Generating...\";\r\n\r\n        const messages: any[] = [{ role: \"system\", content: SYSTEM_PROMPT }];\r\n        const schemaDirective = buildSchemaExtractionDirective(existingColumns);\r\n        const cleanPrompt = userPrompt.replace(\"SCHEMA_EXTRACTION_MODE:\", \"\").trim();\r\n\r\n        const contentText = `${cleanPrompt}\\n\\nEXISTING_COLUMNS: ${JSON.stringify(existingColumns)}\\n\\n${schemaDirective}`;\r\n        const contentParts: any[] = [{ type: \"text\", text: contentText }];\r\n\r\n        let totalImages = 0;\r\n        attachedFiles.forEach((file) => {\r\n          file.data.forEach((url) => {\r\n            if (totalImages < 20) {\r\n              contentParts.push({ type: \"image_url\", image_url: { url } });\r\n              totalImages++;\r\n            }\r\n          });\r\n        });\r\n\r\n        messages.push({ role: \"user\", content: contentParts });\r\n        code = await callLLM(messages, undefined, signal);\r\n\r\n        if (runText) runText.innerText = \"Validating...\";\r\n        let validation = validateCode(code);\r\n        let validationAttempts = 0;\r\n        const MAX_VALIDATION_FIXES = 2;\r\n\r\n        while (!validation.isValid && validationAttempts < MAX_VALIDATION_FIXES) {\r\n          console.warn(`[Agent] Validation failed (attempt ${validationAttempts + 1}):`, validation.errors);\r\n          const errorSummary = validation.errors.map((e) => `${e.message}  ${e.suggestion}`).join(\"\\n\");\r\n\r\n          code = await callLLM(\r\n            [\r\n              { role: \"system\", content: SYSTEM_PROMPT },\r\n              { role: \"user\", content: userPrompt },\r\n              { role: \"assistant\", content: code },\r\n              { role: \"user\", content: `VALIDATION ERRORS:\\n${errorSummary}\\n\\nFix these errors. Output ONLY the corrected code.` },\r\n            ],\r\n            undefined,\r\n            signal\r\n          );\r\n\r\n          validation = validateCode(code);\r\n          validationAttempts++;\r\n        }\r\n\r\n        code = validation.sanitizedCode;\r\n        if (validation.warnings.length > 0) {\r\n          console.log(\"[Agent] Validation warnings:\", validation.warnings);\r\n        }\r\n      } else {\r\n        if (runText) runText.innerText = \"Planning...\";\r\n\r\n        const orchestratorResult = await runAgent(\r\n          userPrompt,\r\n          sheetContext,\r\n          attachedFiles,\r\n          {\r\n            maxRetries: 2,\r\n            enablePlanning: true,\r\n            strictValidation: true,\r\n          },\r\n          signal\r\n        );\r\n\r\n        if (!orchestratorResult.success) {\r\n          throw new Error(orchestratorResult.error || \"Agent failed to generate valid code\");\r\n        }\r\n\r\n        code = orchestratorResult.code;\r\n      }\r\n    }\r\n\r\n    debugEl.innerText = code;\r\n    skeletonEl.style.display = \"none\";\r\n\r\n    //  EXECUTION PHASE with Advanced Recovery \r\n    if (runText) runText.innerText = \"Running...\";\r\n    showStatus(statusEl, \"info\", `<div class=\"spinner\"></div><span>Executing code...</span>`);\r\n\r\n    const recovery = await executeWithRecovery(\r\n      code,\r\n      async (candidateCode: string) => {\r\n        await executeExcelCode(candidateCode);\r\n      },\r\n      MAX_EXECUTION_RETRIES,\r\n      signal\r\n    );\r\n\r\n    if (recovery.success) {\r\n      code = recovery.finalCode;\r\n      debugEl.innerText = code;\r\n      if (!fromCache && attachedFiles.length === 0 && !isSchemaMode) {\r\n        cacheResponse(userPrompt, code);\r\n      }\r\n      showStatus(statusEl, \"success\", `${Icons.check}<span>Done</span>`);\r\n      showToast(\"success\", \"Executed successfully \\u2713 (Press Ctrl+Z to undo)\");\r\n    } else {\r\n      throw new Error(recovery.error || \"Execution failed after retries\");\r\n    }\r\n\r\n  } catch (error: any) {\r\n    console.error(\"[Agent] Fatal error:\", error);\r\n    skeletonEl.style.display = \"none\";\r\n\r\n    if (error.name === 'AbortError') {\r\n      showStatus(statusEl, \"info\", \"Agent stopped by user.\");\r\n      showToast(\"info\", \"Agent stopped\");\r\n    } else {\r\n      showStatus(statusEl, \"error\", error.message || String(error));\r\n      showToast(\"error\", (error.message || \"Execution failed\").substring(0, 80));\r\n    }\r\n  } finally {\r\n    button.disabled = false;\r\n    if (runText) runText.innerText = originalText;\r\n    if (runIcon) runIcon.innerHTML = originalIcon;\r\n    button.classList.remove(\"btn-stop\");\r\n    button.classList.remove(\"is-busy\");\r\n    agentAbortController = null;\r\n  }\r\n}\r\n\r\n//  Helpers \r\nfunction showStatus(el: HTMLElement, type: \"info\" | \"success\" | \"error\", html: string): void {\r\n  el.innerHTML = html;\r\n  el.className = `status-pill ${type}`;\r\n  el.style.display = \"flex\";\r\n}\r\n\r\n/**\r\n * Execute AI-generated Excel JavaScript code with safety wrappers.\r\n * Provides:\r\n * - Pre-declared context, sheet, Excel variables\r\n * - writeData helper function\r\n * - Auto-fit columns on completion\r\n * - Enhanced error messages\r\n */\r\nasync function executeExcelCode(code: string): Promise<void> {\r\n  await Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n\r\n    // Mandatory writeData helper that all generated code can use\r\n    const writeDataHelper = `\r\nfunction writeData(sheet, startCell, data) {\r\n  if (!data || data.length === 0) return null;\r\n  const rows = data.length;\r\n  const cols = Math.max(...data.map(r => r ? r.length : 0));\r\n  if (cols === 0) return null;\r\n  const normalized = data.map(r => {\r\n    const row = r ? [...r] : [];\r\n    while (row.length < cols) row.push(\"\");\r\n    return row;\r\n  });\r\n  try {\r\n    const range = sheet.getRange(startCell).getResizedRange(rows - 1, cols - 1);\r\n    range.values = normalized;\r\n    range.format.font.name = \"Segoe UI\";\r\n    range.format.font.size = 10;\r\n    range.format.verticalAlignment = \"Center\";\r\n    return range;\r\n  } catch (e) {\r\n    console.error(\"writeData error:\", e);\r\n    return null;\r\n  }\r\n}\r\n`;\r\n\r\n    const wrappedCode = `\r\n      ${writeDataHelper}\r\n      \r\n      try {\r\n        //  AI Generated Code \r\n        ${code}\r\n        \r\n        //  Safety Finalization \r\n        try {\r\n          sheet.getUsedRange().format.autofitColumns();\r\n        } catch(_) { /* Sheet might be empty */ }\r\n        \r\n      } catch(_innerErr) {\r\n        console.error(\"[Agent] Runtime Error:\", _innerErr);\r\n        try { await context.sync(); } catch(_) {}\r\n        throw _innerErr;\r\n      }\r\n    `;\r\n\r\n    try {\r\n      await new Function(\r\n        \"context\", \"sheet\", \"Excel\",\r\n        `return (async () => { \r\n          try {\r\n            ${wrappedCode}\r\n            await context.sync();\r\n          } catch (inner) {\r\n            // Enhance error messages for common issues\r\n            if (inner.code === \"InvalidArgument\") {\r\n              const original = inner.message || \"\";\r\n              if (original.includes(\"A0\") || original.includes(\"row 0\")) {\r\n                inner.message = \"Invalid range: Row 0 doesn't exist. Excel rows start at 1.\";\r\n              } else if (original.includes(\"getResizedRange\")) {\r\n                inner.message = \"Invalid range size: Check that data dimensions match the range.\";\r\n              } else {\r\n                inner.message = \"Invalid argument: \" + original;\r\n              }\r\n            } else if (inner.message?.includes(\"is not a function\")) {\r\n              const fnMatch = inner.message.match(/(\\\\w+) is not a function/);\r\n              const fn = fnMatch ? fnMatch[1] : (inner.stack?.match(/at\\\\s+.*\\\\.(.*)\\\\s+\\\\(/)?.[1] || \"method\");\r\n              inner.message = \"API Error: .\" + fn + \"() doesn't exist. Use correct Excel JS API methods.\";\r\n            } else if (inner.message?.includes(\"is not defined\")) {\r\n              const varMatch = inner.message.match(/(\\\\w+) is not defined/);\r\n              const v = varMatch ? varMatch[1] : \"variable\";\r\n              inner.message = \"Undefined: '\" + v + \"' was used before being declared.\";\r\n            } else if (inner.message?.includes(\"Cannot read property\")) {\r\n              inner.message = \"Null reference: Tried to read property of undefined. Add null checks or ensure .load() was called.\";\r\n            }\r\n            throw inner;\r\n          }\r\n        })()`\r\n      )(context, sheet, Excel);\r\n    } catch (e: any) {\r\n      console.error(\"[Agent] Execution Error:\", e);\r\n      try { await context.sync(); } catch (_) { }\r\n      throw e;\r\n    }\r\n\r\n    await context.sync();\r\n  });\r\n}\r\n//  File Handling Logic \r\nasync function handleFileSelect(event: Event, isAgent: boolean = false) {\r\n  const input = event.target as HTMLInputElement;\r\n  if (!input.files || input.files.length === 0) return;\r\n\r\n  const btnId = isAgent ? \"agent-file-btn\" : \"file-upload-btn\";\r\n  const btn = document.getElementById(btnId);\r\n  if (btn) btn.innerHTML = `<span class=\"btn-spinner\"></span>`;\r\n\r\n  try {\r\n    const newFiles = [];\r\n\r\n    // Process all selected files\r\n    for (let i = 0; i < input.files.length; i++) {\r\n      const file = input.files[i];\r\n      if (file.type === \"application/pdf\") {\r\n        rawPDFFiles.push(file); // Keep raw file for text extraction\r\n        const arrayBuffer = await file.arrayBuffer();\r\n        const images = await renderPdfToImages(arrayBuffer);\r\n        newFiles.push({ name: file.name, type: \"pdf\", data: images });\r\n      } else if (file.type.startsWith(\"image/\")) {\r\n        const base64 = await fileToBase64(file);\r\n        newFiles.push({ name: file.name, type: \"image\", data: [base64] });\r\n      }\r\n    }\r\n\r\n    if (newFiles.length > 0) {\r\n      // Append to existing files\r\n      attachedFiles = [...attachedFiles, ...newFiles];\r\n      // Show batch panel if in extract mode and we have PDFs\r\n      if (currentCategory === \"extract\" && rawPDFFiles.length > 0) {\r\n        showBatchPanel(true);\r\n      }\r\n      updateFilePreview(true, isAgent);\r\n    } else {\r\n      throw new Error(\"Unsupported file type. Please upload PDF or Image.\");\r\n    }\r\n  } catch (error: any) {\r\n    console.error(error);\r\n    showStatus(document.getElementById(\"status-message\"), \"error\", \"Error reading file: \" + error.message);\r\n  } finally {\r\n    // Reset input so same file can be selected again if needed\r\n    input.value = \"\";\r\n    if (btn) {\r\n      // Restore icon\r\n      const icon = isAgent\r\n        ? `<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48\"></path></svg>`\r\n        : `<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48\"></path></svg>`;\r\n      btn.innerHTML = icon;\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateFilePreview(show: boolean, isAgent: boolean = false) {\r\n  const listId = isAgent ? \"agent-file-preview-list\" : \"file-preview-list\";\r\n  const container = document.getElementById(listId);\r\n\r\n  if (!container) return;\r\n  container.innerHTML = \"\";\r\n\r\n  if (attachedFiles.length === 0) {\r\n    return;\r\n  }\r\n\r\n  // Render chips\r\n  attachedFiles.forEach((file, index) => {\r\n    const chip = document.createElement(\"div\");\r\n    chip.className = \"file-chip\";\r\n\r\n    const icon = document.createElement(\"span\");\r\n    icon.className = \"file-chip-icon\";\r\n    icon.innerHTML = file.type === \"pdf\" ? \"\" : \"\";\r\n\r\n    const name = document.createElement(\"span\");\r\n    name.className = \"file-chip-name\";\r\n    name.innerText = file.name;\r\n\r\n    const remove = document.createElement(\"button\");\r\n    remove.className = \"file-chip-remove\";\r\n    remove.innerHTML = \"\";\r\n    remove.title = \"Remove file\";\r\n    remove.onclick = (e) => {\r\n      e.stopPropagation();\r\n      removeFile(index, isAgent);\r\n    };\r\n\r\n    chip.appendChild(icon);\r\n    chip.appendChild(name);\r\n    chip.appendChild(remove);\r\n    container.appendChild(chip);\r\n  });\r\n}\r\n\r\nfunction removeFile(index: number, isAgent: boolean) {\r\n  attachedFiles.splice(index, 1);\r\n  updateFilePreview(true, isAgent);\r\n}\r\n\r\nfunction clearFile(isAgent: boolean = false) {\r\n  attachedFiles = [];\r\n  rawPDFFiles = [];\r\n  showBatchPanel(false);\r\n  updateFilePreview(false, isAgent);\r\n}\r\n\r\nfunction fileToBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onload = () => resolve(reader.result as string);\r\n    reader.onerror = reject;\r\n    reader.readAsDataURL(file);\r\n  });\r\n}\r\n\r\nasync function renderPdfToImages(buffer: ArrayBuffer): Promise<string[]> {\r\n  // @ts-ignore\r\n  const pdf = await pdfjsLib.getDocument(buffer).promise;\r\n  const images: string[] = [];\r\n  // Limit to 5 pages per PDF for better coverage of long CVs\r\n  const maxPages = Math.min(pdf.numPages, 5);\r\n\r\n  for (let i = 1; i <= maxPages; i++) {\r\n    const page = await pdf.getPage(i);\r\n    // Use 1.0 scale to keep image size manageable for local vision models\r\n    const viewport = page.getViewport({ scale: 1.0 });\r\n    const canvas = document.createElement(\"canvas\");\r\n    const context = canvas.getContext(\"2d\");\r\n    if (!context) continue;\r\n    canvas.height = viewport.height;\r\n    canvas.width = viewport.width;\r\n    await page.render({ canvasContext: context, viewport }).promise;\r\n    images.push(canvas.toDataURL(\"image/png\"));\r\n  }\r\n  return images;\r\n}\r\n\r\n// \r\n// BATCH PDF EXTRACTION ENGINE\r\n// \r\n\r\n/**\r\n * Shows or hides the batch extraction panel and updates the file count badge.\r\n */\r\nfunction showBatchPanel(show: boolean): void {\r\n  const panel = document.getElementById(\"batch-extraction-panel\");\r\n  const badge = document.getElementById(\"batch-file-count\");\r\n  if (!panel) return;\r\n  panel.style.display = show ? \"block\" : \"none\";\r\n  if (show && badge) {\r\n    const count = rawPDFFiles.length;\r\n    badge.textContent = `${count} PDF${count !== 1 ? \"s\" : \"\"}`;\r\n  }\r\n}\r\n\r\n/**\r\n * Parses field names from natural language instruction using regex heuristics.\r\n * E.g. \"Extract Name, Email, Phone, Skills and Experience\"  [\"Name\",\"Email\",\"Phone\",\"Skills\",\"Experience\"]\r\n */\r\nfunction parseFieldsFromInstruction(instruction: string): string[] {\r\n  // Look for explicit list patterns: \"extract X, Y, Z\" or \"find X, Y and Z\"\r\n  const listPattern = /(?:extract|find|get|pull|identify|return|capture|include)[:\\s]+([^.!?]+)/i;\r\n  const match = instruction.match(listPattern);\r\n  if (match) {\r\n    return match[1]\r\n      .split(/[,;&]| and /i)\r\n      .map(f => f.trim().replace(/^[\"'\\-]+|[\"'\\-]+$/g, \"\"))\r\n      .filter(f => f.length > 1 && f.length < 50);\r\n  }\r\n\r\n  // Fallback: detect capitalised or quoted words as field names\r\n  const capitalWords = instruction.match(/\\b[A-Z][a-z]{2,}(?:\\s[A-Z][a-z]{2,})?\\b/g) || [];\r\n  const filtered = capitalWords.filter(w =>\r\n    !/^(These|This|The|And|From|With|For|All|Each|Into|Then|After|Before|Upload|File|Excel|Sheet|Row|Column|PDF|Resume|CV)$/.test(w)\r\n  );\r\n  if (filtered.length > 0) return Array.from(new Set(filtered));\r\n\r\n  // Default for resumes if nothing detected\r\n  return [\"Name\", \"Email\", \"Phone\", \"Skills\", \"Experience\"];\r\n}\r\n\r\n/**\r\n * Ensures the first row of the active sheet has the given fields as headers.\r\n * If the sheet is empty, writes them in row 1. If headers already exist, leaves them.\r\n * Returns the final, authoritative list of headers in sheet order.\r\n */\r\nasync function ensureExcelHeaders(fields: string[]): Promise<string[]> {\r\n  return Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n    const headerRange = sheet.getRange(`A1:${String.fromCharCode(64 + fields.length)}1`);\r\n    headerRange.load(\"values\");\r\n    await context.sync();\r\n\r\n    const existing = (headerRange.values[0] as any[]).map(v => String(v || \"\").trim()).filter(v => v);\r\n    if (existing.length > 0) {\r\n      // Headers already exist  respect them\r\n      return existing;\r\n    }\r\n\r\n    // Write new headers\r\n    headerRange.values = [fields.map(f => f.trim())];\r\n    headerRange.format.set({ font: { bold: true }, fill: { color: \"#1B2A4A\" }, horizontalAlignment: \"Center\" });\r\n    headerRange.format.font.color = \"#FFFFFF\";\r\n    headerRange.format.autofitColumns();\r\n    await context.sync();\r\n    return fields;\r\n  });\r\n}\r\n\r\n/**\r\n * Calls the LLM to extract structured fields from raw PDF text.\r\n * Returns a parsed object { fieldName: value } or null on failure.\r\n */\r\nasync function extractStructuredData(\r\n  pdfText: string,\r\n  userInstruction: string,\r\n  fields: string[],\r\n  signal?: AbortSignal\r\n): Promise<Record<string, string> | null> {\r\n  const fieldList = fields.join(\", \");\r\n  const systemPrompt = `You are a precision data extraction engine. Your ONLY output is valid JSON.\r\n\r\nGiven a document, extract the following fields: ${fieldList}\r\n\r\nRules:\r\n- Output ONLY a JSON object. No markdown, no explanation, no extra text.\r\n- Use exact field names as keys: ${JSON.stringify(fields)}\r\n- If a field is not found in the document, use null as the value.\r\n- For \"Skills\": list as a comma-separated string.\r\n- For \"Experience\": summarize the most recent role: \"Title at Company (Years)\" or list companies.\r\n- Never hallucinate or guess information not in the document.\r\n\r\nExample output:\r\n{\"Name\": \"John Smith\", \"Email\": \"john@email.com\", \"Phone\": \"9876543210\", \"Skills\": \"Python, React, SQL\", \"Experience\": \"Software Engineer at Google (3 yrs)\"}`;\r\n\r\n  const userMessage = `Instruction: ${userInstruction}\\n\\nDOCUMENT TEXT:\\n${pdfText.substring(0, 8000)}`;\r\n\r\n  try {\r\n    const response = await callLLM(\r\n      [\r\n        { role: \"system\", content: systemPrompt },\r\n        { role: \"user\", content: userMessage }\r\n      ],\r\n      undefined,\r\n      signal\r\n    );\r\n\r\n    // Strip markdown fences if model added them\r\n    const cleaned = response.replace(/^```(?:json)?\\s*/i, \"\").replace(/\\s*```$/i, \"\").trim();\r\n    const jsonMatch = cleaned.match(/\\{[\\s\\S]*\\}/);\r\n    if (!jsonMatch) return null;\r\n    return JSON.parse(jsonMatch[0]);\r\n  } catch (e) {\r\n    console.error(\"[Batch] LLM extraction failed:\", e);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Appends a single data row to the Excel sheet below the header.\r\n * Detects the next empty row automatically.\r\n */\r\nasync function appendExcelRow(headers: string[], data: Record<string, string | null>): Promise<void> {\r\n  await Excel.run(async (context) => {\r\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n    const usedRange = sheet.getUsedRangeOrNullObject();\r\n    usedRange.load(\"rowCount,isNullObject\");\r\n    await context.sync();\r\n\r\n    const nextRow = usedRange.isNullObject ? 1 : usedRange.rowCount + 1; // 1-indexed\r\n\r\n    const rowValues = headers.map(h => {\r\n      const val = data[h] ?? data[h.toLowerCase()] ?? data[Object.keys(data).find(\r\n        k => k.toLowerCase() === h.toLowerCase()\r\n      ) || \"\"] ?? \"\";\r\n      return String(val === null || val === undefined ? \"\" : val);\r\n    });\r\n\r\n    const startCell = `A${nextRow}`;\r\n    const endCell = `${String.fromCharCode(64 + headers.length)}${nextRow}`;\r\n    const range = sheet.getRange(`${startCell}:${endCell}`);\r\n    range.values = [rowValues];\r\n    range.format.autofitColumns();\r\n    // Subtle alternating row colour\r\n    range.format.fill.color = nextRow % 2 === 0 ? \"#F4F5F7\" : \"#FFFFFF\";\r\n    await context.sync();\r\n  });\r\n}\r\n\r\n/**\r\n * Adds a log entry to the batch log panel.\r\n */\r\nfunction batchLog(message: string, type: \"success\" | \"error\" | \"info\" = \"info\"): void {\r\n  const log = document.getElementById(\"batch-log\");\r\n  if (!log) return;\r\n  const entry = document.createElement(\"div\");\r\n  entry.className = `batch-log-entry ${type}`;\r\n  entry.textContent = `${type === \"success\" ? \"\" : type === \"error\" ? \"\" : \"\"} ${message}`;\r\n  log.appendChild(entry);\r\n  log.scrollTop = log.scrollHeight;\r\n}\r\n\r\n/**\r\n * Main batch PDF extraction orchestrator.\r\n * Reads instruction, parses fields, creates headers, loops through PDFs, extracts data, appends rows.\r\n */\r\nasync function runBatchPDFExtraction(): Promise<void> {\r\n  const btn = document.getElementById(\"batch-extract-btn\") as HTMLButtonElement;\r\n  const btnText = document.getElementById(\"batch-btn-text\");\r\n  const progressWrap = document.getElementById(\"batch-progress-wrap\");\r\n  const progressBar = document.getElementById(\"batch-progress-bar\");\r\n  const progressLabel = document.getElementById(\"batch-progress-label\");\r\n  const logEl = document.getElementById(\"batch-log\");\r\n  const instructionEl = document.getElementById(\"batch-instruction\") as HTMLTextAreaElement;\r\n\r\n  // Handle stop\r\n  if (batchAbortController) {\r\n    batchAbortController.abort();\r\n    batchAbortController = null;\r\n    if (btnText) btnText.textContent = \"Extract All PDFs\";\r\n    if (btn) btn.disabled = false;\r\n    return;\r\n  }\r\n\r\n  const instruction = instructionEl?.value?.trim() ||\r\n    \"These are documents. Extract Name, Email, Phone, Skills, and Experience.\";\r\n\r\n  const pdfsToProcess = [...rawPDFFiles]; // snapshot\r\n  if (pdfsToProcess.length === 0) {\r\n    showToast(\"error\", \"No PDFs attached. Please upload PDFs first.\");\r\n    return;\r\n  }\r\n\r\n  // Parse target fields\r\n  const fields = parseFieldsFromInstruction(instruction);\r\n  if (fields.length === 0) {\r\n    showToast(\"error\", \"Could not detect fields to extract. Please be more specific.\");\r\n    return;\r\n  }\r\n\r\n  batchAbortController = new AbortController();\r\n  const signal = batchAbortController.signal;\r\n\r\n  // Setup UI\r\n  if (btn) { btn.disabled = false; }\r\n  if (btnText) btnText.textContent = \" Stop Extraction\";\r\n  if (progressWrap) progressWrap.style.display = \"block\";\r\n  if (logEl) logEl.innerHTML = \"\";\r\n\r\n  batchLog(`Starting extraction of ${pdfsToProcess.length} PDF(s)`, \"info\");\r\n  batchLog(`Detected fields: ${fields.join(\", \")}`, \"info\");\r\n\r\n  let successCount = 0;\r\n  let errorCount = 0;\r\n  let headers: string[] = [];\r\n\r\n  try {\r\n    // Ensure Excel headers are ready\r\n    headers = await ensureExcelHeaders(fields);\r\n    batchLog(`Excel headers ready: ${headers.join(\", \")}`, \"info\");\r\n\r\n    for (let i = 0; i < pdfsToProcess.length; i++) {\r\n      if (signal.aborted) break;\r\n\r\n      const file = pdfsToProcess[i];\r\n      const pct = Math.round(((i) / pdfsToProcess.length) * 100);\r\n      if (progressBar) progressBar.style.width = `${pct}%`;\r\n      if (progressLabel) progressLabel.textContent = `${i} / ${pdfsToProcess.length}`;\r\n      batchLog(`[${i + 1}/${pdfsToProcess.length}] Processing: ${file.name}`, \"info\");\r\n\r\n      try {\r\n        // Step 1: Extract text from PDF\r\n        const extracted = await extractTextFromPDFFile(file);\r\n        if (!extracted.text || extracted.text.length < 20) {\r\n          throw new Error(\"PDF appears empty or unreadable\");\r\n        }\r\n\r\n        // Step 2: Call LLM for structured data\r\n        const data = await extractStructuredData(extracted.text, instruction, fields, signal);\r\n        if (!data) throw new Error(\"LLM returned no data\");\r\n\r\n        // Step 3: Write to Excel\r\n        await appendExcelRow(headers, data);\r\n\r\n        successCount++;\r\n        batchLog(` ${file.name}  ${Object.values(data).filter(v => v).length}/${fields.length} fields extracted`, \"success\");\r\n      } catch (fileError: any) {\r\n        if (fileError.name === \"AbortError\") break;\r\n        errorCount++;\r\n        batchLog(` ${file.name}: ${fileError.message}`, \"error\");\r\n      }\r\n    }\r\n  } catch (fatalError: any) {\r\n    batchLog(`Fatal error: ${fatalError.message}`, \"error\");\r\n  } finally {\r\n    // Final UI update\r\n    const finalPct = Math.round((successCount / pdfsToProcess.length) * 100);\r\n    if (progressBar) progressBar.style.width = \"100%\";\r\n    if (progressLabel) progressLabel.textContent = `${pdfsToProcess.length} / ${pdfsToProcess.length}`;\r\n\r\n    const msg = ` Done! ${successCount} rows added${errorCount > 0 ? `, ${errorCount} failed` : \"\"}.`;\r\n    batchLog(msg, successCount > 0 ? \"success\" : \"error\");\r\n    showToast(successCount > 0 ? \"success\" : \"error\", msg);\r\n\r\n    batchAbortController = null;\r\n    if (btn) btn.disabled = false;\r\n    if (btnText) btnText.textContent = \"Extract All PDFs\";\r\n  }\r\n}\r\n\r\n","/**\r\n * SheetOS AI  Planning Mode (Chat) System Prompt\r\n * Conversational AI that helps users plan, learn, and strategize Excel work.\r\n */\r\nexport const CHAT_PROMPT = `You are SheetOS AI  a friendly, expert Excel assistant in Planning Mode.\r\n\r\nYOUR ROLE:\r\n- Help users plan their spreadsheet work\r\n- Explain Excel concepts, formulas, and best practices\r\n- Suggest approaches before executing\r\n- Answer questions about data organization, analysis, and visualization\r\n- Provide formula examples and explanations\r\n- When given sheet context, analyze the USER'S ACTUAL DATA and answer questions directly using the data provided\r\n- If the user asks for details about a person or entity (e.g., \"What are John's contact details?\"), and you see that entity in the  SEARCH HITS, provide all relevant information from that row.\r\n\r\nCONTEXT AWARENESS:\r\nWhen a message includes [SHEET CONTEXT], you have access to the user's ACTUAL Excel data!\r\n- Analyze the real column names, data types, and sample values\r\n- Give SPECIFIC answers or suggestions based on their actual data structure\r\n- Reference their exact column names in your response\r\n- Suggest improvements tailored to their dataset\r\n- Point out data quality issues you observe (empty cells, inconsistent formats, etc.)\r\n- You CAN see their sheet  do NOT say \"I don't have access to your sheet\"\r\n- If you see  SEARCH HITS in the context, these are specific values found in the sheet. Use them to answer questions like \"Where is X?\", \"Does Y exist?\", or \"Give me details on Z\". Reference the exact cell address shown in the match.\r\n- Answering questions about existing data should be done DIRECTLY in chat. You do NOT need Agent Mode for simple information retrieval.\r\n\r\nRESPONSE FORMAT RULES:\r\n1. Respond in natural, conversational language\r\n2. Use markdown-style formatting for emphasis: **bold**, *italic*, \\`code\\`\r\n3. When showing formulas, wrap them in backticks: \\`=VLOOKUP(A2, Sheet2!A:B, 2, FALSE)\\`\r\n4. Use bullet points and numbered lists for clarity\r\n5. Keep responses concise but thorough (aim for 2-5 paragraphs max)\r\n6. If the user's request requires MODIFYING the sheet (formatting, inserting, complex calculations), mention that they can switch to  Agent Mode to execute it\r\n7. When you have sheet context, ALWAYS reference the user's actual column names and data\r\n\r\nEXCEL EXPERTISE AREAS:\r\n- Information retrieval from the current sheet\r\n- Formula writing & debugging (VLOOKUP, INDEX/MATCH, IF, SUMIFS, etc.)\r\n- Data organization best practices\r\n- Chart type selection guidance\r\n- PivotTable planning\r\n- Data validation strategies\r\n- Conditional formatting approaches\r\n- Dashboard design principles\r\n- Data cleaning strategies\r\n- Performance optimization tips\r\n- Cross-sheet referencing patterns\r\n\r\nPERSONALITY:\r\n- Friendly and encouraging\r\n- Uses concrete examples when explaining\r\n- Proactive  suggest improvements the user might not have thought of\r\n- Mentions potential pitfalls or common mistakes to avoid\r\n\r\nIf the user asks you to MODIFY or EXECUTE something (create, format, calculate), remind them:\r\n\" Switch to  Agent Mode to execute this! I can help you plan it here first.\"\r\n(Remember: Reading data and answering questions about it can be done here in Chat.)\r\n\r\nUser Message:\r\n`;\r\n\r\n/**\r\n * Prompt for generating contextual suggestions based on sheet data\r\n */\r\nexport const CONTEXT_PROMPT = `You are SheetOS AI. Based on the following spreadsheet data, suggest 3-4 useful actions the user could take. Each suggestion should be a short phrase (5-8 words max). Format as a JSON array of strings. Example: [\"Add SUM to numeric columns\", \"Create a bar chart\", \"Apply professional formatting\"]. Only output the JSON array, nothing else.\r\n\r\nSheet Data:\r\n`;\r\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_GET_URL_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/getUrl.js\";\nvar ___CSS_LOADER_URL_IMPORT_0___ = new URL(\"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2710%27 height=%2710%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%238C8E91%27 stroke-width=%272%27%3E%3Cpolyline points=%276 9 12 15 18 9%27/%3E%3C/svg%3E\", import.meta.url);\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* \\r\\n * SheetOS AI  Redesigned Interface\\r\\n * A warm, human-crafted design system.\\r\\n * Forest green + terracotta. No AI-purple gradients.\\r\\n */\\r\\n\\r\\n:root {\\r\\n    /*  Surface & Layout  */\\r\\n    --bg: #F5F4F1;\\r\\n    --bg-gradient: radial-gradient(circle at 50% 0%, #FFFFFF, #F2F0EB);\\r\\n    --surface: #FAFAF8;\\r\\n    --card: #FFFFFF;\\r\\n    --card-border: #E3E1DC;\\r\\n    --card-hover: #F0EFEB;\\r\\n    --input-bg: #F5F4F1;\\r\\n\\r\\n    /*  Primary: Forest Green  */\\r\\n    --primary: #2D6A4F;\\r\\n    --primary-hover: #1B4D3E;\\r\\n    --primary-light: #74C69D;\\r\\n    --primary-bg: rgba(45, 106, 79, 0.06);\\r\\n    --primary-glow: rgba(45, 106, 79, 0.12);\\r\\n\\r\\n    /*  Accent: Terracotta  */\\r\\n    --accent: #C4603D;\\r\\n    --accent-hover: #A8502F;\\r\\n    --accent-bg: rgba(196, 96, 61, 0.07);\\r\\n\\r\\n    /*  Text  */\\r\\n    --text: #1A1C1E;\\r\\n    --text-2: #555759;\\r\\n    --text-3: #8C8E91;\\r\\n    --text-4: #C5C7CA;\\r\\n\\r\\n    /*  Semantic  */\\r\\n    --success: #2D6A4F;\\r\\n    --success-bg: rgba(45, 106, 79, 0.07);\\r\\n    --error: #B83A3A;\\r\\n    --error-bg: rgba(184, 58, 58, 0.07);\\r\\n    --warning: #C08B2D;\\r\\n    --warning-bg: rgba(192, 139, 45, 0.07);\\r\\n\\r\\n    /*  Shape  */\\r\\n    --radius: 10px;\\r\\n    --radius-lg: 14px;\\r\\n    --radius-xl: 20px;\\r\\n\\r\\n    /*  Depth  warm tinted shadows  */\\r\\n    --shadow-sm: 0 1px 2px rgba(30, 25, 20, 0.04);\\r\\n    --shadow: 0 2px 5px rgba(30, 25, 20, 0.05), 0 1px 2px rgba(30, 25, 20, 0.03);\\r\\n    --shadow-md: 0 4px 12px rgba(30, 25, 20, 0.06), 0 1px 3px rgba(30, 25, 20, 0.04);\\r\\n    --shadow-lg: 0 8px 24px rgba(30, 25, 20, 0.08), 0 2px 6px rgba(30, 25, 20, 0.04);\\r\\n\\r\\n    /*  Typography  */\\r\\n    --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\\r\\n    --mono: 'JetBrains Mono', 'Cascadia Code', 'Menlo', monospace;\\r\\n\\r\\n    /*  Chat  */\\r\\n    --chat-user-bg: var(--primary);\\r\\n    --chat-user-text: #FFFFFF;\\r\\n    --chat-ai-bg: #FFFFFF;\\r\\n    --chat-ai-border: rgba(0, 0, 0, 0.06);\\r\\n    --chat-ai-text: var(--text);\\r\\n\\r\\n    /*  Glass  */\\r\\n    --glass-bg: rgba(255, 255, 255, 0.7);\\r\\n    --glass-border: rgba(255, 255, 255, 0.4);\\r\\n    --blur: 16px;\\r\\n}\\r\\n\\r\\n/*  Dark mode  */\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    :root {\\r\\n        --bg: #141516;\\r\\n        --bg-gradient: radial-gradient(circle at 50% 0%, #1A1B1D, #0F1011);\\r\\n        --surface: #1A1B1D;\\r\\n        --card: #212224;\\r\\n        --card-border: #313335;\\r\\n        --card-hover: #2A2B2D;\\r\\n        --input-bg: #19191B;\\r\\n\\r\\n        --primary: #52B788;\\r\\n        --primary-hover: #74C69D;\\r\\n        --primary-light: #2D6A4F;\\r\\n        --primary-bg: rgba(82, 183, 136, 0.08);\\r\\n        --primary-glow: rgba(82, 183, 136, 0.14);\\r\\n\\r\\n        --accent: #E0915A;\\r\\n        --accent-hover: #EAA876;\\r\\n        --accent-bg: rgba(224, 145, 90, 0.09);\\r\\n\\r\\n        --text: #E5E3DE;\\r\\n        --text-2: #9B9D9F;\\r\\n        --text-3: #606264;\\r\\n        --text-4: #3A3C3E;\\r\\n\\r\\n        --success: #52B788;\\r\\n        --success-bg: rgba(82, 183, 136, 0.09);\\r\\n        --error: #E06060;\\r\\n        --error-bg: rgba(224, 96, 96, 0.09);\\r\\n        --warning: #E0B85A;\\r\\n        --warning-bg: rgba(224, 184, 90, 0.09);\\r\\n\\r\\n        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.18);\\r\\n        --shadow: 0 2px 5px rgba(0, 0, 0, 0.22);\\r\\n        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.28);\\r\\n        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.32);\\r\\n\\r\\n        --chat-user-bg: var(--primary);\\r\\n        --chat-user-text: #141516;\\r\\n        --chat-ai-bg: #212224;\\r\\n        --chat-ai-border: rgba(255, 255, 255, 0.05);\\r\\n        --chat-ai-text: var(--text);\\r\\n\\r\\n        --glass-bg: rgba(20, 21, 22, 0.75);\\r\\n        --glass-border: rgba(255, 255, 255, 0.08);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* RESET & BASE                                                    */\\r\\n/*  */\\r\\n*,\\r\\n*::before,\\r\\n*::after {\\r\\n    box-sizing: border-box;\\r\\n}\\r\\n\\r\\nhtml,\\r\\nbody {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    margin: 0;\\r\\n    padding: 0;\\r\\n    font-family: var(--font);\\r\\n    font-size: 13px;\\r\\n    line-height: 1.55;\\r\\n    background: var(--bg-gradient);\\r\\n    color: var(--text);\\r\\n    -webkit-font-smoothing: antialiased;\\r\\n    -moz-osx-font-smoothing: grayscale;\\r\\n    overflow-x: hidden;\\r\\n}\\r\\n\\r\\n#app-body {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    height: 100vh;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* HEADER                                                          */\\r\\n/*  */\\r\\n.app-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    padding: 12px 18px;\\r\\n    background: var(--glass-bg);\\r\\n    backdrop-filter: blur(var(--blur));\\r\\n    -webkit-backdrop-filter: blur(var(--blur));\\r\\n    border-bottom: 1px solid var(--glass-border);\\r\\n    position: sticky;\\r\\n    top: 0;\\r\\n    z-index: 100;\\r\\n}\\r\\n\\r\\n.brand {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 9px;\\r\\n}\\r\\n\\r\\n.logo {\\r\\n    color: var(--primary);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.brand h1 {\\r\\n    font-size: 15px;\\r\\n    font-weight: 700;\\r\\n    margin: 0;\\r\\n    letter-spacing: -0.025em;\\r\\n    color: var(--text);\\r\\n}\\r\\n\\r\\n.highlight-text {\\r\\n    color: var(--primary);\\r\\n    font-weight: 700;\\r\\n    /* Solid color, not a gradient  feels hand-picked */\\r\\n}\\r\\n\\r\\n.header-actions {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Icon Buttons  */\\r\\n/* Base Icon Button */\\r\\n.btn-icon {\\r\\n    width: 34px;\\r\\n    height: 34px;\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 10px;\\r\\n    background: var(--card);\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    padding: 0;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n}\\r\\n\\r\\n.btn-icon:hover {\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-light);\\r\\n    background: var(--primary-bg);\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow);\\r\\n}\\r\\n\\r\\n.btn-icon:active {\\r\\n    transform: scale(0.95);\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n/*  Panels (Docs / Settings)  */\\r\\n.panel {\\r\\n    padding: 16px;\\r\\n    background: var(--card);\\r\\n    border-bottom: 1px solid var(--card-border);\\r\\n    animation: slideDown 0.22s ease-out;\\r\\n    max-height: 80vh;\\r\\n    overflow-y: auto;\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n.panel h3 {\\r\\n    font-size: 11px;\\r\\n    font-weight: 700;\\r\\n    /* Fixed from 650 */\\r\\n    text-transform: uppercase;\\r\\n    letter-spacing: 0.06em;\\r\\n    color: var(--text-3);\\r\\n    margin: 0 0 12px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Docs Grid  */\\r\\n.docs-grid {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 8px;\\r\\n}\\r\\n\\r\\n.doc-item {\\r\\n    display: flex;\\r\\n    gap: 10px;\\r\\n    align-items: flex-start;\\r\\n    padding: 5px 0;\\r\\n}\\r\\n\\r\\n.doc-icon {\\r\\n    flex-shrink: 0;\\r\\n    width: 18px;\\r\\n    height: 18px;\\r\\n    color: var(--primary);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    margin-top: 1px;\\r\\n}\\r\\n\\r\\n.doc-item strong {\\r\\n    font-size: 12px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text);\\r\\n    display: block;\\r\\n    margin-bottom: 2px;\\r\\n}\\r\\n\\r\\n.doc-item p {\\r\\n    font-size: 11px;\\r\\n    color: var(--text-2);\\r\\n    margin: 0;\\r\\n    line-height: 1.45;\\r\\n}\\r\\n\\r\\n.docs-hint {\\r\\n    font-size: 11px;\\r\\n    color: var(--text-3);\\r\\n    margin: 12px 0 0;\\r\\n    font-style: italic;\\r\\n    line-height: 1.5;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Forms  */\\r\\n.form-group {\\r\\n    margin-bottom: 12px;\\r\\n}\\r\\n\\r\\n.form-group label {\\r\\n    display: block;\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-3);\\r\\n    margin-bottom: 4px;\\r\\n    text-transform: uppercase;\\r\\n    letter-spacing: 0.04em;\\r\\n}\\r\\n\\r\\n.form-input {\\r\\n    width: 100%;\\r\\n    padding: 8px 11px;\\r\\n    font-size: 13px;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 9px;\\r\\n    outline: none;\\r\\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.form-input:focus {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 0 0 3px var(--primary-glow);\\r\\n}\\r\\n\\r\\nselect.form-input {\\r\\n    cursor: pointer;\\r\\n    appearance: none;\\r\\n    background-image: url(\" + ___CSS_LOADER_URL_REPLACEMENT_0___ + \");\\r\\n    background-repeat: no-repeat;\\r\\n    background-position: right 10px center;\\r\\n    padding-right: 28px;\\r\\n}\\r\\n\\r\\n.btn-save {\\r\\n    width: 100%;\\r\\n    justify-content: center;\\r\\n    margin-top: 6px;\\r\\n}\\r\\n\\r\\n/* Model selector row */\\r\\n.model-select-wrapper {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.model-select-wrapper .form-input {\\r\\n    flex: 1;\\r\\n    min-width: 0;\\r\\n}\\r\\n\\r\\n.btn-refresh {\\r\\n    width: 30px;\\r\\n    height: 30px;\\r\\n    flex-shrink: 0;\\r\\n    padding: 0;\\r\\n}\\r\\n\\r\\n.model-status {\\r\\n    font-size: 11px;\\r\\n    margin-top: 4px;\\r\\n    min-height: 15px;\\r\\n    color: var(--text-3);\\r\\n}\\r\\n\\r\\n.model-status-ok {\\r\\n    color: var(--success);\\r\\n}\\r\\n\\r\\n.model-status-warn {\\r\\n    color: var(--error);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* MODE TOGGLE                                                     */\\r\\n/*  */\\r\\n.mode-toggle {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    padding: 5px;\\r\\n    margin: 10px 14px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 14px;\\r\\n    position: relative;\\r\\n    gap: 4px;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n}\\r\\n\\r\\n.mode-tab {\\r\\n    flex: 1;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    gap: 8px;\\r\\n    padding: 10px;\\r\\n    font-size: 13px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.3s ease;\\r\\n    position: relative;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.mode-tab.active {\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.mode-indicator {\\r\\n    position: absolute;\\r\\n    left: 5px;\\r\\n    top: 5px;\\r\\n    width: calc(50% - 7px);\\r\\n    height: calc(100% - 10px);\\r\\n    background: var(--primary-bg);\\r\\n    border-radius: 10px;\\r\\n    transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.mode-indicator.right {\\r\\n    transform: translateX(calc(100% + 4px));\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* MODE CONTENT WRAPPER                                            */\\r\\n/*  */\\r\\n.mode-content {\\r\\n    display: none;\\r\\n    flex-direction: column;\\r\\n    flex: 1;\\r\\n    overflow: hidden;\\r\\n    animation: fadeIn 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.mode-content.active {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* PLANNING MODE  Chat                                            */\\r\\n/*  */\\r\\n\\r\\n/*  Chat Messages Container  */\\r\\n.chat-messages {\\r\\n    flex: 1;\\r\\n    overflow-y: auto;\\r\\n    padding: 14px 14px 6px;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 14px;\\r\\n    scroll-behavior: smooth;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Welcome Screen  */\\r\\n.chat-welcome {\\r\\n    text-align: center;\\r\\n    padding: 28px 18px 18px;\\r\\n    animation: fadeIn 0.35s ease-out;\\r\\n}\\r\\n\\r\\n.welcome-icon {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    width: 52px;\\r\\n    height: 52px;\\r\\n    background: var(--primary);\\r\\n    border-radius: 16px;\\r\\n    color: white;\\r\\n    margin-bottom: 14px;\\r\\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.2);\\r\\n}\\r\\n\\r\\n.welcome-icon svg {\\r\\n    width: 24px;\\r\\n    height: 24px;\\r\\n}\\r\\n\\r\\n.chat-welcome h2 {\\r\\n    font-size: 17px;\\r\\n    font-weight: 700;\\r\\n    margin: 0 0 8px;\\r\\n    color: var(--text);\\r\\n    letter-spacing: -0.02em;\\r\\n}\\r\\n\\r\\n.chat-welcome p {\\r\\n    font-size: 12.5px;\\r\\n    color: var(--text-2);\\r\\n    margin: 0 0 18px;\\r\\n    line-height: 1.65;\\r\\n    max-width: 270px;\\r\\n    margin-left: auto;\\r\\n    margin-right: auto;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat Suggestions  */\\r\\n.welcome-suggestions {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 7px;\\r\\n    max-width: 280px;\\r\\n    margin: 0 auto;\\r\\n}\\r\\n\\r\\n.suggestion-chip {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 9px;\\r\\n    padding: 10px 13px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius);\\r\\n    font-size: 11.5px;\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    transition: all 0.22s ease-out;\\r\\n    text-align: left;\\r\\n    font-family: var(--font);\\r\\n    line-height: 1.4;\\r\\n}\\r\\n\\r\\n.suggestion-chip:hover {\\r\\n    border-color: var(--primary);\\r\\n    color: var(--primary);\\r\\n    background: var(--primary-bg);\\r\\n    transform: translateX(3px);\\r\\n}\\r\\n\\r\\n.suggestion-chip svg {\\r\\n    flex-shrink: 0;\\r\\n    color: var(--primary);\\r\\n    opacity: 0.5;\\r\\n}\\r\\n\\r\\n.suggestion-chip:hover svg {\\r\\n    opacity: 1;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat Message Bubbles  */\\r\\n.chat-msg {\\r\\n    display: flex;\\r\\n    gap: 0;\\r\\n    margin-bottom: 12px;\\r\\n    animation: msgSlideIn 0.35s cubic-bezier(0.19, 1, 0.22, 1);\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.chat-msg.user {\\r\\n    justify-content: flex-end;\\r\\n}\\r\\n\\r\\n.chat-msg.ai {\\r\\n    justify-content: flex-start;\\r\\n}\\r\\n\\r\\n.chat-bubble {\\r\\n    padding: 12px 16px;\\r\\n    border-radius: 20px;\\r\\n    font-size: 14px;\\r\\n    line-height: 1.5;\\r\\n    max-width: 85%;\\r\\n    word-wrap: break-word;\\r\\n    overflow-wrap: break-word;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n    transition: transform 0.2s ease;\\r\\n}\\r\\n\\r\\n.chat-bubble:has(table) {\\r\\n    max-width: 95%;\\r\\n}\\r\\n\\r\\n.chat-msg.user .chat-bubble {\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    border-bottom-right-radius: 4px;\\r\\n    margin-right: 4px;\\r\\n}\\r\\n\\r\\n.chat-msg.ai .chat-bubble {\\r\\n    background: var(--card);\\r\\n    color: var(--text-1);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-bottom-left-radius: 4px;\\r\\n    margin-left: 4px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat formatted text  */\\r\\n.chat-bubble strong {\\r\\n    font-weight: 600;\\r\\n}\\r\\n\\r\\n.chat-bubble em {\\r\\n    font-style: italic;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.chat-bubble code {\\r\\n    font-family: var(--mono);\\r\\n    font-size: 11px;\\r\\n    padding: 2px 5px;\\r\\n    border-radius: 5px;\\r\\n    background: rgba(0, 0, 0, 0.06);\\r\\n}\\r\\n\\r\\n.chat-msg.user .chat-bubble code {\\r\\n    background: rgba(255, 255, 255, 0.18);\\r\\n}\\r\\n\\r\\n.chat-bubble ul,\\r\\n.chat-bubble ol {\\r\\n    margin: 6px 0;\\r\\n    padding-left: 18px;\\r\\n}\\r\\n\\r\\n.chat-bubble li {\\r\\n    margin-bottom: 3px;\\r\\n}\\r\\n\\r\\n.chat-bubble p {\\r\\n    margin: 0 0 8px;\\r\\n}\\r\\n\\r\\n.chat-bubble li p {\\r\\n    margin: 0;\\r\\n    display: inline;\\r\\n}\\r\\n\\r\\n.chat-bubble p:last-child {\\r\\n    margin: 0;\\r\\n}\\r\\n\\r\\n.chat-bubble h1,\\r\\n.chat-bubble h2,\\r\\n.chat-bubble h3 {\\r\\n    margin: 12px 0 6px;\\r\\n    font-weight: 700;\\r\\n    line-height: 1.3;\\r\\n}\\r\\n\\r\\n.chat-bubble h1 {\\r\\n    font-size: 1.25em;\\r\\n    border-bottom: 1px solid var(--border);\\r\\n    padding-bottom: 4px;\\r\\n}\\r\\n\\r\\n.chat-bubble h2 {\\r\\n    font-size: 1.15em;\\r\\n}\\r\\n\\r\\n.chat-bubble h3 {\\r\\n    font-size: 1.05em;\\r\\n    color: var(--text-2);\\r\\n}\\r\\n\\r\\n/* Table styling for AI responses */\\r\\n.chat-bubble table {\\r\\n    width: 100%;\\r\\n    border-collapse: collapse;\\r\\n    margin: 10px 0;\\r\\n    font-size: 11px;\\r\\n    background: var(--surface);\\r\\n    border-radius: 8px;\\r\\n    overflow: hidden;\\r\\n    display: block;\\r\\n    overflow-x: auto;\\r\\n}\\r\\n\\r\\n.chat-bubble th,\\r\\n.chat-bubble td {\\r\\n    padding: 6px 10px;\\r\\n    border: 1px solid var(--border);\\r\\n    text-align: left;\\r\\n}\\r\\n\\r\\n.chat-bubble th {\\r\\n    background: var(--surface-2);\\r\\n    font-weight: 600;\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.chat-bubble tr:nth-child(even) {\\r\\n    background: rgba(0, 0, 0, 0.02);\\r\\n}\\r\\n\\r\\n/*  Context Badge  */\\r\\n.context-badge {\\r\\n    display: block;\\r\\n    margin-top: 8px;\\r\\n    padding: 4px 8px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 500;\\r\\n    color: rgba(255, 255, 255, 0.85);\\r\\n    background: rgba(255, 255, 255, 0.15);\\r\\n    border-radius: 6px;\\r\\n    letter-spacing: 0.2px;\\r\\n}\\r\\n\\r\\n.chat-msg.ai .context-badge {\\r\\n    color: var(--text-2);\\r\\n    background: var(--primary-bg);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Execute from Chat  */\\r\\n.chat-action-bar {\\r\\n    display: flex;\\r\\n    gap: 6px;\\r\\n    margin-top: 10px;\\r\\n}\\r\\n\\r\\n.btn-execute-from-chat {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 5px;\\r\\n    padding: 5px 11px;\\r\\n    font-size: 10.5px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    background: var(--primary-bg);\\r\\n    color: var(--primary);\\r\\n    border: 1px solid var(--primary-glow);\\r\\n    border-radius: 7px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.btn-execute-from-chat:hover {\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    box-shadow: 0 2px 8px rgba(45, 106, 79, 0.25);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Typing Indicator  */\\r\\n.typing-indicator {\\r\\n    display: flex;\\r\\n    gap: 4px;\\r\\n    align-items: center;\\r\\n    padding: 4px 0;\\r\\n}\\r\\n\\r\\n.typing-dot {\\r\\n    width: 6px;\\r\\n    height: 6px;\\r\\n    background: var(--text-3);\\r\\n    border-radius: 50%;\\r\\n    animation: typingBounce 0.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n.typing-dot:nth-child(2) {\\r\\n    animation-delay: 0.15s;\\r\\n}\\r\\n\\r\\n.typing-dot:nth-child(3) {\\r\\n    animation-delay: 0.3s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat Input Area  */\\r\\n.chat-input-area {\\r\\n    padding: 12px 14px 12px;\\r\\n    background: var(--glass-bg);\\r\\n    backdrop-filter: blur(var(--blur));\\r\\n    -webkit-backdrop-filter: blur(var(--blur));\\r\\n    border-top: 1px solid var(--glass-border);\\r\\n}\\r\\n\\r\\n.chat-input-card {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 10px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius-xl);\\r\\n    padding: 6px 6px 6px 16px;\\r\\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n.chat-input-card:focus-within {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 4px 20px var(--primary-glow);\\r\\n    transform: translateY(-2px);\\r\\n}\\r\\n\\r\\n#chat-input {\\r\\n    flex: 1;\\r\\n    border: none;\\r\\n    background: transparent;\\r\\n    font-family: var(--font);\\r\\n    font-size: 13px;\\r\\n    line-height: 1.4;\\r\\n    padding: 6px 0;\\r\\n    color: var(--text-1);\\r\\n    resize: none;\\r\\n    outline: none;\\r\\n    max-height: 120px;\\r\\n    min-height: 20px;\\r\\n}\\r\\n\\r\\n/* Agent Footer Layout */\\r\\n.card-footer {\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    align-items: center;\\r\\n    margin-top: 12px;\\r\\n}\\r\\n\\r\\n.footer-left {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n}\\r\\n\\r\\n/* Original btn-clip (updated) */\\r\\n.btn-clip {\\r\\n    background: none;\\r\\n    border: none;\\r\\n    color: var(--text-3);\\r\\n    cursor: pointer;\\r\\n    padding: 6px;\\r\\n    border-radius: 6px;\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    transition: all 0.2s;\\r\\n}\\r\\n\\r\\n.btn-clip:hover {\\r\\n    background: var(--surface-hover);\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.file-preview {\\r\\n    background: var(--surface-2);\\r\\n    border: 1px solid var(--border);\\r\\n    border-radius: 6px;\\r\\n    padding: 6px 10px;\\r\\n    margin-bottom: 8px;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    font-size: 11px;\\r\\n    color: var(--text-1);\\r\\n}\\r\\n\\r\\n.file-thumb {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    padding-right: 8px;\\r\\n}\\r\\n\\r\\n.file-remove {\\r\\n    background: none;\\r\\n    border: none;\\r\\n    color: var(--text-3);\\r\\n    font-size: 16px;\\r\\n    cursor: pointer;\\r\\n    padding: 0 4px;\\r\\n    line-height: 1;\\r\\n}\\r\\n\\r\\n.file-center {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n#chat-input::placeholder {\\r\\n    color: var(--text-3);\\r\\n}\\r\\n\\r\\n.btn-send {\\r\\n    width: 38px;\\r\\n    height: 38px;\\r\\n    border: none;\\r\\n    border-radius: 12px;\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    cursor: pointer;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    flex-shrink: 0;\\r\\n    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    box-shadow: 0 4px 12px rgba(45, 106, 79, 0.3);\\r\\n}\\r\\n\\r\\n.btn-send:hover {\\r\\n    background: var(--primary-hover);\\r\\n    transform: translateY(-2px) scale(1.05);\\r\\n}\\r\\n\\r\\n.btn-send:disabled {\\r\\n    opacity: 0.35;\\r\\n    cursor: not-allowed;\\r\\n    transform: none;\\r\\n}\\r\\n\\r\\n.btn-send.is-busy {\\r\\n    background: #FF4D4D;\\r\\n    /* Red stop button */\\r\\n    box-shadow: 0 4px 12px rgba(255, 77, 77, 0.3);\\r\\n}\\r\\n\\r\\n.btn-send.is-busy:hover {\\r\\n    background: #E60000;\\r\\n    transform: scale(1.1);\\r\\n}\\r\\n\\r\\n.btn-send svg {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n}\\r\\n\\r\\n.chat-footer {\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    padding: 4px 0 0;\\r\\n}\\r\\n\\r\\n/*  File Preview List  */\\r\\n.file-preview-list {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 6px;\\r\\n    margin-bottom: 8px;\\r\\n    padding: 0 4px;\\r\\n}\\r\\n\\r\\n.file-chip {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    background: var(--surface);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 6px;\\r\\n    padding: 4px 8px;\\r\\n    font-size: 11px;\\r\\n    color: var(--text);\\r\\n    transition: all 0.2s ease;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.file-chip:hover {\\r\\n    border-color: var(--primary-light);\\r\\n    background: var(--card);\\r\\n    transform: translateY(-1px);\\r\\n    box-shadow: var(--shadow-sm);\\r\\n}\\r\\n\\r\\n.file-chip-icon {\\r\\n    font-size: 12px;\\r\\n    opacity: 0.7;\\r\\n}\\r\\n\\r\\n.file-chip-name {\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis;\\r\\n    max-width: 140px;\\r\\n}\\r\\n\\r\\n.file-chip-remove {\\r\\n    background: none;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n    color: var(--text-3);\\r\\n    padding: 0 2px;\\r\\n    font-size: 14px;\\r\\n    line-height: 1;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    border-radius: 4px;\\r\\n    transition: color 0.2s;\\r\\n}\\r\\n\\r\\n.file-chip-remove:hover {\\r\\n    color: var(--error);\\r\\n    background: var(--error-bg);\\r\\n}\\r\\n\\r\\n/*  Custom Scrollbar  */\\r\\n::-webkit-scrollbar {\\r\\n    width: 6px;\\r\\n    height: 6px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-track {\\r\\n    background: transparent;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb {\\r\\n    background: rgba(0, 0, 0, 0.1);\\r\\n    border-radius: 3px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb:hover {\\r\\n    background: rgba(0, 0, 0, 0.2);\\r\\n}\\r\\n\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    ::-webkit-scrollbar-thumb {\\r\\n        background: rgba(255, 255, 255, 0.15);\\r\\n    }\\r\\n\\r\\n    ::-webkit-scrollbar-thumb:hover {\\r\\n        background: rgba(255, 255, 255, 0.25);\\r\\n    }\\r\\n\\r\\n    .app-header {\\r\\n        background: rgba(26, 27, 29, 0.85);\\r\\n        /* Dark mode glass */\\r\\n    }\\r\\n}\\r\\n\\r\\n.btn-text {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 4px;\\r\\n    padding: 5px 9px;\\r\\n    font-size: 11px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n    border-radius: 7px;\\r\\n    transition: color 0.15s, background 0.15s;\\r\\n}\\r\\n\\r\\n.btn-text:hover {\\r\\n    color: var(--error);\\r\\n    background: var(--error-bg);\\r\\n}\\r\\n\\r\\n.btn-text svg {\\r\\n    width: 12px;\\r\\n    height: 12px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* AGENT MODE                                                      */\\r\\n/*  */\\r\\n.content-wrapper {\\r\\n    flex: 1;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    width: 100%;\\r\\n    overflow: hidden;\\r\\n    position: relative;\\r\\n    min-height: 0;\\r\\n}\\r\\n\\r\\n.agent-scroll-area {\\r\\n    flex: 1;\\r\\n    overflow-y: auto;\\r\\n    padding: 10px 14px 14px;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 12px;\\r\\n    scroll-behavior: smooth;\\r\\n    min-height: 0;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Category Tabs  */\\r\\n.action-categories {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n    overflow-x: auto;\\r\\n    padding: 2px 0;\\r\\n    scrollbar-width: none;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.action-categories::-webkit-scrollbar {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.category-tab {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 5px;\\r\\n    padding: 7px 11px;\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: transparent;\\r\\n    border: 1px solid transparent;\\r\\n    border-radius: 9px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease-out;\\r\\n    white-space: nowrap;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.category-tab:hover {\\r\\n    color: var(--text-2);\\r\\n    background: var(--card);\\r\\n}\\r\\n\\r\\n.category-tab.active {\\r\\n    color: var(--primary);\\r\\n    background: var(--primary-bg);\\r\\n    border-color: var(--primary-glow);\\r\\n    animation: tabPulse 2s infinite ease-in-out;\\r\\n}\\r\\n\\r\\n.category-tab svg {\\r\\n    width: 12px;\\r\\n    height: 12px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Schema Info Banner (Extract Mode)  */\\r\\n.schema-info {\\r\\n    display: flex;\\r\\n    align-items: flex-start;\\r\\n    gap: 10px;\\r\\n    padding: 10px 12px;\\r\\n    margin-bottom: 10px;\\r\\n    background: linear-gradient(135deg, var(--primary-bg), rgba(74, 144, 226, 0.06));\\r\\n    border: 1px solid var(--primary-glow);\\r\\n    border-radius: 10px;\\r\\n    animation: fadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n.schema-icon {\\r\\n    font-size: 18px;\\r\\n    line-height: 1;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.schema-text {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 2px;\\r\\n}\\r\\n\\r\\n.schema-text strong {\\r\\n    font-size: 11.5px;\\r\\n    font-weight: 600;\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.schema-text span {\\r\\n    font-size: 10.5px;\\r\\n    color: var(--text-2);\\r\\n    line-height: 1.4;\\r\\n}\\r\\n\\r\\n.btn-detect {\\r\\n    padding: 5px 10px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    color: var(--primary);\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--primary-glow);\\r\\n    border-radius: 6px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease-out;\\r\\n    flex-shrink: 0;\\r\\n    margin-left: auto;\\r\\n}\\r\\n\\r\\n.btn-detect:hover {\\r\\n    background: var(--primary-bg);\\r\\n    transform: translateY(-1px);\\r\\n}\\r\\n\\r\\n.btn-detect:active {\\r\\n    transform: scale(0.96);\\r\\n}\\r\\n\\r\\n/*  Detected Columns Preview  */\\r\\n.detected-columns {\\r\\n    padding: 10px 12px;\\r\\n    margin-bottom: 10px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 10px;\\r\\n    animation: fadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n.detected-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    margin-bottom: 8px;\\r\\n}\\r\\n\\r\\n.detected-label {\\r\\n    font-size: 10.5px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-2);\\r\\n}\\r\\n\\r\\n.column-count {\\r\\n    font-size: 10px;\\r\\n    font-weight: 700;\\r\\n    color: var(--primary);\\r\\n    background: var(--primary-bg);\\r\\n    padding: 2px 8px;\\r\\n    border-radius: 10px;\\r\\n}\\r\\n\\r\\n.column-chips {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 4px;\\r\\n}\\r\\n\\r\\n.column-chip {\\r\\n    padding: 3px 8px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 500;\\r\\n    color: var(--text-2);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 6px;\\r\\n}\\r\\n\\r\\n.column-chip.empty-warning {\\r\\n    color: var(--warning);\\r\\n    background: var(--warning-bg);\\r\\n    border-color: rgba(192, 139, 45, 0.2);\\r\\n}\\r\\n\\r\\n/*  Extract Category Highlight  */\\r\\n.category-tab[data-category=\\\"extract\\\"].active {\\r\\n    color: #C4603D;\\r\\n    background: rgba(196, 96, 61, 0.08);\\r\\n    border-color: rgba(196, 96, 61, 0.15);\\r\\n}\\r\\n\\r\\n.category-tab[data-category=\\\"extract\\\"]:hover {\\r\\n    color: #A8502F;\\r\\n}\\r\\n\\r\\n/*  Smart Tools Category Highlight  */\\r\\n.category-tab[data-category=\\\"smart\\\"].active {\\r\\n    color: #7C3AED;\\r\\n    background: rgba(124, 58, 237, 0.08);\\r\\n    border-color: rgba(124, 58, 237, 0.15);\\r\\n}\\r\\n\\r\\n.category-tab[data-category=\\\"smart\\\"]:hover {\\r\\n    color: #6D28D9;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Quick Action Chips  */\\r\\n.quick-actions {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 6px;\\r\\n}\\r\\n\\r\\n.chip {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    padding: 8px 14px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-2);\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 24px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n.chip:hover {\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary);\\r\\n    background: var(--card);\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n.chip svg {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n    flex-shrink: 0;\\r\\n    transition: transform 0.3s ease;\\r\\n}\\r\\n\\r\\n.chip:hover svg {\\r\\n    transform: rotate(15deg);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Input Card (Agent)  */\\r\\n.input-card {\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius-xl);\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    box-shadow: var(--shadow-md);\\r\\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\\r\\n    margin: 14px 14px 0 14px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.input-card:focus-within {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 2px 16px var(--primary-glow);\\r\\n}\\r\\n\\r\\ntextarea {\\r\\n    width: 100%;\\r\\n    min-height: 80px;\\r\\n    max-height: 160px;\\r\\n    padding: 14px 16px;\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    color: var(--text);\\r\\n    font-family: var(--font);\\r\\n    font-size: 13px;\\r\\n    line-height: 1.6;\\r\\n    resize: none;\\r\\n    outline: none;\\r\\n}\\r\\n\\r\\n.card-footer {\\r\\n    padding: 8px 12px;\\r\\n    background: rgba(0, 0, 0, 0.02);\\r\\n    border-top: 1px solid var(--card-border);\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Cache Badge  */\\r\\n.cache-badge {\\r\\n    font-size: 10.5px;\\r\\n    font-weight: 600;\\r\\n    color: var(--success);\\r\\n    background: var(--success-bg);\\r\\n    padding: 3px 9px;\\r\\n    border-radius: 10px;\\r\\n    animation: fadeIn 0.2s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Primary Button  */\\r\\n.btn-primary {\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    border: none;\\r\\n    padding: 8px 16px;\\r\\n    border-radius: 9px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 600;\\r\\n    cursor: pointer;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    transition: background 0.2s ease-out, transform 0.15s ease-out, box-shadow 0.2s ease-out;\\r\\n    box-shadow: 0 2px 6px rgba(45, 106, 79, 0.2);\\r\\n}\\r\\n\\r\\n.btn-primary:hover {\\r\\n    background: var(--primary-hover);\\r\\n    transform: translateY(-1px);\\r\\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.25);\\r\\n}\\r\\n\\r\\n.btn-primary:active {\\r\\n    transform: translateY(0);\\r\\n}\\r\\n\\r\\n.btn-primary.btn-stop {\\r\\n    background: #E53E3E;\\r\\n    border-color: #C53030;\\r\\n    box-shadow: 0 4px 10px rgba(229, 62, 62, 0.2);\\r\\n}\\r\\n\\r\\n.btn-primary.btn-stop:hover {\\r\\n    background: #C53030;\\r\\n}\\r\\n\\r\\n.btn-primary:disabled {\\r\\n    opacity: 0.4;\\r\\n    cursor: not-allowed;\\r\\n    transform: none;\\r\\n}\\r\\n\\r\\n.btn-primary svg {\\r\\n    width: 13px;\\r\\n    height: 13px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Skeleton Loading  */\\r\\n.skeleton-container {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 9px;\\r\\n    padding: 4px 0;\\r\\n}\\r\\n\\r\\n.skeleton-pill {\\r\\n    width: 140px;\\r\\n    height: 28px;\\r\\n    border-radius: 9px;\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n.skeleton-line {\\r\\n    height: 13px;\\r\\n    border-radius: 5px;\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n.skeleton-line.w80 {\\r\\n    width: 80%;\\r\\n}\\r\\n\\r\\n.skeleton-line.w60 {\\r\\n    width: 60%;\\r\\n}\\r\\n\\r\\n.skeleton-line.w40 {\\r\\n    width: 40%;\\r\\n}\\r\\n\\r\\n/* Chat Skeleton Specifics */\\r\\n.skeleton-msg {\\r\\n    display: flex;\\r\\n    gap: 12px;\\r\\n    margin-bottom: 12px;\\r\\n    align-items: flex-start;\\r\\n}\\r\\n\\r\\n.skeleton-bubble {\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 20px;\\r\\n    border-bottom-left-radius: 4px;\\r\\n    padding: 14px;\\r\\n    flex: 1;\\r\\n    max-width: 85%;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 10px;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n    margin-left: 4px;\\r\\n}\\r\\n\\r\\n.sk-shimmer {\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Status Pill  */\\r\\n.status-pill {\\r\\n    padding: 9px 13px;\\r\\n    border-radius: var(--radius);\\r\\n    font-size: 12px;\\r\\n    font-weight: 500;\\r\\n    display: none;\\r\\n    align-items: center;\\r\\n    gap: 7px;\\r\\n    animation: fadeIn 0.2s;\\r\\n    border: 1px solid transparent;\\r\\n}\\r\\n\\r\\n.status-pill.info {\\r\\n    background: var(--primary-bg);\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-glow);\\r\\n}\\r\\n\\r\\n.status-pill.success {\\r\\n    background: var(--success-bg);\\r\\n    color: var(--success);\\r\\n    border-color: rgba(45, 106, 79, 0.12);\\r\\n}\\r\\n\\r\\n.status-pill.error {\\r\\n    background: var(--error-bg);\\r\\n    color: var(--error);\\r\\n    border-color: rgba(184, 58, 58, 0.12);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Generated Code (Debug Section)  */\\r\\n#debug-section {\\r\\n    margin-top: 4px;\\r\\n}\\r\\n\\r\\n#debug-section details {\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius);\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n#debug-section summary {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    padding: 10px 14px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    user-select: none;\\r\\n    transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n#debug-section summary:hover {\\r\\n    color: var(--text);\\r\\n    background: rgba(0, 0, 0, 0.02);\\r\\n}\\r\\n\\r\\n#debug-section summary svg {\\r\\n    width: 12px;\\r\\n    height: 12px;\\r\\n    transition: transform 0.2s ease;\\r\\n}\\r\\n\\r\\n#debug-section details[open] summary svg {\\r\\n    transform: rotate(180deg);\\r\\n}\\r\\n\\r\\n#debug-code {\\r\\n    margin: 0;\\r\\n    padding: 12px 14px;\\r\\n    font-family: var(--mono);\\r\\n    font-size: 10px;\\r\\n    line-height: 1.6;\\r\\n    color: var(--text-2);\\r\\n    background: var(--input-bg);\\r\\n    border-top: 1px solid var(--card-border);\\r\\n    max-height: 200px;\\r\\n    overflow-y: auto;\\r\\n    white-space: pre-wrap;\\r\\n    word-break: break-all;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Spinners  */\\r\\n.spinner {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n    border: 2px solid transparent;\\r\\n    border-radius: 50%;\\r\\n    border-top-color: currentColor;\\r\\n    border-right-color: currentColor;\\r\\n    animation: spin 0.7s linear infinite;\\r\\n}\\r\\n\\r\\n.btn-spinner {\\r\\n    width: 13px;\\r\\n    height: 13px;\\r\\n    border: 2px solid rgba(255, 255, 255, 0.3);\\r\\n    border-radius: 50%;\\r\\n    border-top-color: white;\\r\\n    animation: spin 0.7s linear infinite;\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Debug Section  */\\r\\n#debug-section {\\r\\n    margin-top: auto;\\r\\n    padding-top: 8px;\\r\\n}\\r\\n\\r\\ndetails {\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    border-radius: var(--radius);\\r\\n}\\r\\n\\r\\nsummary {\\r\\n    padding: 5px 0;\\r\\n    cursor: pointer;\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-3);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 5px;\\r\\n    list-style: none;\\r\\n    user-select: none;\\r\\n    transition: color 0.15s;\\r\\n}\\r\\n\\r\\nsummary::-webkit-details-marker {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\nsummary:hover {\\r\\n    color: var(--text-2);\\r\\n}\\r\\n\\r\\ndetails[open] summary svg {\\r\\n    transform: rotate(180deg);\\r\\n}\\r\\n\\r\\nsummary svg {\\r\\n    transition: transform 0.15s;\\r\\n}\\r\\n\\r\\ndetails[open] summary {\\r\\n    margin-bottom: 5px;\\r\\n}\\r\\n\\r\\npre {\\r\\n    margin: 0;\\r\\n    padding: 11px;\\r\\n    background: var(--input-bg);\\r\\n    color: var(--text-2);\\r\\n    font-family: var(--mono);\\r\\n    font-size: 11px;\\r\\n    overflow-x: auto;\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 9px;\\r\\n    line-height: 1.55;\\r\\n    white-space: pre-wrap;\\r\\n    word-break: break-all;\\r\\n    max-height: 180px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SIDELOAD  Skeleton Loading Screen                              */\\r\\n/*  */\\r\\n.sideload-container {\\r\\n    height: 100vh;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    background: var(--bg);\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.sideload-skeleton {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    animation: fadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n.sk-shimmer {\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.8s ease-in-out infinite;\\r\\n    border-radius: 7px;\\r\\n}\\r\\n\\r\\n.sk-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    padding: 13px 16px;\\r\\n    border-bottom: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n.sk-brand {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 9px;\\r\\n}\\r\\n\\r\\n.sk-logo {\\r\\n    width: 24px;\\r\\n    height: 24px;\\r\\n    border-radius: 7px;\\r\\n}\\r\\n\\r\\n.sk-title {\\r\\n    width: 105px;\\r\\n    height: 15px;\\r\\n    border-radius: 5px;\\r\\n}\\r\\n\\r\\n.sk-header-actions {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n}\\r\\n\\r\\n.sk-icon-btn {\\r\\n    width: 32px;\\r\\n    height: 32px;\\r\\n    border-radius: 9px;\\r\\n}\\r\\n\\r\\n.sk-mode-toggle {\\r\\n    display: flex;\\r\\n    gap: 4px;\\r\\n    padding: 8px 6px;\\r\\n    border-bottom: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n.sk-mode-tab {\\r\\n    flex: 1;\\r\\n    height: 36px;\\r\\n    border-radius: 9px;\\r\\n}\\r\\n\\r\\n.sk-welcome {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    padding: 34px 20px 18px;\\r\\n    gap: 11px;\\r\\n}\\r\\n\\r\\n.sk-welcome-icon {\\r\\n    width: 52px;\\r\\n    height: 52px;\\r\\n    border-radius: 16px;\\r\\n}\\r\\n\\r\\n.sk-welcome-title {\\r\\n    width: 145px;\\r\\n    height: 19px;\\r\\n    border-radius: 6px;\\r\\n}\\r\\n\\r\\n.sk-welcome-desc {\\r\\n    width: 220px;\\r\\n    height: 13px;\\r\\n    border-radius: 5px;\\r\\n}\\r\\n\\r\\n.sk-welcome-desc.short {\\r\\n    width: 175px;\\r\\n}\\r\\n\\r\\n.sk-suggestions {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 8px;\\r\\n    padding: 10px 32px;\\r\\n}\\r\\n\\r\\n.sk-suggestion {\\r\\n    width: 100%;\\r\\n    height: 38px;\\r\\n    border-radius: 10px;\\r\\n}\\r\\n\\r\\n.sk-suggestion:nth-child(2) {\\r\\n    animation-delay: 0.1s;\\r\\n}\\r\\n\\r\\n.sk-suggestion:nth-child(3) {\\r\\n    animation-delay: 0.2s;\\r\\n}\\r\\n\\r\\n.sk-suggestion:nth-child(4) {\\r\\n    animation-delay: 0.3s;\\r\\n}\\r\\n\\r\\n.sk-input-area {\\r\\n    margin-top: auto;\\r\\n    padding: 12px 16px 8px;\\r\\n    border-top: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n.sk-input {\\r\\n    width: 100%;\\r\\n    height: 42px;\\r\\n    border-radius: 14px;\\r\\n}\\r\\n\\r\\n.sideload-status {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    gap: 9px;\\r\\n    padding: 11px;\\r\\n    font-size: 11.5px;\\r\\n    font-weight: 500;\\r\\n    color: var(--text-3);\\r\\n}\\r\\n\\r\\n.sideload-pulse {\\r\\n    width: 8px;\\r\\n    height: 8px;\\r\\n    border-radius: 50%;\\r\\n    background: var(--primary);\\r\\n    animation: pulse 1.5s ease-in-out infinite;\\r\\n    box-shadow: 0 0 8px var(--primary-glow);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* KEYFRAMES                                                       */\\r\\n/*  */\\r\\n@keyframes fadeIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(3px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes slideDown {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(-6px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes spin {\\r\\n    to {\\r\\n        transform: rotate(360deg);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes shimmer {\\r\\n    0% {\\r\\n        background-position: 200% 0;\\r\\n    }\\r\\n\\r\\n    100% {\\r\\n        background-position: -200% 0;\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes msgSlideIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(6px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes typingBounce {\\r\\n\\r\\n    0%,\\r\\n    100% {\\r\\n        transform: translateY(0);\\r\\n        opacity: 0.4;\\r\\n    }\\r\\n\\r\\n    50% {\\r\\n        transform: translateY(-4px);\\r\\n        opacity: 1;\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes pulse {\\r\\n\\r\\n    0%,\\r\\n    100% {\\r\\n        opacity: 0.4;\\r\\n        transform: scale(0.85);\\r\\n    }\\r\\n\\r\\n    50% {\\r\\n        opacity: 1;\\r\\n        transform: scale(1.15);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SCROLL FIXES                                                    */\\r\\n/*  */\\r\\n\\r\\n/* Chat messages area scrolls */\\r\\n.chat-messages {\\r\\n    flex: 1;\\r\\n    overflow-y: auto !important;\\r\\n    min-height: 0;\\r\\n    padding-bottom: 40px;\\r\\n    scroll-behavior: smooth;\\r\\n    -webkit-overflow-scrolling: touch;\\r\\n}\\r\\n\\r\\n/* Content-wrapper is a flex container, NOT a scroller */\\r\\n.content-wrapper {\\r\\n    flex: 1;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    overflow: hidden !important;\\r\\n    min-height: 0;\\r\\n}\\r\\n\\r\\n/* Ensure parent containers occupy full height but don't scroll themselves */\\r\\n#agent-mode,\\r\\n#planning-mode {\\r\\n    display: none;\\r\\n    height: 100%;\\r\\n    overflow: hidden;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\n#agent-mode.active,\\r\\n#planning-mode.active {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* SCROLLBAR STYLING                                               */\\r\\n/*  */\\r\\n::-webkit-scrollbar {\\r\\n    width: 6px;\\r\\n    height: 6px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-track {\\r\\n    background: transparent;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb {\\r\\n    background: rgba(0, 0, 0, 0.15);\\r\\n    border-radius: 4px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb:hover {\\r\\n    background: rgba(0, 0, 0, 0.3);\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* PRODUCTION OPTIMIZATIONS (RESPONSIVE & PERFORMANCE)             */\\r\\n/*  */\\r\\n\\r\\n/* 1. Hardware Acceleration for Animations */\\r\\n.chat-msg,\\r\\n.panel,\\r\\n.sideload-container {\\r\\n    will-change: transform, opacity;\\r\\n    backface-visibility: hidden;\\r\\n    /* sharpen animations */\\r\\n    transform: translateZ(0);\\r\\n    /* trigger GPU */\\r\\n}\\r\\n\\r\\n.chip,\\r\\n.category-tab,\\r\\n.btn-icon {\\r\\n    transform: translateZ(0);\\r\\n}\\r\\n\\r\\n/* 2. Responsive Tweaks for Narrow Taskpanes (< 360px) */\\r\\n@media (max-width: 360px) {\\r\\n    :root {\\r\\n        --radius-lg: 10px;\\r\\n        /* Tighter corners */\\r\\n    }\\r\\n\\r\\n    .app-header {\\r\\n        padding: 8px 12px;\\r\\n    }\\r\\n\\r\\n    .chat-bubble {\\r\\n        font-size: 11.5px;\\r\\n        padding: 8px 12px;\\r\\n        max-width: 88%;\\r\\n    }\\r\\n\\r\\n    .chip {\\r\\n        font-size: 10px;\\r\\n        padding: 5px 9px;\\r\\n    }\\r\\n\\r\\n    .category-tab {\\r\\n        padding: 5px 9px;\\r\\n        font-size: 10px;\\r\\n    }\\r\\n\\r\\n    /* Stack form groups tighter */\\r\\n    .form-group {\\r\\n        margin-bottom: 10px;\\r\\n    }\\r\\n\\r\\n    /* Ensure code blocks don't overflow */\\r\\n    .chat-bubble pre {\\r\\n        font-size: 10px;\\r\\n        padding: 8px;\\r\\n    }\\r\\n}\\r\\n\\r\\n/* 3. High-DPI Screens (Retina) Text Sharpness */\\r\\n@media (-webkit-min-device-pixel-ratio: 2),\\r\\n(min-resolution: 192dpi) {\\r\\n    body {\\r\\n        -webkit-font-smoothing: antialiased;\\r\\n        -moz-osx-font-smoothing: grayscale;\\r\\n    }\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* ANIMATION ENHANCEMENTS                                          */\\r\\n/*  */\\r\\n\\r\\n/* Make transitions smoother */\\r\\n.chip,\\r\\n.suggestion-chip,\\r\\n.category-tab,\\r\\n.btn-icon,\\r\\n.btn-primary,\\r\\n.btn-send {\\r\\n    transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    /* A bit of overshoot */\\r\\n}\\r\\n\\r\\n/* More pronounced hover effect for chips */\\r\\n.chip:hover,\\r\\n.suggestion-chip:hover,\\r\\n.category-tab:hover {\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n/* Remove the translateX from suggestion-chip to be consistent */\\r\\n.suggestion-chip:hover {\\r\\n    transform: translateY(-2px);\\r\\n}\\r\\n\\r\\n/* Add hover effect to icon buttons */\\r\\n.btn-icon:hover {\\r\\n    transform: translateY(-2px) scale(1.05);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n@keyframes tabPulse {\\r\\n    0% {\\r\\n        box-shadow: 0 0 0 0 rgba(74, 144, 226, 0.15);\\r\\n    }\\r\\n\\r\\n    70% {\\r\\n        box-shadow: 0 0 0 4px rgba(74, 144, 226, 0);\\r\\n    }\\r\\n\\r\\n    100% {\\r\\n        box-shadow: 0 0 0 0 rgba(74, 144, 226, 0);\\r\\n    }\\r\\n}\\r\\n\\r\\n.chat-msg {\\r\\n    animation: msgSlideIn 0.4s cubic-bezier(0.19, 1, 0.22, 1) forwards;\\r\\n}\\r\\n\\r\\n/* Better button press feedback */\\r\\n.btn-primary:active,\\r\\n.btn-send:active,\\r\\n.btn-icon:active,\\r\\n.chip:active,\\r\\n.suggestion-chip:active,\\r\\n.category-tab:active {\\r\\n    transform: scale(0.95) !important;\\r\\n    /* Use important to override hover transforms */\\r\\n    transition-duration: 0.1s;\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* BUSINESS MODULES                                                */\\r\\n/*  */\\r\\n.modules-grid {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 12px;\\r\\n    margin-top: 16px;\\r\\n}\\r\\n\\r\\n.module-card {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 16px;\\r\\n    padding: 16px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius-lg);\\r\\n    transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n.module-card:hover {\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow-md);\\r\\n    border-color: var(--primary-light);\\r\\n}\\r\\n\\r\\n.module-icon {\\r\\n    font-size: 24px;\\r\\n    width: 48px;\\r\\n    height: 48px;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    background: var(--bg);\\r\\n    border-radius: 12px;\\r\\n}\\r\\n\\r\\n.module-info {\\r\\n    flex: 1;\\r\\n}\\r\\n\\r\\n.module-info h3 {\\r\\n    margin: 0 0 4px;\\r\\n    font-size: 14px;\\r\\n    font-weight: 600;\\r\\n}\\r\\n\\r\\n.module-info p {\\r\\n    margin: 0;\\r\\n    font-size: 12px;\\r\\n    color: var(--text-2);\\r\\n    line-height: 1.4;\\r\\n}\\r\\n\\r\\n.module-preview-area {\\r\\n    margin-top: 24px;\\r\\n    padding: 16px;\\r\\n    background: var(--primary-bg);\\r\\n    border-radius: var(--radius-lg);\\r\\n    border: 1px dashed var(--primary);\\r\\n}\\r\\n\\r\\n.badge-gold {\\r\\n    background: #FFF9E6;\\r\\n    color: #B28B00;\\r\\n    border: 1px solid #FFE699;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* TOAST NOTIFICATION SYSTEM                                       */\\r\\n/*  */\\r\\n.toast-container {\\r\\n    position: fixed;\\r\\n    bottom: 20px;\\r\\n    left: 50%;\\r\\n    transform: translateX(-50%);\\r\\n    z-index: 10000;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n.toast {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    padding: 10px 16px;\\r\\n    border-radius: 12px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    box-shadow: var(--shadow-lg);\\r\\n    animation: toastIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    pointer-events: auto;\\r\\n    backdrop-filter: blur(12px);\\r\\n    -webkit-backdrop-filter: blur(12px);\\r\\n    max-width: 280px;\\r\\n}\\r\\n\\r\\n.toast.toast-out {\\r\\n    animation: toastOut 0.3s ease-in forwards;\\r\\n}\\r\\n\\r\\n.toast.toast-success {\\r\\n    background: rgba(45, 106, 79, 0.92);\\r\\n    color: white;\\r\\n    border: 1px solid rgba(82, 183, 136, 0.3);\\r\\n}\\r\\n\\r\\n.toast.toast-error {\\r\\n    background: rgba(184, 58, 58, 0.92);\\r\\n    color: white;\\r\\n    border: 1px solid rgba(224, 96, 96, 0.3);\\r\\n}\\r\\n\\r\\n.toast.toast-info {\\r\\n    background: rgba(255, 255, 255, 0.92);\\r\\n    color: var(--text);\\r\\n    border: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    .toast.toast-info {\\r\\n        background: rgba(33, 34, 36, 0.92);\\r\\n        color: var(--text);\\r\\n        border: 1px solid var(--card-border);\\r\\n    }\\r\\n}\\r\\n\\r\\n.toast svg {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n@keyframes toastIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(16px) scale(0.95);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0) scale(1);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes toastOut {\\r\\n    from {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0) scale(1);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 0;\\r\\n        transform: translateY(10px) scale(0.95);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* COPY-TO-CLIPBOARD BUTTON (AI Bubble)                            */\\r\\n/*  */\\r\\n.chat-bubble-actions {\\r\\n    display: flex;\\r\\n    gap: 4px;\\r\\n    margin-top: 8px;\\r\\n    opacity: 0;\\r\\n    transition: opacity 0.2s ease;\\r\\n}\\r\\n\\r\\n.chat-msg.ai:hover .chat-bubble-actions {\\r\\n    opacity: 1;\\r\\n}\\r\\n\\r\\n.btn-copy {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 4px;\\r\\n    padding: 3px 8px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 6px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n.btn-copy:hover {\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-glow);\\r\\n    background: var(--primary-bg);\\r\\n}\\r\\n\\r\\n.btn-copy.copied {\\r\\n    color: var(--success);\\r\\n    border-color: rgba(45, 106, 79, 0.2);\\r\\n    background: var(--success-bg);\\r\\n}\\r\\n\\r\\n.btn-copy svg {\\r\\n    width: 11px;\\r\\n    height: 11px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SMOOTH MODE CROSSFADE                                           */\\r\\n/*  */\\r\\n.mode-content {\\r\\n    animation: modeFadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n@keyframes modeFadeIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(4px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SCROLL-TO-BOTTOM FAB                                            */\\r\\n/*  */\\r\\n.scroll-to-bottom {\\r\\n    position: absolute;\\r\\n    bottom: 80px;\\r\\n    right: 18px;\\r\\n    width: 32px;\\r\\n    height: 32px;\\r\\n    border-radius: 50%;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    display: none;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    box-shadow: var(--shadow-md);\\r\\n    z-index: 10;\\r\\n    transition: all 0.2s ease;\\r\\n    animation: fadeIn 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.scroll-to-bottom:hover {\\r\\n    background: var(--primary-bg);\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-glow);\\r\\n    transform: translateY(-2px);\\r\\n}\\r\\n\\r\\n.scroll-to-bottom.visible {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n.scroll-to-bottom svg {\\r\\n    width: 16px;\\r\\n    height: 16px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* CHARACTER COUNT INDICATOR                                       */\\r\\n/*  */\\r\\n.char-count {\\r\\n    font-size: 10px;\\r\\n    color: var(--text-4);\\r\\n    font-weight: 500;\\r\\n    font-variant-numeric: tabular-nums;\\r\\n    transition: color 0.2s ease;\\r\\n    min-width: 28px;\\r\\n    text-align: right;\\r\\n}\\r\\n\\r\\n.char-count.warning {\\r\\n    color: var(--warning);\\r\\n}\\r\\n\\r\\n.char-count.danger {\\r\\n    color: var(--error);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* KEYBOARD SHORTCUT BADGE                                         */\\r\\n/*  */\\r\\n.kbd-hint {\\r\\n    font-size: 9px;\\r\\n    font-weight: 500;\\r\\n    color: var(--text-4);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 4px;\\r\\n    padding: 1px 5px;\\r\\n    font-family: var(--mono);\\r\\n    letter-spacing: 0.02em;\\r\\n    pointer-events: none;\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* STAGGERED SUGGESTION ANIMATION                                  */\\r\\n/*  */\\r\\n.suggestion-chip:nth-child(1) {\\r\\n    animation-delay: 0.05s;\\r\\n}\\r\\n\\r\\n.suggestion-chip:nth-child(2) {\\r\\n    animation-delay: 0.1s;\\r\\n}\\r\\n\\r\\n.suggestion-chip:nth-child(3) {\\r\\n    animation-delay: 0.15s;\\r\\n}\\r\\n\\r\\n.suggestion-chip:nth-child(4) {\\r\\n    animation-delay: 0.2s;\\r\\n}\\r\\n\\r\\n.suggestion-chip {\\r\\n    animation: msgSlideIn 0.4s cubic-bezier(0.19, 1, 0.22, 1) both;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* ENHANCED INPUT FOCUS GLOW                                       */\\r\\n/*  */\\r\\n.input-card:focus-within,\\r\\n.chat-input-card:focus-within {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 0 0 3px var(--primary-glow), var(--shadow-md);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SETTINGS SAVE SUCCESS ANIMATION                                 */\\r\\n/*  */\\r\\n.btn-save.saved {\\r\\n    background: var(--success);\\r\\n    box-shadow: 0 2px 8px rgba(45, 106, 79, 0.3);\\r\\n}\\r\\n\\r\\n@keyframes successPop {\\r\\n    0% {\\r\\n        transform: scale(1);\\r\\n    }\\r\\n\\r\\n    50% {\\r\\n        transform: scale(1.05);\\r\\n    }\\r\\n\\r\\n    100% {\\r\\n        transform: scale(1);\\r\\n    }\\r\\n}\\r\\n\\r\\n.btn-save.saved {\\r\\n    animation: successPop 0.3s ease;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* CHAT WELCOME STAGGER                                            */\\r\\n/*  */\\r\\n.chat-welcome img {\\r\\n    animation: fadeIn 0.5s ease-out both;\\r\\n    animation-delay: 0.1s;\\r\\n}\\r\\n\\r\\n.chat-welcome h2 {\\r\\n    animation: fadeIn 0.5s ease-out both;\\r\\n    animation-delay: 0.2s;\\r\\n}\\r\\n\\r\\n.chat-welcome .welcome-suggestions {\\r\\n    animation: fadeIn 0.5s ease-out both;\\r\\n    animation-delay: 0.3s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* RIPPLE EFFECT ON BUTTONS                                        */\\r\\n/*  */\\r\\n.btn-primary,\\r\\n.btn-send,\\r\\n.chip,\\r\\n.category-tab {\\r\\n    position: relative;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.btn-primary::after,\\r\\n.btn-send::after {\\r\\n    content: '';\\r\\n    position: absolute;\\r\\n    inset: 0;\\r\\n    background: radial-gradient(circle at var(--ripple-x, 50%) var(--ripple-y, 50%), rgba(255, 255, 255, 0.25) 0%, transparent 60%);\\r\\n    opacity: 0;\\r\\n    transition: opacity 0.4s ease;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n.btn-primary:active::after,\\r\\n.btn-send:active::after {\\r\\n    opacity: 1;\\r\\n    transition: opacity 0s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* IMPROVED DARK MODE SCROLLBAR                                    */\\r\\n/*  */\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    ::-webkit-scrollbar-thumb {\\r\\n        background: rgba(255, 255, 255, 0.12);\\r\\n    }\\r\\n\\r\\n    ::-webkit-scrollbar-thumb:hover {\\r\\n        background: rgba(255, 255, 255, 0.22);\\r\\n    }\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* BATCH PDF EXTRACTION PANEL                                      */\\r\\n/*  */\\r\\n.batch-panel {\\r\\n    margin: 10px 14px;\\r\\n    padding: 14px;\\r\\n    background: var(--card);\\r\\n    border: 1.5px solid var(--primary-glow);\\r\\n    border-radius: var(--radius-lg);\\r\\n    box-shadow: var(--shadow-md);\\r\\n    animation: slideDown 0.22s ease-out;\\r\\n}\\r\\n\\r\\n.batch-panel-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    margin-bottom: 10px;\\r\\n}\\r\\n\\r\\n.batch-panel-title {\\r\\n    font-size: 12px;\\r\\n    font-weight: 700;\\r\\n    color: var(--primary);\\r\\n    letter-spacing: -0.01em;\\r\\n}\\r\\n\\r\\n.batch-file-count {\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-3);\\r\\n    background: var(--primary-bg);\\r\\n    padding: 2px 8px;\\r\\n    border-radius: 20px;\\r\\n}\\r\\n\\r\\n.batch-instruction {\\r\\n    width: 100%;\\r\\n    padding: 9px 11px;\\r\\n    font-size: 12.5px;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius);\\r\\n    outline: none;\\r\\n    resize: none;\\r\\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\\r\\n    margin-bottom: 10px;\\r\\n    line-height: 1.5;\\r\\n}\\r\\n\\r\\n.batch-instruction:focus {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 0 0 3px var(--primary-glow);\\r\\n}\\r\\n\\r\\n.btn-batch-extract {\\r\\n    width: 100%;\\r\\n    justify-content: center;\\r\\n    gap: 7px;\\r\\n    font-size: 13px;\\r\\n    padding: 10px;\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    border: none;\\r\\n    border-radius: var(--radius);\\r\\n    cursor: pointer;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    transition: all 0.2s ease-out;\\r\\n    box-shadow: 0 3px 10px rgba(45, 106, 79, 0.3);\\r\\n}\\r\\n\\r\\n.btn-batch-extract:hover {\\r\\n    background: var(--primary-hover);\\r\\n    transform: translateY(-1px);\\r\\n    box-shadow: 0 5px 16px rgba(45, 106, 79, 0.38);\\r\\n}\\r\\n\\r\\n.btn-batch-extract:disabled {\\r\\n    opacity: 0.55;\\r\\n    cursor: not-allowed;\\r\\n    transform: none;\\r\\n}\\r\\n\\r\\n.batch-progress-wrap {\\r\\n    margin-top: 12px;\\r\\n}\\r\\n\\r\\n.batch-progress-bar-track {\\r\\n    height: 6px;\\r\\n    background: var(--input-bg);\\r\\n    border-radius: 99px;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.batch-progress-bar {\\r\\n    height: 100%;\\r\\n    background: linear-gradient(90deg, var(--primary), var(--primary-light));\\r\\n    border-radius: 99px;\\r\\n    transition: width 0.4s ease-out;\\r\\n    position: relative;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.batch-progress-bar::after {\\r\\n    content: '';\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    left: -60%;\\r\\n    width: 60%;\\r\\n    height: 100%;\\r\\n    background: rgba(255, 255, 255, 0.3);\\r\\n    animation: shimmer 1.2s linear infinite;\\r\\n}\\r\\n\\r\\n@keyframes shimmer {\\r\\n    to {\\r\\n        left: 160%;\\r\\n    }\\r\\n}\\r\\n\\r\\n.batch-progress-label {\\r\\n    font-size: 11px;\\r\\n    color: var(--text-3);\\r\\n    text-align: right;\\r\\n    margin-top: 4px;\\r\\n    font-weight: 600;\\r\\n}\\r\\n\\r\\n.batch-log {\\r\\n    margin-top: 10px;\\r\\n    max-height: 100px;\\r\\n    overflow-y: auto;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 3px;\\r\\n}\\r\\n\\r\\n.batch-log-entry {\\r\\n    font-size: 11px;\\r\\n    font-family: var(--mono);\\r\\n    color: var(--text-2);\\r\\n    padding: 2px 6px;\\r\\n    border-radius: 4px;\\r\\n    display: flex;\\r\\n    gap: 6px;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.batch-log-entry.success {\\r\\n    color: var(--success);\\r\\n    background: var(--success-bg);\\r\\n}\\r\\n\\r\\n.batch-log-entry.error {\\r\\n    color: var(--error);\\r\\n    background: var(--error-bg);\\r\\n}\\r\\n\\r\\n.batch-log-entry.info {\\r\\n    color: var(--text-3);\\r\\n    background: var(--input-bg);\\r\\n}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/taskpane/taskpane.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\"/* \\r\\n * SheetOS AI  Redesigned Interface\\r\\n * A warm, human-crafted design system.\\r\\n * Forest green + terracotta. No AI-purple gradients.\\r\\n */\\r\\n\\r\\n:root {\\r\\n    /*  Surface & Layout  */\\r\\n    --bg: #F5F4F1;\\r\\n    --bg-gradient: radial-gradient(circle at 50% 0%, #FFFFFF, #F2F0EB);\\r\\n    --surface: #FAFAF8;\\r\\n    --card: #FFFFFF;\\r\\n    --card-border: #E3E1DC;\\r\\n    --card-hover: #F0EFEB;\\r\\n    --input-bg: #F5F4F1;\\r\\n\\r\\n    /*  Primary: Forest Green  */\\r\\n    --primary: #2D6A4F;\\r\\n    --primary-hover: #1B4D3E;\\r\\n    --primary-light: #74C69D;\\r\\n    --primary-bg: rgba(45, 106, 79, 0.06);\\r\\n    --primary-glow: rgba(45, 106, 79, 0.12);\\r\\n\\r\\n    /*  Accent: Terracotta  */\\r\\n    --accent: #C4603D;\\r\\n    --accent-hover: #A8502F;\\r\\n    --accent-bg: rgba(196, 96, 61, 0.07);\\r\\n\\r\\n    /*  Text  */\\r\\n    --text: #1A1C1E;\\r\\n    --text-2: #555759;\\r\\n    --text-3: #8C8E91;\\r\\n    --text-4: #C5C7CA;\\r\\n\\r\\n    /*  Semantic  */\\r\\n    --success: #2D6A4F;\\r\\n    --success-bg: rgba(45, 106, 79, 0.07);\\r\\n    --error: #B83A3A;\\r\\n    --error-bg: rgba(184, 58, 58, 0.07);\\r\\n    --warning: #C08B2D;\\r\\n    --warning-bg: rgba(192, 139, 45, 0.07);\\r\\n\\r\\n    /*  Shape  */\\r\\n    --radius: 10px;\\r\\n    --radius-lg: 14px;\\r\\n    --radius-xl: 20px;\\r\\n\\r\\n    /*  Depth  warm tinted shadows  */\\r\\n    --shadow-sm: 0 1px 2px rgba(30, 25, 20, 0.04);\\r\\n    --shadow: 0 2px 5px rgba(30, 25, 20, 0.05), 0 1px 2px rgba(30, 25, 20, 0.03);\\r\\n    --shadow-md: 0 4px 12px rgba(30, 25, 20, 0.06), 0 1px 3px rgba(30, 25, 20, 0.04);\\r\\n    --shadow-lg: 0 8px 24px rgba(30, 25, 20, 0.08), 0 2px 6px rgba(30, 25, 20, 0.04);\\r\\n\\r\\n    /*  Typography  */\\r\\n    --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\\r\\n    --mono: 'JetBrains Mono', 'Cascadia Code', 'Menlo', monospace;\\r\\n\\r\\n    /*  Chat  */\\r\\n    --chat-user-bg: var(--primary);\\r\\n    --chat-user-text: #FFFFFF;\\r\\n    --chat-ai-bg: #FFFFFF;\\r\\n    --chat-ai-border: rgba(0, 0, 0, 0.06);\\r\\n    --chat-ai-text: var(--text);\\r\\n\\r\\n    /*  Glass  */\\r\\n    --glass-bg: rgba(255, 255, 255, 0.7);\\r\\n    --glass-border: rgba(255, 255, 255, 0.4);\\r\\n    --blur: 16px;\\r\\n}\\r\\n\\r\\n/*  Dark mode  */\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    :root {\\r\\n        --bg: #141516;\\r\\n        --bg-gradient: radial-gradient(circle at 50% 0%, #1A1B1D, #0F1011);\\r\\n        --surface: #1A1B1D;\\r\\n        --card: #212224;\\r\\n        --card-border: #313335;\\r\\n        --card-hover: #2A2B2D;\\r\\n        --input-bg: #19191B;\\r\\n\\r\\n        --primary: #52B788;\\r\\n        --primary-hover: #74C69D;\\r\\n        --primary-light: #2D6A4F;\\r\\n        --primary-bg: rgba(82, 183, 136, 0.08);\\r\\n        --primary-glow: rgba(82, 183, 136, 0.14);\\r\\n\\r\\n        --accent: #E0915A;\\r\\n        --accent-hover: #EAA876;\\r\\n        --accent-bg: rgba(224, 145, 90, 0.09);\\r\\n\\r\\n        --text: #E5E3DE;\\r\\n        --text-2: #9B9D9F;\\r\\n        --text-3: #606264;\\r\\n        --text-4: #3A3C3E;\\r\\n\\r\\n        --success: #52B788;\\r\\n        --success-bg: rgba(82, 183, 136, 0.09);\\r\\n        --error: #E06060;\\r\\n        --error-bg: rgba(224, 96, 96, 0.09);\\r\\n        --warning: #E0B85A;\\r\\n        --warning-bg: rgba(224, 184, 90, 0.09);\\r\\n\\r\\n        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.18);\\r\\n        --shadow: 0 2px 5px rgba(0, 0, 0, 0.22);\\r\\n        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.28);\\r\\n        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.32);\\r\\n\\r\\n        --chat-user-bg: var(--primary);\\r\\n        --chat-user-text: #141516;\\r\\n        --chat-ai-bg: #212224;\\r\\n        --chat-ai-border: rgba(255, 255, 255, 0.05);\\r\\n        --chat-ai-text: var(--text);\\r\\n\\r\\n        --glass-bg: rgba(20, 21, 22, 0.75);\\r\\n        --glass-border: rgba(255, 255, 255, 0.08);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* RESET & BASE                                                    */\\r\\n/*  */\\r\\n*,\\r\\n*::before,\\r\\n*::after {\\r\\n    box-sizing: border-box;\\r\\n}\\r\\n\\r\\nhtml,\\r\\nbody {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    margin: 0;\\r\\n    padding: 0;\\r\\n    font-family: var(--font);\\r\\n    font-size: 13px;\\r\\n    line-height: 1.55;\\r\\n    background: var(--bg-gradient);\\r\\n    color: var(--text);\\r\\n    -webkit-font-smoothing: antialiased;\\r\\n    -moz-osx-font-smoothing: grayscale;\\r\\n    overflow-x: hidden;\\r\\n}\\r\\n\\r\\n#app-body {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    height: 100vh;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* HEADER                                                          */\\r\\n/*  */\\r\\n.app-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    padding: 12px 18px;\\r\\n    background: var(--glass-bg);\\r\\n    backdrop-filter: blur(var(--blur));\\r\\n    -webkit-backdrop-filter: blur(var(--blur));\\r\\n    border-bottom: 1px solid var(--glass-border);\\r\\n    position: sticky;\\r\\n    top: 0;\\r\\n    z-index: 100;\\r\\n}\\r\\n\\r\\n.brand {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 9px;\\r\\n}\\r\\n\\r\\n.logo {\\r\\n    color: var(--primary);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.brand h1 {\\r\\n    font-size: 15px;\\r\\n    font-weight: 700;\\r\\n    margin: 0;\\r\\n    letter-spacing: -0.025em;\\r\\n    color: var(--text);\\r\\n}\\r\\n\\r\\n.highlight-text {\\r\\n    color: var(--primary);\\r\\n    font-weight: 700;\\r\\n    /* Solid color, not a gradient  feels hand-picked */\\r\\n}\\r\\n\\r\\n.header-actions {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Icon Buttons  */\\r\\n/* Base Icon Button */\\r\\n.btn-icon {\\r\\n    width: 34px;\\r\\n    height: 34px;\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 10px;\\r\\n    background: var(--card);\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    padding: 0;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n}\\r\\n\\r\\n.btn-icon:hover {\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-light);\\r\\n    background: var(--primary-bg);\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow);\\r\\n}\\r\\n\\r\\n.btn-icon:active {\\r\\n    transform: scale(0.95);\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n/*  Panels (Docs / Settings)  */\\r\\n.panel {\\r\\n    padding: 16px;\\r\\n    background: var(--card);\\r\\n    border-bottom: 1px solid var(--card-border);\\r\\n    animation: slideDown 0.22s ease-out;\\r\\n    max-height: 80vh;\\r\\n    overflow-y: auto;\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n.panel h3 {\\r\\n    font-size: 11px;\\r\\n    font-weight: 700;\\r\\n    /* Fixed from 650 */\\r\\n    text-transform: uppercase;\\r\\n    letter-spacing: 0.06em;\\r\\n    color: var(--text-3);\\r\\n    margin: 0 0 12px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Docs Grid  */\\r\\n.docs-grid {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 8px;\\r\\n}\\r\\n\\r\\n.doc-item {\\r\\n    display: flex;\\r\\n    gap: 10px;\\r\\n    align-items: flex-start;\\r\\n    padding: 5px 0;\\r\\n}\\r\\n\\r\\n.doc-icon {\\r\\n    flex-shrink: 0;\\r\\n    width: 18px;\\r\\n    height: 18px;\\r\\n    color: var(--primary);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    margin-top: 1px;\\r\\n}\\r\\n\\r\\n.doc-item strong {\\r\\n    font-size: 12px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text);\\r\\n    display: block;\\r\\n    margin-bottom: 2px;\\r\\n}\\r\\n\\r\\n.doc-item p {\\r\\n    font-size: 11px;\\r\\n    color: var(--text-2);\\r\\n    margin: 0;\\r\\n    line-height: 1.45;\\r\\n}\\r\\n\\r\\n.docs-hint {\\r\\n    font-size: 11px;\\r\\n    color: var(--text-3);\\r\\n    margin: 12px 0 0;\\r\\n    font-style: italic;\\r\\n    line-height: 1.5;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Forms  */\\r\\n.form-group {\\r\\n    margin-bottom: 12px;\\r\\n}\\r\\n\\r\\n.form-group label {\\r\\n    display: block;\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-3);\\r\\n    margin-bottom: 4px;\\r\\n    text-transform: uppercase;\\r\\n    letter-spacing: 0.04em;\\r\\n}\\r\\n\\r\\n.form-input {\\r\\n    width: 100%;\\r\\n    padding: 8px 11px;\\r\\n    font-size: 13px;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 9px;\\r\\n    outline: none;\\r\\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.form-input:focus {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 0 0 3px var(--primary-glow);\\r\\n}\\r\\n\\r\\nselect.form-input {\\r\\n    cursor: pointer;\\r\\n    appearance: none;\\r\\n    background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='%238C8E91' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E\\\");\\r\\n    background-repeat: no-repeat;\\r\\n    background-position: right 10px center;\\r\\n    padding-right: 28px;\\r\\n}\\r\\n\\r\\n.btn-save {\\r\\n    width: 100%;\\r\\n    justify-content: center;\\r\\n    margin-top: 6px;\\r\\n}\\r\\n\\r\\n/* Model selector row */\\r\\n.model-select-wrapper {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.model-select-wrapper .form-input {\\r\\n    flex: 1;\\r\\n    min-width: 0;\\r\\n}\\r\\n\\r\\n.btn-refresh {\\r\\n    width: 30px;\\r\\n    height: 30px;\\r\\n    flex-shrink: 0;\\r\\n    padding: 0;\\r\\n}\\r\\n\\r\\n.model-status {\\r\\n    font-size: 11px;\\r\\n    margin-top: 4px;\\r\\n    min-height: 15px;\\r\\n    color: var(--text-3);\\r\\n}\\r\\n\\r\\n.model-status-ok {\\r\\n    color: var(--success);\\r\\n}\\r\\n\\r\\n.model-status-warn {\\r\\n    color: var(--error);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* MODE TOGGLE                                                     */\\r\\n/*  */\\r\\n.mode-toggle {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    padding: 5px;\\r\\n    margin: 10px 14px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 14px;\\r\\n    position: relative;\\r\\n    gap: 4px;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n}\\r\\n\\r\\n.mode-tab {\\r\\n    flex: 1;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    gap: 8px;\\r\\n    padding: 10px;\\r\\n    font-size: 13px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.3s ease;\\r\\n    position: relative;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.mode-tab.active {\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.mode-indicator {\\r\\n    position: absolute;\\r\\n    left: 5px;\\r\\n    top: 5px;\\r\\n    width: calc(50% - 7px);\\r\\n    height: calc(100% - 10px);\\r\\n    background: var(--primary-bg);\\r\\n    border-radius: 10px;\\r\\n    transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.mode-indicator.right {\\r\\n    transform: translateX(calc(100% + 4px));\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* MODE CONTENT WRAPPER                                            */\\r\\n/*  */\\r\\n.mode-content {\\r\\n    display: none;\\r\\n    flex-direction: column;\\r\\n    flex: 1;\\r\\n    overflow: hidden;\\r\\n    animation: fadeIn 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.mode-content.active {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* PLANNING MODE  Chat                                            */\\r\\n/*  */\\r\\n\\r\\n/*  Chat Messages Container  */\\r\\n.chat-messages {\\r\\n    flex: 1;\\r\\n    overflow-y: auto;\\r\\n    padding: 14px 14px 6px;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 14px;\\r\\n    scroll-behavior: smooth;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Welcome Screen  */\\r\\n.chat-welcome {\\r\\n    text-align: center;\\r\\n    padding: 28px 18px 18px;\\r\\n    animation: fadeIn 0.35s ease-out;\\r\\n}\\r\\n\\r\\n.welcome-icon {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    width: 52px;\\r\\n    height: 52px;\\r\\n    background: var(--primary);\\r\\n    border-radius: 16px;\\r\\n    color: white;\\r\\n    margin-bottom: 14px;\\r\\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.2);\\r\\n}\\r\\n\\r\\n.welcome-icon svg {\\r\\n    width: 24px;\\r\\n    height: 24px;\\r\\n}\\r\\n\\r\\n.chat-welcome h2 {\\r\\n    font-size: 17px;\\r\\n    font-weight: 700;\\r\\n    margin: 0 0 8px;\\r\\n    color: var(--text);\\r\\n    letter-spacing: -0.02em;\\r\\n}\\r\\n\\r\\n.chat-welcome p {\\r\\n    font-size: 12.5px;\\r\\n    color: var(--text-2);\\r\\n    margin: 0 0 18px;\\r\\n    line-height: 1.65;\\r\\n    max-width: 270px;\\r\\n    margin-left: auto;\\r\\n    margin-right: auto;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat Suggestions  */\\r\\n.welcome-suggestions {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 7px;\\r\\n    max-width: 280px;\\r\\n    margin: 0 auto;\\r\\n}\\r\\n\\r\\n.suggestion-chip {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 9px;\\r\\n    padding: 10px 13px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius);\\r\\n    font-size: 11.5px;\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    transition: all 0.22s ease-out;\\r\\n    text-align: left;\\r\\n    font-family: var(--font);\\r\\n    line-height: 1.4;\\r\\n}\\r\\n\\r\\n.suggestion-chip:hover {\\r\\n    border-color: var(--primary);\\r\\n    color: var(--primary);\\r\\n    background: var(--primary-bg);\\r\\n    transform: translateX(3px);\\r\\n}\\r\\n\\r\\n.suggestion-chip svg {\\r\\n    flex-shrink: 0;\\r\\n    color: var(--primary);\\r\\n    opacity: 0.5;\\r\\n}\\r\\n\\r\\n.suggestion-chip:hover svg {\\r\\n    opacity: 1;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat Message Bubbles  */\\r\\n.chat-msg {\\r\\n    display: flex;\\r\\n    gap: 0;\\r\\n    margin-bottom: 12px;\\r\\n    animation: msgSlideIn 0.35s cubic-bezier(0.19, 1, 0.22, 1);\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.chat-msg.user {\\r\\n    justify-content: flex-end;\\r\\n}\\r\\n\\r\\n.chat-msg.ai {\\r\\n    justify-content: flex-start;\\r\\n}\\r\\n\\r\\n.chat-bubble {\\r\\n    padding: 12px 16px;\\r\\n    border-radius: 20px;\\r\\n    font-size: 14px;\\r\\n    line-height: 1.5;\\r\\n    max-width: 85%;\\r\\n    word-wrap: break-word;\\r\\n    overflow-wrap: break-word;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n    transition: transform 0.2s ease;\\r\\n}\\r\\n\\r\\n.chat-bubble:has(table) {\\r\\n    max-width: 95%;\\r\\n}\\r\\n\\r\\n.chat-msg.user .chat-bubble {\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    border-bottom-right-radius: 4px;\\r\\n    margin-right: 4px;\\r\\n}\\r\\n\\r\\n.chat-msg.ai .chat-bubble {\\r\\n    background: var(--card);\\r\\n    color: var(--text-1);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-bottom-left-radius: 4px;\\r\\n    margin-left: 4px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat formatted text  */\\r\\n.chat-bubble strong {\\r\\n    font-weight: 600;\\r\\n}\\r\\n\\r\\n.chat-bubble em {\\r\\n    font-style: italic;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.chat-bubble code {\\r\\n    font-family: var(--mono);\\r\\n    font-size: 11px;\\r\\n    padding: 2px 5px;\\r\\n    border-radius: 5px;\\r\\n    background: rgba(0, 0, 0, 0.06);\\r\\n}\\r\\n\\r\\n.chat-msg.user .chat-bubble code {\\r\\n    background: rgba(255, 255, 255, 0.18);\\r\\n}\\r\\n\\r\\n.chat-bubble ul,\\r\\n.chat-bubble ol {\\r\\n    margin: 6px 0;\\r\\n    padding-left: 18px;\\r\\n}\\r\\n\\r\\n.chat-bubble li {\\r\\n    margin-bottom: 3px;\\r\\n}\\r\\n\\r\\n.chat-bubble p {\\r\\n    margin: 0 0 8px;\\r\\n}\\r\\n\\r\\n.chat-bubble li p {\\r\\n    margin: 0;\\r\\n    display: inline;\\r\\n}\\r\\n\\r\\n.chat-bubble p:last-child {\\r\\n    margin: 0;\\r\\n}\\r\\n\\r\\n.chat-bubble h1,\\r\\n.chat-bubble h2,\\r\\n.chat-bubble h3 {\\r\\n    margin: 12px 0 6px;\\r\\n    font-weight: 700;\\r\\n    line-height: 1.3;\\r\\n}\\r\\n\\r\\n.chat-bubble h1 {\\r\\n    font-size: 1.25em;\\r\\n    border-bottom: 1px solid var(--border);\\r\\n    padding-bottom: 4px;\\r\\n}\\r\\n\\r\\n.chat-bubble h2 {\\r\\n    font-size: 1.15em;\\r\\n}\\r\\n\\r\\n.chat-bubble h3 {\\r\\n    font-size: 1.05em;\\r\\n    color: var(--text-2);\\r\\n}\\r\\n\\r\\n/* Table styling for AI responses */\\r\\n.chat-bubble table {\\r\\n    width: 100%;\\r\\n    border-collapse: collapse;\\r\\n    margin: 10px 0;\\r\\n    font-size: 11px;\\r\\n    background: var(--surface);\\r\\n    border-radius: 8px;\\r\\n    overflow: hidden;\\r\\n    display: block;\\r\\n    overflow-x: auto;\\r\\n}\\r\\n\\r\\n.chat-bubble th,\\r\\n.chat-bubble td {\\r\\n    padding: 6px 10px;\\r\\n    border: 1px solid var(--border);\\r\\n    text-align: left;\\r\\n}\\r\\n\\r\\n.chat-bubble th {\\r\\n    background: var(--surface-2);\\r\\n    font-weight: 600;\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.chat-bubble tr:nth-child(even) {\\r\\n    background: rgba(0, 0, 0, 0.02);\\r\\n}\\r\\n\\r\\n/*  Context Badge  */\\r\\n.context-badge {\\r\\n    display: block;\\r\\n    margin-top: 8px;\\r\\n    padding: 4px 8px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 500;\\r\\n    color: rgba(255, 255, 255, 0.85);\\r\\n    background: rgba(255, 255, 255, 0.15);\\r\\n    border-radius: 6px;\\r\\n    letter-spacing: 0.2px;\\r\\n}\\r\\n\\r\\n.chat-msg.ai .context-badge {\\r\\n    color: var(--text-2);\\r\\n    background: var(--primary-bg);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Execute from Chat  */\\r\\n.chat-action-bar {\\r\\n    display: flex;\\r\\n    gap: 6px;\\r\\n    margin-top: 10px;\\r\\n}\\r\\n\\r\\n.btn-execute-from-chat {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 5px;\\r\\n    padding: 5px 11px;\\r\\n    font-size: 10.5px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    background: var(--primary-bg);\\r\\n    color: var(--primary);\\r\\n    border: 1px solid var(--primary-glow);\\r\\n    border-radius: 7px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.btn-execute-from-chat:hover {\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    box-shadow: 0 2px 8px rgba(45, 106, 79, 0.25);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Typing Indicator  */\\r\\n.typing-indicator {\\r\\n    display: flex;\\r\\n    gap: 4px;\\r\\n    align-items: center;\\r\\n    padding: 4px 0;\\r\\n}\\r\\n\\r\\n.typing-dot {\\r\\n    width: 6px;\\r\\n    height: 6px;\\r\\n    background: var(--text-3);\\r\\n    border-radius: 50%;\\r\\n    animation: typingBounce 0.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n.typing-dot:nth-child(2) {\\r\\n    animation-delay: 0.15s;\\r\\n}\\r\\n\\r\\n.typing-dot:nth-child(3) {\\r\\n    animation-delay: 0.3s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Chat Input Area  */\\r\\n.chat-input-area {\\r\\n    padding: 12px 14px 12px;\\r\\n    background: var(--glass-bg);\\r\\n    backdrop-filter: blur(var(--blur));\\r\\n    -webkit-backdrop-filter: blur(var(--blur));\\r\\n    border-top: 1px solid var(--glass-border);\\r\\n}\\r\\n\\r\\n.chat-input-card {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 10px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius-xl);\\r\\n    padding: 6px 6px 6px 16px;\\r\\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n.chat-input-card:focus-within {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 4px 20px var(--primary-glow);\\r\\n    transform: translateY(-2px);\\r\\n}\\r\\n\\r\\n#chat-input {\\r\\n    flex: 1;\\r\\n    border: none;\\r\\n    background: transparent;\\r\\n    font-family: var(--font);\\r\\n    font-size: 13px;\\r\\n    line-height: 1.4;\\r\\n    padding: 6px 0;\\r\\n    color: var(--text-1);\\r\\n    resize: none;\\r\\n    outline: none;\\r\\n    max-height: 120px;\\r\\n    min-height: 20px;\\r\\n}\\r\\n\\r\\n/* Agent Footer Layout */\\r\\n.card-footer {\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    align-items: center;\\r\\n    margin-top: 12px;\\r\\n}\\r\\n\\r\\n.footer-left {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n}\\r\\n\\r\\n/* Original btn-clip (updated) */\\r\\n.btn-clip {\\r\\n    background: none;\\r\\n    border: none;\\r\\n    color: var(--text-3);\\r\\n    cursor: pointer;\\r\\n    padding: 6px;\\r\\n    border-radius: 6px;\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    transition: all 0.2s;\\r\\n}\\r\\n\\r\\n.btn-clip:hover {\\r\\n    background: var(--surface-hover);\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.file-preview {\\r\\n    background: var(--surface-2);\\r\\n    border: 1px solid var(--border);\\r\\n    border-radius: 6px;\\r\\n    padding: 6px 10px;\\r\\n    margin-bottom: 8px;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    font-size: 11px;\\r\\n    color: var(--text-1);\\r\\n}\\r\\n\\r\\n.file-thumb {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    padding-right: 8px;\\r\\n}\\r\\n\\r\\n.file-remove {\\r\\n    background: none;\\r\\n    border: none;\\r\\n    color: var(--text-3);\\r\\n    font-size: 16px;\\r\\n    cursor: pointer;\\r\\n    padding: 0 4px;\\r\\n    line-height: 1;\\r\\n}\\r\\n\\r\\n.file-center {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n#chat-input::placeholder {\\r\\n    color: var(--text-3);\\r\\n}\\r\\n\\r\\n.btn-send {\\r\\n    width: 38px;\\r\\n    height: 38px;\\r\\n    border: none;\\r\\n    border-radius: 12px;\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    cursor: pointer;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    flex-shrink: 0;\\r\\n    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    box-shadow: 0 4px 12px rgba(45, 106, 79, 0.3);\\r\\n}\\r\\n\\r\\n.btn-send:hover {\\r\\n    background: var(--primary-hover);\\r\\n    transform: translateY(-2px) scale(1.05);\\r\\n}\\r\\n\\r\\n.btn-send:disabled {\\r\\n    opacity: 0.35;\\r\\n    cursor: not-allowed;\\r\\n    transform: none;\\r\\n}\\r\\n\\r\\n.btn-send.is-busy {\\r\\n    background: #FF4D4D;\\r\\n    /* Red stop button */\\r\\n    box-shadow: 0 4px 12px rgba(255, 77, 77, 0.3);\\r\\n}\\r\\n\\r\\n.btn-send.is-busy:hover {\\r\\n    background: #E60000;\\r\\n    transform: scale(1.1);\\r\\n}\\r\\n\\r\\n.btn-send svg {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n}\\r\\n\\r\\n.chat-footer {\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    padding: 4px 0 0;\\r\\n}\\r\\n\\r\\n/*  File Preview List  */\\r\\n.file-preview-list {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 6px;\\r\\n    margin-bottom: 8px;\\r\\n    padding: 0 4px;\\r\\n}\\r\\n\\r\\n.file-chip {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    background: var(--surface);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 6px;\\r\\n    padding: 4px 8px;\\r\\n    font-size: 11px;\\r\\n    color: var(--text);\\r\\n    transition: all 0.2s ease;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.file-chip:hover {\\r\\n    border-color: var(--primary-light);\\r\\n    background: var(--card);\\r\\n    transform: translateY(-1px);\\r\\n    box-shadow: var(--shadow-sm);\\r\\n}\\r\\n\\r\\n.file-chip-icon {\\r\\n    font-size: 12px;\\r\\n    opacity: 0.7;\\r\\n}\\r\\n\\r\\n.file-chip-name {\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis;\\r\\n    max-width: 140px;\\r\\n}\\r\\n\\r\\n.file-chip-remove {\\r\\n    background: none;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n    color: var(--text-3);\\r\\n    padding: 0 2px;\\r\\n    font-size: 14px;\\r\\n    line-height: 1;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    border-radius: 4px;\\r\\n    transition: color 0.2s;\\r\\n}\\r\\n\\r\\n.file-chip-remove:hover {\\r\\n    color: var(--error);\\r\\n    background: var(--error-bg);\\r\\n}\\r\\n\\r\\n/*  Custom Scrollbar  */\\r\\n::-webkit-scrollbar {\\r\\n    width: 6px;\\r\\n    height: 6px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-track {\\r\\n    background: transparent;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb {\\r\\n    background: rgba(0, 0, 0, 0.1);\\r\\n    border-radius: 3px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb:hover {\\r\\n    background: rgba(0, 0, 0, 0.2);\\r\\n}\\r\\n\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    ::-webkit-scrollbar-thumb {\\r\\n        background: rgba(255, 255, 255, 0.15);\\r\\n    }\\r\\n\\r\\n    ::-webkit-scrollbar-thumb:hover {\\r\\n        background: rgba(255, 255, 255, 0.25);\\r\\n    }\\r\\n\\r\\n    .app-header {\\r\\n        background: rgba(26, 27, 29, 0.85);\\r\\n        /* Dark mode glass */\\r\\n    }\\r\\n}\\r\\n\\r\\n.btn-text {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 4px;\\r\\n    padding: 5px 9px;\\r\\n    font-size: 11px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    cursor: pointer;\\r\\n    border-radius: 7px;\\r\\n    transition: color 0.15s, background 0.15s;\\r\\n}\\r\\n\\r\\n.btn-text:hover {\\r\\n    color: var(--error);\\r\\n    background: var(--error-bg);\\r\\n}\\r\\n\\r\\n.btn-text svg {\\r\\n    width: 12px;\\r\\n    height: 12px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* AGENT MODE                                                      */\\r\\n/*  */\\r\\n.content-wrapper {\\r\\n    flex: 1;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    width: 100%;\\r\\n    overflow: hidden;\\r\\n    position: relative;\\r\\n    min-height: 0;\\r\\n}\\r\\n\\r\\n.agent-scroll-area {\\r\\n    flex: 1;\\r\\n    overflow-y: auto;\\r\\n    padding: 10px 14px 14px;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 12px;\\r\\n    scroll-behavior: smooth;\\r\\n    min-height: 0;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Category Tabs  */\\r\\n.action-categories {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n    overflow-x: auto;\\r\\n    padding: 2px 0;\\r\\n    scrollbar-width: none;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.action-categories::-webkit-scrollbar {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.category-tab {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 5px;\\r\\n    padding: 7px 11px;\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: transparent;\\r\\n    border: 1px solid transparent;\\r\\n    border-radius: 9px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease-out;\\r\\n    white-space: nowrap;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.category-tab:hover {\\r\\n    color: var(--text-2);\\r\\n    background: var(--card);\\r\\n}\\r\\n\\r\\n.category-tab.active {\\r\\n    color: var(--primary);\\r\\n    background: var(--primary-bg);\\r\\n    border-color: var(--primary-glow);\\r\\n    animation: tabPulse 2s infinite ease-in-out;\\r\\n}\\r\\n\\r\\n.category-tab svg {\\r\\n    width: 12px;\\r\\n    height: 12px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Schema Info Banner (Extract Mode)  */\\r\\n.schema-info {\\r\\n    display: flex;\\r\\n    align-items: flex-start;\\r\\n    gap: 10px;\\r\\n    padding: 10px 12px;\\r\\n    margin-bottom: 10px;\\r\\n    background: linear-gradient(135deg, var(--primary-bg), rgba(74, 144, 226, 0.06));\\r\\n    border: 1px solid var(--primary-glow);\\r\\n    border-radius: 10px;\\r\\n    animation: fadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n.schema-icon {\\r\\n    font-size: 18px;\\r\\n    line-height: 1;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.schema-text {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 2px;\\r\\n}\\r\\n\\r\\n.schema-text strong {\\r\\n    font-size: 11.5px;\\r\\n    font-weight: 600;\\r\\n    color: var(--primary);\\r\\n}\\r\\n\\r\\n.schema-text span {\\r\\n    font-size: 10.5px;\\r\\n    color: var(--text-2);\\r\\n    line-height: 1.4;\\r\\n}\\r\\n\\r\\n.btn-detect {\\r\\n    padding: 5px 10px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    color: var(--primary);\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--primary-glow);\\r\\n    border-radius: 6px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease-out;\\r\\n    flex-shrink: 0;\\r\\n    margin-left: auto;\\r\\n}\\r\\n\\r\\n.btn-detect:hover {\\r\\n    background: var(--primary-bg);\\r\\n    transform: translateY(-1px);\\r\\n}\\r\\n\\r\\n.btn-detect:active {\\r\\n    transform: scale(0.96);\\r\\n}\\r\\n\\r\\n/*  Detected Columns Preview  */\\r\\n.detected-columns {\\r\\n    padding: 10px 12px;\\r\\n    margin-bottom: 10px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 10px;\\r\\n    animation: fadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n.detected-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    margin-bottom: 8px;\\r\\n}\\r\\n\\r\\n.detected-label {\\r\\n    font-size: 10.5px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-2);\\r\\n}\\r\\n\\r\\n.column-count {\\r\\n    font-size: 10px;\\r\\n    font-weight: 700;\\r\\n    color: var(--primary);\\r\\n    background: var(--primary-bg);\\r\\n    padding: 2px 8px;\\r\\n    border-radius: 10px;\\r\\n}\\r\\n\\r\\n.column-chips {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 4px;\\r\\n}\\r\\n\\r\\n.column-chip {\\r\\n    padding: 3px 8px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 500;\\r\\n    color: var(--text-2);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 6px;\\r\\n}\\r\\n\\r\\n.column-chip.empty-warning {\\r\\n    color: var(--warning);\\r\\n    background: var(--warning-bg);\\r\\n    border-color: rgba(192, 139, 45, 0.2);\\r\\n}\\r\\n\\r\\n/*  Extract Category Highlight  */\\r\\n.category-tab[data-category=\\\"extract\\\"].active {\\r\\n    color: #C4603D;\\r\\n    background: rgba(196, 96, 61, 0.08);\\r\\n    border-color: rgba(196, 96, 61, 0.15);\\r\\n}\\r\\n\\r\\n.category-tab[data-category=\\\"extract\\\"]:hover {\\r\\n    color: #A8502F;\\r\\n}\\r\\n\\r\\n/*  Smart Tools Category Highlight  */\\r\\n.category-tab[data-category=\\\"smart\\\"].active {\\r\\n    color: #7C3AED;\\r\\n    background: rgba(124, 58, 237, 0.08);\\r\\n    border-color: rgba(124, 58, 237, 0.15);\\r\\n}\\r\\n\\r\\n.category-tab[data-category=\\\"smart\\\"]:hover {\\r\\n    color: #6D28D9;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Quick Action Chips  */\\r\\n.quick-actions {\\r\\n    display: flex;\\r\\n    flex-wrap: wrap;\\r\\n    gap: 6px;\\r\\n}\\r\\n\\r\\n.chip {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    padding: 8px 14px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-2);\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 24px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n.chip:hover {\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary);\\r\\n    background: var(--card);\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n.chip svg {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n    flex-shrink: 0;\\r\\n    transition: transform 0.3s ease;\\r\\n}\\r\\n\\r\\n.chip:hover svg {\\r\\n    transform: rotate(15deg);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Input Card (Agent)  */\\r\\n.input-card {\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius-xl);\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    box-shadow: var(--shadow-md);\\r\\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\\r\\n    margin: 14px 14px 0 14px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n.input-card:focus-within {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 2px 16px var(--primary-glow);\\r\\n}\\r\\n\\r\\ntextarea {\\r\\n    width: 100%;\\r\\n    min-height: 80px;\\r\\n    max-height: 160px;\\r\\n    padding: 14px 16px;\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    color: var(--text);\\r\\n    font-family: var(--font);\\r\\n    font-size: 13px;\\r\\n    line-height: 1.6;\\r\\n    resize: none;\\r\\n    outline: none;\\r\\n}\\r\\n\\r\\n.card-footer {\\r\\n    padding: 8px 12px;\\r\\n    background: rgba(0, 0, 0, 0.02);\\r\\n    border-top: 1px solid var(--card-border);\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Cache Badge  */\\r\\n.cache-badge {\\r\\n    font-size: 10.5px;\\r\\n    font-weight: 600;\\r\\n    color: var(--success);\\r\\n    background: var(--success-bg);\\r\\n    padding: 3px 9px;\\r\\n    border-radius: 10px;\\r\\n    animation: fadeIn 0.2s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Primary Button  */\\r\\n.btn-primary {\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    border: none;\\r\\n    padding: 8px 16px;\\r\\n    border-radius: 9px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 600;\\r\\n    cursor: pointer;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    transition: background 0.2s ease-out, transform 0.15s ease-out, box-shadow 0.2s ease-out;\\r\\n    box-shadow: 0 2px 6px rgba(45, 106, 79, 0.2);\\r\\n}\\r\\n\\r\\n.btn-primary:hover {\\r\\n    background: var(--primary-hover);\\r\\n    transform: translateY(-1px);\\r\\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.25);\\r\\n}\\r\\n\\r\\n.btn-primary:active {\\r\\n    transform: translateY(0);\\r\\n}\\r\\n\\r\\n.btn-primary.btn-stop {\\r\\n    background: #E53E3E;\\r\\n    border-color: #C53030;\\r\\n    box-shadow: 0 4px 10px rgba(229, 62, 62, 0.2);\\r\\n}\\r\\n\\r\\n.btn-primary.btn-stop:hover {\\r\\n    background: #C53030;\\r\\n}\\r\\n\\r\\n.btn-primary:disabled {\\r\\n    opacity: 0.4;\\r\\n    cursor: not-allowed;\\r\\n    transform: none;\\r\\n}\\r\\n\\r\\n.btn-primary svg {\\r\\n    width: 13px;\\r\\n    height: 13px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Skeleton Loading  */\\r\\n.skeleton-container {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 9px;\\r\\n    padding: 4px 0;\\r\\n}\\r\\n\\r\\n.skeleton-pill {\\r\\n    width: 140px;\\r\\n    height: 28px;\\r\\n    border-radius: 9px;\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n.skeleton-line {\\r\\n    height: 13px;\\r\\n    border-radius: 5px;\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n.skeleton-line.w80 {\\r\\n    width: 80%;\\r\\n}\\r\\n\\r\\n.skeleton-line.w60 {\\r\\n    width: 60%;\\r\\n}\\r\\n\\r\\n.skeleton-line.w40 {\\r\\n    width: 40%;\\r\\n}\\r\\n\\r\\n/* Chat Skeleton Specifics */\\r\\n.skeleton-msg {\\r\\n    display: flex;\\r\\n    gap: 12px;\\r\\n    margin-bottom: 12px;\\r\\n    align-items: flex-start;\\r\\n}\\r\\n\\r\\n.skeleton-bubble {\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 20px;\\r\\n    border-bottom-left-radius: 4px;\\r\\n    padding: 14px;\\r\\n    flex: 1;\\r\\n    max-width: 85%;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 10px;\\r\\n    box-shadow: var(--shadow-sm);\\r\\n    margin-left: 4px;\\r\\n}\\r\\n\\r\\n.sk-shimmer {\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.6s ease-in-out infinite;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Status Pill  */\\r\\n.status-pill {\\r\\n    padding: 9px 13px;\\r\\n    border-radius: var(--radius);\\r\\n    font-size: 12px;\\r\\n    font-weight: 500;\\r\\n    display: none;\\r\\n    align-items: center;\\r\\n    gap: 7px;\\r\\n    animation: fadeIn 0.2s;\\r\\n    border: 1px solid transparent;\\r\\n}\\r\\n\\r\\n.status-pill.info {\\r\\n    background: var(--primary-bg);\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-glow);\\r\\n}\\r\\n\\r\\n.status-pill.success {\\r\\n    background: var(--success-bg);\\r\\n    color: var(--success);\\r\\n    border-color: rgba(45, 106, 79, 0.12);\\r\\n}\\r\\n\\r\\n.status-pill.error {\\r\\n    background: var(--error-bg);\\r\\n    color: var(--error);\\r\\n    border-color: rgba(184, 58, 58, 0.12);\\r\\n}\\r\\n\\r\\n\\r\\n/*  Generated Code (Debug Section)  */\\r\\n#debug-section {\\r\\n    margin-top: 4px;\\r\\n}\\r\\n\\r\\n#debug-section details {\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius);\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n#debug-section summary {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 6px;\\r\\n    padding: 10px 14px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    user-select: none;\\r\\n    transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n#debug-section summary:hover {\\r\\n    color: var(--text);\\r\\n    background: rgba(0, 0, 0, 0.02);\\r\\n}\\r\\n\\r\\n#debug-section summary svg {\\r\\n    width: 12px;\\r\\n    height: 12px;\\r\\n    transition: transform 0.2s ease;\\r\\n}\\r\\n\\r\\n#debug-section details[open] summary svg {\\r\\n    transform: rotate(180deg);\\r\\n}\\r\\n\\r\\n#debug-code {\\r\\n    margin: 0;\\r\\n    padding: 12px 14px;\\r\\n    font-family: var(--mono);\\r\\n    font-size: 10px;\\r\\n    line-height: 1.6;\\r\\n    color: var(--text-2);\\r\\n    background: var(--input-bg);\\r\\n    border-top: 1px solid var(--card-border);\\r\\n    max-height: 200px;\\r\\n    overflow-y: auto;\\r\\n    white-space: pre-wrap;\\r\\n    word-break: break-all;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Spinners  */\\r\\n.spinner {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n    border: 2px solid transparent;\\r\\n    border-radius: 50%;\\r\\n    border-top-color: currentColor;\\r\\n    border-right-color: currentColor;\\r\\n    animation: spin 0.7s linear infinite;\\r\\n}\\r\\n\\r\\n.btn-spinner {\\r\\n    width: 13px;\\r\\n    height: 13px;\\r\\n    border: 2px solid rgba(255, 255, 255, 0.3);\\r\\n    border-radius: 50%;\\r\\n    border-top-color: white;\\r\\n    animation: spin 0.7s linear infinite;\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n\\r\\n/*  Debug Section  */\\r\\n#debug-section {\\r\\n    margin-top: auto;\\r\\n    padding-top: 8px;\\r\\n}\\r\\n\\r\\ndetails {\\r\\n    background: transparent;\\r\\n    border: none;\\r\\n    border-radius: var(--radius);\\r\\n}\\r\\n\\r\\nsummary {\\r\\n    padding: 5px 0;\\r\\n    cursor: pointer;\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-3);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 5px;\\r\\n    list-style: none;\\r\\n    user-select: none;\\r\\n    transition: color 0.15s;\\r\\n}\\r\\n\\r\\nsummary::-webkit-details-marker {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\nsummary:hover {\\r\\n    color: var(--text-2);\\r\\n}\\r\\n\\r\\ndetails[open] summary svg {\\r\\n    transform: rotate(180deg);\\r\\n}\\r\\n\\r\\nsummary svg {\\r\\n    transition: transform 0.15s;\\r\\n}\\r\\n\\r\\ndetails[open] summary {\\r\\n    margin-bottom: 5px;\\r\\n}\\r\\n\\r\\npre {\\r\\n    margin: 0;\\r\\n    padding: 11px;\\r\\n    background: var(--input-bg);\\r\\n    color: var(--text-2);\\r\\n    font-family: var(--mono);\\r\\n    font-size: 11px;\\r\\n    overflow-x: auto;\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 9px;\\r\\n    line-height: 1.55;\\r\\n    white-space: pre-wrap;\\r\\n    word-break: break-all;\\r\\n    max-height: 180px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SIDELOAD  Skeleton Loading Screen                              */\\r\\n/*  */\\r\\n.sideload-container {\\r\\n    height: 100vh;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    background: var(--bg);\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.sideload-skeleton {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    animation: fadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n.sk-shimmer {\\r\\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\\r\\n    background-size: 200% 100%;\\r\\n    animation: shimmer 1.8s ease-in-out infinite;\\r\\n    border-radius: 7px;\\r\\n}\\r\\n\\r\\n.sk-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    padding: 13px 16px;\\r\\n    border-bottom: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n.sk-brand {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 9px;\\r\\n}\\r\\n\\r\\n.sk-logo {\\r\\n    width: 24px;\\r\\n    height: 24px;\\r\\n    border-radius: 7px;\\r\\n}\\r\\n\\r\\n.sk-title {\\r\\n    width: 105px;\\r\\n    height: 15px;\\r\\n    border-radius: 5px;\\r\\n}\\r\\n\\r\\n.sk-header-actions {\\r\\n    display: flex;\\r\\n    gap: 5px;\\r\\n}\\r\\n\\r\\n.sk-icon-btn {\\r\\n    width: 32px;\\r\\n    height: 32px;\\r\\n    border-radius: 9px;\\r\\n}\\r\\n\\r\\n.sk-mode-toggle {\\r\\n    display: flex;\\r\\n    gap: 4px;\\r\\n    padding: 8px 6px;\\r\\n    border-bottom: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n.sk-mode-tab {\\r\\n    flex: 1;\\r\\n    height: 36px;\\r\\n    border-radius: 9px;\\r\\n}\\r\\n\\r\\n.sk-welcome {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    padding: 34px 20px 18px;\\r\\n    gap: 11px;\\r\\n}\\r\\n\\r\\n.sk-welcome-icon {\\r\\n    width: 52px;\\r\\n    height: 52px;\\r\\n    border-radius: 16px;\\r\\n}\\r\\n\\r\\n.sk-welcome-title {\\r\\n    width: 145px;\\r\\n    height: 19px;\\r\\n    border-radius: 6px;\\r\\n}\\r\\n\\r\\n.sk-welcome-desc {\\r\\n    width: 220px;\\r\\n    height: 13px;\\r\\n    border-radius: 5px;\\r\\n}\\r\\n\\r\\n.sk-welcome-desc.short {\\r\\n    width: 175px;\\r\\n}\\r\\n\\r\\n.sk-suggestions {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 8px;\\r\\n    padding: 10px 32px;\\r\\n}\\r\\n\\r\\n.sk-suggestion {\\r\\n    width: 100%;\\r\\n    height: 38px;\\r\\n    border-radius: 10px;\\r\\n}\\r\\n\\r\\n.sk-suggestion:nth-child(2) {\\r\\n    animation-delay: 0.1s;\\r\\n}\\r\\n\\r\\n.sk-suggestion:nth-child(3) {\\r\\n    animation-delay: 0.2s;\\r\\n}\\r\\n\\r\\n.sk-suggestion:nth-child(4) {\\r\\n    animation-delay: 0.3s;\\r\\n}\\r\\n\\r\\n.sk-input-area {\\r\\n    margin-top: auto;\\r\\n    padding: 12px 16px 8px;\\r\\n    border-top: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n.sk-input {\\r\\n    width: 100%;\\r\\n    height: 42px;\\r\\n    border-radius: 14px;\\r\\n}\\r\\n\\r\\n.sideload-status {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    gap: 9px;\\r\\n    padding: 11px;\\r\\n    font-size: 11.5px;\\r\\n    font-weight: 500;\\r\\n    color: var(--text-3);\\r\\n}\\r\\n\\r\\n.sideload-pulse {\\r\\n    width: 8px;\\r\\n    height: 8px;\\r\\n    border-radius: 50%;\\r\\n    background: var(--primary);\\r\\n    animation: pulse 1.5s ease-in-out infinite;\\r\\n    box-shadow: 0 0 8px var(--primary-glow);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* KEYFRAMES                                                       */\\r\\n/*  */\\r\\n@keyframes fadeIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(3px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes slideDown {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(-6px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes spin {\\r\\n    to {\\r\\n        transform: rotate(360deg);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes shimmer {\\r\\n    0% {\\r\\n        background-position: 200% 0;\\r\\n    }\\r\\n\\r\\n    100% {\\r\\n        background-position: -200% 0;\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes msgSlideIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(6px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes typingBounce {\\r\\n\\r\\n    0%,\\r\\n    100% {\\r\\n        transform: translateY(0);\\r\\n        opacity: 0.4;\\r\\n    }\\r\\n\\r\\n    50% {\\r\\n        transform: translateY(-4px);\\r\\n        opacity: 1;\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes pulse {\\r\\n\\r\\n    0%,\\r\\n    100% {\\r\\n        opacity: 0.4;\\r\\n        transform: scale(0.85);\\r\\n    }\\r\\n\\r\\n    50% {\\r\\n        opacity: 1;\\r\\n        transform: scale(1.15);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SCROLL FIXES                                                    */\\r\\n/*  */\\r\\n\\r\\n/* Chat messages area scrolls */\\r\\n.chat-messages {\\r\\n    flex: 1;\\r\\n    overflow-y: auto !important;\\r\\n    min-height: 0;\\r\\n    padding-bottom: 40px;\\r\\n    scroll-behavior: smooth;\\r\\n    -webkit-overflow-scrolling: touch;\\r\\n}\\r\\n\\r\\n/* Content-wrapper is a flex container, NOT a scroller */\\r\\n.content-wrapper {\\r\\n    flex: 1;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    overflow: hidden !important;\\r\\n    min-height: 0;\\r\\n}\\r\\n\\r\\n/* Ensure parent containers occupy full height but don't scroll themselves */\\r\\n#agent-mode,\\r\\n#planning-mode {\\r\\n    display: none;\\r\\n    height: 100%;\\r\\n    overflow: hidden;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\n#agent-mode.active,\\r\\n#planning-mode.active {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* SCROLLBAR STYLING                                               */\\r\\n/*  */\\r\\n::-webkit-scrollbar {\\r\\n    width: 6px;\\r\\n    height: 6px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-track {\\r\\n    background: transparent;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb {\\r\\n    background: rgba(0, 0, 0, 0.15);\\r\\n    border-radius: 4px;\\r\\n}\\r\\n\\r\\n::-webkit-scrollbar-thumb:hover {\\r\\n    background: rgba(0, 0, 0, 0.3);\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* PRODUCTION OPTIMIZATIONS (RESPONSIVE & PERFORMANCE)             */\\r\\n/*  */\\r\\n\\r\\n/* 1. Hardware Acceleration for Animations */\\r\\n.chat-msg,\\r\\n.panel,\\r\\n.sideload-container {\\r\\n    will-change: transform, opacity;\\r\\n    backface-visibility: hidden;\\r\\n    /* sharpen animations */\\r\\n    transform: translateZ(0);\\r\\n    /* trigger GPU */\\r\\n}\\r\\n\\r\\n.chip,\\r\\n.category-tab,\\r\\n.btn-icon {\\r\\n    transform: translateZ(0);\\r\\n}\\r\\n\\r\\n/* 2. Responsive Tweaks for Narrow Taskpanes (< 360px) */\\r\\n@media (max-width: 360px) {\\r\\n    :root {\\r\\n        --radius-lg: 10px;\\r\\n        /* Tighter corners */\\r\\n    }\\r\\n\\r\\n    .app-header {\\r\\n        padding: 8px 12px;\\r\\n    }\\r\\n\\r\\n    .chat-bubble {\\r\\n        font-size: 11.5px;\\r\\n        padding: 8px 12px;\\r\\n        max-width: 88%;\\r\\n    }\\r\\n\\r\\n    .chip {\\r\\n        font-size: 10px;\\r\\n        padding: 5px 9px;\\r\\n    }\\r\\n\\r\\n    .category-tab {\\r\\n        padding: 5px 9px;\\r\\n        font-size: 10px;\\r\\n    }\\r\\n\\r\\n    /* Stack form groups tighter */\\r\\n    .form-group {\\r\\n        margin-bottom: 10px;\\r\\n    }\\r\\n\\r\\n    /* Ensure code blocks don't overflow */\\r\\n    .chat-bubble pre {\\r\\n        font-size: 10px;\\r\\n        padding: 8px;\\r\\n    }\\r\\n}\\r\\n\\r\\n/* 3. High-DPI Screens (Retina) Text Sharpness */\\r\\n@media (-webkit-min-device-pixel-ratio: 2),\\r\\n(min-resolution: 192dpi) {\\r\\n    body {\\r\\n        -webkit-font-smoothing: antialiased;\\r\\n        -moz-osx-font-smoothing: grayscale;\\r\\n    }\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* ANIMATION ENHANCEMENTS                                          */\\r\\n/*  */\\r\\n\\r\\n/* Make transitions smoother */\\r\\n.chip,\\r\\n.suggestion-chip,\\r\\n.category-tab,\\r\\n.btn-icon,\\r\\n.btn-primary,\\r\\n.btn-send {\\r\\n    transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    /* A bit of overshoot */\\r\\n}\\r\\n\\r\\n/* More pronounced hover effect for chips */\\r\\n.chip:hover,\\r\\n.suggestion-chip:hover,\\r\\n.category-tab:hover {\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n/* Remove the translateX from suggestion-chip to be consistent */\\r\\n.suggestion-chip:hover {\\r\\n    transform: translateY(-2px);\\r\\n}\\r\\n\\r\\n/* Add hover effect to icon buttons */\\r\\n.btn-icon:hover {\\r\\n    transform: translateY(-2px) scale(1.05);\\r\\n    box-shadow: var(--shadow-md);\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n@keyframes tabPulse {\\r\\n    0% {\\r\\n        box-shadow: 0 0 0 0 rgba(74, 144, 226, 0.15);\\r\\n    }\\r\\n\\r\\n    70% {\\r\\n        box-shadow: 0 0 0 4px rgba(74, 144, 226, 0);\\r\\n    }\\r\\n\\r\\n    100% {\\r\\n        box-shadow: 0 0 0 0 rgba(74, 144, 226, 0);\\r\\n    }\\r\\n}\\r\\n\\r\\n.chat-msg {\\r\\n    animation: msgSlideIn 0.4s cubic-bezier(0.19, 1, 0.22, 1) forwards;\\r\\n}\\r\\n\\r\\n/* Better button press feedback */\\r\\n.btn-primary:active,\\r\\n.btn-send:active,\\r\\n.btn-icon:active,\\r\\n.chip:active,\\r\\n.suggestion-chip:active,\\r\\n.category-tab:active {\\r\\n    transform: scale(0.95) !important;\\r\\n    /* Use important to override hover transforms */\\r\\n    transition-duration: 0.1s;\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* BUSINESS MODULES                                                */\\r\\n/*  */\\r\\n.modules-grid {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 12px;\\r\\n    margin-top: 16px;\\r\\n}\\r\\n\\r\\n.module-card {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 16px;\\r\\n    padding: 16px;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius-lg);\\r\\n    transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n.module-card:hover {\\r\\n    transform: translateY(-2px);\\r\\n    box-shadow: var(--shadow-md);\\r\\n    border-color: var(--primary-light);\\r\\n}\\r\\n\\r\\n.module-icon {\\r\\n    font-size: 24px;\\r\\n    width: 48px;\\r\\n    height: 48px;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    background: var(--bg);\\r\\n    border-radius: 12px;\\r\\n}\\r\\n\\r\\n.module-info {\\r\\n    flex: 1;\\r\\n}\\r\\n\\r\\n.module-info h3 {\\r\\n    margin: 0 0 4px;\\r\\n    font-size: 14px;\\r\\n    font-weight: 600;\\r\\n}\\r\\n\\r\\n.module-info p {\\r\\n    margin: 0;\\r\\n    font-size: 12px;\\r\\n    color: var(--text-2);\\r\\n    line-height: 1.4;\\r\\n}\\r\\n\\r\\n.module-preview-area {\\r\\n    margin-top: 24px;\\r\\n    padding: 16px;\\r\\n    background: var(--primary-bg);\\r\\n    border-radius: var(--radius-lg);\\r\\n    border: 1px dashed var(--primary);\\r\\n}\\r\\n\\r\\n.badge-gold {\\r\\n    background: #FFF9E6;\\r\\n    color: #B28B00;\\r\\n    border: 1px solid #FFE699;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* TOAST NOTIFICATION SYSTEM                                       */\\r\\n/*  */\\r\\n.toast-container {\\r\\n    position: fixed;\\r\\n    bottom: 20px;\\r\\n    left: 50%;\\r\\n    transform: translateX(-50%);\\r\\n    z-index: 10000;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n.toast {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    gap: 8px;\\r\\n    padding: 10px 16px;\\r\\n    border-radius: 12px;\\r\\n    font-size: 12px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    box-shadow: var(--shadow-lg);\\r\\n    animation: toastIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\r\\n    pointer-events: auto;\\r\\n    backdrop-filter: blur(12px);\\r\\n    -webkit-backdrop-filter: blur(12px);\\r\\n    max-width: 280px;\\r\\n}\\r\\n\\r\\n.toast.toast-out {\\r\\n    animation: toastOut 0.3s ease-in forwards;\\r\\n}\\r\\n\\r\\n.toast.toast-success {\\r\\n    background: rgba(45, 106, 79, 0.92);\\r\\n    color: white;\\r\\n    border: 1px solid rgba(82, 183, 136, 0.3);\\r\\n}\\r\\n\\r\\n.toast.toast-error {\\r\\n    background: rgba(184, 58, 58, 0.92);\\r\\n    color: white;\\r\\n    border: 1px solid rgba(224, 96, 96, 0.3);\\r\\n}\\r\\n\\r\\n.toast.toast-info {\\r\\n    background: rgba(255, 255, 255, 0.92);\\r\\n    color: var(--text);\\r\\n    border: 1px solid var(--card-border);\\r\\n}\\r\\n\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    .toast.toast-info {\\r\\n        background: rgba(33, 34, 36, 0.92);\\r\\n        color: var(--text);\\r\\n        border: 1px solid var(--card-border);\\r\\n    }\\r\\n}\\r\\n\\r\\n.toast svg {\\r\\n    width: 14px;\\r\\n    height: 14px;\\r\\n    flex-shrink: 0;\\r\\n}\\r\\n\\r\\n@keyframes toastIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(16px) scale(0.95);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0) scale(1);\\r\\n    }\\r\\n}\\r\\n\\r\\n@keyframes toastOut {\\r\\n    from {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0) scale(1);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 0;\\r\\n        transform: translateY(10px) scale(0.95);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* COPY-TO-CLIPBOARD BUTTON (AI Bubble)                            */\\r\\n/*  */\\r\\n.chat-bubble-actions {\\r\\n    display: flex;\\r\\n    gap: 4px;\\r\\n    margin-top: 8px;\\r\\n    opacity: 0;\\r\\n    transition: opacity 0.2s ease;\\r\\n}\\r\\n\\r\\n.chat-msg.ai:hover .chat-bubble-actions {\\r\\n    opacity: 1;\\r\\n}\\r\\n\\r\\n.btn-copy {\\r\\n    display: inline-flex;\\r\\n    align-items: center;\\r\\n    gap: 4px;\\r\\n    padding: 3px 8px;\\r\\n    font-size: 10px;\\r\\n    font-weight: 500;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text-3);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 6px;\\r\\n    cursor: pointer;\\r\\n    transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n.btn-copy:hover {\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-glow);\\r\\n    background: var(--primary-bg);\\r\\n}\\r\\n\\r\\n.btn-copy.copied {\\r\\n    color: var(--success);\\r\\n    border-color: rgba(45, 106, 79, 0.2);\\r\\n    background: var(--success-bg);\\r\\n}\\r\\n\\r\\n.btn-copy svg {\\r\\n    width: 11px;\\r\\n    height: 11px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SMOOTH MODE CROSSFADE                                           */\\r\\n/*  */\\r\\n.mode-content {\\r\\n    animation: modeFadeIn 0.3s ease-out;\\r\\n}\\r\\n\\r\\n@keyframes modeFadeIn {\\r\\n    from {\\r\\n        opacity: 0;\\r\\n        transform: translateY(4px);\\r\\n    }\\r\\n\\r\\n    to {\\r\\n        opacity: 1;\\r\\n        transform: translateY(0);\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SCROLL-TO-BOTTOM FAB                                            */\\r\\n/*  */\\r\\n.scroll-to-bottom {\\r\\n    position: absolute;\\r\\n    bottom: 80px;\\r\\n    right: 18px;\\r\\n    width: 32px;\\r\\n    height: 32px;\\r\\n    border-radius: 50%;\\r\\n    background: var(--card);\\r\\n    border: 1px solid var(--card-border);\\r\\n    color: var(--text-2);\\r\\n    cursor: pointer;\\r\\n    display: none;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    box-shadow: var(--shadow-md);\\r\\n    z-index: 10;\\r\\n    transition: all 0.2s ease;\\r\\n    animation: fadeIn 0.2s ease-out;\\r\\n}\\r\\n\\r\\n.scroll-to-bottom:hover {\\r\\n    background: var(--primary-bg);\\r\\n    color: var(--primary);\\r\\n    border-color: var(--primary-glow);\\r\\n    transform: translateY(-2px);\\r\\n}\\r\\n\\r\\n.scroll-to-bottom.visible {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n.scroll-to-bottom svg {\\r\\n    width: 16px;\\r\\n    height: 16px;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* CHARACTER COUNT INDICATOR                                       */\\r\\n/*  */\\r\\n.char-count {\\r\\n    font-size: 10px;\\r\\n    color: var(--text-4);\\r\\n    font-weight: 500;\\r\\n    font-variant-numeric: tabular-nums;\\r\\n    transition: color 0.2s ease;\\r\\n    min-width: 28px;\\r\\n    text-align: right;\\r\\n}\\r\\n\\r\\n.char-count.warning {\\r\\n    color: var(--warning);\\r\\n}\\r\\n\\r\\n.char-count.danger {\\r\\n    color: var(--error);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* KEYBOARD SHORTCUT BADGE                                         */\\r\\n/*  */\\r\\n.kbd-hint {\\r\\n    font-size: 9px;\\r\\n    font-weight: 500;\\r\\n    color: var(--text-4);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: 4px;\\r\\n    padding: 1px 5px;\\r\\n    font-family: var(--mono);\\r\\n    letter-spacing: 0.02em;\\r\\n    pointer-events: none;\\r\\n    white-space: nowrap;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* STAGGERED SUGGESTION ANIMATION                                  */\\r\\n/*  */\\r\\n.suggestion-chip:nth-child(1) {\\r\\n    animation-delay: 0.05s;\\r\\n}\\r\\n\\r\\n.suggestion-chip:nth-child(2) {\\r\\n    animation-delay: 0.1s;\\r\\n}\\r\\n\\r\\n.suggestion-chip:nth-child(3) {\\r\\n    animation-delay: 0.15s;\\r\\n}\\r\\n\\r\\n.suggestion-chip:nth-child(4) {\\r\\n    animation-delay: 0.2s;\\r\\n}\\r\\n\\r\\n.suggestion-chip {\\r\\n    animation: msgSlideIn 0.4s cubic-bezier(0.19, 1, 0.22, 1) both;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* ENHANCED INPUT FOCUS GLOW                                       */\\r\\n/*  */\\r\\n.input-card:focus-within,\\r\\n.chat-input-card:focus-within {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 0 0 3px var(--primary-glow), var(--shadow-md);\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* SETTINGS SAVE SUCCESS ANIMATION                                 */\\r\\n/*  */\\r\\n.btn-save.saved {\\r\\n    background: var(--success);\\r\\n    box-shadow: 0 2px 8px rgba(45, 106, 79, 0.3);\\r\\n}\\r\\n\\r\\n@keyframes successPop {\\r\\n    0% {\\r\\n        transform: scale(1);\\r\\n    }\\r\\n\\r\\n    50% {\\r\\n        transform: scale(1.05);\\r\\n    }\\r\\n\\r\\n    100% {\\r\\n        transform: scale(1);\\r\\n    }\\r\\n}\\r\\n\\r\\n.btn-save.saved {\\r\\n    animation: successPop 0.3s ease;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* CHAT WELCOME STAGGER                                            */\\r\\n/*  */\\r\\n.chat-welcome img {\\r\\n    animation: fadeIn 0.5s ease-out both;\\r\\n    animation-delay: 0.1s;\\r\\n}\\r\\n\\r\\n.chat-welcome h2 {\\r\\n    animation: fadeIn 0.5s ease-out both;\\r\\n    animation-delay: 0.2s;\\r\\n}\\r\\n\\r\\n.chat-welcome .welcome-suggestions {\\r\\n    animation: fadeIn 0.5s ease-out both;\\r\\n    animation-delay: 0.3s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* RIPPLE EFFECT ON BUTTONS                                        */\\r\\n/*  */\\r\\n.btn-primary,\\r\\n.btn-send,\\r\\n.chip,\\r\\n.category-tab {\\r\\n    position: relative;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.btn-primary::after,\\r\\n.btn-send::after {\\r\\n    content: '';\\r\\n    position: absolute;\\r\\n    inset: 0;\\r\\n    background: radial-gradient(circle at var(--ripple-x, 50%) var(--ripple-y, 50%), rgba(255, 255, 255, 0.25) 0%, transparent 60%);\\r\\n    opacity: 0;\\r\\n    transition: opacity 0.4s ease;\\r\\n    pointer-events: none;\\r\\n}\\r\\n\\r\\n.btn-primary:active::after,\\r\\n.btn-send:active::after {\\r\\n    opacity: 1;\\r\\n    transition: opacity 0s;\\r\\n}\\r\\n\\r\\n\\r\\n/*  */\\r\\n/* IMPROVED DARK MODE SCROLLBAR                                    */\\r\\n/*  */\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    ::-webkit-scrollbar-thumb {\\r\\n        background: rgba(255, 255, 255, 0.12);\\r\\n    }\\r\\n\\r\\n    ::-webkit-scrollbar-thumb:hover {\\r\\n        background: rgba(255, 255, 255, 0.22);\\r\\n    }\\r\\n}\\r\\n\\r\\n/*  */\\r\\n/* BATCH PDF EXTRACTION PANEL                                      */\\r\\n/*  */\\r\\n.batch-panel {\\r\\n    margin: 10px 14px;\\r\\n    padding: 14px;\\r\\n    background: var(--card);\\r\\n    border: 1.5px solid var(--primary-glow);\\r\\n    border-radius: var(--radius-lg);\\r\\n    box-shadow: var(--shadow-md);\\r\\n    animation: slideDown 0.22s ease-out;\\r\\n}\\r\\n\\r\\n.batch-panel-header {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n    margin-bottom: 10px;\\r\\n}\\r\\n\\r\\n.batch-panel-title {\\r\\n    font-size: 12px;\\r\\n    font-weight: 700;\\r\\n    color: var(--primary);\\r\\n    letter-spacing: -0.01em;\\r\\n}\\r\\n\\r\\n.batch-file-count {\\r\\n    font-size: 11px;\\r\\n    font-weight: 600;\\r\\n    color: var(--text-3);\\r\\n    background: var(--primary-bg);\\r\\n    padding: 2px 8px;\\r\\n    border-radius: 20px;\\r\\n}\\r\\n\\r\\n.batch-instruction {\\r\\n    width: 100%;\\r\\n    padding: 9px 11px;\\r\\n    font-size: 12.5px;\\r\\n    font-family: var(--font);\\r\\n    color: var(--text);\\r\\n    background: var(--input-bg);\\r\\n    border: 1px solid var(--card-border);\\r\\n    border-radius: var(--radius);\\r\\n    outline: none;\\r\\n    resize: none;\\r\\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\\r\\n    margin-bottom: 10px;\\r\\n    line-height: 1.5;\\r\\n}\\r\\n\\r\\n.batch-instruction:focus {\\r\\n    border-color: var(--primary);\\r\\n    box-shadow: 0 0 0 3px var(--primary-glow);\\r\\n}\\r\\n\\r\\n.btn-batch-extract {\\r\\n    width: 100%;\\r\\n    justify-content: center;\\r\\n    gap: 7px;\\r\\n    font-size: 13px;\\r\\n    padding: 10px;\\r\\n    background: var(--primary);\\r\\n    color: white;\\r\\n    border: none;\\r\\n    border-radius: var(--radius);\\r\\n    cursor: pointer;\\r\\n    font-weight: 600;\\r\\n    font-family: var(--font);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    transition: all 0.2s ease-out;\\r\\n    box-shadow: 0 3px 10px rgba(45, 106, 79, 0.3);\\r\\n}\\r\\n\\r\\n.btn-batch-extract:hover {\\r\\n    background: var(--primary-hover);\\r\\n    transform: translateY(-1px);\\r\\n    box-shadow: 0 5px 16px rgba(45, 106, 79, 0.38);\\r\\n}\\r\\n\\r\\n.btn-batch-extract:disabled {\\r\\n    opacity: 0.55;\\r\\n    cursor: not-allowed;\\r\\n    transform: none;\\r\\n}\\r\\n\\r\\n.batch-progress-wrap {\\r\\n    margin-top: 12px;\\r\\n}\\r\\n\\r\\n.batch-progress-bar-track {\\r\\n    height: 6px;\\r\\n    background: var(--input-bg);\\r\\n    border-radius: 99px;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.batch-progress-bar {\\r\\n    height: 100%;\\r\\n    background: linear-gradient(90deg, var(--primary), var(--primary-light));\\r\\n    border-radius: 99px;\\r\\n    transition: width 0.4s ease-out;\\r\\n    position: relative;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.batch-progress-bar::after {\\r\\n    content: '';\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    left: -60%;\\r\\n    width: 60%;\\r\\n    height: 100%;\\r\\n    background: rgba(255, 255, 255, 0.3);\\r\\n    animation: shimmer 1.2s linear infinite;\\r\\n}\\r\\n\\r\\n@keyframes shimmer {\\r\\n    to {\\r\\n        left: 160%;\\r\\n    }\\r\\n}\\r\\n\\r\\n.batch-progress-label {\\r\\n    font-size: 11px;\\r\\n    color: var(--text-3);\\r\\n    text-align: right;\\r\\n    margin-top: 4px;\\r\\n    font-weight: 600;\\r\\n}\\r\\n\\r\\n.batch-log {\\r\\n    margin-top: 10px;\\r\\n    max-height: 100px;\\r\\n    overflow-y: auto;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    gap: 3px;\\r\\n}\\r\\n\\r\\n.batch-log-entry {\\r\\n    font-size: 11px;\\r\\n    font-family: var(--mono);\\r\\n    color: var(--text-2);\\r\\n    padding: 2px 6px;\\r\\n    border-radius: 4px;\\r\\n    display: flex;\\r\\n    gap: 6px;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.batch-log-entry.success {\\r\\n    color: var(--success);\\r\\n    background: var(--success-bg);\\r\\n}\\r\\n\\r\\n.batch-log-entry.error {\\r\\n    color: var(--error);\\r\\n    background: var(--error-bg);\\r\\n}\\r\\n\\r\\n.batch-log-entry.info {\\r\\n    color: var(--text-3);\\r\\n    background: var(--input-bg);\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"../../assets/icon-80-v2.png\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>SheetOS AI</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"preconnect\\\" href=\\\"https://fonts.googleapis.com\\\"> <link rel=\\\"preconnect\\\" href=\\\"https://fonts.gstatic.com\\\" crossorigin> <link href=\\\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap\\\" rel=\\\"stylesheet\\\"> </head> <body> <main id=\\\"app-body\\\" style=\\\"display:none\\\"> <header class=\\\"app-header\\\"> <div class=\\\"brand\\\"> <h1>SheetOS <span class=\\\"highlight-text\\\">AI</span></h1> </div> <div class=\\\"header-actions\\\"> <button id=\\\"docs-toggle\\\" class=\\\"btn-icon\\\" title=\\\"What can I do?\\\"></button> <button id=\\\"settings-toggle\\\" class=\\\"btn-icon\\\" title=\\\"Settings\\\"></button> </div> </header> <div id=\\\"docs-panel\\\" class=\\\"panel\\\" style=\\\"display:none\\\"> <h3>What can SheetOS AI do?</h3> <div class=\\\"docs-grid\\\"> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"paintbrush\\\"></span> <div><strong>Smart Formatter</strong> <p>Say \\\"make this professional\\\" and get instant clean formatting, spacing, fonts, colors, alignment</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"formula\\\"></span> <div><strong>Formula Generator</strong> <p>Describe what you need in plain English  get VLOOKUP, SUMIF, INDEX/MATCH, any formula</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"barChart\\\"></span> <div><strong>Report Automation</strong> <p>Generate monthly sales, financial, or performance reports with charts in one click</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"table\\\"></span> <div><strong>Tables & Charts</strong> <p>Create formatted tables, column/bar/line/pie charts, dashboards</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"sortAsc\\\"></span> <div><strong>Sort & Filter</strong> <p>Sort by any column, apply AutoFilter, multi-column sorting</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"checkSquare\\\"></span> <div><strong>Validation</strong> <p>Dropdown lists, number constraints, date limits, error alerts</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"trendUp\\\"></span> <div><strong>Conditional Formatting</strong> <p>Color scales, data bars, icon sets, highlight rules</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"eraser\\\"></span> <div><strong>Data Cleanup</strong> <p>Remove duplicates, trim spaces, fix formats, standardize case</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"snowflake\\\"></span> <div><strong>Freeze & Protect</strong> <p>Freeze header rows, protect sheets with custom permissions</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"columns\\\"></span> <div><strong>Worksheets</strong> <p>Add, rename, delete, copy sheets, change tab colors</p> </div> </div> <div class=\\\"doc-item\\\"><span class=\\\"doc-icon\\\" data-icon=\\\"fileTemplate\\\"></span> <div><strong>Templates</strong> <p>Budget trackers, invoices, employee lists, project trackers, grade books</p> </div> </div> </div> <p class=\\\"docs-hint\\\">Just describe what you need in plain English  SheetOS handles the rest.</p> </div> <div id=\\\"settings-panel\\\" class=\\\"panel\\\" style=\\\"display:none\\\"> <h3>AI Provider</h3> <div class=\\\"form-group\\\"> <label for=\\\"setting-provider\\\">Provider</label> <select id=\\\"setting-provider\\\" class=\\\"form-input\\\"> <option value=\\\"groq\\\">Groq (Llama)</option> <option value=\\\"gemini\\\">Google Gemini</option> <option value=\\\"openai\\\">OpenAI (GPT-4)</option> <option value=\\\"anthropic\\\">Anthropic (Claude)</option> <option value=\\\"openrouter\\\">OpenRouter</option> <option value=\\\"local\\\">Ollama (Local)</option> </select> </div> <div id=\\\"groq-fields\\\"> <div class=\\\"form-group\\\"> <label for=\\\"setting-api-key\\\">Groq API Key</label> <input id=\\\"setting-api-key\\\" type=\\\"password\\\" class=\\\"form-input\\\" placeholder=\\\"gsk_...\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"setting-groq-model\\\">Model</label> <select id=\\\"setting-groq-model\\\" class=\\\"form-input\\\"> <option value=\\\"llama-3.1-8b-instant\\\" selected=\\\"selected\\\">Llama 3.1 8B  Fast (131K TPM)</option> <option value=\\\"llama-3.3-70b-versatile\\\">Llama 3.3 70B  Smart (12K TPM)</option> <option value=\\\"gemma2-9b-it\\\">Gemma 2 9B (15K TPM)</option> <option value=\\\"mixtral-8x7b-32768\\\">Mixtral 8x7B (5K TPM)</option> </select> </div> </div> <div id=\\\"gemini-fields\\\" style=\\\"display:none\\\"> <div class=\\\"form-group\\\"> <label for=\\\"setting-gemini-key\\\">Gemini API Key</label> <input id=\\\"setting-gemini-key\\\" type=\\\"password\\\" class=\\\"form-input\\\" placeholder=\\\"AIzaSy...\\\"/> <div style=\\\"font-size:10px;color:var(--text-3);margin-top:4px\\\">Get free key at <a href=\\\"https://aistudio.google.com/app/apikey\\\" target=\\\"_blank\\\">aistudio.google.com</a></div> </div> <div class=\\\"form-group\\\"> <label for=\\\"setting-gemini-model\\\">Model</label> <select id=\\\"setting-gemini-model\\\" class=\\\"form-input\\\"> <option value=\\\"gemini-1.5-flash\\\" selected=\\\"selected\\\">Gemini 1.5 Flash (Latest)</option> <option value=\\\"gemini-1.5-flash-001\\\">Gemini 1.5 Flash-001</option> <option value=\\\"gemini-1.5-flash-002\\\">Gemini 1.5 Flash-002</option> <option value=\\\"gemini-1.5-flash-8b\\\">Gemini 1.5 Flash-8B</option> <option value=\\\"gemini-1.5-pro\\\">Gemini 1.5 Pro</option> </select> </div> </div> <div id=\\\"openai-fields\\\" style=\\\"display:none\\\"> <div class=\\\"form-group\\\"> <label for=\\\"setting-openai-key\\\">OpenAI API Key</label> <input id=\\\"setting-openai-key\\\" type=\\\"password\\\" class=\\\"form-input\\\" placeholder=\\\"sk-...\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"setting-openai-model\\\">Model</label> <select id=\\\"setting-openai-model\\\" class=\\\"form-input\\\"> <option value=\\\"gpt-4o-mini\\\" selected=\\\"selected\\\">GPT-4o Mini (Fast)</option> <option value=\\\"gpt-4o\\\">GPT-4o (Smart)</option> <option value=\\\"gpt-3.5-turbo\\\">GPT-3.5 Turbo</option> </select> </div> </div> <div id=\\\"anthropic-fields\\\" style=\\\"display:none\\\"> <div class=\\\"form-group\\\"> <label for=\\\"setting-anthropic-key\\\">Anthropic API Key</label> <input id=\\\"setting-anthropic-key\\\" type=\\\"password\\\" class=\\\"form-input\\\" placeholder=\\\"sk-ant-...\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"setting-anthropic-model\\\">Model</label> <select id=\\\"setting-anthropic-model\\\" class=\\\"form-input\\\"> <option value=\\\"claude-3-5-sonnet-20241022\\\" selected=\\\"selected\\\">Claude 3.5 Sonnet (Best for Code)</option> <option value=\\\"claude-3-5-haiku-20241022\\\">Claude 3.5 Haiku (Fast)</option> <option value=\\\"claude-3-opus-20240229\\\">Claude 3 Opus</option> </select> </div> </div> <div id=\\\"openrouter-fields\\\" style=\\\"display:none\\\"> <div class=\\\"form-group\\\"> <label for=\\\"setting-openrouter-key\\\">OpenRouter API Key</label> <input id=\\\"setting-openrouter-key\\\" type=\\\"password\\\" class=\\\"form-input\\\" placeholder=\\\"sk-or-v1-...\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"setting-openrouter-model\\\">Model</label> <select id=\\\"setting-openrouter-model\\\" class=\\\"form-input\\\"> <option value=\\\"anthropic/claude-3.5-sonnet:beta\\\" selected=\\\"selected\\\">Claude 3.5 Sonnet</option> <option value=\\\"google/gemini-2.5-pro\\\">Gemini 2.5 Pro</option> <option value=\\\"openai/gpt-4o\\\">GPT-4o</option> <option value=\\\"meta-llama/llama-3.3-70b-instruct\\\">Llama 3.3 70B</option> </select> </div> </div> <div id=\\\"local-fields\\\" style=\\\"display:none\\\"> <div class=\\\"form-group\\\"> <label for=\\\"setting-base-url\\\">Ollama Host</label> <input id=\\\"setting-base-url\\\" type=\\\"text\\\" class=\\\"form-input\\\" placeholder=\\\"http://localhost:11434\\\"/> </div> <div class=\\\"form-group\\\"> <label>Model</label> <div class=\\\"model-select-wrapper\\\"> <select id=\\\"setting-local-model\\\" class=\\\"form-input\\\"> <option value=\\\"\\\" disabled=\\\"disabled\\\" selected=\\\"selected\\\">Click refresh </option> </select> <button id=\\\"refresh-models\\\" class=\\\"btn-icon btn-refresh\\\" title=\\\"Refresh models\\\"></button> </div> <div id=\\\"model-status\\\" class=\\\"model-status\\\"></div> </div> </div> <button id=\\\"save-settings\\\" class=\\\"btn-primary btn-save\\\">Save</button> </div> <div class=\\\"mode-toggle\\\"> <button id=\\\"mode-planning\\\" class=\\\"mode-tab active\\\" data-mode=\\\"planning\\\"> <span id=\\\"mode-planning-icon\\\"></span> <span>Planning</span> </button> <button id=\\\"mode-agent\\\" class=\\\"mode-tab\\\" data-mode=\\\"agent\\\"> <span id=\\\"mode-agent-icon\\\"></span> <span>Agent</span> </button> <div class=\\\"mode-indicator\\\" id=\\\"mode-indicator\\\"></div> </div> <div id=\\\"planning-mode\\\" class=\\\"mode-content active\\\"> <div style=\\\"position:relative;flex:1;display:flex;flex-direction:column;overflow:hidden\\\"> <div id=\\\"chat-messages\\\" class=\\\"chat-messages\\\"> <div class=\\\"chat-welcome\\\"> <img src=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" alt=\\\"SheetOS Logo\\\" style=\\\"width:64px;height:64px;margin-bottom:16px\\\"> <h2>What are you working on?</h2> <div class=\\\"welcome-suggestions\\\" id=\\\"chat-suggestions\\\"> </div> </div> </div> <button id=\\\"scroll-to-bottom\\\" class=\\\"scroll-to-bottom\\\" title=\\\"Scroll to bottom\\\"> <svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"> <polyline points=\\\"6 9 12 15 18 9\\\"/> </svg> </button> </div> <div class=\\\"chat-input-area\\\"> <div id=\\\"file-preview-list\\\" class=\\\"file-preview-list\\\"></div> <div class=\\\"chat-input-card\\\"> <input type=\\\"file\\\" id=\\\"file-input\\\" accept=\\\"image/png, image/jpeg, application/pdf\\\" multiple=\\\"multiple\\\" style=\\\"display:none\\\"/> <button id=\\\"file-upload-btn\\\" class=\\\"btn-clip\\\" title=\\\"Attach Images or PDFs\\\"> <svg width=\\\"18\\\" height=\\\"18\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"> <path d=\\\"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48\\\"> </path> </svg> </button> <textarea id=\\\"chat-input\\\" placeholder=\\\"Ask or upload file...\\\" rows=\\\"1\\\" spellcheck=\\\"false\\\"></textarea> <button id=\\\"chat-send\\\" class=\\\"btn-send\\\" title=\\\"Send message\\\"> <span id=\\\"chat-send-icon\\\"></span> </button> </div> <div class=\\\"chat-footer\\\"> <button id=\\\"chat-clear\\\" class=\\\"btn-text\\\" title=\\\"Clear conversation\\\"> <span id=\\\"chat-clear-icon\\\"></span> <span>Clear</span> </button> </div> </div> </div> <div id=\\\"agent-mode\\\" class=\\\"mode-content\\\"> <div class=\\\"content-wrapper\\\"> <div class=\\\"input-card\\\"> <textarea id=\\\"prompt-input\\\" placeholder=\\\"Describe what you want to do in Excel...\\\" spellcheck=\\\"false\\\"></textarea> <div id=\\\"agent-file-preview-list\\\" class=\\\"file-preview-list\\\"></div> <div id=\\\"batch-extraction-panel\\\" class=\\\"batch-panel\\\" style=\\\"display:none\\\"> <div class=\\\"batch-panel-header\\\"> <span class=\\\"batch-panel-title\\\"> Batch PDF Extraction</span> <span id=\\\"batch-file-count\\\" class=\\\"batch-file-count\\\">0 PDFs</span> </div> <textarea id=\\\"batch-instruction\\\" class=\\\"batch-instruction\\\" placeholder=\\\"Describe what to extract, e.g: These are resumes. Extract Name, Email, Phone, Skills, and Experience.\\\" rows=\\\"2\\\"></textarea> <button id=\\\"batch-extract-btn\\\" class=\\\"btn-primary btn-batch-extract\\\"> <span id=\\\"batch-icon\\\"></span> <span id=\\\"batch-btn-text\\\">Extract All PDFs</span> </button> <div id=\\\"batch-progress-wrap\\\" class=\\\"batch-progress-wrap\\\" style=\\\"display:none\\\"> <div class=\\\"batch-progress-bar-track\\\"> <div id=\\\"batch-progress-bar\\\" class=\\\"batch-progress-bar\\\" style=\\\"width:0%\\\"></div> </div> <div id=\\\"batch-progress-label\\\" class=\\\"batch-progress-label\\\">0 / 0</div> </div> <div id=\\\"batch-log\\\" class=\\\"batch-log\\\"></div> </div> <div class=\\\"card-footer\\\"> <div class=\\\"footer-left\\\"> <input type=\\\"file\\\" id=\\\"agent-file-input\\\" accept=\\\"image/png, image/jpeg, application/pdf\\\" multiple=\\\"multiple\\\" style=\\\"display:none\\\"/> <button id=\\\"agent-file-btn\\\" class=\\\"btn-clip\\\" title=\\\"Extract from Images/PDFs\\\"> <svg width=\\\"18\\\" height=\\\"18\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"> <path d=\\\"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48\\\"> </path> </svg> </button> <span id=\\\"cache-badge\\\" class=\\\"cache-badge\\\" style=\\\"display:none\\\"> cached</span> </div> <span class=\\\"kbd-hint\\\">Ctrl+</span> <button id=\\\"run\\\" class=\\\"btn-primary\\\"> <span id=\\\"run-text\\\">Execute</span> <span id=\\\"run-icon\\\"></span> </button> </div> </div> <div class=\\\"agent-scroll-area\\\"> <div class=\\\"action-categories\\\" id=\\\"action-categories\\\"> <button class=\\\"category-tab active\\\" data-category=\\\"cleanup\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"broom\\\"></span> <span>Cleanup</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"formulas\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"formula\\\"></span> <span>Formulas</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"format\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"palette\\\"></span> <span>Format</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"reports\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"barChart\\\"></span> <span>Reports</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"templates\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"fileTemplate\\\"></span> <span>Templates</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"analysis\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"trendUp\\\"></span> <span>Analysis</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"extract\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"upload\\\"></span> <span>Extract</span> </button> <button class=\\\"category-tab\\\" data-category=\\\"smart\\\"> <span class=\\\"cat-icon\\\" data-icon=\\\"brain\\\"></span> <span>Smart Tools</span> </button> </div> <div id=\\\"schema-info\\\" class=\\\"schema-info\\\" style=\\\"display:none\\\"> <div class=\\\"schema-icon\\\"></div> <div class=\\\"schema-text\\\"> <strong>Schema-Aware Mode</strong> <span>Data will only be extracted for columns defined in Row 1 of your sheet</span> </div> <button id=\\\"detect-columns-btn\\\" class=\\\"btn-detect\\\" title=\\\"Detect column headers\\\">  Detect </button> </div> <div id=\\\"detected-columns\\\" class=\\\"detected-columns\\\" style=\\\"display:none\\\"> <div class=\\\"detected-header\\\"> <span class=\\\"detected-label\\\">Detected Columns:</span> <span id=\\\"column-count\\\" class=\\\"column-count\\\">0</span> </div> <div id=\\\"column-chips\\\" class=\\\"column-chips\\\"></div> </div> <div id=\\\"quick-actions\\\" class=\\\"quick-actions\\\"></div> <div id=\\\"skeleton\\\" class=\\\"skeleton-container\\\" style=\\\"display:none\\\"> <div class=\\\"skeleton-pill\\\"></div> <div class=\\\"skeleton-line w80\\\"></div> <div class=\\\"skeleton-line w60\\\"></div> </div> <div id=\\\"status-message\\\" class=\\\"status-pill\\\"></div> <div id=\\\"debug-section\\\"> <details> <summary> <span id=\\\"chevron-icon\\\"></span> <span>Generated Code</span> </summary> <pre id=\\\"debug-code\\\"></pre> </details> </div> </div> </div> </div> <div id=\\\"toast-container\\\" class=\\\"toast-container\\\"></div> </main> <section id=\\\"sideload-msg\\\" class=\\\"sideload-container\\\"> <div class=\\\"sideload-skeleton\\\"> <div class=\\\"sk-header\\\"> <div class=\\\"sk-brand\\\"> <div class=\\\"sk-logo sk-shimmer\\\"></div> <div class=\\\"sk-title sk-shimmer\\\"></div> </div> <div class=\\\"sk-header-actions\\\"> <div class=\\\"sk-icon-btn sk-shimmer\\\"></div> <div class=\\\"sk-icon-btn sk-shimmer\\\"></div> </div> </div> <div style=\\\"padding:0 16px\\\"> <div class=\\\"sk-mode-toggle\\\"> <div class=\\\"sk-mode-tab sk-shimmer\\\"></div> <div class=\\\"sk-mode-tab sk-shimmer\\\"></div> </div> </div> <div class=\\\"sk-welcome\\\"> <div class=\\\"sk-welcome-icon sk-shimmer\\\"></div> <div class=\\\"sk-welcome-title sk-shimmer\\\"></div> <div class=\\\"sk-welcome-desc sk-shimmer\\\"></div> <div class=\\\"sk-welcome-desc short sk-shimmer\\\"></div> </div> <div class=\\\"sk-suggestions\\\"> <div class=\\\"sk-suggestion sk-shimmer\\\"></div> <div class=\\\"sk-suggestion sk-shimmer\\\"></div> <div class=\\\"sk-suggestion sk-shimmer\\\"></div> </div> <div class=\\\"sk-input-area\\\"> <div style=\\\"padding:0 16px\\\"> <div class=\\\"sk-input sk-shimmer\\\"></div> </div> </div> <div class=\\\"sideload-status\\\"> <div class=\\\"sideload-pulse\\\"></div> <span id=\\\"loading-status\\\">Initializing SheetOS AI...</span> </div> </div> <div id=\\\"debug-fallback\\\" style=\\\"display:none;position:fixed;inset:0;background:rgba(255,255,255,.98);padding:30px;z-index:10000;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-family:'Segoe UI',system-ui,sans-serif\\\"> <div style=\\\"background:#fff5f5;border:1px solid #ffd1d1;padding:24px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.05);max-width:320px\\\"> <div style=\\\"font-size:48px;margin-bottom:16px\\\"></div> <h3 style=\\\"color:#e53e3e;margin:0 0 12px;font-size:18px\\\">Connection Blocked</h3> <p style=\\\"color:#718096;font-size:13px;line-height:1.6;margin-bottom:20px\\\"> Windows is preventing the Add-in from connecting to the local server. </p> <div style=\\\"text-align:left;background:#fff;padding:12px;border-radius:8px;border:1px solid #edf2f7;font-size:12px;margin-bottom:20px\\\"> <strong style=\\\"color:#2d3748;display:block;margin-bottom:8px\\\">Quick Fix:</strong> <ol style=\\\"margin:0;padding-left:20px;color:#4a5568\\\"> <li style=\\\"margin-bottom:6px\\\">Open <b>PowerShell</b> as Admin</li> <li style=\\\"margin-bottom:6px\\\">Paste and run this:</li> </ol> <code style=\\\"display:block;background:#f4f4f4;padding:8px;border-radius:4px;font-size:10px;word-break:break-all;margin-top:8px;color:#c53030;border:1px solid #e2e8f0\\\"> npx office-addin-dev-settings loopback --add 5552d631-21e7-4926-b20c-84c6c296efd5 </code> </div> <a href=\\\"https://localhost:3000/taskpane.html\\\" target=\\\"_blank\\\" style=\\\"display:block;background:#e53e3e;color:#fff;text-decoration:none;padding:10px;border-radius:8px;font-weight:600;font-size:13px;margin-bottom:12px\\\"> Open Debug & Trust Cert </a> <button onclick=\\\"location.reload()\\\" style=\\\"background:0 0;border:none;color:#718096;font-size:12px;cursor:pointer;text-decoration:underline\\\"> Try Refreshing </button> </div> </div> </section> <template id=\\\"chat-skeleton-template\\\"> <div class=\\\"chat-msg ai skeleton-msg\\\"> <div class=\\\"chat-bubble skeleton-bubble\\\"> <div class=\\\"skeleton-line w80 sk-shimmer\\\"></div> <div class=\\\"skeleton-line w60 sk-shimmer\\\"></div> <div class=\\\"skeleton-line w40 sk-shimmer\\\"></div> </div> </div> </template> <\" + \"script>setTimeout(function(){var e=document.getElementById(\\\"app-body\\\"),t=document.getElementById(\\\"debug-fallback\\\");e&&\\\"none\\\"!==e.style.display||!t||(t.style.display=\\\"block\\\")},3e4)<\" + \"/script> </body> </html>\";\n// Exports\nexport default code;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunksheetos_ai\"] = self[\"webpackChunksheetos_ai\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\n__webpack_require__.O(undefined, [121], function() { return __webpack_require__(31096); })\nvar __webpack_exports__ = __webpack_require__.O(undefined, [121], function() { return __webpack_require__(39046); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","options","e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","getConfig","saved","localStorage","getItem","JSON","parse","console","warn","provider","apiKey","process","GROQ_API_KEY","groqModel","localModel","sleep","ms","setTimeout","resolveModel","cfg","hasImages","undefined","model","includes","geminiModel","openaiModel","anthropicModel","openrouterModel","callGemini","_x","_x2","_x3","_x4","_callGemini","_callee","messages","signal","_data$candidates","url","contents","systemParts","payload","response","err","data","text","_context","concat","forEach","msg","role","Array","isArray","content","map","type","join","push","_contents$parts","parts","image_url","base64","split","inline_data","mime_type","generationConfig","temperature","topP","maxOutputTokens","system_instruction","fetch","method","headers","body","stringify","ok","Error","status","json","candidates","callLLM","_x5","_x6","_x7","_callLLM","_callee2","config","primaryConfig","currentConfig","_loop","_ret","attempt","_context3","_objectSpread","some","_data$choices","resp","_data$content","systemPrompt","anthropicMessages","_resp","errText","_data","_data2$choices","_resp2","_errText","_data2","_data3$choices","_resp3","_errText2","_data3","cleanContent","waitMs","_t","_context2","geminiKey","openaiKey","top_p","max_tokens","choices","message","anthropicKey","source","media_type","filter","system","substring","openrouterKey","window","location","origin","baseUrl","trim","replace","Math","pow","_regeneratorValues","fetchOllamaModels","_x8","_fetchOllamaModels","_callee3","baseHost","host","_t2","_context4","models","name","size","modified_at","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","SYSTEM_PROMPT","CACHE_KEY","CACHE_VERSION_KEY","getCache","raw","_unused2","getCachedResponse","prompt","String","removeItem","setItem","_unused","ensureCacheVersion","entries","key","toLowerCase","match","find","Date","now","timestamp","cacheResponse","filtered","trimmed","slice","setCache","COLUMN_ALIASES","extractTextFromPDF","_extractTextFromPDF","fileBuffer","loadingTask","pdf","totalPages","fullText","pageNum","page","textContent","pageText","metadata","info","pdfjsLib","promise","numPages","getPage","getTextContent","items","item","str","getMetadata","cleanExtractedText","pages","title","Title","author","Author","subject","Subject","creator","Creator","extractTextFromPDFFile","_extractTextFromPDFFile","file","arrayBuffer","_createForOfIteratorHelper","_arrayLikeToArray","toString","constructor","from","test","_unsupportedIterableToArray","_n","F","s","next","workerSrc","BANNED_PATTERNS","pattern","fix","ALLOWED_API_PATTERNS","validateCode","code","errors","warnings","apiCallsDetected","sanitizedCode","_step","_iterator","banned","suggestion","loadCalls","syncCalls","Function","syntaxError","_step2","_iterator2","isValid","createPlan","_createPlan","task","sheetContext","contextInfo","jsonMatch","hasData","sheetName","rowCount","columnCount","dataTypes","understanding","steps","dataNeeded","expectedOutput","complexity","generateCode","_x9","_generateCode","plan","attachedFiles","previousError","_i","contentParts","firstNewline","sampleData","imageUrl","startsWith","indexOf","endsWith","fixCode","_x0","_x1","_x10","_x11","_fixCode","originalCode","runtimeError","errorSummary","fixedCode","DEFAULT_CONFIG","maxRetries","enablePlanning","strictValidation","timeout","runAgent","_x12","_x13","_x14","_runAgent","_callee4","startTime","validation","retries","_t3","_args4","log","success","duration","error","executeWithRecovery","_x15","_x16","_executeWithRecovery","_callee5","executor","currentCode","lastError","_t4","_args5","_context5","aborted","DOMException","finalCode","readSheetContext","_readSheetContext","_callee7","_t5","_context8","Excel","run","_ref","_callee6","context","sheet","usedRange","values","col","_context7","workbook","worksheets","getActiveWorksheet","load","getUsedRangeOrNullObject","sync","isNullObject","h","colValues","_context6","row","every","isNaN","Number","_x17","Icons","chart","barChart","table","paintbrush","formula","sortAsc","checkSquare","trendUp","eraser","copy","columns","lock","hash","search","snowflake","check","alertCircle","arrowRight","settings","helpCircle","refresh","chevronDown","fileText","messageCircle","zap","send","stop","broom","pieChart","palette","fileTemplate","play","trash","sparkles","user","bot","upload","users","filePlus","calendar","database","clipboardList","brain","crosshair","dollarSign","shield","mail","highlight","layers","ownKeys","keys","getOwnPropertySymbols","getOwnPropertyDescriptor","_defineProperty","getOwnPropertyDescriptors","defineProperties","_typeof","toPrimitive","_toPrimitive","_toPropertyKey","currentMode","currentCategory","chatHistory","chatConversation","isChatBusy","chatAbortController","agentAbortController","rawPDFFiles","batchAbortController","CATEGORIZED_ACTIONS","cleanup","icon","label","formulas","format","reports","templates","analysis","extract","smart","CHAT_SUGGESTIONS","switchMode","mode","document","querySelectorAll","tab","classList","toggle","dataset","indicator","getElementById","add","remove","focus","buildQuickActions","container","innerHTML","actions","action","chip","createElement","className","iconKey","onclick","input","statusEl","style","display","appendChild","buildChatSuggestions","btn","sendChatMessage","updateProviderFields","setDisplay","id","show","el","loadOllamaModels","_loadOllamaModels","_document$getElementB3","select","opt","toFixed","selected","handleSaveSettings","_document$getElementB","current","getVal","_document$getElementB2","originalText","showToast","panel","_sendChatMessage","welcome","initialPrompt","overview","contextResult","hits","lastBubble","badge","skeletonEl","chatSendButton","chatSendIcon","formattedResponse","newBubble","bubbleContent","_error$message","sendIcon","stopChatGeneration","querySelector","addChatBubble","getSheetContext","height","showTypingIndicator","AbortController","formatChatResponse","createChatBubble","replaceWith","typewriterEffect","_stopChatGeneration","abort","_typewriterEffect","element","html","tokens","token","words","_iterator3","_step3","word","scrollTop","scrollHeight","random","htmlContent","rawContent","msgDiv","bubbleDiv","actionsDiv","copyBtn","navigator","clipboard","writeText","catch","execBtn","agentPromptInput","aiResponse","line","firstSentence","extractActionablePrompt","actionBar","template","oldIndicator","skeletonElement","cloneNode","firstElementChild","lines","inTable","tableHtml","processedLines","cleanCells","blocks","block","b","clearChat","toast","iconMap","_getSheetContext","query","_t6","headerRange","deepSearchContext","hitsCount","searchTerms","termsArray","_termsArray","term","foundRange","bestWord","rowData","sampleSize","sampleRange","columnTypes","_loop2","contextStr","overviewHeaders","getRow","Set","commonWords","completeMatch","matchCase","sort","getEntireRow","getIntersection","idx","header","val","address","repeat","min","getResizedRange","columnValues","getExcelColumnHeaders","_getExcelColumnHeaders","_callee8","_context9","_ref2","getRange","cell","detectAndShowColumns","_detectAndShowColumns","_callee1","detectedSection","columnChips","_t7","_context10","buildSchemaExtractionDirective","columnList","enhancedHints","columnDetails","aliases","aliasHint","buildEnhancedPrompt","runAICommand","_runAICommand","_callee11","debugEl","cacheBadge","promptInput","button","userPrompt","isSchemaMode","runText","runIcon","originalIcon","fromCache","_sheetContext","existingColumns","cached","schemaDirective","cleanPrompt","contentText","totalImages","_validation","validationAttempts","MAX_VALIDATION_FIXES","orchestratorResult","recovery","_t8","_t9","_t0","_context12","showStatus","innerText","_ref4","_callee10","candidateCode","_context11","executeExcelCode","disabled","_executeExcelCode","_callee13","_context14","_ref5","_callee12","wrappedCode","_t1","_context13","handleFileSelect","_handleFileSelect","_callee14","event","isAgent","btnId","newFiles","images","_t11","_args15","_context15","target","files","renderPdfToImages","fileToBase64","_toConsumableArray","showBatchPanel","updateFilePreview","listId","index","stopPropagation","splice","removeFile","clearFile","reject","reader","FileReader","onload","result","onerror","readAsDataURL","_renderPdfToImages","_callee15","buffer","maxPages","viewport","canvas","_context16","getViewport","scale","getContext","width","render","canvasContext","toDataURL","count","parseFieldsFromInstruction","instruction","ensureExcelHeaders","_ensureExcelHeaders","_callee17","fields","_context18","_ref6","_callee16","existing","_context17","fromCharCode","set","font","bold","fill","color","horizontalAlignment","autofitColumns","extractStructuredData","_extractStructuredData","_callee18","pdfText","userInstruction","fieldList","userMessage","cleaned","_t12","_context19","appendExcelRow","_appendExcelRow","_callee20","_context21","_ref7","_callee19","nextRow","rowValues","startCell","endCell","range","_context20","_ref8","_ref9","_data$h","k","_x18","batchLog","entry","runBatchPDFExtraction","_runBatchPDFExtraction","_callee21","_instructionEl$value","btnText","progressWrap","progressBar","progressLabel","logEl","instructionEl","pdfsToProcess","successCount","errorCount","pct","extracted","_t13","_t14","_context22","round","Office","onReady","sideloadMsg","appBody","HostType","node","getAttribute","chatMessages","scrollBtn","clearBtn","addEventListener","shiftKey","preventDefault","isNearBottom","clientHeight","scrollTo","top","behavior","ctrlKey","metaKey","_promptInput$closest","charCount","footerLeft","closest","len","setupCharCount","bindClick","handler","bindChange","onchange","click","category","schemaInfo","detectedColumns","switchCategory","providerSelect","setVal","loadSettingsUI","___CSS_LOADER_URL_IMPORT_0___","URL","___CSS_LOADER_EXPORT___","___CSS_LOADER_URL_REPLACEMENT_0___","module","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","__webpack_modules__","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","getter","__esModule","definition","get","g","globalThis","this","obj","prop","hasOwnProperty","scriptUrl","importScripts","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","baseURI","self","href","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","nc","__webpack_exports__"],"sourceRoot":""}
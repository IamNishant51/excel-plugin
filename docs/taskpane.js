/*! For license information please see taskpane.js.LICENSE.txt */
(function(){var __webpack_modules__={93942:function(e,t,n){"use strict";var r=n(71354),a=n.n(r),i=n(76314),s=n.n(i),o=n(4417),l=n.n(o),c=new URL(n(41198),n.b),d=s()(a()),h=l()(c);d.push([e.id,"/* \n * SheetOS AI — Redesigned Interface\n * A warm, human-crafted design system.\n * Forest green + terracotta. No AI-purple gradients.\n */\n\n:root {\n    /* ── Surface & Layout ── */\n    --bg: #F5F4F1;\n    --bg-gradient: radial-gradient(circle at 50% 0%, #FFFFFF, #F2F0EB);\n    --surface: #FAFAF8;\n    --card: #FFFFFF;\n    --card-border: #E3E1DC;\n    --card-hover: #F0EFEB;\n    --input-bg: #F5F4F1;\n\n    /* ── Primary: Forest Green ── */\n    --primary: #2D6A4F;\n    --primary-hover: #1B4D3E;\n    --primary-light: #74C69D;\n    --primary-bg: rgba(45, 106, 79, 0.06);\n    --primary-glow: rgba(45, 106, 79, 0.12);\n\n    /* ── Accent: Terracotta ── */\n    --accent: #C4603D;\n    --accent-hover: #A8502F;\n    --accent-bg: rgba(196, 96, 61, 0.07);\n\n    /* ── Text ── */\n    --text: #1A1C1E;\n    --text-2: #555759;\n    --text-3: #8C8E91;\n    --text-4: #C5C7CA;\n\n    /* ── Semantic ── */\n    --success: #2D6A4F;\n    --success-bg: rgba(45, 106, 79, 0.07);\n    --error: #B83A3A;\n    --error-bg: rgba(184, 58, 58, 0.07);\n    --warning: #C08B2D;\n    --warning-bg: rgba(192, 139, 45, 0.07);\n\n    /* ── Shape ── */\n    --radius: 10px;\n    --radius-lg: 14px;\n    --radius-xl: 20px;\n\n    /* ── Depth — warm tinted shadows ── */\n    --shadow-sm: 0 1px 2px rgba(30, 25, 20, 0.04);\n    --shadow: 0 2px 5px rgba(30, 25, 20, 0.05), 0 1px 2px rgba(30, 25, 20, 0.03);\n    --shadow-md: 0 4px 12px rgba(30, 25, 20, 0.06), 0 1px 3px rgba(30, 25, 20, 0.04);\n    --shadow-lg: 0 8px 24px rgba(30, 25, 20, 0.08), 0 2px 6px rgba(30, 25, 20, 0.04);\n\n    /* ── Typography ── */\n    --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n    --mono: 'JetBrains Mono', 'Cascadia Code', 'Menlo', monospace;\n\n    /* ── Chat ── */\n    --chat-user-bg: var(--primary);\n    --chat-user-text: #FFFFFF;\n    --chat-ai-bg: #F0EFEB;\n    --chat-ai-border: #E3E1DC;\n    --chat-ai-text: var(--text);\n}\n\n/* ── Dark mode ── */\n@media (prefers-color-scheme: dark) {\n    :root {\n        --bg: #141516;\n        --bg-gradient: radial-gradient(circle at 50% 0%, #1A1B1D, #0F1011);\n        --surface: #1A1B1D;\n        --card: #212224;\n        --card-border: #313335;\n        --card-hover: #2A2B2D;\n        --input-bg: #19191B;\n\n        --primary: #52B788;\n        --primary-hover: #74C69D;\n        --primary-light: #2D6A4F;\n        --primary-bg: rgba(82, 183, 136, 0.08);\n        --primary-glow: rgba(82, 183, 136, 0.14);\n\n        --accent: #E0915A;\n        --accent-hover: #EAA876;\n        --accent-bg: rgba(224, 145, 90, 0.09);\n\n        --text: #E5E3DE;\n        --text-2: #9B9D9F;\n        --text-3: #606264;\n        --text-4: #3A3C3E;\n\n        --success: #52B788;\n        --success-bg: rgba(82, 183, 136, 0.09);\n        --error: #E06060;\n        --error-bg: rgba(224, 96, 96, 0.09);\n        --warning: #E0B85A;\n        --warning-bg: rgba(224, 184, 90, 0.09);\n\n        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.18);\n        --shadow: 0 2px 5px rgba(0, 0, 0, 0.22);\n        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.28);\n        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.32);\n\n        --chat-user-bg: var(--primary);\n        --chat-user-text: #141516;\n        --chat-ai-bg: #262729;\n        --chat-ai-border: #313335;\n        --chat-ai-text: var(--text);\n    }\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* RESET & BASE                                                    */\n/* ═══════════════════════════════════════════════════════════════ */\n*, *::before, *::after { box-sizing: border-box; }\n\nhtml, body {\n    width: 100%; height: 100%;\n    margin: 0; padding: 0;\n    font-family: var(--font);\n    font-size: 13px;\n    line-height: 1.55;\n    background: var(--bg-gradient);\n    color: var(--text);\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    overflow-x: hidden;\n}\n\n#app-body {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    overflow: hidden;\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* HEADER                                                          */\n/* ═══════════════════════════════════════════════════════════════ */\n.app-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 11px 16px;\n    padding: 11px 16px;\n    background: rgba(250, 250, 248, 0.85);\n    backdrop-filter: blur(12px);\n    -webkit-backdrop-filter: blur(12px);\n    border-bottom: 1px solid var(--card-border);\n    position: sticky;\n    top: 0;\n    z-index: 20;\n}\n\n.brand {\n    display: flex;\n    align-items: center;\n    gap: 9px;\n}\n\n.logo {\n    color: var(--primary);\n    display: flex;\n    align-items: center;\n}\n\n.brand h1 {\n    font-size: 15px;\n    font-weight: 700;\n    margin: 0;\n    letter-spacing: -0.025em;\n    color: var(--text);\n}\n\n.highlight-text {\n    color: var(--primary);\n    font-weight: 700;\n    /* Solid color, not a gradient — feels hand-picked */\n}\n\n.header-actions {\n    display: flex;\n    gap: 5px;\n}\n\n\n/* ── Icon Buttons ── */\n.btn-icon {\n    width: 32px; height: 32px;\n    border: 1px solid var(--card-border);\n    border-radius: 9px;\n    background: var(--card);\n    color: var(--text-3);\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: color 0.2s ease-out, border-color 0.2s ease-out, background 0.2s ease-out;\n    padding: 0;\n}\n\n.btn-icon:hover {\n    color: var(--primary);\n    border-color: var(--primary);\n    background: var(--primary-bg);\n}\n\n.btn-icon:active {\n    transform: scale(0.95);\n}\n\n\n/* ─── Header ─── */\n.app-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 11px 16px;\n    background: var(--surface);\n    border-bottom: 1px solid var(--card-border);\n    position: sticky;\n    top: 0;\n    z-index: 20;\n}\n\n/* ... (skip unchanged) ... */\n\n/* ─── Panels (Docs / Settings) ─── */\n.panel {\n    padding: 16px;\n    background: var(--card);\n    border-bottom: 1px solid var(--card-border);\n    animation: slideDown 0.22s ease-out;\n    max-height: 80vh;\n    overflow-y: auto;\n    box-shadow: var(--shadow-md);\n}\n\n.panel h3 {\n    font-size: 11px;\n    font-weight: 700; /* Fixed from 650 */\n    text-transform: uppercase;\n    letter-spacing: 0.06em;\n    color: var(--text-3);\n    margin: 0 0 12px;\n}\n\n\n/* ── Docs Grid ── */\n.docs-grid {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.doc-item {\n    display: flex;\n    gap: 10px;\n    align-items: flex-start;\n    padding: 5px 0;\n}\n\n.doc-icon {\n    flex-shrink: 0;\n    width: 18px; height: 18px;\n    color: var(--primary);\n    display: flex;\n    align-items: center;\n    margin-top: 1px;\n}\n\n.doc-item strong {\n    font-size: 12px;\n    font-weight: 600;\n    color: var(--text);\n    display: block;\n    margin-bottom: 2px;\n}\n\n.doc-item p {\n    font-size: 11px;\n    color: var(--text-2);\n    margin: 0;\n    line-height: 1.45;\n}\n\n.docs-hint {\n    font-size: 11px;\n    color: var(--text-3);\n    margin: 12px 0 0;\n    font-style: italic;\n    line-height: 1.5;\n}\n\n\n/* ── Forms ── */\n.form-group { margin-bottom: 12px; }\n\n.form-group label {\n    display: block;\n    font-size: 11px;\n    font-weight: 600;\n    color: var(--text-3);\n    margin-bottom: 4px;\n    text-transform: uppercase;\n    letter-spacing: 0.04em;\n}\n\n.form-input {\n    width: 100%;\n    padding: 8px 11px;\n    font-size: 13px;\n    font-family: var(--font);\n    color: var(--text);\n    background: var(--input-bg);\n    border: 1px solid var(--card-border);\n    border-radius: 9px;\n    outline: none;\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\n}\n\n.form-input:focus {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\nselect.form-input {\n    cursor: pointer;\n    appearance: none;\n    background-image: url("+h+');\n    background-repeat: no-repeat;\n    background-position: right 10px center;\n    padding-right: 28px;\n}\n\n.btn-save {\n    width: 100%;\n    justify-content: center;\n    margin-top: 6px;\n}\n\n/* Model selector row */\n.model-select-wrapper {\n    display: flex;\n    gap: 5px;\n    align-items: center;\n}\n\n.model-select-wrapper .form-input {\n    flex: 1;\n    min-width: 0;\n}\n\n.btn-refresh {\n    width: 30px; height: 30px;\n    flex-shrink: 0;\n    padding: 0;\n}\n\n.model-status {\n    font-size: 11px;\n    margin-top: 4px;\n    min-height: 15px;\n    color: var(--text-3);\n}\n\n.model-status-ok  { color: var(--success); }\n.model-status-warn { color: var(--error); }\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* MODE TOGGLE                                                     */\n/* ═══════════════════════════════════════════════════════════════ */\n.mode-toggle {\n    display: flex;\n    align-items: center;\n    padding: 6px;\n    margin: 0;\n    background: var(--surface);\n    border-bottom: 1px solid var(--card-border);\n    position: relative;\n    gap: 4px;\n}\n\n.mode-tab {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 6px;\n    padding: 9px 14px;\n    font-size: 12.5px;\n    font-weight: 600;\n    font-family: var(--font);\n    color: var(--text-3);\n    background: transparent;\n    border: none;\n    border-radius: 9px;\n    cursor: pointer;\n    transition: color 0.25s ease-out;\n    position: relative;\n    z-index: 2;\n}\n\n.mode-tab:hover { color: var(--text-2); }\n.mode-tab.active { color: var(--primary); }\n.mode-tab svg { width: 14px; height: 14px; }\n\n.mode-indicator {\n    position: absolute;\n    left: 6px;\n    top: 6px;\n    width: calc(50% - 8px);\n    height: calc(100% - 12px);\n    background: var(--primary-bg);\n    border: 1px solid var(--primary-glow);\n    border-radius: 9px;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    z-index: 1;\n}\n\n.mode-indicator.right {\n    transform: translateX(calc(100% + 4px));\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* MODE CONTENT WRAPPER                                            */\n/* ═══════════════════════════════════════════════════════════════ */\n.mode-content {\n    display: none;\n    flex-direction: column;\n    flex: 1;\n    overflow: hidden;\n    animation: fadeIn 0.2s ease-out;\n}\n\n.mode-content.active { display: flex; }\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* PLANNING MODE — Chat                                            */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* ── Chat Messages Container ── */\n.chat-messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 14px 14px 6px;\n    display: flex;\n    flex-direction: column;\n    gap: 14px;\n    scroll-behavior: smooth;\n}\n\n\n/* ── Welcome Screen ── */\n.chat-welcome {\n    text-align: center;\n    padding: 28px 18px 18px;\n    animation: fadeIn 0.35s ease-out;\n}\n\n.welcome-icon {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 52px; height: 52px;\n    background: var(--primary);\n    border-radius: 16px;\n    color: white;\n    margin-bottom: 14px;\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.2);\n}\n\n.welcome-icon svg { width: 24px; height: 24px; }\n\n.chat-welcome h2 {\n    font-size: 17px;\n    font-weight: 700;\n    margin: 0 0 8px;\n    color: var(--text);\n    letter-spacing: -0.02em;\n}\n\n.chat-welcome p {\n    font-size: 12.5px;\n    color: var(--text-2);\n    margin: 0 0 18px;\n    line-height: 1.65;\n    max-width: 270px;\n    margin-left: auto;\n    margin-right: auto;\n}\n\n\n/* ── Chat Suggestions ── */\n.welcome-suggestions {\n    display: flex;\n    flex-direction: column;\n    gap: 7px;\n    max-width: 280px;\n    margin: 0 auto;\n}\n\n.suggestion-chip {\n    display: flex;\n    align-items: center;\n    gap: 9px;\n    padding: 10px 13px;\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: var(--radius);\n    font-size: 11.5px;\n    color: var(--text-2);\n    cursor: pointer;\n    transition: all 0.22s ease-out;\n    text-align: left;\n    font-family: var(--font);\n    line-height: 1.4;\n}\n\n.suggestion-chip:hover {\n    border-color: var(--primary);\n    color: var(--primary);\n    background: var(--primary-bg);\n    transform: translateX(3px);\n}\n\n.suggestion-chip svg {\n    flex-shrink: 0;\n    color: var(--primary);\n    opacity: 0.5;\n}\n\n.suggestion-chip:hover svg { opacity: 1; }\n\n\n/* ── Chat Message Bubbles ── */\n.chat-msg {\n    display: flex;\n    gap: 9px;\n    animation: msgSlideIn 0.25s ease-out;\n    max-width: 100%;\n}\n\n.chat-msg.user {\n    flex-direction: row-reverse;\n}\n\n.chat-avatar {\n    width: 28px; height: 28px;\n    border-radius: 9px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-shrink: 0;\n    font-size: 11px;\n    font-weight: 600;\n}\n\n.chat-msg.user .chat-avatar {\n    background: var(--primary);\n    color: white;\n}\n\n.chat-msg.ai .chat-avatar {\n    background: var(--primary-bg);\n    color: var(--primary);\n    border: 1px solid var(--primary-glow);\n}\n\n.chat-bubble {\n    padding: 11px 14px;\n    border-radius: var(--radius-lg);\n    font-size: 12.5px;\n    line-height: 1.65;\n    max-width: 82%;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n}\n\n.chat-msg.user .chat-bubble {\n    background: var(--chat-user-bg);\n    color: var(--chat-user-text);\n    border-bottom-right-radius: 5px;\n}\n\n.chat-msg.ai .chat-bubble {\n    background: var(--chat-ai-bg);\n    color: var(--chat-ai-text);\n    border: 1px solid var(--chat-ai-border);\n    border-bottom-left-radius: 5px;\n}\n\n\n/* ── Chat formatted text ── */\n.chat-bubble strong { font-weight: 600; }\n.chat-bubble em { font-style: italic; opacity: 0.9; }\n\n.chat-bubble code {\n    font-family: var(--mono);\n    font-size: 11px;\n    padding: 2px 5px;\n    border-radius: 5px;\n    background: rgba(0, 0, 0, 0.06);\n}\n\n.chat-msg.user .chat-bubble code {\n    background: rgba(255, 255, 255, 0.18);\n}\n\n.chat-bubble ul, .chat-bubble ol { margin: 6px 0; padding-left: 18px; }\n.chat-bubble li { margin-bottom: 3px; }\n.chat-bubble p { margin: 0 0 8px; }\n.chat-bubble p:last-child { margin: 0; }\n\n/* ── Context Badge ── */\n.context-badge {\n    display: block;\n    margin-top: 8px;\n    padding: 4px 8px;\n    font-size: 10px;\n    font-weight: 500;\n    color: rgba(255, 255, 255, 0.85);\n    background: rgba(255, 255, 255, 0.15);\n    border-radius: 6px;\n    letter-spacing: 0.2px;\n}\n\n.chat-msg.ai .context-badge {\n    color: var(--text-2);\n    background: var(--primary-bg);\n}\n\n\n/* ── Execute from Chat ── */\n.chat-action-bar {\n    display: flex;\n    gap: 6px;\n    margin-top: 10px;\n}\n\n.btn-execute-from-chat {\n    display: inline-flex;\n    align-items: center;\n    gap: 5px;\n    padding: 5px 11px;\n    font-size: 10.5px;\n    font-weight: 600;\n    font-family: var(--font);\n    background: var(--primary-bg);\n    color: var(--primary);\n    border: 1px solid var(--primary-glow);\n    border-radius: 7px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n}\n\n.btn-execute-from-chat:hover {\n    background: var(--primary);\n    color: white;\n    box-shadow: 0 2px 8px rgba(45, 106, 79, 0.25);\n}\n\n\n/* ── Typing Indicator ── */\n.typing-indicator {\n    display: flex;\n    gap: 4px;\n    align-items: center;\n    padding: 4px 0;\n}\n\n.typing-dot {\n    width: 6px; height: 6px;\n    background: var(--text-3);\n    border-radius: 50%;\n    animation: typingBounce 0.6s ease-in-out infinite;\n}\n\n.typing-dot:nth-child(2) { animation-delay: 0.15s; }\n.typing-dot:nth-child(3) { animation-delay: 0.3s; }\n\n\n/* ── Chat Input Area ── */\n.chat-input-area {\n    padding: 10px 14px 8px;\n    background: var(--surface);\n    border-top: 1px solid var(--card-border);\n}\n\n.chat-input-card {\n    display: flex;\n    align-items: flex-end;\n    gap: 7px;\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: var(--radius-lg);\n    padding: 5px 5px 5px 14px;\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\n    box-shadow: var(--shadow-sm);\n}\n\n.chat-input-card:focus-within {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\n#chat-input {\n    flex: 1;\n    border: none;\n    background: transparent;\n    font-family: var(--font);\n    font-size: 13px;\n    line-height: 1.4;\n    padding: 6px 0;\n    color: var(--text-1);\n    resize: none;\n    outline: none;\n    max-height: 120px;\n    min-height: 20px;\n}\n\n/* Agent Footer Layout */\n.card-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 12px;\n}\n.footer-left {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n/* Original btn-clip (updated) */\n.btn-clip {\n    background: none;\n    border: none;\n    color: var(--text-3);\n    cursor: pointer;\n    padding: 6px;\n    border-radius: 6px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s;\n}\n.btn-clip:hover {\n    background: var(--surface-hover);\n    color: var(--primary);\n}\n\n.file-preview {\n    background: var(--surface-2);\n    border: 1px solid var(--border);\n    border-radius: 6px;\n    padding: 6px 10px;\n    margin-bottom: 8px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 11px;\n    color: var(--text-1);\n}\n.file-thumb {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding-right: 8px;\n}\n.file-remove {\n    background: none;\n    border: none;\n    color: var(--text-3);\n    font-size: 16px;\n    cursor: pointer;\n    padding: 0 4px;\n    line-height: 1;\n}\n.file-center {\n    display: flex;\n    align-items: center;\n}\n#chat-input::placeholder { color: var(--text-3); }\n\n.btn-send {\n    width: 34px; height: 34px;\n    border: none;\n    border-radius: 9px;\n    background: var(--primary);\n    color: white;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-shrink: 0;\n    transition: background 0.2s ease-out, transform 0.15s ease-out;\n    box-shadow: 0 2px 6px rgba(45, 106, 79, 0.2);\n}\n\n.btn-send:hover {\n    background: var(--primary-hover);\n    transform: scale(1.04);\n}\n\n.btn-send:active { transform: scale(0.94); }\n\n.btn-send:disabled {\n    opacity: 0.35;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.btn-send svg { width: 14px; height: 14px; }\n\n.chat-footer {\n    display: flex;\n    justify-content: center;\n    padding: 4px 0 0;\n}\n\n/* ── File Preview List ── */\n.file-preview-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n    margin-bottom: 8px;\n    padding: 0 4px;\n}\n\n.file-chip {\n    display: inline-flex;\n    align-items: center;\n    gap: 6px;\n    background: var(--surface);\n    border: 1px solid var(--card-border);\n    border-radius: 6px;\n    padding: 4px 8px;\n    font-size: 11px;\n    color: var(--text);\n    transition: all 0.2s ease;\n    max-width: 100%;\n}\n\n.file-chip:hover {\n    border-color: var(--primary-light);\n    background: var(--card);\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-sm);\n}\n\n.file-chip-icon {\n    font-size: 12px;\n    opacity: 0.7;\n}\n\n.file-chip-name {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 140px;\n}\n\n.file-chip-remove {\n    background: none;\n    border: none;\n    cursor: pointer;\n    color: var(--text-3);\n    padding: 0 2px;\n    font-size: 14px;\n    line-height: 1;\n    display: flex;\n    align-items: center;\n    border-radius: 4px;\n    transition: color 0.2s;\n}\n\n.file-chip-remove:hover {\n    color: var(--error);\n    background: var(--error-bg);\n}\n\n/* ── Custom Scrollbar ── */\n::-webkit-scrollbar {\n    width: 6px;\n    height: 6px;\n}\n::-webkit-scrollbar-track {\n    background: transparent;\n}\n::-webkit-scrollbar-thumb {\n    background: rgba(0,0,0,0.1);\n    border-radius: 3px;\n}\n::-webkit-scrollbar-thumb:hover {\n    background: rgba(0,0,0,0.2);\n}\n@media (prefers-color-scheme: dark) {\n    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); }\n    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.25); }\n    \n    .app-header {\n        background: rgba(26, 27, 29, 0.85); /* Dark mode glass */\n    }\n}\n\n.btn-text {\n    display: inline-flex;\n    align-items: center;\n    gap: 4px;\n    padding: 5px 9px;\n    font-size: 11px;\n    font-weight: 500;\n    font-family: var(--font);\n    color: var(--text-3);\n    background: transparent;\n    border: none;\n    cursor: pointer;\n    border-radius: 7px;\n    transition: color 0.15s, background 0.15s;\n}\n\n.btn-text:hover {\n    color: var(--error);\n    background: var(--error-bg);\n}\n\n.btn-text svg { width: 12px; height: 12px; }\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* AGENT MODE                                                      */\n/* ═══════════════════════════════════════════════════════════════ */\n.content-wrapper {\n    flex: 1;\n    padding: 14px;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    width: 100%;\n    overflow-y: auto;\n}\n\n\n/* ── Category Tabs ── */\n.action-categories {\n    display: flex;\n    gap: 5px;\n    overflow-x: auto;\n    padding: 2px 0;\n    scrollbar-width: none;\n}\n\n.action-categories::-webkit-scrollbar { display: none; }\n\n.category-tab {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    padding: 7px 11px;\n    font-size: 11px;\n    font-weight: 600;\n    font-family: var(--font);\n    color: var(--text-3);\n    background: transparent;\n    border: 1px solid transparent;\n    border-radius: 9px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n    white-space: nowrap;\n    flex-shrink: 0;\n}\n\n.category-tab:hover {\n    color: var(--text-2);\n    background: var(--card);\n}\n\n.category-tab.active {\n    color: var(--primary);\n    background: var(--primary-bg);\n    border-color: var(--primary-glow);\n}\n\n.category-tab svg { width: 12px; height: 12px; }\n\n\n/* ── Schema Info Banner (Extract Mode) ── */\n.schema-info {\n    display: flex;\n    align-items: flex-start;\n    gap: 10px;\n    padding: 10px 12px;\n    margin-bottom: 10px;\n    background: linear-gradient(135deg, var(--primary-bg), rgba(74, 144, 226, 0.06));\n    border: 1px solid var(--primary-glow);\n    border-radius: 10px;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.schema-icon {\n    font-size: 18px;\n    line-height: 1;\n    flex-shrink: 0;\n}\n\n.schema-text {\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.schema-text strong {\n    font-size: 11.5px;\n    font-weight: 600;\n    color: var(--primary);\n}\n\n.schema-text span {\n    font-size: 10.5px;\n    color: var(--text-2);\n    line-height: 1.4;\n}\n\n.btn-detect {\n    padding: 5px 10px;\n    font-size: 10px;\n    font-weight: 600;\n    font-family: var(--font);\n    color: var(--primary);\n    background: var(--card);\n    border: 1px solid var(--primary-glow);\n    border-radius: 6px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n    flex-shrink: 0;\n    margin-left: auto;\n}\n\n.btn-detect:hover {\n    background: var(--primary-bg);\n    transform: translateY(-1px);\n}\n\n.btn-detect:active {\n    transform: scale(0.96);\n}\n\n/* ── Detected Columns Preview ── */\n.detected-columns {\n    padding: 10px 12px;\n    margin-bottom: 10px;\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: 10px;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.detected-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8px;\n}\n\n.detected-label {\n    font-size: 10.5px;\n    font-weight: 600;\n    color: var(--text-2);\n}\n\n.column-count {\n    font-size: 10px;\n    font-weight: 700;\n    color: var(--primary);\n    background: var(--primary-bg);\n    padding: 2px 8px;\n    border-radius: 10px;\n}\n\n.column-chips {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 4px;\n}\n\n.column-chip {\n    padding: 3px 8px;\n    font-size: 10px;\n    font-weight: 500;\n    color: var(--text-2);\n    background: var(--input-bg);\n    border: 1px solid var(--card-border);\n    border-radius: 6px;\n}\n\n.column-chip.empty-warning {\n    color: var(--warning);\n    background: var(--warning-bg);\n    border-color: rgba(192, 139, 45, 0.2);\n}\n\n/* ── Extract Category Highlight ── */\n.category-tab[data-category="extract"].active {\n    color: #C4603D;\n    background: rgba(196, 96, 61, 0.08);\n    border-color: rgba(196, 96, 61, 0.15);\n}\n\n.category-tab[data-category="extract"]:hover {\n    color: #A8502F;\n}\n\n\n/* ── Quick Action Chips ── */\n.quick-actions {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n}\n\n.chip {\n    display: inline-flex;\n    align-items: center;\n    gap: 5px;\n    padding: 6px 11px;\n    font-size: 11px;\n    font-weight: 500;\n    font-family: var(--font);\n    color: var(--text-2);\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: 20px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n    white-space: nowrap;\n}\n\n.chip:hover {\n    color: var(--primary);\n    border-color: var(--primary);\n    background: var(--primary-bg);\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-sm);\n}\n\n.chip:active {\n    transform: scale(0.96) translateY(0);\n}\n\n.chip svg { width: 12px; height: 12px; flex-shrink: 0; }\n\n\n/* ── Input Card (Agent) ── */\n.input-card {\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: var(--radius-lg);\n    display: flex;\n    flex-direction: column;\n    box-shadow: var(--shadow);\n    overflow: hidden;\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\n}\n\n.input-card:focus-within {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\ntextarea {\n    width: 100%;\n    min-height: 84px;\n    padding: 12px 14px;\n    background: transparent;\n    border: none;\n    color: var(--text);\n    font-family: var(--font);\n    font-size: 13px;\n    line-height: 1.6;\n    resize: vertical;\n    outline: none;\n}\n\ntextarea::placeholder {\n    color: var(--text-3);\n    opacity: 0.85;\n}\n\n.card-footer {\n    padding: 8px 12px;\n    border-top: 1px solid var(--card-border);\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    gap: 8px;\n}\n\n\n/* ── Cache Badge ── */\n.cache-badge {\n    font-size: 10.5px;\n    font-weight: 600;\n    color: var(--success);\n    background: var(--success-bg);\n    padding: 3px 9px;\n    border-radius: 10px;\n    animation: fadeIn 0.2s;\n}\n\n\n/* ── Primary Button ── */\n.btn-primary {\n    background: var(--primary);\n    color: white;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 9px;\n    font-size: 12px;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    transition: background 0.2s ease-out, transform 0.15s ease-out, box-shadow 0.2s ease-out;\n    box-shadow: 0 2px 6px rgba(45, 106, 79, 0.2);\n}\n\n.btn-primary:hover {\n    background: var(--primary-hover);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.25);\n}\n\n.btn-primary:active {\n    transform: translateY(0);\n}\n\n.btn-primary:disabled {\n    opacity: 0.4;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.btn-primary svg { width: 13px; height: 13px; }\n\n\n/* ── Skeleton Loading ── */\n.skeleton-container {\n    display: flex;\n    flex-direction: column;\n    gap: 9px;\n    padding: 4px 0;\n}\n\n.skeleton-pill {\n    width: 140px;\n    height: 28px;\n    border-radius: 9px;\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.6s ease-in-out infinite;\n}\n\n.skeleton-line {\n    height: 13px;\n    border-radius: 5px;\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.6s ease-in-out infinite;\n}\n\n.skeleton-line.w80 { width: 80%; }\n.skeleton-line.w60 { width: 60%; }\n\n\n/* ── Status Pill ── */\n.status-pill {\n    padding: 9px 13px;\n    border-radius: var(--radius);\n    font-size: 12px;\n    font-weight: 500;\n    display: none;\n    align-items: center;\n    gap: 7px;\n    animation: fadeIn 0.2s;\n    border: 1px solid transparent;\n}\n\n.status-pill.info {\n    background: var(--primary-bg);\n    color: var(--primary);\n    border-color: var(--primary-glow);\n}\n\n.status-pill.success {\n    background: var(--success-bg);\n    color: var(--success);\n    border-color: rgba(45, 106, 79, 0.12);\n}\n\n.status-pill.error {\n    background: var(--error-bg);\n    color: var(--error);\n    border-color: rgba(184, 58, 58, 0.12);\n}\n\n\n/* ── Spinners ── */\n.spinner {\n    width: 14px; height: 14px;\n    border: 2px solid transparent;\n    border-radius: 50%;\n    border-top-color: currentColor;\n    border-right-color: currentColor;\n    animation: spin 0.7s linear infinite;\n}\n\n.btn-spinner {\n    width: 13px; height: 13px;\n    border: 2px solid rgba(255, 255, 255, 0.3);\n    border-radius: 50%;\n    border-top-color: white;\n    animation: spin 0.7s linear infinite;\n    display: inline-block;\n}\n\n\n/* ── Debug Section ── */\n#debug-section {\n    margin-top: auto;\n    padding-top: 8px;\n}\n\ndetails {\n    background: transparent;\n    border: none;\n    border-radius: var(--radius);\n}\n\nsummary {\n    padding: 5px 0;\n    cursor: pointer;\n    font-size: 11px;\n    font-weight: 600;\n    color: var(--text-3);\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    list-style: none;\n    user-select: none;\n    transition: color 0.15s;\n}\n\nsummary::-webkit-details-marker { display: none; }\nsummary:hover { color: var(--text-2); }\ndetails[open] summary svg { transform: rotate(180deg); }\nsummary svg { transition: transform 0.15s; }\ndetails[open] summary { margin-bottom: 5px; }\n\npre {\n    margin: 0;\n    padding: 11px;\n    background: var(--input-bg);\n    color: var(--text-2);\n    font-family: var(--mono);\n    font-size: 11px;\n    overflow-x: auto;\n    border: 1px solid var(--card-border);\n    border-radius: 9px;\n    line-height: 1.55;\n    white-space: pre-wrap;\n    word-break: break-all;\n    max-height: 180px;\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* SIDELOAD — Skeleton Loading Screen                              */\n/* ═══════════════════════════════════════════════════════════════ */\n.sideload-container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    background: var(--bg);\n    overflow: hidden;\n}\n\n.sideload-skeleton {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.sk-shimmer {\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.8s ease-in-out infinite;\n    border-radius: 7px;\n}\n\n.sk-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 13px 16px;\n    border-bottom: 1px solid var(--card-border);\n}\n\n.sk-brand { display: flex; align-items: center; gap: 9px; }\n.sk-logo { width: 24px; height: 24px; border-radius: 7px; }\n.sk-title { width: 105px; height: 15px; border-radius: 5px; }\n.sk-header-actions { display: flex; gap: 5px; }\n.sk-icon-btn { width: 32px; height: 32px; border-radius: 9px; }\n\n.sk-mode-toggle {\n    display: flex;\n    gap: 4px;\n    padding: 8px 6px;\n    border-bottom: 1px solid var(--card-border);\n}\n\n.sk-mode-tab { flex: 1; height: 36px; border-radius: 9px; }\n\n.sk-welcome {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 34px 20px 18px;\n    gap: 11px;\n}\n\n.sk-welcome-icon { width: 52px; height: 52px; border-radius: 16px; }\n.sk-welcome-title { width: 145px; height: 19px; border-radius: 6px; }\n.sk-welcome-desc { width: 220px; height: 13px; border-radius: 5px; }\n.sk-welcome-desc.short { width: 175px; }\n\n.sk-suggestions {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    padding: 10px 32px;\n}\n\n.sk-suggestion { width: 100%; height: 38px; border-radius: 10px; }\n.sk-suggestion:nth-child(2) { animation-delay: 0.1s; }\n.sk-suggestion:nth-child(3) { animation-delay: 0.2s; }\n.sk-suggestion:nth-child(4) { animation-delay: 0.3s; }\n\n.sk-input-area {\n    margin-top: auto;\n    padding: 12px 16px 8px;\n    border-top: 1px solid var(--card-border);\n}\n\n.sk-input { width: 100%; height: 42px; border-radius: 14px; }\n\n.sideload-status {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 9px;\n    padding: 11px;\n    font-size: 11.5px;\n    font-weight: 500;\n    color: var(--text-3);\n}\n\n.sideload-pulse {\n    width: 8px; height: 8px;\n    border-radius: 50%;\n    background: var(--primary);\n    animation: pulse 1.5s ease-in-out infinite;\n    box-shadow: 0 0 8px var(--primary-glow);\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* KEYFRAMES                                                       */\n/* ═══════════════════════════════════════════════════════════════ */\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(3px); }\n    to   { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes slideDown {\n    from { opacity: 0; transform: translateY(-6px); }\n    to   { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n\n@keyframes shimmer {\n    0%   { background-position: 200% 0; }\n    100% { background-position: -200% 0; }\n}\n\n@keyframes msgSlideIn {\n    from { opacity: 0; transform: translateY(6px); }\n    to   { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes typingBounce {\n    0%, 100% { transform: translateY(0); opacity: 0.4; }\n    50%      { transform: translateY(-4px); opacity: 1; }\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 0.4; transform: scale(0.85); }\n    50%      { opacity: 1; transform: scale(1.15); }\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* SCROLLBAR & SCROLL FIXES                                        */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* LOADING / SKELETON SCREENS                                      */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* Sideload Container */\n.sideload-container {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: var(--bg);\n    z-index: 9999;\n    display: flex;\n    flex-direction: column;\n    padding: 20px;\n    align-items: center;\n    justify-content: center;\n}\n\n/* Skeleton Base */\n.sideload-skeleton {\n    width: 100%;\n    max-width: 320px;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    opacity: 0.8;\n}\n\n/* Shimmer Animation Class */\n.sk-shimmer {\n    background: #e0e0e0;\n    background-image: linear-gradient(\n        to right,\n        #e0e0e0 0%,\n        #f0f0f0 20%,\n        #e0e0e0 40%,\n        #e0e0e0 100%\n    );\n    background-repeat: no-repeat;\n    background-size: 800px 100%;\n    animation: shimmer 1.5s infinite linear; \n    border-radius: 6px;\n}\n\n/* Specific Skeleton Elements */\n.sk-header { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 10px; }\n.sk-brand { display: flex; align-items: center; gap: 10px; }\n.sk-logo { width: 32px; height: 32px; border-radius: 8px; }\n.sk-title { width: 100px; height: 20px; }\n.sk-header-actions { display: flex; gap: 8px; }\n.sk-icon-btn { width: 28px; height: 28px; border-radius: 50%; }\n\n.sk-mode-toggle { display: flex; gap: 4px; background: var(--surface); padding: 4px; border-radius: 12px; margin-bottom: 20px; }\n.sk-mode-tab { flex: 1; height: 36px; border-radius: 8px; opacity: 0.7; }\n\n.sk-welcome { display: flex; flex-direction: column; align-items: center; gap: 12px; margin-top: 20px; text-align: center; }\n.sk-welcome-icon { width: 48px; height: 48px; border-radius: 12px; }\n.sk-welcome-title { width: 180px; height: 24px; }\n.sk-welcome-desc { width: 240px; height: 16px; margin-bottom: 4px; }\n.sk-welcome-desc.short { width: 160px; }\n\n.sk-suggestions { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 30px; }\n.sk-suggestion { width: 140px; height: 32px; border-radius: 16px; }\n\n.sk-input-area { width: 100%; margin-top: auto; padding-top: 40px; }\n.sk-input { width: 100%; height: 50px; border-radius: 12px; }\n\n/* Status Text */\n.sideload-status {\n    position: absolute;\n    bottom: 30px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 8px;\n    font-size: 11px;\n    color: var(--text-3);\n    font-weight: 500;\n} \n.sideload-pulse {\n    width: 6px; height: 6px;\n    background: var(--primary);\n    border-radius: 50%;\n    animation: pulse 1s infinite;\n}\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* SCROLLBAR & SCROLL FIXES                                        */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* Ensure main content areas scroll properly */\n.content-wrapper, .chat-messages {\n    flex: 1;\n    overflow-y: auto !important;\n    min-height: 0; /* Critical for flex child scrolling */\n    padding-bottom: 40px; /* Extra space at bottom */\n    scroll-behavior: smooth;\n    -webkit-overflow-scrolling: touch;\n}\n\n/* Ensure parent containers occupy full height but don\'t scroll themselves */\n#agent-mode, #planning-mode {\n    display: none; /* Hide by default */\n    height: 100%;\n    overflow: hidden; /* Prevent body scroll */\n    flex-direction: column;\n}\n#agent-mode.active, #planning-mode.active {\n    display: flex; /* Show when active */\n}\n\n/* Scrollbar Visually */\n::-webkit-scrollbar { width: 6px; height: 6px; }\n::-webkit-scrollbar-track { background: transparent; }\n::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.15); border-radius: 4px; }\n::-webkit-scrollbar-thumb:hover { background: rgba(0, 0, 0, 0.3); }\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* PRODUCTION OPTIMIZATIONS (RESPONSIVE & PERFORMANCE)             */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* 1. Hardware Acceleration for Animations */\n.chat-msg, .panel, .sideload-container {\n    will-change: transform, opacity;\n    backface-visibility: hidden; /* sharpen animations */\n    transform: translateZ(0);     /* trigger GPU */\n}\n\n.chip, .category-tab, .btn-icon {\n    transform: translateZ(0); \n}\n\n/* 2. Responsive Tweaks for Narrow Taskpanes (< 360px) */\n@media (max-width: 360px) {\n    :root {\n        --radius-lg: 10px; /* Tighter corners */\n    }\n\n    .app-header { padding: 8px 12px; }\n    \n    .chat-bubble {\n        font-size: 11.5px;\n        padding: 8px 12px;\n        max-width: 88%;\n    }\n    \n    .chip {\n        font-size: 10px;\n        padding: 5px 9px;\n    }\n    \n    .category-tab {\n        padding: 5px 9px;\n        font-size: 10px;\n    }\n    \n    /* Stack form groups tighter */\n    .form-group { margin-bottom: 10px; }\n    \n    /* Ensure code blocks don\'t overflow */\n    .chat-bubble pre { \n        font-size: 10px; \n        padding: 8px;\n    }\n}\n\n/* 3. High-DPI Screens (Retina) Text Sharpness */\n@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {\n    body {\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n    }\n}',"",{version:3,sources:["webpack://./src/taskpane/taskpane.css"],names:[],mappings:"AAAA;;;;EAIE;;AAEF;IACI,2BAA2B;IAC3B,aAAa;IACb,kEAAkE;IAClE,kBAAkB;IAClB,eAAe;IACf,sBAAsB;IACtB,qBAAqB;IACrB,mBAAmB;;IAEnB,gCAAgC;IAChC,kBAAkB;IAClB,wBAAwB;IACxB,wBAAwB;IACxB,qCAAqC;IACrC,uCAAuC;;IAEvC,6BAA6B;IAC7B,iBAAiB;IACjB,uBAAuB;IACvB,oCAAoC;;IAEpC,eAAe;IACf,eAAe;IACf,iBAAiB;IACjB,iBAAiB;IACjB,iBAAiB;;IAEjB,mBAAmB;IACnB,kBAAkB;IAClB,qCAAqC;IACrC,gBAAgB;IAChB,mCAAmC;IACnC,kBAAkB;IAClB,sCAAsC;;IAEtC,gBAAgB;IAChB,cAAc;IACd,iBAAiB;IACjB,iBAAiB;;IAEjB,sCAAsC;IACtC,6CAA6C;IAC7C,4EAA4E;IAC5E,gFAAgF;IAChF,gFAAgF;;IAEhF,qBAAqB;IACrB,qFAAqF;IACrF,6DAA6D;;IAE7D,eAAe;IACf,8BAA8B;IAC9B,yBAAyB;IACzB,qBAAqB;IACrB,yBAAyB;IACzB,2BAA2B;AAC/B;;AAEA,oBAAoB;AACpB;IACI;QACI,aAAa;QACb,kEAAkE;QAClE,kBAAkB;QAClB,eAAe;QACf,sBAAsB;QACtB,qBAAqB;QACrB,mBAAmB;;QAEnB,kBAAkB;QAClB,wBAAwB;QACxB,wBAAwB;QACxB,sCAAsC;QACtC,wCAAwC;;QAExC,iBAAiB;QACjB,uBAAuB;QACvB,qCAAqC;;QAErC,eAAe;QACf,iBAAiB;QACjB,iBAAiB;QACjB,iBAAiB;;QAEjB,kBAAkB;QAClB,sCAAsC;QACtC,gBAAgB;QAChB,mCAAmC;QACnC,kBAAkB;QAClB,sCAAsC;;QAEtC,0CAA0C;QAC1C,uCAAuC;QACvC,2CAA2C;QAC3C,2CAA2C;;QAE3C,8BAA8B;QAC9B,yBAAyB;QACzB,qBAAqB;QACrB,yBAAyB;QACzB,2BAA2B;IAC/B;AACJ;;;AAGA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE,yBAAyB,sBAAsB,EAAE;;AAEjD;IACI,WAAW,EAAE,YAAY;IACzB,SAAS,EAAE,UAAU;IACrB,wBAAwB;IACxB,eAAe;IACf,iBAAiB;IACjB,8BAA8B;IAC9B,kBAAkB;IAClB,mCAAmC;IACnC,kCAAkC;IAClC,kBAAkB;AACtB;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,aAAa;IACb,gBAAgB;AACpB;;;AAGA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE;IACI,aAAa;IACb,mBAAmB;IACnB,8BAA8B;IAC9B,kBAAkB;IAClB,kBAAkB;IAClB,qCAAqC;IACrC,2BAA2B;IAC3B,mCAAmC;IACnC,2CAA2C;IAC3C,gBAAgB;IAChB,MAAM;IACN,WAAW;AACf;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,QAAQ;AACZ;;AAEA;IACI,qBAAqB;IACrB,aAAa;IACb,mBAAmB;AACvB;;AAEA;IACI,eAAe;IACf,gBAAgB;IAChB,SAAS;IACT,wBAAwB;IACxB,kBAAkB;AACtB;;AAEA;IACI,qBAAqB;IACrB,gBAAgB;IAChB,oDAAoD;AACxD;;AAEA;IACI,aAAa;IACb,QAAQ;AACZ;;;AAGA,uBAAuB;AACvB;IACI,WAAW,EAAE,YAAY;IACzB,oCAAoC;IACpC,kBAAkB;IAClB,uBAAuB;IACvB,oBAAoB;IACpB,eAAe;IACf,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,qFAAqF;IACrF,UAAU;AACd;;AAEA;IACI,qBAAqB;IACrB,4BAA4B;IAC5B,6BAA6B;AACjC;;AAEA;IACI,sBAAsB;AAC1B;;;AAGA,mBAAmB;AACnB;IACI,aAAa;IACb,mBAAmB;IACnB,8BAA8B;IAC9B,kBAAkB;IAClB,0BAA0B;IAC1B,2CAA2C;IAC3C,gBAAgB;IAChB,MAAM;IACN,WAAW;AACf;;AAEA,6BAA6B;;AAE7B,qCAAqC;AACrC;IACI,aAAa;IACb,uBAAuB;IACvB,2CAA2C;IAC3C,mCAAmC;IACnC,gBAAgB;IAChB,gBAAgB;IAChB,4BAA4B;AAChC;;AAEA;IACI,eAAe;IACf,gBAAgB,EAAE,mBAAmB;IACrC,yBAAyB;IACzB,sBAAsB;IACtB,oBAAoB;IACpB,gBAAgB;AACpB;;;AAGA,oBAAoB;AACpB;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;AACZ;;AAEA;IACI,aAAa;IACb,SAAS;IACT,uBAAuB;IACvB,cAAc;AAClB;;AAEA;IACI,cAAc;IACd,WAAW,EAAE,YAAY;IACzB,qBAAqB;IACrB,aAAa;IACb,mBAAmB;IACnB,eAAe;AACnB;;AAEA;IACI,eAAe;IACf,gBAAgB;IAChB,kBAAkB;IAClB,cAAc;IACd,kBAAkB;AACtB;;AAEA;IACI,eAAe;IACf,oBAAoB;IACpB,SAAS;IACT,iBAAiB;AACrB;;AAEA;IACI,eAAe;IACf,oBAAoB;IACpB,gBAAgB;IAChB,kBAAkB;IAClB,gBAAgB;AACpB;;;AAGA,gBAAgB;AAChB,cAAc,mBAAmB,EAAE;;AAEnC;IACI,cAAc;IACd,eAAe;IACf,gBAAgB;IAChB,oBAAoB;IACpB,kBAAkB;IAClB,yBAAyB;IACzB,sBAAsB;AAC1B;;AAEA;IACI,WAAW;IACX,iBAAiB;IACjB,eAAe;IACf,wBAAwB;IACxB,kBAAkB;IAClB,2BAA2B;IAC3B,oCAAoC;IACpC,kBAAkB;IAClB,aAAa;IACb,gEAAgE;AACpE;;AAEA;IACI,4BAA4B;IAC5B,yCAAyC;AAC7C;;AAEA;IACI,eAAe;IACf,gBAAgB;IAChB,yDAAoO;IACpO,4BAA4B;IAC5B,sCAAsC;IACtC,mBAAmB;AACvB;;AAEA;IACI,WAAW;IACX,uBAAuB;IACvB,eAAe;AACnB;;AAEA,uBAAuB;AACvB;IACI,aAAa;IACb,QAAQ;IACR,mBAAmB;AACvB;;AAEA;IACI,OAAO;IACP,YAAY;AAChB;;AAEA;IACI,WAAW,EAAE,YAAY;IACzB,cAAc;IACd,UAAU;AACd;;AAEA;IACI,eAAe;IACf,eAAe;IACf,gBAAgB;IAChB,oBAAoB;AACxB;;AAEA,oBAAoB,qBAAqB,EAAE;AAC3C,qBAAqB,mBAAmB,EAAE;;;AAG1C,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE;IACI,aAAa;IACb,mBAAmB;IACnB,YAAY;IACZ,SAAS;IACT,0BAA0B;IAC1B,2CAA2C;IAC3C,kBAAkB;IAClB,QAAQ;AACZ;;AAEA;IACI,OAAO;IACP,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,QAAQ;IACR,iBAAiB;IACjB,iBAAiB;IACjB,gBAAgB;IAChB,wBAAwB;IACxB,oBAAoB;IACpB,uBAAuB;IACvB,YAAY;IACZ,kBAAkB;IAClB,eAAe;IACf,gCAAgC;IAChC,kBAAkB;IAClB,UAAU;AACd;;AAEA,kBAAkB,oBAAoB,EAAE;AACxC,mBAAmB,qBAAqB,EAAE;AAC1C,gBAAgB,WAAW,EAAE,YAAY,EAAE;;AAE3C;IACI,kBAAkB;IAClB,SAAS;IACT,QAAQ;IACR,sBAAsB;IACtB,yBAAyB;IACzB,6BAA6B;IAC7B,qCAAqC;IACrC,kBAAkB;IAClB,uDAAuD;IACvD,UAAU;AACd;;AAEA;IACI,uCAAuC;AAC3C;;;AAGA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE;IACI,aAAa;IACb,sBAAsB;IACtB,OAAO;IACP,gBAAgB;IAChB,+BAA+B;AACnC;;AAEA,uBAAuB,aAAa,EAAE;;;AAGtC,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;;AAEpE,kCAAkC;AAClC;IACI,OAAO;IACP,gBAAgB;IAChB,sBAAsB;IACtB,aAAa;IACb,sBAAsB;IACtB,SAAS;IACT,uBAAuB;AAC3B;;;AAGA,yBAAyB;AACzB;IACI,kBAAkB;IAClB,uBAAuB;IACvB,gCAAgC;AACpC;;AAEA;IACI,oBAAoB;IACpB,mBAAmB;IACnB,uBAAuB;IACvB,WAAW,EAAE,YAAY;IACzB,0BAA0B;IAC1B,mBAAmB;IACnB,YAAY;IACZ,mBAAmB;IACnB,6CAA6C;AACjD;;AAEA,oBAAoB,WAAW,EAAE,YAAY,EAAE;;AAE/C;IACI,eAAe;IACf,gBAAgB;IAChB,eAAe;IACf,kBAAkB;IAClB,uBAAuB;AAC3B;;AAEA;IACI,iBAAiB;IACjB,oBAAoB;IACpB,gBAAgB;IAChB,iBAAiB;IACjB,gBAAgB;IAChB,iBAAiB;IACjB,kBAAkB;AACtB;;;AAGA,2BAA2B;AAC3B;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;IACR,gBAAgB;IAChB,cAAc;AAClB;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,kBAAkB;IAClB,uBAAuB;IACvB,oCAAoC;IACpC,4BAA4B;IAC5B,iBAAiB;IACjB,oBAAoB;IACpB,eAAe;IACf,8BAA8B;IAC9B,gBAAgB;IAChB,wBAAwB;IACxB,gBAAgB;AACpB;;AAEA;IACI,4BAA4B;IAC5B,qBAAqB;IACrB,6BAA6B;IAC7B,0BAA0B;AAC9B;;AAEA;IACI,cAAc;IACd,qBAAqB;IACrB,YAAY;AAChB;;AAEA,6BAA6B,UAAU,EAAE;;;AAGzC,+BAA+B;AAC/B;IACI,aAAa;IACb,QAAQ;IACR,oCAAoC;IACpC,eAAe;AACnB;;AAEA;IACI,2BAA2B;AAC/B;;AAEA;IACI,WAAW,EAAE,YAAY;IACzB,kBAAkB;IAClB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,cAAc;IACd,eAAe;IACf,gBAAgB;AACpB;;AAEA;IACI,0BAA0B;IAC1B,YAAY;AAChB;;AAEA;IACI,6BAA6B;IAC7B,qBAAqB;IACrB,qCAAqC;AACzC;;AAEA;IACI,kBAAkB;IAClB,+BAA+B;IAC/B,iBAAiB;IACjB,iBAAiB;IACjB,cAAc;IACd,qBAAqB;IACrB,yBAAyB;AAC7B;;AAEA;IACI,+BAA+B;IAC/B,4BAA4B;IAC5B,+BAA+B;AACnC;;AAEA;IACI,6BAA6B;IAC7B,0BAA0B;IAC1B,uCAAuC;IACvC,8BAA8B;AAClC;;;AAGA,8BAA8B;AAC9B,sBAAsB,gBAAgB,EAAE;AACxC,kBAAkB,kBAAkB,EAAE,YAAY,EAAE;;AAEpD;IACI,wBAAwB;IACxB,eAAe;IACf,gBAAgB;IAChB,kBAAkB;IAClB,+BAA+B;AACnC;;AAEA;IACI,qCAAqC;AACzC;;AAEA,mCAAmC,aAAa,EAAE,kBAAkB,EAAE;AACtE,kBAAkB,kBAAkB,EAAE;AACtC,iBAAiB,eAAe,EAAE;AAClC,4BAA4B,SAAS,EAAE;;AAEvC,wBAAwB;AACxB;IACI,cAAc;IACd,eAAe;IACf,gBAAgB;IAChB,eAAe;IACf,gBAAgB;IAChB,gCAAgC;IAChC,qCAAqC;IACrC,kBAAkB;IAClB,qBAAqB;AACzB;;AAEA;IACI,oBAAoB;IACpB,6BAA6B;AACjC;;;AAGA,4BAA4B;AAC5B;IACI,aAAa;IACb,QAAQ;IACR,gBAAgB;AACpB;;AAEA;IACI,oBAAoB;IACpB,mBAAmB;IACnB,QAAQ;IACR,iBAAiB;IACjB,iBAAiB;IACjB,gBAAgB;IAChB,wBAAwB;IACxB,6BAA6B;IAC7B,qBAAqB;IACrB,qCAAqC;IACrC,kBAAkB;IAClB,eAAe;IACf,6BAA6B;AACjC;;AAEA;IACI,0BAA0B;IAC1B,YAAY;IACZ,6CAA6C;AACjD;;;AAGA,2BAA2B;AAC3B;IACI,aAAa;IACb,QAAQ;IACR,mBAAmB;IACnB,cAAc;AAClB;;AAEA;IACI,UAAU,EAAE,WAAW;IACvB,yBAAyB;IACzB,kBAAkB;IAClB,iDAAiD;AACrD;;AAEA,2BAA2B,sBAAsB,EAAE;AACnD,2BAA2B,qBAAqB,EAAE;;;AAGlD,0BAA0B;AAC1B;IACI,sBAAsB;IACtB,0BAA0B;IAC1B,wCAAwC;AAC5C;;AAEA;IACI,aAAa;IACb,qBAAqB;IACrB,QAAQ;IACR,uBAAuB;IACvB,oCAAoC;IACpC,+BAA+B;IAC/B,yBAAyB;IACzB,gEAAgE;IAChE,4BAA4B;AAChC;;AAEA;IACI,4BAA4B;IAC5B,yCAAyC;AAC7C;;AAEA;IACI,OAAO;IACP,YAAY;IACZ,uBAAuB;IACvB,wBAAwB;IACxB,eAAe;IACf,gBAAgB;IAChB,cAAc;IACd,oBAAoB;IACpB,YAAY;IACZ,aAAa;IACb,iBAAiB;IACjB,gBAAgB;AACpB;;AAEA,wBAAwB;AACxB;IACI,aAAa;IACb,8BAA8B;IAC9B,mBAAmB;IACnB,gBAAgB;AACpB;AACA;EACE,aAAa;EACb,mBAAmB;EACnB,QAAQ;AACV;;AAEA,gCAAgC;AAChC;IACI,gBAAgB;IAChB,YAAY;IACZ,oBAAoB;IACpB,eAAe;IACf,YAAY;IACZ,kBAAkB;IAClB,oBAAoB;IACpB,mBAAmB;IACnB,uBAAuB;IACvB,oBAAoB;AACxB;AACA;IACI,gCAAgC;IAChC,qBAAqB;AACzB;;AAEA;IACI,4BAA4B;IAC5B,+BAA+B;IAC/B,kBAAkB;IAClB,iBAAiB;IACjB,kBAAkB;IAClB,aAAa;IACb,mBAAmB;IACnB,8BAA8B;IAC9B,eAAe;IACf,oBAAoB;AACxB;AACA;IACI,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,kBAAkB;AACtB;AACA;IACI,gBAAgB;IAChB,YAAY;IACZ,oBAAoB;IACpB,eAAe;IACf,eAAe;IACf,cAAc;IACd,cAAc;AAClB;AACA;IACI,aAAa;IACb,mBAAmB;AACvB;AACA,2BAA2B,oBAAoB,EAAE;;AAEjD;IACI,WAAW,EAAE,YAAY;IACzB,YAAY;IACZ,kBAAkB;IAClB,0BAA0B;IAC1B,YAAY;IACZ,eAAe;IACf,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,cAAc;IACd,8DAA8D;IAC9D,4CAA4C;AAChD;;AAEA;IACI,gCAAgC;IAChC,sBAAsB;AAC1B;;AAEA,mBAAmB,sBAAsB,EAAE;;AAE3C;IACI,aAAa;IACb,mBAAmB;IACnB,eAAe;AACnB;;AAEA,gBAAgB,WAAW,EAAE,YAAY,EAAE;;AAE3C;IACI,aAAa;IACb,uBAAuB;IACvB,gBAAgB;AACpB;;AAEA,4BAA4B;AAC5B;IACI,aAAa;IACb,eAAe;IACf,QAAQ;IACR,kBAAkB;IAClB,cAAc;AAClB;;AAEA;IACI,oBAAoB;IACpB,mBAAmB;IACnB,QAAQ;IACR,0BAA0B;IAC1B,oCAAoC;IACpC,kBAAkB;IAClB,gBAAgB;IAChB,eAAe;IACf,kBAAkB;IAClB,yBAAyB;IACzB,eAAe;AACnB;;AAEA;IACI,kCAAkC;IAClC,uBAAuB;IACvB,2BAA2B;IAC3B,4BAA4B;AAChC;;AAEA;IACI,eAAe;IACf,YAAY;AAChB;;AAEA;IACI,mBAAmB;IACnB,gBAAgB;IAChB,uBAAuB;IACvB,gBAAgB;AACpB;;AAEA;IACI,gBAAgB;IAChB,YAAY;IACZ,eAAe;IACf,oBAAoB;IACpB,cAAc;IACd,eAAe;IACf,cAAc;IACd,aAAa;IACb,mBAAmB;IACnB,kBAAkB;IAClB,sBAAsB;AAC1B;;AAEA;IACI,mBAAmB;IACnB,2BAA2B;AAC/B;;AAEA,2BAA2B;AAC3B;IACI,UAAU;IACV,WAAW;AACf;AACA;IACI,uBAAuB;AAC3B;AACA;IACI,2BAA2B;IAC3B,kBAAkB;AACtB;AACA;IACI,2BAA2B;AAC/B;AACA;IACI,4BAA4B,kCAAkC,EAAE;IAChE,kCAAkC,kCAAkC,EAAE;;IAEtE;QACI,kCAAkC,EAAE,oBAAoB;IAC5D;AACJ;;AAEA;IACI,oBAAoB;IACpB,mBAAmB;IACnB,QAAQ;IACR,gBAAgB;IAChB,eAAe;IACf,gBAAgB;IAChB,wBAAwB;IACxB,oBAAoB;IACpB,uBAAuB;IACvB,YAAY;IACZ,eAAe;IACf,kBAAkB;IAClB,yCAAyC;AAC7C;;AAEA;IACI,mBAAmB;IACnB,2BAA2B;AAC/B;;AAEA,gBAAgB,WAAW,EAAE,YAAY,EAAE;;;AAG3C,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE;IACI,OAAO;IACP,aAAa;IACb,aAAa;IACb,sBAAsB;IACtB,SAAS;IACT,WAAW;IACX,gBAAgB;AACpB;;;AAGA,wBAAwB;AACxB;IACI,aAAa;IACb,QAAQ;IACR,gBAAgB;IAChB,cAAc;IACd,qBAAqB;AACzB;;AAEA,wCAAwC,aAAa,EAAE;;AAEvD;IACI,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,iBAAiB;IACjB,eAAe;IACf,gBAAgB;IAChB,wBAAwB;IACxB,oBAAoB;IACpB,uBAAuB;IACvB,6BAA6B;IAC7B,kBAAkB;IAClB,eAAe;IACf,6BAA6B;IAC7B,mBAAmB;IACnB,cAAc;AAClB;;AAEA;IACI,oBAAoB;IACpB,uBAAuB;AAC3B;;AAEA;IACI,qBAAqB;IACrB,6BAA6B;IAC7B,iCAAiC;AACrC;;AAEA,oBAAoB,WAAW,EAAE,YAAY,EAAE;;;AAG/C,4CAA4C;AAC5C;IACI,aAAa;IACb,uBAAuB;IACvB,SAAS;IACT,kBAAkB;IAClB,mBAAmB;IACnB,gFAAgF;IAChF,qCAAqC;IACrC,mBAAmB;IACnB,+BAA+B;AACnC;;AAEA;IACI,eAAe;IACf,cAAc;IACd,cAAc;AAClB;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;AACZ;;AAEA;IACI,iBAAiB;IACjB,gBAAgB;IAChB,qBAAqB;AACzB;;AAEA;IACI,iBAAiB;IACjB,oBAAoB;IACpB,gBAAgB;AACpB;;AAEA;IACI,iBAAiB;IACjB,eAAe;IACf,gBAAgB;IAChB,wBAAwB;IACxB,qBAAqB;IACrB,uBAAuB;IACvB,qCAAqC;IACrC,kBAAkB;IAClB,eAAe;IACf,6BAA6B;IAC7B,cAAc;IACd,iBAAiB;AACrB;;AAEA;IACI,6BAA6B;IAC7B,2BAA2B;AAC/B;;AAEA;IACI,sBAAsB;AAC1B;;AAEA,mCAAmC;AACnC;IACI,kBAAkB;IAClB,mBAAmB;IACnB,uBAAuB;IACvB,oCAAoC;IACpC,mBAAmB;IACnB,+BAA+B;AACnC;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,8BAA8B;IAC9B,kBAAkB;AACtB;;AAEA;IACI,iBAAiB;IACjB,gBAAgB;IAChB,oBAAoB;AACxB;;AAEA;IACI,eAAe;IACf,gBAAgB;IAChB,qBAAqB;IACrB,6BAA6B;IAC7B,gBAAgB;IAChB,mBAAmB;AACvB;;AAEA;IACI,aAAa;IACb,eAAe;IACf,QAAQ;AACZ;;AAEA;IACI,gBAAgB;IAChB,eAAe;IACf,gBAAgB;IAChB,oBAAoB;IACpB,2BAA2B;IAC3B,oCAAoC;IACpC,kBAAkB;AACtB;;AAEA;IACI,qBAAqB;IACrB,6BAA6B;IAC7B,qCAAqC;AACzC;;AAEA,qCAAqC;AACrC;IACI,cAAc;IACd,mCAAmC;IACnC,qCAAqC;AACzC;;AAEA;IACI,cAAc;AAClB;;;AAGA,6BAA6B;AAC7B;IACI,aAAa;IACb,eAAe;IACf,QAAQ;AACZ;;AAEA;IACI,oBAAoB;IACpB,mBAAmB;IACnB,QAAQ;IACR,iBAAiB;IACjB,eAAe;IACf,gBAAgB;IAChB,wBAAwB;IACxB,oBAAoB;IACpB,uBAAuB;IACvB,oCAAoC;IACpC,mBAAmB;IACnB,eAAe;IACf,6BAA6B;IAC7B,mBAAmB;AACvB;;AAEA;IACI,qBAAqB;IACrB,4BAA4B;IAC5B,6BAA6B;IAC7B,2BAA2B;IAC3B,4BAA4B;AAChC;;AAEA;IACI,oCAAoC;AACxC;;AAEA,YAAY,WAAW,EAAE,YAAY,EAAE,cAAc,EAAE;;;AAGvD,6BAA6B;AAC7B;IACI,uBAAuB;IACvB,oCAAoC;IACpC,+BAA+B;IAC/B,aAAa;IACb,sBAAsB;IACtB,yBAAyB;IACzB,gBAAgB;IAChB,gEAAgE;AACpE;;AAEA;IACI,4BAA4B;IAC5B,yCAAyC;AAC7C;;AAEA;IACI,WAAW;IACX,gBAAgB;IAChB,kBAAkB;IAClB,uBAAuB;IACvB,YAAY;IACZ,kBAAkB;IAClB,wBAAwB;IACxB,eAAe;IACf,gBAAgB;IAChB,gBAAgB;IAChB,aAAa;AACjB;;AAEA;IACI,oBAAoB;IACpB,aAAa;AACjB;;AAEA;IACI,iBAAiB;IACjB,wCAAwC;IACxC,aAAa;IACb,yBAAyB;IACzB,mBAAmB;IACnB,QAAQ;AACZ;;;AAGA,sBAAsB;AACtB;IACI,iBAAiB;IACjB,gBAAgB;IAChB,qBAAqB;IACrB,6BAA6B;IAC7B,gBAAgB;IAChB,mBAAmB;IACnB,sBAAsB;AAC1B;;;AAGA,yBAAyB;AACzB;IACI,0BAA0B;IAC1B,YAAY;IACZ,YAAY;IACZ,iBAAiB;IACjB,kBAAkB;IAClB,eAAe;IACf,gBAAgB;IAChB,eAAe;IACf,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,wFAAwF;IACxF,4CAA4C;AAChD;;AAEA;IACI,gCAAgC;IAChC,2BAA2B;IAC3B,8CAA8C;AAClD;;AAEA;IACI,wBAAwB;AAC5B;;AAEA;IACI,YAAY;IACZ,mBAAmB;IACnB,eAAe;AACnB;;AAEA,mBAAmB,WAAW,EAAE,YAAY,EAAE;;;AAG9C,2BAA2B;AAC3B;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;IACR,cAAc;AAClB;;AAEA;IACI,YAAY;IACZ,YAAY;IACZ,kBAAkB;IAClB,uGAAuG;IACvG,0BAA0B;IAC1B,4CAA4C;AAChD;;AAEA;IACI,YAAY;IACZ,kBAAkB;IAClB,uGAAuG;IACvG,0BAA0B;IAC1B,4CAA4C;AAChD;;AAEA,qBAAqB,UAAU,EAAE;AACjC,qBAAqB,UAAU,EAAE;;;AAGjC,sBAAsB;AACtB;IACI,iBAAiB;IACjB,4BAA4B;IAC5B,eAAe;IACf,gBAAgB;IAChB,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,sBAAsB;IACtB,6BAA6B;AACjC;;AAEA;IACI,6BAA6B;IAC7B,qBAAqB;IACrB,iCAAiC;AACrC;;AAEA;IACI,6BAA6B;IAC7B,qBAAqB;IACrB,qCAAqC;AACzC;;AAEA;IACI,2BAA2B;IAC3B,mBAAmB;IACnB,qCAAqC;AACzC;;;AAGA,mBAAmB;AACnB;IACI,WAAW,EAAE,YAAY;IACzB,6BAA6B;IAC7B,kBAAkB;IAClB,8BAA8B;IAC9B,gCAAgC;IAChC,oCAAoC;AACxC;;AAEA;IACI,WAAW,EAAE,YAAY;IACzB,0CAA0C;IAC1C,kBAAkB;IAClB,uBAAuB;IACvB,oCAAoC;IACpC,qBAAqB;AACzB;;;AAGA,wBAAwB;AACxB;IACI,gBAAgB;IAChB,gBAAgB;AACpB;;AAEA;IACI,uBAAuB;IACvB,YAAY;IACZ,4BAA4B;AAChC;;AAEA;IACI,cAAc;IACd,eAAe;IACf,eAAe;IACf,gBAAgB;IAChB,oBAAoB;IACpB,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,gBAAgB;IAChB,iBAAiB;IACjB,uBAAuB;AAC3B;;AAEA,kCAAkC,aAAa,EAAE;AACjD,gBAAgB,oBAAoB,EAAE;AACtC,4BAA4B,yBAAyB,EAAE;AACvD,cAAc,2BAA2B,EAAE;AAC3C,wBAAwB,kBAAkB,EAAE;;AAE5C;IACI,SAAS;IACT,aAAa;IACb,2BAA2B;IAC3B,oBAAoB;IACpB,wBAAwB;IACxB,eAAe;IACf,gBAAgB;IAChB,oCAAoC;IACpC,kBAAkB;IAClB,iBAAiB;IACjB,qBAAqB;IACrB,qBAAqB;IACrB,iBAAiB;AACrB;;;AAGA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE;IACI,aAAa;IACb,aAAa;IACb,sBAAsB;IACtB,qBAAqB;IACrB,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,WAAW;IACX,YAAY;IACZ,+BAA+B;AACnC;;AAEA;IACI,uGAAuG;IACvG,0BAA0B;IAC1B,4CAA4C;IAC5C,kBAAkB;AACtB;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,8BAA8B;IAC9B,kBAAkB;IAClB,2CAA2C;AAC/C;;AAEA,YAAY,aAAa,EAAE,mBAAmB,EAAE,QAAQ,EAAE;AAC1D,WAAW,WAAW,EAAE,YAAY,EAAE,kBAAkB,EAAE;AAC1D,YAAY,YAAY,EAAE,YAAY,EAAE,kBAAkB,EAAE;AAC5D,qBAAqB,aAAa,EAAE,QAAQ,EAAE;AAC9C,eAAe,WAAW,EAAE,YAAY,EAAE,kBAAkB,EAAE;;AAE9D;IACI,aAAa;IACb,QAAQ;IACR,gBAAgB;IAChB,2CAA2C;AAC/C;;AAEA,eAAe,OAAO,EAAE,YAAY,EAAE,kBAAkB,EAAE;;AAE1D;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,uBAAuB;IACvB,SAAS;AACb;;AAEA,mBAAmB,WAAW,EAAE,YAAY,EAAE,mBAAmB,EAAE;AACnE,oBAAoB,YAAY,EAAE,YAAY,EAAE,kBAAkB,EAAE;AACpE,mBAAmB,YAAY,EAAE,YAAY,EAAE,kBAAkB,EAAE;AACnE,yBAAyB,YAAY,EAAE;;AAEvC;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;IACR,kBAAkB;AACtB;;AAEA,iBAAiB,WAAW,EAAE,YAAY,EAAE,mBAAmB,EAAE;AACjE,8BAA8B,qBAAqB,EAAE;AACrD,8BAA8B,qBAAqB,EAAE;AACrD,8BAA8B,qBAAqB,EAAE;;AAErD;IACI,gBAAgB;IAChB,sBAAsB;IACtB,wCAAwC;AAC5C;;AAEA,YAAY,WAAW,EAAE,YAAY,EAAE,mBAAmB,EAAE;;AAE5D;IACI,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,QAAQ;IACR,aAAa;IACb,iBAAiB;IACjB,gBAAgB;IAChB,oBAAoB;AACxB;;AAEA;IACI,UAAU,EAAE,WAAW;IACvB,kBAAkB;IAClB,0BAA0B;IAC1B,0CAA0C;IAC1C,uCAAuC;AAC3C;;;AAGA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;AACpE;IACI,OAAO,UAAU,EAAE,0BAA0B,EAAE;IAC/C,OAAO,UAAU,EAAE,wBAAwB,EAAE;AACjD;;AAEA;IACI,OAAO,UAAU,EAAE,2BAA2B,EAAE;IAChD,OAAO,UAAU,EAAE,wBAAwB,EAAE;AACjD;;AAEA;IACI,KAAK,yBAAyB,EAAE;AACpC;;AAEA;IACI,OAAO,2BAA2B,EAAE;IACpC,OAAO,4BAA4B,EAAE;AACzC;;AAEA;IACI,OAAO,UAAU,EAAE,0BAA0B,EAAE;IAC/C,OAAO,UAAU,EAAE,wBAAwB,EAAE;AACjD;;AAEA;IACI,WAAW,wBAAwB,EAAE,YAAY,EAAE;IACnD,WAAW,2BAA2B,EAAE,UAAU,EAAE;AACxD;;AAEA;IACI,WAAW,YAAY,EAAE,sBAAsB,EAAE;IACjD,WAAW,UAAU,EAAE,sBAAsB,EAAE;AACnD;;;AAGA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;;AAEpE,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;;AAEpE,uBAAuB;AACvB;IACI,eAAe;IACf,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS;IACpC,qBAAqB;IACrB,aAAa;IACb,aAAa;IACb,sBAAsB;IACtB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;AAC3B;;AAEA,kBAAkB;AAClB;IACI,WAAW;IACX,gBAAgB;IAChB,aAAa;IACb,sBAAsB;IACtB,SAAS;IACT,YAAY;AAChB;;AAEA,4BAA4B;AAC5B;IACI,mBAAmB;IACnB;;;;;;KAMC;IACD,4BAA4B;IAC5B,2BAA2B;IAC3B,uCAAuC;IACvC,kBAAkB;AACtB;;AAEA,+BAA+B;AAC/B,aAAa,aAAa,EAAE,8BAA8B,EAAE,mBAAmB,EAAE,WAAW,EAAE,mBAAmB,EAAE;AACnH,YAAY,aAAa,EAAE,mBAAmB,EAAE,SAAS,EAAE;AAC3D,WAAW,WAAW,EAAE,YAAY,EAAE,kBAAkB,EAAE;AAC1D,YAAY,YAAY,EAAE,YAAY,EAAE;AACxC,qBAAqB,aAAa,EAAE,QAAQ,EAAE;AAC9C,eAAe,WAAW,EAAE,YAAY,EAAE,kBAAkB,EAAE;;AAE9D,kBAAkB,aAAa,EAAE,QAAQ,EAAE,0BAA0B,EAAE,YAAY,EAAE,mBAAmB,EAAE,mBAAmB,EAAE;AAC/H,eAAe,OAAO,EAAE,YAAY,EAAE,kBAAkB,EAAE,YAAY,EAAE;;AAExE,cAAc,aAAa,EAAE,sBAAsB,EAAE,mBAAmB,EAAE,SAAS,EAAE,gBAAgB,EAAE,kBAAkB,EAAE;AAC3H,mBAAmB,WAAW,EAAE,YAAY,EAAE,mBAAmB,EAAE;AACnE,oBAAoB,YAAY,EAAE,YAAY,EAAE;AAChD,mBAAmB,YAAY,EAAE,YAAY,EAAE,kBAAkB,EAAE;AACnE,yBAAyB,YAAY,EAAE;;AAEvC,kBAAkB,aAAa,EAAE,eAAe,EAAE,QAAQ,EAAE,uBAAuB,EAAE,gBAAgB,EAAE;AACvG,iBAAiB,YAAY,EAAE,YAAY,EAAE,mBAAmB,EAAE;;AAElE,iBAAiB,WAAW,EAAE,gBAAgB,EAAE,iBAAiB,EAAE;AACnE,YAAY,WAAW,EAAE,YAAY,EAAE,mBAAmB,EAAE;;AAE5D,gBAAgB;AAChB;IACI,kBAAkB;IAClB,YAAY;IACZ,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,QAAQ;IACR,eAAe;IACf,oBAAoB;IACpB,gBAAgB;AACpB;AACA;IACI,UAAU,EAAE,WAAW;IACvB,0BAA0B;IAC1B,kBAAkB;IAClB,4BAA4B;AAChC;;AAEA,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;;AAEpE,8CAA8C;AAC9C;IACI,OAAO;IACP,2BAA2B;IAC3B,aAAa,EAAE,sCAAsC;IACrD,oBAAoB,EAAE,0BAA0B;IAChD,uBAAuB;IACvB,iCAAiC;AACrC;;AAEA,4EAA4E;AAC5E;IACI,aAAa,EAAE,oBAAoB;IACnC,YAAY;IACZ,gBAAgB,EAAE,wBAAwB;IAC1C,sBAAsB;AAC1B;AACA;IACI,aAAa,EAAE,qBAAqB;AACxC;;AAEA,uBAAuB;AACvB,sBAAsB,UAAU,EAAE,WAAW,EAAE;AAC/C,4BAA4B,uBAAuB,EAAE;AACrD,4BAA4B,+BAA+B,EAAE,kBAAkB,EAAE;AACjF,kCAAkC,8BAA8B,EAAE;;AAElE,oEAAoE;AACpE,oEAAoE;AACpE,oEAAoE;;AAEpE,4CAA4C;AAC5C;IACI,+BAA+B;IAC/B,2BAA2B,EAAE,uBAAuB;IACpD,wBAAwB,MAAM,gBAAgB;AAClD;;AAEA;IACI,wBAAwB;AAC5B;;AAEA,wDAAwD;AACxD;IACI;QACI,iBAAiB,EAAE,oBAAoB;IAC3C;;IAEA,cAAc,iBAAiB,EAAE;;IAEjC;QACI,iBAAiB;QACjB,iBAAiB;QACjB,cAAc;IAClB;;IAEA;QACI,eAAe;QACf,gBAAgB;IACpB;;IAEA;QACI,gBAAgB;QAChB,eAAe;IACnB;;IAEA,8BAA8B;IAC9B,cAAc,mBAAmB,EAAE;;IAEnC,sCAAsC;IACtC;QACI,eAAe;QACf,YAAY;IAChB;AACJ;;AAEA,gDAAgD;AAChD;IACI;QACI,mCAAmC;QACnC,kCAAkC;IACtC;AACJ",sourcesContent:["/* \n * SheetOS AI — Redesigned Interface\n * A warm, human-crafted design system.\n * Forest green + terracotta. No AI-purple gradients.\n */\n\n:root {\n    /* ── Surface & Layout ── */\n    --bg: #F5F4F1;\n    --bg-gradient: radial-gradient(circle at 50% 0%, #FFFFFF, #F2F0EB);\n    --surface: #FAFAF8;\n    --card: #FFFFFF;\n    --card-border: #E3E1DC;\n    --card-hover: #F0EFEB;\n    --input-bg: #F5F4F1;\n\n    /* ── Primary: Forest Green ── */\n    --primary: #2D6A4F;\n    --primary-hover: #1B4D3E;\n    --primary-light: #74C69D;\n    --primary-bg: rgba(45, 106, 79, 0.06);\n    --primary-glow: rgba(45, 106, 79, 0.12);\n\n    /* ── Accent: Terracotta ── */\n    --accent: #C4603D;\n    --accent-hover: #A8502F;\n    --accent-bg: rgba(196, 96, 61, 0.07);\n\n    /* ── Text ── */\n    --text: #1A1C1E;\n    --text-2: #555759;\n    --text-3: #8C8E91;\n    --text-4: #C5C7CA;\n\n    /* ── Semantic ── */\n    --success: #2D6A4F;\n    --success-bg: rgba(45, 106, 79, 0.07);\n    --error: #B83A3A;\n    --error-bg: rgba(184, 58, 58, 0.07);\n    --warning: #C08B2D;\n    --warning-bg: rgba(192, 139, 45, 0.07);\n\n    /* ── Shape ── */\n    --radius: 10px;\n    --radius-lg: 14px;\n    --radius-xl: 20px;\n\n    /* ── Depth — warm tinted shadows ── */\n    --shadow-sm: 0 1px 2px rgba(30, 25, 20, 0.04);\n    --shadow: 0 2px 5px rgba(30, 25, 20, 0.05), 0 1px 2px rgba(30, 25, 20, 0.03);\n    --shadow-md: 0 4px 12px rgba(30, 25, 20, 0.06), 0 1px 3px rgba(30, 25, 20, 0.04);\n    --shadow-lg: 0 8px 24px rgba(30, 25, 20, 0.08), 0 2px 6px rgba(30, 25, 20, 0.04);\n\n    /* ── Typography ── */\n    --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n    --mono: 'JetBrains Mono', 'Cascadia Code', 'Menlo', monospace;\n\n    /* ── Chat ── */\n    --chat-user-bg: var(--primary);\n    --chat-user-text: #FFFFFF;\n    --chat-ai-bg: #F0EFEB;\n    --chat-ai-border: #E3E1DC;\n    --chat-ai-text: var(--text);\n}\n\n/* ── Dark mode ── */\n@media (prefers-color-scheme: dark) {\n    :root {\n        --bg: #141516;\n        --bg-gradient: radial-gradient(circle at 50% 0%, #1A1B1D, #0F1011);\n        --surface: #1A1B1D;\n        --card: #212224;\n        --card-border: #313335;\n        --card-hover: #2A2B2D;\n        --input-bg: #19191B;\n\n        --primary: #52B788;\n        --primary-hover: #74C69D;\n        --primary-light: #2D6A4F;\n        --primary-bg: rgba(82, 183, 136, 0.08);\n        --primary-glow: rgba(82, 183, 136, 0.14);\n\n        --accent: #E0915A;\n        --accent-hover: #EAA876;\n        --accent-bg: rgba(224, 145, 90, 0.09);\n\n        --text: #E5E3DE;\n        --text-2: #9B9D9F;\n        --text-3: #606264;\n        --text-4: #3A3C3E;\n\n        --success: #52B788;\n        --success-bg: rgba(82, 183, 136, 0.09);\n        --error: #E06060;\n        --error-bg: rgba(224, 96, 96, 0.09);\n        --warning: #E0B85A;\n        --warning-bg: rgba(224, 184, 90, 0.09);\n\n        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.18);\n        --shadow: 0 2px 5px rgba(0, 0, 0, 0.22);\n        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.28);\n        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.32);\n\n        --chat-user-bg: var(--primary);\n        --chat-user-text: #141516;\n        --chat-ai-bg: #262729;\n        --chat-ai-border: #313335;\n        --chat-ai-text: var(--text);\n    }\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* RESET & BASE                                                    */\n/* ═══════════════════════════════════════════════════════════════ */\n*, *::before, *::after { box-sizing: border-box; }\n\nhtml, body {\n    width: 100%; height: 100%;\n    margin: 0; padding: 0;\n    font-family: var(--font);\n    font-size: 13px;\n    line-height: 1.55;\n    background: var(--bg-gradient);\n    color: var(--text);\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    overflow-x: hidden;\n}\n\n#app-body {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    overflow: hidden;\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* HEADER                                                          */\n/* ═══════════════════════════════════════════════════════════════ */\n.app-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 11px 16px;\n    padding: 11px 16px;\n    background: rgba(250, 250, 248, 0.85);\n    backdrop-filter: blur(12px);\n    -webkit-backdrop-filter: blur(12px);\n    border-bottom: 1px solid var(--card-border);\n    position: sticky;\n    top: 0;\n    z-index: 20;\n}\n\n.brand {\n    display: flex;\n    align-items: center;\n    gap: 9px;\n}\n\n.logo {\n    color: var(--primary);\n    display: flex;\n    align-items: center;\n}\n\n.brand h1 {\n    font-size: 15px;\n    font-weight: 700;\n    margin: 0;\n    letter-spacing: -0.025em;\n    color: var(--text);\n}\n\n.highlight-text {\n    color: var(--primary);\n    font-weight: 700;\n    /* Solid color, not a gradient — feels hand-picked */\n}\n\n.header-actions {\n    display: flex;\n    gap: 5px;\n}\n\n\n/* ── Icon Buttons ── */\n.btn-icon {\n    width: 32px; height: 32px;\n    border: 1px solid var(--card-border);\n    border-radius: 9px;\n    background: var(--card);\n    color: var(--text-3);\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: color 0.2s ease-out, border-color 0.2s ease-out, background 0.2s ease-out;\n    padding: 0;\n}\n\n.btn-icon:hover {\n    color: var(--primary);\n    border-color: var(--primary);\n    background: var(--primary-bg);\n}\n\n.btn-icon:active {\n    transform: scale(0.95);\n}\n\n\n/* ─── Header ─── */\n.app-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 11px 16px;\n    background: var(--surface);\n    border-bottom: 1px solid var(--card-border);\n    position: sticky;\n    top: 0;\n    z-index: 20;\n}\n\n/* ... (skip unchanged) ... */\n\n/* ─── Panels (Docs / Settings) ─── */\n.panel {\n    padding: 16px;\n    background: var(--card);\n    border-bottom: 1px solid var(--card-border);\n    animation: slideDown 0.22s ease-out;\n    max-height: 80vh;\n    overflow-y: auto;\n    box-shadow: var(--shadow-md);\n}\n\n.panel h3 {\n    font-size: 11px;\n    font-weight: 700; /* Fixed from 650 */\n    text-transform: uppercase;\n    letter-spacing: 0.06em;\n    color: var(--text-3);\n    margin: 0 0 12px;\n}\n\n\n/* ── Docs Grid ── */\n.docs-grid {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.doc-item {\n    display: flex;\n    gap: 10px;\n    align-items: flex-start;\n    padding: 5px 0;\n}\n\n.doc-icon {\n    flex-shrink: 0;\n    width: 18px; height: 18px;\n    color: var(--primary);\n    display: flex;\n    align-items: center;\n    margin-top: 1px;\n}\n\n.doc-item strong {\n    font-size: 12px;\n    font-weight: 600;\n    color: var(--text);\n    display: block;\n    margin-bottom: 2px;\n}\n\n.doc-item p {\n    font-size: 11px;\n    color: var(--text-2);\n    margin: 0;\n    line-height: 1.45;\n}\n\n.docs-hint {\n    font-size: 11px;\n    color: var(--text-3);\n    margin: 12px 0 0;\n    font-style: italic;\n    line-height: 1.5;\n}\n\n\n/* ── Forms ── */\n.form-group { margin-bottom: 12px; }\n\n.form-group label {\n    display: block;\n    font-size: 11px;\n    font-weight: 600;\n    color: var(--text-3);\n    margin-bottom: 4px;\n    text-transform: uppercase;\n    letter-spacing: 0.04em;\n}\n\n.form-input {\n    width: 100%;\n    padding: 8px 11px;\n    font-size: 13px;\n    font-family: var(--font);\n    color: var(--text);\n    background: var(--input-bg);\n    border: 1px solid var(--card-border);\n    border-radius: 9px;\n    outline: none;\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\n}\n\n.form-input:focus {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\nselect.form-input {\n    cursor: pointer;\n    appearance: none;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='%238C8E91' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E\");\n    background-repeat: no-repeat;\n    background-position: right 10px center;\n    padding-right: 28px;\n}\n\n.btn-save {\n    width: 100%;\n    justify-content: center;\n    margin-top: 6px;\n}\n\n/* Model selector row */\n.model-select-wrapper {\n    display: flex;\n    gap: 5px;\n    align-items: center;\n}\n\n.model-select-wrapper .form-input {\n    flex: 1;\n    min-width: 0;\n}\n\n.btn-refresh {\n    width: 30px; height: 30px;\n    flex-shrink: 0;\n    padding: 0;\n}\n\n.model-status {\n    font-size: 11px;\n    margin-top: 4px;\n    min-height: 15px;\n    color: var(--text-3);\n}\n\n.model-status-ok  { color: var(--success); }\n.model-status-warn { color: var(--error); }\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* MODE TOGGLE                                                     */\n/* ═══════════════════════════════════════════════════════════════ */\n.mode-toggle {\n    display: flex;\n    align-items: center;\n    padding: 6px;\n    margin: 0;\n    background: var(--surface);\n    border-bottom: 1px solid var(--card-border);\n    position: relative;\n    gap: 4px;\n}\n\n.mode-tab {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 6px;\n    padding: 9px 14px;\n    font-size: 12.5px;\n    font-weight: 600;\n    font-family: var(--font);\n    color: var(--text-3);\n    background: transparent;\n    border: none;\n    border-radius: 9px;\n    cursor: pointer;\n    transition: color 0.25s ease-out;\n    position: relative;\n    z-index: 2;\n}\n\n.mode-tab:hover { color: var(--text-2); }\n.mode-tab.active { color: var(--primary); }\n.mode-tab svg { width: 14px; height: 14px; }\n\n.mode-indicator {\n    position: absolute;\n    left: 6px;\n    top: 6px;\n    width: calc(50% - 8px);\n    height: calc(100% - 12px);\n    background: var(--primary-bg);\n    border: 1px solid var(--primary-glow);\n    border-radius: 9px;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    z-index: 1;\n}\n\n.mode-indicator.right {\n    transform: translateX(calc(100% + 4px));\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* MODE CONTENT WRAPPER                                            */\n/* ═══════════════════════════════════════════════════════════════ */\n.mode-content {\n    display: none;\n    flex-direction: column;\n    flex: 1;\n    overflow: hidden;\n    animation: fadeIn 0.2s ease-out;\n}\n\n.mode-content.active { display: flex; }\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* PLANNING MODE — Chat                                            */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* ── Chat Messages Container ── */\n.chat-messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 14px 14px 6px;\n    display: flex;\n    flex-direction: column;\n    gap: 14px;\n    scroll-behavior: smooth;\n}\n\n\n/* ── Welcome Screen ── */\n.chat-welcome {\n    text-align: center;\n    padding: 28px 18px 18px;\n    animation: fadeIn 0.35s ease-out;\n}\n\n.welcome-icon {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 52px; height: 52px;\n    background: var(--primary);\n    border-radius: 16px;\n    color: white;\n    margin-bottom: 14px;\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.2);\n}\n\n.welcome-icon svg { width: 24px; height: 24px; }\n\n.chat-welcome h2 {\n    font-size: 17px;\n    font-weight: 700;\n    margin: 0 0 8px;\n    color: var(--text);\n    letter-spacing: -0.02em;\n}\n\n.chat-welcome p {\n    font-size: 12.5px;\n    color: var(--text-2);\n    margin: 0 0 18px;\n    line-height: 1.65;\n    max-width: 270px;\n    margin-left: auto;\n    margin-right: auto;\n}\n\n\n/* ── Chat Suggestions ── */\n.welcome-suggestions {\n    display: flex;\n    flex-direction: column;\n    gap: 7px;\n    max-width: 280px;\n    margin: 0 auto;\n}\n\n.suggestion-chip {\n    display: flex;\n    align-items: center;\n    gap: 9px;\n    padding: 10px 13px;\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: var(--radius);\n    font-size: 11.5px;\n    color: var(--text-2);\n    cursor: pointer;\n    transition: all 0.22s ease-out;\n    text-align: left;\n    font-family: var(--font);\n    line-height: 1.4;\n}\n\n.suggestion-chip:hover {\n    border-color: var(--primary);\n    color: var(--primary);\n    background: var(--primary-bg);\n    transform: translateX(3px);\n}\n\n.suggestion-chip svg {\n    flex-shrink: 0;\n    color: var(--primary);\n    opacity: 0.5;\n}\n\n.suggestion-chip:hover svg { opacity: 1; }\n\n\n/* ── Chat Message Bubbles ── */\n.chat-msg {\n    display: flex;\n    gap: 9px;\n    animation: msgSlideIn 0.25s ease-out;\n    max-width: 100%;\n}\n\n.chat-msg.user {\n    flex-direction: row-reverse;\n}\n\n.chat-avatar {\n    width: 28px; height: 28px;\n    border-radius: 9px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-shrink: 0;\n    font-size: 11px;\n    font-weight: 600;\n}\n\n.chat-msg.user .chat-avatar {\n    background: var(--primary);\n    color: white;\n}\n\n.chat-msg.ai .chat-avatar {\n    background: var(--primary-bg);\n    color: var(--primary);\n    border: 1px solid var(--primary-glow);\n}\n\n.chat-bubble {\n    padding: 11px 14px;\n    border-radius: var(--radius-lg);\n    font-size: 12.5px;\n    line-height: 1.65;\n    max-width: 82%;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n}\n\n.chat-msg.user .chat-bubble {\n    background: var(--chat-user-bg);\n    color: var(--chat-user-text);\n    border-bottom-right-radius: 5px;\n}\n\n.chat-msg.ai .chat-bubble {\n    background: var(--chat-ai-bg);\n    color: var(--chat-ai-text);\n    border: 1px solid var(--chat-ai-border);\n    border-bottom-left-radius: 5px;\n}\n\n\n/* ── Chat formatted text ── */\n.chat-bubble strong { font-weight: 600; }\n.chat-bubble em { font-style: italic; opacity: 0.9; }\n\n.chat-bubble code {\n    font-family: var(--mono);\n    font-size: 11px;\n    padding: 2px 5px;\n    border-radius: 5px;\n    background: rgba(0, 0, 0, 0.06);\n}\n\n.chat-msg.user .chat-bubble code {\n    background: rgba(255, 255, 255, 0.18);\n}\n\n.chat-bubble ul, .chat-bubble ol { margin: 6px 0; padding-left: 18px; }\n.chat-bubble li { margin-bottom: 3px; }\n.chat-bubble p { margin: 0 0 8px; }\n.chat-bubble p:last-child { margin: 0; }\n\n/* ── Context Badge ── */\n.context-badge {\n    display: block;\n    margin-top: 8px;\n    padding: 4px 8px;\n    font-size: 10px;\n    font-weight: 500;\n    color: rgba(255, 255, 255, 0.85);\n    background: rgba(255, 255, 255, 0.15);\n    border-radius: 6px;\n    letter-spacing: 0.2px;\n}\n\n.chat-msg.ai .context-badge {\n    color: var(--text-2);\n    background: var(--primary-bg);\n}\n\n\n/* ── Execute from Chat ── */\n.chat-action-bar {\n    display: flex;\n    gap: 6px;\n    margin-top: 10px;\n}\n\n.btn-execute-from-chat {\n    display: inline-flex;\n    align-items: center;\n    gap: 5px;\n    padding: 5px 11px;\n    font-size: 10.5px;\n    font-weight: 600;\n    font-family: var(--font);\n    background: var(--primary-bg);\n    color: var(--primary);\n    border: 1px solid var(--primary-glow);\n    border-radius: 7px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n}\n\n.btn-execute-from-chat:hover {\n    background: var(--primary);\n    color: white;\n    box-shadow: 0 2px 8px rgba(45, 106, 79, 0.25);\n}\n\n\n/* ── Typing Indicator ── */\n.typing-indicator {\n    display: flex;\n    gap: 4px;\n    align-items: center;\n    padding: 4px 0;\n}\n\n.typing-dot {\n    width: 6px; height: 6px;\n    background: var(--text-3);\n    border-radius: 50%;\n    animation: typingBounce 0.6s ease-in-out infinite;\n}\n\n.typing-dot:nth-child(2) { animation-delay: 0.15s; }\n.typing-dot:nth-child(3) { animation-delay: 0.3s; }\n\n\n/* ── Chat Input Area ── */\n.chat-input-area {\n    padding: 10px 14px 8px;\n    background: var(--surface);\n    border-top: 1px solid var(--card-border);\n}\n\n.chat-input-card {\n    display: flex;\n    align-items: flex-end;\n    gap: 7px;\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: var(--radius-lg);\n    padding: 5px 5px 5px 14px;\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\n    box-shadow: var(--shadow-sm);\n}\n\n.chat-input-card:focus-within {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\n#chat-input {\n    flex: 1;\n    border: none;\n    background: transparent;\n    font-family: var(--font);\n    font-size: 13px;\n    line-height: 1.4;\n    padding: 6px 0;\n    color: var(--text-1);\n    resize: none;\n    outline: none;\n    max-height: 120px;\n    min-height: 20px;\n}\n\n/* Agent Footer Layout */\n.card-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 12px;\n}\n.footer-left {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n/* Original btn-clip (updated) */\n.btn-clip {\n    background: none;\n    border: none;\n    color: var(--text-3);\n    cursor: pointer;\n    padding: 6px;\n    border-radius: 6px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s;\n}\n.btn-clip:hover {\n    background: var(--surface-hover);\n    color: var(--primary);\n}\n\n.file-preview {\n    background: var(--surface-2);\n    border: 1px solid var(--border);\n    border-radius: 6px;\n    padding: 6px 10px;\n    margin-bottom: 8px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 11px;\n    color: var(--text-1);\n}\n.file-thumb {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding-right: 8px;\n}\n.file-remove {\n    background: none;\n    border: none;\n    color: var(--text-3);\n    font-size: 16px;\n    cursor: pointer;\n    padding: 0 4px;\n    line-height: 1;\n}\n.file-center {\n    display: flex;\n    align-items: center;\n}\n#chat-input::placeholder { color: var(--text-3); }\n\n.btn-send {\n    width: 34px; height: 34px;\n    border: none;\n    border-radius: 9px;\n    background: var(--primary);\n    color: white;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-shrink: 0;\n    transition: background 0.2s ease-out, transform 0.15s ease-out;\n    box-shadow: 0 2px 6px rgba(45, 106, 79, 0.2);\n}\n\n.btn-send:hover {\n    background: var(--primary-hover);\n    transform: scale(1.04);\n}\n\n.btn-send:active { transform: scale(0.94); }\n\n.btn-send:disabled {\n    opacity: 0.35;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.btn-send svg { width: 14px; height: 14px; }\n\n.chat-footer {\n    display: flex;\n    justify-content: center;\n    padding: 4px 0 0;\n}\n\n/* ── File Preview List ── */\n.file-preview-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n    margin-bottom: 8px;\n    padding: 0 4px;\n}\n\n.file-chip {\n    display: inline-flex;\n    align-items: center;\n    gap: 6px;\n    background: var(--surface);\n    border: 1px solid var(--card-border);\n    border-radius: 6px;\n    padding: 4px 8px;\n    font-size: 11px;\n    color: var(--text);\n    transition: all 0.2s ease;\n    max-width: 100%;\n}\n\n.file-chip:hover {\n    border-color: var(--primary-light);\n    background: var(--card);\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-sm);\n}\n\n.file-chip-icon {\n    font-size: 12px;\n    opacity: 0.7;\n}\n\n.file-chip-name {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 140px;\n}\n\n.file-chip-remove {\n    background: none;\n    border: none;\n    cursor: pointer;\n    color: var(--text-3);\n    padding: 0 2px;\n    font-size: 14px;\n    line-height: 1;\n    display: flex;\n    align-items: center;\n    border-radius: 4px;\n    transition: color 0.2s;\n}\n\n.file-chip-remove:hover {\n    color: var(--error);\n    background: var(--error-bg);\n}\n\n/* ── Custom Scrollbar ── */\n::-webkit-scrollbar {\n    width: 6px;\n    height: 6px;\n}\n::-webkit-scrollbar-track {\n    background: transparent;\n}\n::-webkit-scrollbar-thumb {\n    background: rgba(0,0,0,0.1);\n    border-radius: 3px;\n}\n::-webkit-scrollbar-thumb:hover {\n    background: rgba(0,0,0,0.2);\n}\n@media (prefers-color-scheme: dark) {\n    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); }\n    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.25); }\n    \n    .app-header {\n        background: rgba(26, 27, 29, 0.85); /* Dark mode glass */\n    }\n}\n\n.btn-text {\n    display: inline-flex;\n    align-items: center;\n    gap: 4px;\n    padding: 5px 9px;\n    font-size: 11px;\n    font-weight: 500;\n    font-family: var(--font);\n    color: var(--text-3);\n    background: transparent;\n    border: none;\n    cursor: pointer;\n    border-radius: 7px;\n    transition: color 0.15s, background 0.15s;\n}\n\n.btn-text:hover {\n    color: var(--error);\n    background: var(--error-bg);\n}\n\n.btn-text svg { width: 12px; height: 12px; }\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* AGENT MODE                                                      */\n/* ═══════════════════════════════════════════════════════════════ */\n.content-wrapper {\n    flex: 1;\n    padding: 14px;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    width: 100%;\n    overflow-y: auto;\n}\n\n\n/* ── Category Tabs ── */\n.action-categories {\n    display: flex;\n    gap: 5px;\n    overflow-x: auto;\n    padding: 2px 0;\n    scrollbar-width: none;\n}\n\n.action-categories::-webkit-scrollbar { display: none; }\n\n.category-tab {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    padding: 7px 11px;\n    font-size: 11px;\n    font-weight: 600;\n    font-family: var(--font);\n    color: var(--text-3);\n    background: transparent;\n    border: 1px solid transparent;\n    border-radius: 9px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n    white-space: nowrap;\n    flex-shrink: 0;\n}\n\n.category-tab:hover {\n    color: var(--text-2);\n    background: var(--card);\n}\n\n.category-tab.active {\n    color: var(--primary);\n    background: var(--primary-bg);\n    border-color: var(--primary-glow);\n}\n\n.category-tab svg { width: 12px; height: 12px; }\n\n\n/* ── Schema Info Banner (Extract Mode) ── */\n.schema-info {\n    display: flex;\n    align-items: flex-start;\n    gap: 10px;\n    padding: 10px 12px;\n    margin-bottom: 10px;\n    background: linear-gradient(135deg, var(--primary-bg), rgba(74, 144, 226, 0.06));\n    border: 1px solid var(--primary-glow);\n    border-radius: 10px;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.schema-icon {\n    font-size: 18px;\n    line-height: 1;\n    flex-shrink: 0;\n}\n\n.schema-text {\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.schema-text strong {\n    font-size: 11.5px;\n    font-weight: 600;\n    color: var(--primary);\n}\n\n.schema-text span {\n    font-size: 10.5px;\n    color: var(--text-2);\n    line-height: 1.4;\n}\n\n.btn-detect {\n    padding: 5px 10px;\n    font-size: 10px;\n    font-weight: 600;\n    font-family: var(--font);\n    color: var(--primary);\n    background: var(--card);\n    border: 1px solid var(--primary-glow);\n    border-radius: 6px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n    flex-shrink: 0;\n    margin-left: auto;\n}\n\n.btn-detect:hover {\n    background: var(--primary-bg);\n    transform: translateY(-1px);\n}\n\n.btn-detect:active {\n    transform: scale(0.96);\n}\n\n/* ── Detected Columns Preview ── */\n.detected-columns {\n    padding: 10px 12px;\n    margin-bottom: 10px;\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: 10px;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.detected-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8px;\n}\n\n.detected-label {\n    font-size: 10.5px;\n    font-weight: 600;\n    color: var(--text-2);\n}\n\n.column-count {\n    font-size: 10px;\n    font-weight: 700;\n    color: var(--primary);\n    background: var(--primary-bg);\n    padding: 2px 8px;\n    border-radius: 10px;\n}\n\n.column-chips {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 4px;\n}\n\n.column-chip {\n    padding: 3px 8px;\n    font-size: 10px;\n    font-weight: 500;\n    color: var(--text-2);\n    background: var(--input-bg);\n    border: 1px solid var(--card-border);\n    border-radius: 6px;\n}\n\n.column-chip.empty-warning {\n    color: var(--warning);\n    background: var(--warning-bg);\n    border-color: rgba(192, 139, 45, 0.2);\n}\n\n/* ── Extract Category Highlight ── */\n.category-tab[data-category=\"extract\"].active {\n    color: #C4603D;\n    background: rgba(196, 96, 61, 0.08);\n    border-color: rgba(196, 96, 61, 0.15);\n}\n\n.category-tab[data-category=\"extract\"]:hover {\n    color: #A8502F;\n}\n\n\n/* ── Quick Action Chips ── */\n.quick-actions {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n}\n\n.chip {\n    display: inline-flex;\n    align-items: center;\n    gap: 5px;\n    padding: 6px 11px;\n    font-size: 11px;\n    font-weight: 500;\n    font-family: var(--font);\n    color: var(--text-2);\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: 20px;\n    cursor: pointer;\n    transition: all 0.2s ease-out;\n    white-space: nowrap;\n}\n\n.chip:hover {\n    color: var(--primary);\n    border-color: var(--primary);\n    background: var(--primary-bg);\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-sm);\n}\n\n.chip:active {\n    transform: scale(0.96) translateY(0);\n}\n\n.chip svg { width: 12px; height: 12px; flex-shrink: 0; }\n\n\n/* ── Input Card (Agent) ── */\n.input-card {\n    background: var(--card);\n    border: 1px solid var(--card-border);\n    border-radius: var(--radius-lg);\n    display: flex;\n    flex-direction: column;\n    box-shadow: var(--shadow);\n    overflow: hidden;\n    transition: border-color 0.2s ease-out, box-shadow 0.2s ease-out;\n}\n\n.input-card:focus-within {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\ntextarea {\n    width: 100%;\n    min-height: 84px;\n    padding: 12px 14px;\n    background: transparent;\n    border: none;\n    color: var(--text);\n    font-family: var(--font);\n    font-size: 13px;\n    line-height: 1.6;\n    resize: vertical;\n    outline: none;\n}\n\ntextarea::placeholder {\n    color: var(--text-3);\n    opacity: 0.85;\n}\n\n.card-footer {\n    padding: 8px 12px;\n    border-top: 1px solid var(--card-border);\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    gap: 8px;\n}\n\n\n/* ── Cache Badge ── */\n.cache-badge {\n    font-size: 10.5px;\n    font-weight: 600;\n    color: var(--success);\n    background: var(--success-bg);\n    padding: 3px 9px;\n    border-radius: 10px;\n    animation: fadeIn 0.2s;\n}\n\n\n/* ── Primary Button ── */\n.btn-primary {\n    background: var(--primary);\n    color: white;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 9px;\n    font-size: 12px;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    transition: background 0.2s ease-out, transform 0.15s ease-out, box-shadow 0.2s ease-out;\n    box-shadow: 0 2px 6px rgba(45, 106, 79, 0.2);\n}\n\n.btn-primary:hover {\n    background: var(--primary-hover);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 14px rgba(45, 106, 79, 0.25);\n}\n\n.btn-primary:active {\n    transform: translateY(0);\n}\n\n.btn-primary:disabled {\n    opacity: 0.4;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.btn-primary svg { width: 13px; height: 13px; }\n\n\n/* ── Skeleton Loading ── */\n.skeleton-container {\n    display: flex;\n    flex-direction: column;\n    gap: 9px;\n    padding: 4px 0;\n}\n\n.skeleton-pill {\n    width: 140px;\n    height: 28px;\n    border-radius: 9px;\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.6s ease-in-out infinite;\n}\n\n.skeleton-line {\n    height: 13px;\n    border-radius: 5px;\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.6s ease-in-out infinite;\n}\n\n.skeleton-line.w80 { width: 80%; }\n.skeleton-line.w60 { width: 60%; }\n\n\n/* ── Status Pill ── */\n.status-pill {\n    padding: 9px 13px;\n    border-radius: var(--radius);\n    font-size: 12px;\n    font-weight: 500;\n    display: none;\n    align-items: center;\n    gap: 7px;\n    animation: fadeIn 0.2s;\n    border: 1px solid transparent;\n}\n\n.status-pill.info {\n    background: var(--primary-bg);\n    color: var(--primary);\n    border-color: var(--primary-glow);\n}\n\n.status-pill.success {\n    background: var(--success-bg);\n    color: var(--success);\n    border-color: rgba(45, 106, 79, 0.12);\n}\n\n.status-pill.error {\n    background: var(--error-bg);\n    color: var(--error);\n    border-color: rgba(184, 58, 58, 0.12);\n}\n\n\n/* ── Spinners ── */\n.spinner {\n    width: 14px; height: 14px;\n    border: 2px solid transparent;\n    border-radius: 50%;\n    border-top-color: currentColor;\n    border-right-color: currentColor;\n    animation: spin 0.7s linear infinite;\n}\n\n.btn-spinner {\n    width: 13px; height: 13px;\n    border: 2px solid rgba(255, 255, 255, 0.3);\n    border-radius: 50%;\n    border-top-color: white;\n    animation: spin 0.7s linear infinite;\n    display: inline-block;\n}\n\n\n/* ── Debug Section ── */\n#debug-section {\n    margin-top: auto;\n    padding-top: 8px;\n}\n\ndetails {\n    background: transparent;\n    border: none;\n    border-radius: var(--radius);\n}\n\nsummary {\n    padding: 5px 0;\n    cursor: pointer;\n    font-size: 11px;\n    font-weight: 600;\n    color: var(--text-3);\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    list-style: none;\n    user-select: none;\n    transition: color 0.15s;\n}\n\nsummary::-webkit-details-marker { display: none; }\nsummary:hover { color: var(--text-2); }\ndetails[open] summary svg { transform: rotate(180deg); }\nsummary svg { transition: transform 0.15s; }\ndetails[open] summary { margin-bottom: 5px; }\n\npre {\n    margin: 0;\n    padding: 11px;\n    background: var(--input-bg);\n    color: var(--text-2);\n    font-family: var(--mono);\n    font-size: 11px;\n    overflow-x: auto;\n    border: 1px solid var(--card-border);\n    border-radius: 9px;\n    line-height: 1.55;\n    white-space: pre-wrap;\n    word-break: break-all;\n    max-height: 180px;\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* SIDELOAD — Skeleton Loading Screen                              */\n/* ═══════════════════════════════════════════════════════════════ */\n.sideload-container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    background: var(--bg);\n    overflow: hidden;\n}\n\n.sideload-skeleton {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    animation: fadeIn 0.3s ease-out;\n}\n\n.sk-shimmer {\n    background: linear-gradient(90deg, var(--card-border) 25%, var(--input-bg) 50%, var(--card-border) 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.8s ease-in-out infinite;\n    border-radius: 7px;\n}\n\n.sk-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 13px 16px;\n    border-bottom: 1px solid var(--card-border);\n}\n\n.sk-brand { display: flex; align-items: center; gap: 9px; }\n.sk-logo { width: 24px; height: 24px; border-radius: 7px; }\n.sk-title { width: 105px; height: 15px; border-radius: 5px; }\n.sk-header-actions { display: flex; gap: 5px; }\n.sk-icon-btn { width: 32px; height: 32px; border-radius: 9px; }\n\n.sk-mode-toggle {\n    display: flex;\n    gap: 4px;\n    padding: 8px 6px;\n    border-bottom: 1px solid var(--card-border);\n}\n\n.sk-mode-tab { flex: 1; height: 36px; border-radius: 9px; }\n\n.sk-welcome {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 34px 20px 18px;\n    gap: 11px;\n}\n\n.sk-welcome-icon { width: 52px; height: 52px; border-radius: 16px; }\n.sk-welcome-title { width: 145px; height: 19px; border-radius: 6px; }\n.sk-welcome-desc { width: 220px; height: 13px; border-radius: 5px; }\n.sk-welcome-desc.short { width: 175px; }\n\n.sk-suggestions {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    padding: 10px 32px;\n}\n\n.sk-suggestion { width: 100%; height: 38px; border-radius: 10px; }\n.sk-suggestion:nth-child(2) { animation-delay: 0.1s; }\n.sk-suggestion:nth-child(3) { animation-delay: 0.2s; }\n.sk-suggestion:nth-child(4) { animation-delay: 0.3s; }\n\n.sk-input-area {\n    margin-top: auto;\n    padding: 12px 16px 8px;\n    border-top: 1px solid var(--card-border);\n}\n\n.sk-input { width: 100%; height: 42px; border-radius: 14px; }\n\n.sideload-status {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 9px;\n    padding: 11px;\n    font-size: 11.5px;\n    font-weight: 500;\n    color: var(--text-3);\n}\n\n.sideload-pulse {\n    width: 8px; height: 8px;\n    border-radius: 50%;\n    background: var(--primary);\n    animation: pulse 1.5s ease-in-out infinite;\n    box-shadow: 0 0 8px var(--primary-glow);\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* KEYFRAMES                                                       */\n/* ═══════════════════════════════════════════════════════════════ */\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(3px); }\n    to   { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes slideDown {\n    from { opacity: 0; transform: translateY(-6px); }\n    to   { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n\n@keyframes shimmer {\n    0%   { background-position: 200% 0; }\n    100% { background-position: -200% 0; }\n}\n\n@keyframes msgSlideIn {\n    from { opacity: 0; transform: translateY(6px); }\n    to   { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes typingBounce {\n    0%, 100% { transform: translateY(0); opacity: 0.4; }\n    50%      { transform: translateY(-4px); opacity: 1; }\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 0.4; transform: scale(0.85); }\n    50%      { opacity: 1; transform: scale(1.15); }\n}\n\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* SCROLLBAR & SCROLL FIXES                                        */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* LOADING / SKELETON SCREENS                                      */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* Sideload Container */\n.sideload-container {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: var(--bg);\n    z-index: 9999;\n    display: flex;\n    flex-direction: column;\n    padding: 20px;\n    align-items: center;\n    justify-content: center;\n}\n\n/* Skeleton Base */\n.sideload-skeleton {\n    width: 100%;\n    max-width: 320px;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    opacity: 0.8;\n}\n\n/* Shimmer Animation Class */\n.sk-shimmer {\n    background: #e0e0e0;\n    background-image: linear-gradient(\n        to right,\n        #e0e0e0 0%,\n        #f0f0f0 20%,\n        #e0e0e0 40%,\n        #e0e0e0 100%\n    );\n    background-repeat: no-repeat;\n    background-size: 800px 100%;\n    animation: shimmer 1.5s infinite linear; \n    border-radius: 6px;\n}\n\n/* Specific Skeleton Elements */\n.sk-header { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 10px; }\n.sk-brand { display: flex; align-items: center; gap: 10px; }\n.sk-logo { width: 32px; height: 32px; border-radius: 8px; }\n.sk-title { width: 100px; height: 20px; }\n.sk-header-actions { display: flex; gap: 8px; }\n.sk-icon-btn { width: 28px; height: 28px; border-radius: 50%; }\n\n.sk-mode-toggle { display: flex; gap: 4px; background: var(--surface); padding: 4px; border-radius: 12px; margin-bottom: 20px; }\n.sk-mode-tab { flex: 1; height: 36px; border-radius: 8px; opacity: 0.7; }\n\n.sk-welcome { display: flex; flex-direction: column; align-items: center; gap: 12px; margin-top: 20px; text-align: center; }\n.sk-welcome-icon { width: 48px; height: 48px; border-radius: 12px; }\n.sk-welcome-title { width: 180px; height: 24px; }\n.sk-welcome-desc { width: 240px; height: 16px; margin-bottom: 4px; }\n.sk-welcome-desc.short { width: 160px; }\n\n.sk-suggestions { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 30px; }\n.sk-suggestion { width: 140px; height: 32px; border-radius: 16px; }\n\n.sk-input-area { width: 100%; margin-top: auto; padding-top: 40px; }\n.sk-input { width: 100%; height: 50px; border-radius: 12px; }\n\n/* Status Text */\n.sideload-status {\n    position: absolute;\n    bottom: 30px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 8px;\n    font-size: 11px;\n    color: var(--text-3);\n    font-weight: 500;\n} \n.sideload-pulse {\n    width: 6px; height: 6px;\n    background: var(--primary);\n    border-radius: 50%;\n    animation: pulse 1s infinite;\n}\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* SCROLLBAR & SCROLL FIXES                                        */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* Ensure main content areas scroll properly */\n.content-wrapper, .chat-messages {\n    flex: 1;\n    overflow-y: auto !important;\n    min-height: 0; /* Critical for flex child scrolling */\n    padding-bottom: 40px; /* Extra space at bottom */\n    scroll-behavior: smooth;\n    -webkit-overflow-scrolling: touch;\n}\n\n/* Ensure parent containers occupy full height but don't scroll themselves */\n#agent-mode, #planning-mode {\n    display: none; /* Hide by default */\n    height: 100%;\n    overflow: hidden; /* Prevent body scroll */\n    flex-direction: column;\n}\n#agent-mode.active, #planning-mode.active {\n    display: flex; /* Show when active */\n}\n\n/* Scrollbar Visually */\n::-webkit-scrollbar { width: 6px; height: 6px; }\n::-webkit-scrollbar-track { background: transparent; }\n::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.15); border-radius: 4px; }\n::-webkit-scrollbar-thumb:hover { background: rgba(0, 0, 0, 0.3); }\n\n/* ═══════════════════════════════════════════════════════════════ */\n/* PRODUCTION OPTIMIZATIONS (RESPONSIVE & PERFORMANCE)             */\n/* ═══════════════════════════════════════════════════════════════ */\n\n/* 1. Hardware Acceleration for Animations */\n.chat-msg, .panel, .sideload-container {\n    will-change: transform, opacity;\n    backface-visibility: hidden; /* sharpen animations */\n    transform: translateZ(0);     /* trigger GPU */\n}\n\n.chip, .category-tab, .btn-icon {\n    transform: translateZ(0); \n}\n\n/* 2. Responsive Tweaks for Narrow Taskpanes (< 360px) */\n@media (max-width: 360px) {\n    :root {\n        --radius-lg: 10px; /* Tighter corners */\n    }\n\n    .app-header { padding: 8px 12px; }\n    \n    .chat-bubble {\n        font-size: 11.5px;\n        padding: 8px 12px;\n        max-width: 88%;\n    }\n    \n    .chip {\n        font-size: 10px;\n        padding: 5px 9px;\n    }\n    \n    .category-tab {\n        padding: 5px 9px;\n        font-size: 10px;\n    }\n    \n    /* Stack form groups tighter */\n    .form-group { margin-bottom: 10px; }\n    \n    /* Ensure code blocks don't overflow */\n    .chat-bubble pre { \n        font-size: 10px; \n        padding: 8px;\n    }\n}\n\n/* 3. High-DPI Screens (Retina) Text Sharpness */\n@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {\n    body {\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n    }\n}"],sourceRoot:""}]),t.A=d},76314:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&s[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},4417:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},71354:function(e){"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},80748:function(module,__unused_webpack_exports,__webpack_require__){var root,factory;root=globalThis,factory=()=>(()=>{"use strict";var __webpack_modules__=[,(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=function(e,t){e||s(t)},t.bytesToString=c,t.createValidAbsoluteUrl=function(e,t=null,n=null){if(!e)return null;try{if(n&&"string"==typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);t?.length>=2&&(e=`http://${e}`)}if(n.tryConvertEncoding)try{e=p(e)}catch{}}const r=t?new URL(e,t):new URL(e);if(function(e){switch(e?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(r))return r}catch{}return null},t.getModificationDate=function(e=new Date){return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),e.getUTCDate().toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getUuid=function(){if("undefined"!=typeof crypto&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);if("undefined"!=typeof crypto&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(e);else for(let t=0;t<32;t++)e[t]=Math.floor(255*Math.random());return c(e)},t.getVerbosityLevel=function(){return a},t.info=function(e){a>=r.INFOS&&console.log(`Info: ${e}`)},t.isArrayBuffer=function(e){return"object"==typeof e&&void 0!==e?.byteLength},t.isArrayEqual=function(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0},t.isNodeJS=void 0,t.normalizeUnicode=function(e){return A||(A=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,g=new Map([["ﬅ","ſt"]])),e.replaceAll(A,(e,t,n)=>t?t.normalize("NFKC"):g.get(n))},t.objectFromMap=function(e){const t=Object.create(null);for(const[n,r]of e)t[n]=r;return t},t.objectSize=function(e){return Object.keys(e).length},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(a=e)},t.shadow=o,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=d,t.stringToPDFString=function(e){if(e[0]>="ï"){let t;if("þ"===e[0]&&"ÿ"===e[1]?t="utf-16be":"ÿ"===e[0]&&"þ"===e[1]?t="utf-16le":"ï"===e[0]&&"»"===e[1]&&"¿"===e[2]&&(t="utf-8"),t)try{const n=new TextDecoder(t,{fatal:!0}),r=d(e);return n.decode(r)}catch(e){i(`stringToPDFString: "${e}".`)}}const t=[];for(let n=0,r=e.length;n<r;n++){const r=u[e.charCodeAt(n)];t.push(r?String.fromCharCode(r):e.charAt(n))}return t.join("")},t.stringToUTF8String=p,t.unreachable=s,t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=i;const n=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=n,t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.MAX_IMAGE_SIZE_TO_CACHE=1e7,t.LINE_FACTOR=1.35,t.LINE_DESCENT_FACTOR=.35;t.BASELINE_FACTOR=.35/1.35,t.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},t.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},t.AnnotationEditorPrefix="pdfjs_internal_editor_",t.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15},t.AnnotationEditorParamsType={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23},t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},t.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},t.PageActionEventType={O:"PageOpen",C:"PageClose"};const r={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=r,t.CMapCompressionType={NONE:0,BINARY:1},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let a=r.WARNINGS;function i(e){a>=r.WARNINGS&&console.log(`Warning: ${e}`)}function s(e){throw new Error(e)}function o(e,t,n,r=!1){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!0,writable:!1}),n}const l=function(){function e(t,n){this.constructor===e&&s("Cannot initialize BaseException."),this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();function c(e){"object"==typeof e&&void 0!==e?.length||s("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const r=[];for(let a=0;a<t;a+=n){const i=Math.min(a+n,t),s=e.subarray(a,i);r.push(String.fromCharCode.apply(null,s))}return r.join("")}function d(e){"string"!=typeof e&&s("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let r=0;r<t;++r)n[r]=255&e.charCodeAt(r);return n}t.BaseException=l,t.PasswordException=class extends l{constructor(e,t){super(e,"PasswordException"),this.code=t}},t.UnknownErrorException=class extends l{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},t.InvalidPDFException=class extends l{constructor(e){super(e,"InvalidPDFException")}},t.MissingPDFException=class extends l{constructor(e){super(e,"MissingPDFException")}},t.UnexpectedResponseException=class extends l{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},t.FormatError=class extends l{constructor(e){super(e,"FormatError")}},t.AbortException=class extends l{constructor(e){super(e,"AbortException")}},t.FeatureTest=class{static get isLittleEndian(){return o(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return o(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return o(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"==typeof navigator?o(this,"platform",{isWin:!1,isMac:!1}):o(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return o(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}};const h=[...Array(256).keys()].map(e=>e.toString(16).padStart(2,"0"));t.Util=class{static makeHexColor(e,t,n){return`#${h[e]}${h[t]}${h[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[1],t[1]=n),t[0]*=e[0],t[1]*=e[0],e[3]<0&&(n=t[2],t[2]=t[3],t[3]=n),t[2]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[2],t[2]=n,n=t[1],t[1]=t[3],t[3]=n,e[1]<0&&(n=t[2],t[2]=t[3],t[3]=n),t[2]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[1],t[1]=n),t[0]*=e[2],t[1]*=e[2]),t[0]+=e[4],t[1]+=e[4],t[2]+=e[5],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),i=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],r[0],a[0],i[0]),Math.min(n[1],r[1],a[1],i[1]),Math.max(n[0],r[0],a[0],i[0]),Math.max(n[1],r[1],a[1],i[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],i=e[2]*t[1]+e[3]*t[3],s=(n+i)/2,o=Math.sqrt((n+i)**2-4*(n*i-a*r))/2,l=s+o||1,c=s-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),i=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>i?null:[n,a,r,i]}static bezierBoundingBox(e,t,n,r,a,i,s,o){const l=[],c=[[],[]];let d,h,u,p,A,g,m,f;for(let c=0;c<2;++c)if(0===c?(h=6*e-12*n+6*a,d=-3*e+9*n-9*a+3*s,u=3*n-3*e):(h=6*t-12*r+6*i,d=-3*t+9*r-9*i+3*o,u=3*r-3*t),Math.abs(d)<1e-12){if(Math.abs(h)<1e-12)continue;p=-u/h,0<p&&p<1&&l.push(p)}else m=h*h-4*u*d,f=Math.sqrt(m),m<0||(A=(-h+f)/(2*d),0<A&&A<1&&l.push(A),g=(-h-f)/(2*d),0<g&&g<1&&l.push(g));let b,C=l.length;const y=C;for(;C--;)p=l[C],b=1-p,c[0][C]=b*b*b*e+3*b*b*p*n+3*b*p*p*a+p*p*p*s,c[1][C]=b*b*b*t+3*b*b*p*r+3*b*p*p*i+p*p*p*o;return c[0][y]=e,c[1][y]=t,c[0][y+1]=s,c[1][y+1]=o,c[0].length=c[1].length=y+2,[Math.min(...c[0]),Math.min(...c[1]),Math.max(...c[0]),Math.max(...c[1])]}};const u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function p(e){return decodeURIComponent(escape(e))}t.PromiseCapability=class{#e=!1;constructor(){this.promise=new Promise((e,t)=>{this.resolve=t=>{this.#e=!0,e(t)},this.reject=e=>{this.#e=!0,t(e)}})}get settled(){return this.#e}};let A=null,g=null;t.AnnotationPrefix="pdfjs_internal_id_"},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;function getDocument(e){if("string"==typeof e||e instanceof URL?e={url:e}:(0,_util.isArrayBuffer)(e)&&(e={data:e}),"object"!=typeof e)throw new Error("Invalid parameter in getDocument, need parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new PDFDocumentLoadingTask,{docId:n}=t,r=e.url?getUrlProp(e.url):null,a=e.data?getDataProp(e.data):null,i=e.httpHeaders||null,s=!0===e.withCredentials,o=e.password??null,l=e.range instanceof PDFDataRangeTransport?e.range:null,c=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let d=e.worker instanceof PDFWorker?e.worker:null;const h=e.verbosity,u="string"!=typeof e.docBaseUrl||(0,_display_utils.isDataScheme)(e.docBaseUrl)?null:e.docBaseUrl,p="string"==typeof e.cMapUrl?e.cMapUrl:null,A=!1!==e.cMapPacked,g=e.CMapReaderFactory||DefaultCMapReaderFactory,m="string"==typeof e.standardFontDataUrl?e.standardFontDataUrl:null,f=e.StandardFontDataFactory||DefaultStandardFontDataFactory,b=!0!==e.stopAtErrors,C=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,y=!1!==e.isEvalSupported,v="boolean"==typeof e.isOffscreenCanvasSupported?e.isOffscreenCanvasSupported:!_util.isNodeJS,x=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,E="boolean"==typeof e.disableFontFace?e.disableFontFace:_util.isNodeJS,w=!0===e.fontExtraProperties,_=!0===e.enableXfa,B=e.ownerDocument||globalThis.document,I=!0===e.disableRange,k=!0===e.disableStream,S=!0===e.disableAutoFetch,T=!0===e.pdfBug,R=l?l.length:e.length??NaN,M="boolean"==typeof e.useSystemFonts?e.useSystemFonts:!_util.isNodeJS&&!E,P="boolean"==typeof e.useWorkerFetch?e.useWorkerFetch:g===_display_utils.DOMCMapReaderFactory&&f===_display_utils.DOMStandardFontDataFactory&&p&&m&&(0,_display_utils.isValidFetchUrl)(p,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(m,document.baseURI),F=e.canvasFactory||new DefaultCanvasFactory({ownerDocument:B}),D=e.filterFactory||new DefaultFilterFactory({docId:n,ownerDocument:B});(0,_util.setVerbosityLevel)(h);const O={canvasFactory:F,filterFactory:D};if(P||(O.cMapReaderFactory=new g({baseUrl:p,isCompressed:A}),O.standardFontDataFactory=new f({baseUrl:m})),!d){const e={verbosity:h,port:_worker_options.GlobalWorkerOptions.workerPort};d=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=d}const L={docId:n,apiVersion:"3.11.174",data:a,password:o,disableAutoFetch:S,rangeChunkSize:c,length:R,docBaseUrl:u,enableXfa:_,evaluatorOptions:{maxImageSize:C,disableFontFace:E,ignoreErrors:b,isEvalSupported:y,isOffscreenCanvasSupported:v,canvasMaxAreaInBytes:x,fontExtraProperties:w,useSystemFonts:M,cMapUrl:P?p:null,standardFontDataUrl:P?m:null}},N={ignoreErrors:b,isEvalSupported:y,disableFontFace:E,fontExtraProperties:w,enableXfa:_,ownerDocument:B,disableAutoFetch:S,pdfBug:T,styleElement:null};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(d,L),o=new Promise(function(e){let t;var n;l?t=new _transport_stream.PDFDataTransportStream({length:R,initialData:l.initialData,progressiveDone:l.progressiveDone,contentDispositionFilename:l.contentDispositionFilename,disableRange:I,disableStream:k},l):a||(n={url:r,length:R,httpHeaders:i,withCredentials:s,rangeChunkSize:c,disableRange:I,disableStream:k},t=_util.isNodeJS?new _displayNode_stream.PDFNodeStream(n):(0,_display_utils.isValidFetchUrl)(n.url)?new _displayFetch_stream.PDFFetchStream(n):new _displayNetwork.PDFNetworkStream(n)),e(t)});return Promise.all([e,o]).then(function([e,r]){if(t.destroyed)throw new Error("Loading aborted");const a=new _message_handler.MessageHandler(n,e,d.port),i=new WorkerTransport(a,t,r,N,O);t._transport=i,a.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(e,t){if(e.destroyed)throw new Error("Worker was destroyed");const n=await e.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(e.destroyed)throw new Error("Worker was destroyed");return n}function getUrlProp(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(_util.isNodeJS&&"string"==typeof e)return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(e){if(_util.isNodeJS&&"undefined"!=typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"==typeof e)return(0,_util.stringToBytes)(e);if("object"==typeof e&&!isNaN(e?.length)||(0,_util.isArrayBuffer)(e))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,t,n=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(e=>{if(!e)return e;const t=[];for(const n in e)t.push(...e[n]);return t}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#n=null;#r=!1;constructor(e,t,n,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:a})}getAnnotations({intent:e="display"}={}){const t=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:r=_util.AnnotationMode.ENABLE,transform:a=null,background:i=null,optionalContentConfigPromise:s=null,annotationCanvasMap:o=null,pageColors:l=null,printAnnotationStorage:c=null}){this._stats?.time("Overall");const d=this._transport.getRenderingIntent(n,r,c);this.#r=!1,this.#a(),s||(s=this._transport.getOptionalContentConfig());let h=this._intentStates.get(d.cacheKey);h||(h=Object.create(null),this._intentStates.set(d.cacheKey,h)),h.streamReaderCancelTimeout&&(clearTimeout(h.streamReaderCancelTimeout),h.streamReaderCancelTimeout=null);const u=!!(d.renderingIntent&_util.RenderingIntentFlag.PRINT);h.displayReadyCapability||(h.displayReadyCapability=new _util.PromiseCapability,h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));const p=e=>{h.renderTasks.delete(A),(this._maybeCleanupAfterRender||u)&&(this.#r=!0),this.#i(!u),e?(A.capability.reject(e),this._abortOperatorList({intentState:h,reason:e instanceof Error?e:new Error(e)})):A.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},A=new InternalRenderTask({callback:p,params:{canvasContext:e,viewport:t,transform:a,background:i},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:h.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!u,pdfBug:this._pdfBug,pageColors:l});(h.renderTasks||=new Set).add(A);const g=A.task;return Promise.all([h.displayReadyCapability.promise,s]).then(([e,t])=>{this.destroyed?p():(this._stats?.time("Rendering"),A.initializeGraphics({transparency:e,optionalContentConfig:t}),A.operatorListChanged())}).catch(p),g}getOperatorList({intent:e="display",annotationMode:t=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){const r=this._transport.getRenderingIntent(e,t,n,!0);let a,i=this._intentStates.get(r.cacheKey);return i||(i=Object.create(null),this._intentStates.set(r.cacheKey,i)),i.opListReadCapability||(a=Object.create(null),a.operatorListChanged=function(){i.operatorList.lastChunk&&(i.opListReadCapability.resolve(i.operatorList),i.renderTasks.delete(a))},i.opListReadCapability=new _util.PromiseCapability,(i.renderTasks||=new Set).add(a),i.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(r)),i.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size(e){return e.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const r=t.getReader(),a={items:[],styles:Object.create(null)};!function t(){r.read().then(function({value:n,done:r}){r?e(a):(Object.assign(a.styles,n.styles),a.items.push(...n.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#r=!1,this.#a(),Promise.all(e)}cleanup(e=!1){this.#r=!0;const t=this.#i(!1);return e&&t&&(this._stats&&=new _display_utils.StatTimer),t}#i(e=!1){if(this.#a(),!this.#r||this.destroyed)return!1;if(e)return this.#n=setTimeout(()=>{this.#n=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#r=!1,!0}#a(){this.#n&&(clearTimeout(this.#n),this.#n=null)}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const e of t.renderTasks)e.operatorListChanged();e.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n}){const{map:r,transfers:a}=n,i=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r},a).getReader(),s=this._intentStates.get(t);s.streamReader=i;const o=()=>{i.read().then(({value:e,done:t})=>{t?s.streamReader=null:this._transport.destroyed||(this._renderPageChunk(e,s),o())},e=>{if(s.streamReader=null,!this._transport.destroyed){if(s.operatorList){s.operatorList.lastChunk=!0;for(const e of s.renderTasks)e.operatorListChanged();this.#i(!0)}if(s.displayReadyCapability)s.displayReadyCapability.reject(e);else{if(!s.opListReadCapability)throw e;s.opListReadCapability.reject(e)}}})};o()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException){let n=RENDERING_CANCELLED_TIMEOUT;return t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),void(e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n))}}if(e.streamReader.cancel(new _util.AbortException(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[t,n]of this._intentStates)if(n===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#s=new Set;#o=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#o.then(()=>{for(const e of this.#s)e.call(this,n)})}addEventListener(e,t){this.#s.add(t)}removeEventListener(e,t){this.#s.delete(t)}terminate(){this.#s.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_util.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const e=document?.currentScript?.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,t){let n;try{if(n=new URL(e),!n.origin||"null"===n.origin)return!1}catch{return!1}const r=new URL(t,n);return n.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(e){const t=`importScripts("${e}");`;return URL.createObjectURL(new Blob([t]))};class PDFWorker{static#l;constructor({name:e=null,port:t=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){if(PDFWorker.#l?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");return(PDFWorker.#l||=new WeakMap).set(t,this),void this._initializeFromPort(t)}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:e}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,e)||(e=PDFWorkerUtil.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e),n=new _message_handler.MessageHandler("main","worker",t),r=()=>{t.removeEventListener("error",a),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||r()};t.addEventListener("error",a),n.on("test",e=>{t.removeEventListener("error",a),this.destroyed?r():e?(this._messageHandler=n,this._port=t,this._webWorker=t,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),t.terminate())}),n.on("ready",e=>{if(t.removeEventListener("error",a),this.destroyed)r();else try{i()}catch{this._setupFakeWorker()}});const i=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void i()}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new LoopbackPort;this._port=t;const n="fake"+PDFWorkerUtil.fakeWorkerId++,r=new _message_handler.MessageHandler(n+"_worker",n,t);e.setup(r,t);const a=new _message_handler.MessageHandler(n,n+"_worker",t);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#l?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#l?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#c=new Map;#d=new Map;#h=new Map;#u=null;constructor(e,t,n,r,a){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#p(e,t=null){const n=this.#c.get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,t);return this.#c.set(e,r),r}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,t=_util.AnnotationMode.ENABLE,n=null,r=!1){let a=_util.RenderingIntentFlag.DISPLAY,i=_annotation_storage.SerializableEmpty;switch(e){case"any":a=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":a=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(t){case _util.AnnotationMode.DISABLE:a+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:a+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:a+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,i=(a&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return r&&(a+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:a,cacheKey:`${a}_${i.hash}`,annotationStorageSerializable:i}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#u?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const t of this.#d.values())e.push(t._destroy());this.#d.clear(),this.#h.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#c.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function({value:e,done:n}){n?t.close():((0,_util.assert)(e instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",e=>{const n=new _util.PromiseCapability,r=this._fullReader;return r.headersReady.then(()=>{r.isStreamingSupported&&r.isRangeSupported||(this._lastProgress&&t.onProgress?.(this._lastProgress),r.onProgress=e=>{t.onProgress?.({loaded:e.loaded,total:e.total})}),n.resolve({isStreamingSupported:r.isStreamingSupported,isRangeSupported:r.isRangeSupported,contentLength:r.contentLength})},n.reject),n.promise}),e.on("GetRangeReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function({value:e,done:n}){n?t.close():((0,_util.assert)(e instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(e,this))}),e.on("DocException",function(e){let n;switch(e.name){case"PasswordException":n=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":n=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":n=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":n=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":n=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(n)}),e.on("PasswordRequest",e=>{if(this.#u=new _util.PromiseCapability,t.onPassword){const n=e=>{e instanceof Error?this.#u.reject(e):this.#u.resolve({password:e})};try{t.onPassword(n,e.code)}catch(e){this.#u.reject(e)}}else this.#u.reject(new _util.PasswordException(e.message,e.code));return this.#u.promise}),e.on("DataLoaded",e=>{t.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{this.destroyed||this.#d.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",([t,n,r])=>{if(!this.destroyed&&!this.commonObjs.has(t))switch(n){case"Font":const a=this._params;if("error"in r){const e=r.error;(0,_util.warn)(`Error during font loading: ${e}`),this.commonObjs.resolve(t,e);break}const i=a.pdfBug&&globalThis.FontInspector?.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,s=new _font_loader.FontFaceObject(r,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,inspectFont:i});this.fontLoader.bind(s).catch(n=>e.sendWithPromise("FontFallback",{id:t})).finally(()=>{!a.fontExtraProperties&&s.data&&(s.data=null),this.commonObjs.resolve(t,s)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(t,r);break;default:throw new Error(`Got unknown common object type ${n}`)}}),e.on("obj",([e,t,n,r])=>{if(this.destroyed)return;const a=this.#d.get(t);if(!a.objs.has(e))switch(n){case"Image":if(a.objs.resolve(e,r),r){let e;if(r.bitmap){const{width:t,height:n}=r;e=t*n*4}else e=r.data?.length||0;e>_util.MAX_IMAGE_SIZE_TO_CACHE&&(a._maybeCleanupAfterRender=!0)}break;case"Pattern":a.objs.resolve(e,r);break;default:throw new Error(`Got unknown object type ${n}`)}}),e.on("DocProgress",e=>{this.destroyed||t.onProgress?.({loaded:e.loaded,total:e.total})}),e.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfers:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#h.get(t);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(e=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(t,e,this,this._params.pdfBug);return this.#d.set(t,n),n});return this.#h.set(t,r),r}getPageIndex(e){return"object"!=typeof e||null===e||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#p("GetFieldObjects")}hasJSActions(){return this.#p("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#p("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#c.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#c.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#d.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#c.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:e,enableXfa:t}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:t})}}class PDFObjects{#A=Object.create(null);#g(e){return this.#A[e]||={capability:new _util.PromiseCapability,data:null}}get(e,t=null){if(t){const n=this.#g(e);return n.capability.promise.then(()=>t(n.data)),null}const n=this.#A[e];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#A[e];return t?.capability.settled||!1}resolve(e,t=null){const n=this.#g(e);n.data=t,n.capability.resolve()}clear(){for(const e in this.#A){const{data:t}=this.#A[e];t?.bitmap?.close()}this.#A=Object.create(null)}}class RenderTask{#m=null;constructor(e){this.#m=e,this.onContinue=null}get promise(){return this.#m.capability.promise}cancel(e=0){this.#m.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#m.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#m;return e.form||e.canvas&&t?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#f=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:a,operatorList:i,pageIndex:s,canvasFactory:o,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:d=!1,pageColors:h=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=i,this._pageIndex=s,this.canvasFactory=o,this.filterFactory=l,this._pdfBug=d,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!=typeof window,this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#f.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#f.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:r,transform:a,background:i}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:r,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#f.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#f.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var r=n(1),a=n(4),i=n(8);const s=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=s;class o{#b=!1;#C=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#C.get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return this.#C.get(e)}remove(e){if(this.#C.delete(e),0===this.#C.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const e of this.#C.values())if(e instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#C.get(e);let r=!1;if(void 0!==n)for(const[e,a]of Object.entries(t))n[e]!==a&&(r=!0,n[e]=a);else r=!0,this.#C.set(e,t);r&&this.#y(),t instanceof a.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#C.has(e)}getAll(){return this.#C.size>0?(0,r.objectFromMap)(this.#C):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#C.size}#y(){this.#b||(this.#b=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#b&&(this.#b=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new l(this)}get serializable(){if(0===this.#C.size)return s;const e=new Map,t=new i.MurmurHash3_64,n=[],r=Object.create(null);let o=!1;for(const[n,i]of this.#C){const s=i instanceof a.AnnotationEditor?i.serialize(!1,r):i;s&&(e.set(n,s),t.update(`${n}:${JSON.stringify(s)}`),o||=!!s.bitmap)}if(o)for(const t of e.values())t.bitmap&&n.push(t.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfers:n}:s}}t.AnnotationStorage=o;class l extends o{#v;constructor(e){super();const{map:t,hash:n,transfers:r}=e.serializable,a=structuredClone(t,r?{transfer:r}:null);this.#v={map:a,hash:n,transfers:r}}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#v}}t.PrintAnnotationStorage=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var r=n(5),a=n(1),i=n(6);class s{#x="";#E=!1;#w=null;#_=null;#B=null;#I=!1;#k=null;#S=this.focusin.bind(this);#T=this.focusout.bind(this);#R=!1;#M=!1;#P=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#F=!1;#D=s._zIndex++;static _borderLineWidth=-1;static _colorManager=new r.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(e){this.constructor===s&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[i,o];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new o({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t=null){if(s._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(t=>[t,e.get(t)])),t?.strings)for(const n of t.strings)s._l10nPromise.set(n,e.get(n));if(-1!==s._borderLineWidth)return;const n=getComputedStyle(document.documentElement);s._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){(0,a.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#F}set _isDraggable(e){this.#F=e,this.div?.classList.toggle("draggable",e)}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#D}setParent(e){null!==e&&(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#R?this.#R=!1:this.parent.setSelected(this))}focusout(e){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const t=e.relatedTarget;t?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){const[a,i]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/a,this.y=(t+r)/i,this.fixAndSetPosition()}#O([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this.fixAndSetPosition()}translate(e,t){this.#O(this.parentDimensions,e,t)}translateInPage(e,t){this.#O(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){const[n,r]=this.parentDimensions;if(this.x+=e/n,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:i}=this;const[s,o]=this.#L();a+=s,i+=o,this.div.style.left=`${(100*a).toFixed(2)}%`,this.div.style.top=`${(100*i).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#L(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=s,r=n/e,a=n/t;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}fixAndSetPosition(){const[e,t]=this.pageDimensions;let{x:n,y:r,width:a,height:i}=this;switch(a*=e,i*=t,n*=e,r*=t,this.rotation){case 0:n=Math.max(0,Math.min(e-a,n)),r=Math.max(0,Math.min(t-i,r));break;case 90:n=Math.max(0,Math.min(e-i,n)),r=Math.min(t,Math.max(a,r));break;case 180:n=Math.min(e,Math.max(a,n)),r=Math.min(t,Math.max(i,r));break;case 270:n=Math.min(e,Math.max(i,n)),r=Math.max(0,Math.min(t-a,r))}this.x=n/=e,this.y=r/=t;const[s,o]=this.#L();n+=s,r+=o;const{style:l}=this.div;l.left=`${(100*n).toFixed(2)}%`,l.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}static#N(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return s.#N(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return s.#N(e,t,360-this.parentRotation)}#U(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this,r=t*e,i=n*e;return a.FeatureTest.isCSSRoundSupported?[Math.round(r),Math.round(i)]:[r,i]}setDims(e,t){const[n,r]=this.parentDimensions;this.div.style.width=`${(100*e/n).toFixed(2)}%`,this.#I||(this.div.style.height=`${(100*t/r).toFixed(2)}%`),this.#w?.classList.toggle("small",e<s.SMALL_EDITOR_SIZE||t<s.SMALL_EDITOR_SIZE)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),a=!this.#I&&t.endsWith("%");if(r&&a)return;const[i,s]=this.parentDimensions;r||(e.width=`${(100*parseFloat(n)/i).toFixed(2)}%`),this.#I||a||(e.height=`${(100*parseFloat(t)/s).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#j(){if(this.#k)return;this.#k=document.createElement("div"),this.#k.classList.add("resizers");const e=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||e.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of e){const e=document.createElement("div");this.#k.append(e),e.classList.add("resizer",t),e.addEventListener("pointerdown",this.#z.bind(this,t)),e.addEventListener("contextmenu",i.noContextMenu)}this.div.prepend(this.#k)}#z(e,t){t.preventDefault();const{isMac:n}=a.FeatureTest.platform;if(0!==t.button||t.ctrlKey&&n)return;const r=this.#q.bind(this,e),i=this._isDraggable;this._isDraggable=!1;const s={passive:!0,capture:!0};window.addEventListener("pointermove",r,s);const o=this.x,l=this.y,c=this.width,d=this.height,h=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{this._isDraggable=i,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",r,s),this.parent.div.style.cursor=h,this.div.style.cursor=u;const e=this.x,t=this.y,n=this.width,a=this.height;e===o&&t===l&&n===c&&a===d||this.addCommands({cmd:()=>{this.width=n,this.height=a,this.x=e,this.y=t;const[r,i]=this.parentDimensions;this.setDims(r*n,i*a),this.fixAndSetPosition()},undo:()=>{this.width=c,this.height=d,this.x=o,this.y=l;const[e,t]=this.parentDimensions;this.setDims(e*c,t*d),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}#q(e,t){const[n,r]=this.parentDimensions,a=this.x,i=this.y,o=this.width,l=this.height,c=s.MIN_SIZE/n,d=s.MIN_SIZE/r,h=e=>Math.round(1e4*e)/1e4,u=this.#U(this.rotation),p=(e,t)=>[u[0]*e+u[2]*t,u[1]*e+u[3]*t],A=this.#U(360-this.rotation);let g,m,f=!1,b=!1;switch(e){case"topLeft":f=!0,g=(e,t)=>[0,0],m=(e,t)=>[e,t];break;case"topMiddle":g=(e,t)=>[e/2,0],m=(e,t)=>[e/2,t];break;case"topRight":f=!0,g=(e,t)=>[e,0],m=(e,t)=>[0,t];break;case"middleRight":b=!0,g=(e,t)=>[e,t/2],m=(e,t)=>[0,t/2];break;case"bottomRight":f=!0,g=(e,t)=>[e,t],m=(e,t)=>[0,0];break;case"bottomMiddle":g=(e,t)=>[e/2,t],m=(e,t)=>[e/2,0];break;case"bottomLeft":f=!0,g=(e,t)=>[0,t],m=(e,t)=>[e,0];break;case"middleLeft":b=!0,g=(e,t)=>[0,t/2],m=(e,t)=>[e,t/2]}const C=g(o,l),y=m(o,l);let v=p(...y);const x=h(a+v[0]),E=h(i+v[1]);let w=1,_=1,[B,I]=this.screenToPageTranslation(t.movementX,t.movementY);var k,S;if([B,I]=(k=B/n,S=I/r,[A[0]*k+A[2]*S,A[1]*k+A[3]*S]),f){const e=Math.hypot(o,l);w=_=Math.max(Math.min(Math.hypot(y[0]-C[0]-B,y[1]-C[1]-I)/e,1/o,1/l),c/o,d/l)}else b?w=Math.max(c,Math.min(1,Math.abs(y[0]-C[0]-B)))/o:_=Math.max(d,Math.min(1,Math.abs(y[1]-C[1]-I)))/l;const T=h(o*w),R=h(l*_);v=p(...m(T,R));const M=x-v[0],P=E-v[1];this.width=T,this.height=R,this.x=M,this.y=P,this.setDims(n*T,r*R),this.fixAndSetPosition()}async addAltTextButton(){if(this.#w)return;const e=this.#w=document.createElement("button");e.className="altText";const t=await s._l10nPromise.get("editor_alt_text_button_label");if(e.textContent=t,e.setAttribute("aria-label",t),e.tabIndex="0",e.addEventListener("contextmenu",i.noContextMenu),e.addEventListener("pointerdown",e=>e.stopPropagation()),e.addEventListener("click",e=>{e.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(t.preventDefault(),this._uiManager.editAltText(this))}),this.#H(),this.div.append(e),!s.SMALL_EDITOR_SIZE){const t=40;s.SMALL_EDITOR_SIZE=Math.min(128,Math.round(e.getBoundingClientRect().width*(1+t/100)))}}async#H(){const e=this.#w;if(!e)return;if(!this.#x&&!this.#E)return e.classList.remove("done"),void this.#_?.remove();s._l10nPromise.get("editor_alt_text_edit_button_label").then(t=>{e.setAttribute("aria-label",t)});let t=this.#_;if(!t){this.#_=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const n=t.id=`alt-text-tooltip-${this.id}`;e.setAttribute("aria-describedby",n);const r=100;e.addEventListener("mouseenter",()=>{this.#B=setTimeout(()=>{this.#B=null,this.#_.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},r)}),e.addEventListener("mouseleave",()=>{clearTimeout(this.#B),this.#B=null,this.#_?.classList.remove("show")})}e.classList.add("done"),t.innerText=this.#E?await s._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#x,t.parentNode||e.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#x,decorative:this.#E}}set altTextData({altText:e,decorative:t}){this.#x===e&&this.#E===t||(this.#x=e,this.#E=t,this.#H())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#S),this.div.addEventListener("focusout",this.#T);const[e,t]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,a]=this.getInitialTranslation();return this.translate(n,a),(0,r.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=a.FeatureTest.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(this.#R=!0,this.#W(e))}#W(e){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);let n,r;this._uiManager.setUpDragSession(),t&&(n={passive:!0,capture:!0},r=e=>{const[t,n]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(t,n)},window.addEventListener("pointermove",r,n));const i=()=>{if(window.removeEventListener("pointerup",i),window.removeEventListener("blur",i),t&&window.removeEventListener("pointermove",r,n),this.#R=!1,!this._uiManager.endDragSession()){const{isMac:t}=a.FeatureTest.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",i),window.addEventListener("blur",i)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t){const n=this.parentScale,[r,a]=this.pageDimensions,[i,s]=this.pageTranslation,o=e/n,l=t/n,c=this.x*r,d=this.y*a,h=this.width*r,u=this.height*a;switch(this.rotation){case 0:return[c+o+i,a-d-l-u+s,c+o+h+i,a-d-l+s];case 90:return[c+l+i,a-d+o+s,c+l+u+i,a-d+o+h+s];case 180:return[c-o-h+i,a-d+l+s,c-o+i,a-d+l+u+s];case 270:return[c-l-u+i,a-d-o-h+s,c-l+i,a-d-o+s];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,r,a,i]=e,s=a-n,o=i-r;switch(this.rotation){case 0:return[n,t-i,s,o];case 90:return[n,t-r,o,s];case 180:return[a,t-r,s,o];case 270:return[a,t-i,o,s];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#P=!0}disableEditMode(){this.#P=!1}isInEditMode(){return this.#P}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#S),this.div?.addEventListener("focusout",this.#T)}serialize(e=!1,t=null){(0,a.unreachable)("An editor must be serializable")}static deserialize(e,t,n){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});r.rotation=e.rotation;const[a,i]=r.pageDimensions,[s,o,l,c]=r.getRectInCurrentCoords(e.rect,i);return r.x=s/a,r.y=o/i,r.width=l/a,r.height=c/i,r}remove(){this.div.removeEventListener("focusin",this.#S),this.div.removeEventListener("focusout",this.#T),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#w?.remove(),this.#w=null,this.#_=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#k.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#k?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(e,t){}disableEditing(){this.#w&&(this.#w.hidden=!0)}enableEditing(){this.#w&&(this.#w.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#M}set isEditing(e){this.#M=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#I=!0;const n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}}t.AnnotationEditor=s;class o extends s{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=function(e,t,n){for(const r of n)t.addEventListener(r,e[r].bind(e))},t.opacityToHex=function(e){return Math.round(Math.min(255,Math.max(1,255*e))).toString(16).padStart(2,"0")};var r=n(1),a=n(6);class i{#Y=0;getId(){return`${r.AnnotationEditorPrefix}${this.#Y++}`}}class s{#G=(0,r.getUuid)();#Y=0;#V=null;static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d"),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';const n=t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]));return(0,r.shadow)(this,"_isSVGFittingCanvas",n)}async#X(e,t){this.#V||=new Map;let n=this.#V.get(e);if(null===n)return null;if(n?.bitmap)return n.refCounter+=1,n;try{let e;if(n||={bitmap:null,id:`image_${this.#G}_${this.#Y++}`,refCounter:0,isSvg:!1},"string"==typeof t){n.url=t;const r=await fetch(t);if(!r.ok)throw new Error(r.statusText);e=await r.blob()}else e=n.file=t;if("image/svg+xml"===e.type){const t=s._isSVGFittingCanvas,r=new FileReader,a=new Image,i=new Promise((e,i)=>{a.onload=()=>{n.bitmap=a,n.isSvg=!0,e()},r.onload=async()=>{const e=n.svgUrl=r.result;a.src=await t?`${e}#svgView(preserveAspectRatio(none))`:e},a.onerror=r.onerror=i});r.readAsDataURL(e),await i}else n.bitmap=await createImageBitmap(e);n.refCounter=1}catch(e){console.error(e),n=null}return this.#V.set(e,n),n&&this.#V.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:r,type:a}=e;return this.#X(`${t}_${n}_${r}_${a}`,e)}async getFromUrl(e){return this.#X(e,e)}async getFromId(e){this.#V||=new Map;const t=this.#V.get(e);return t?t.bitmap?(t.refCounter+=1,t):t.file?this.getFromFile(t.file):this.getFromUrl(t.url):null}getSvgUrl(e){const t=this.#V.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#V||=new Map;const t=this.#V.get(e);t&&(t.refCounter-=1,0===t.refCounter&&(t.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#G}_`)}}class o{#$=[];#K=!1;#Q;#J=-1;constructor(e=128){this.#Q=e}add({cmd:e,undo:t,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:i=!1}){if(n&&e(),this.#K)return;const s={cmd:e,undo:t,type:r};if(-1===this.#J)return this.#$.length>0&&(this.#$.length=0),this.#J=0,void this.#$.push(s);if(a&&this.#$[this.#J].type===r)return i&&(s.undo=this.#$[this.#J].undo),void(this.#$[this.#J]=s);const o=this.#J+1;o===this.#Q?this.#$.splice(0,1):(this.#J=o,o<this.#$.length&&this.#$.splice(o)),this.#$.push(s)}undo(){-1!==this.#J&&(this.#K=!0,this.#$[this.#J].undo(),this.#K=!1,this.#J-=1)}redo(){this.#J<this.#$.length-1&&(this.#J+=1,this.#K=!0,this.#$[this.#J].cmd(),this.#K=!1)}hasSomethingToUndo(){return-1!==this.#J}hasSomethingToRedo(){return this.#J<this.#$.length-1}destroy(){this.#$=null}}t.CommandManager=o;class l{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=r.FeatureTest.platform;for(const[n,r,a={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:r,options:a}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:r,options:a}),this.allKeys.add(e.split("+").at(-1)))}}#Z(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#Z(t));if(!n)return;const{callback:r,options:{bubbles:a=!1,args:i=[],checker:s=null}}=n;s&&!s(e,t)||(r.bind(e,...i)(),a||(t.stopPropagation(),t.preventDefault()))}}t.KeyboardManager=l;class c{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)(e),(0,r.shadow)(this,"_colors",e)}convert(e){const t=(0,a.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[e,n]of this._colors)if(n.every((e,n)=>e===t[n]))return c._colorsMapping.get(e);return t}getHexCode(e){const t=this._colors.get(e);return t?r.Util.makeHexColor(...t):e}}t.ColorManager=c;class d{#ee=null;#te=new Map;#ne=new Map;#re=null;#ae=null;#ie=new o;#se=0;#oe=new Set;#le=null;#ce=null;#de=new Set;#he=null;#ue=new i;#pe=!1;#Ae=!1;#ge=null;#me=r.AnnotationEditorType.NONE;#fe=new Set;#be=null;#Ce=this.blur.bind(this);#ye=this.focus.bind(this);#ve=this.copy.bind(this);#xe=this.cut.bind(this);#Ee=this.paste.bind(this);#we=this.keydown.bind(this);#_e=this.onEditingAction.bind(this);#Be=this.onPageChanging.bind(this);#Ie=this.onScaleChanging.bind(this);#ke=this.onRotationChanging.bind(this);#Se={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#Te=[0,0];#Re=null;#Me=null;#Pe=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=d.prototype,t=e=>{const{activeElement:t}=document;return t&&e.#Me.contains(t)&&e.hasSomethingToControl()},n=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new l([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,n,r,i,s){this.#Me=e,this.#Pe=t,this.#re=n,this._eventBus=r,this._eventBus._on("editingaction",this.#_e),this._eventBus._on("pagechanging",this.#Be),this._eventBus._on("scalechanging",this.#Ie),this._eventBus._on("rotationchanging",this.#ke),this.#ae=i.annotationStorage,this.#he=i.filterFactory,this.#be=s,this.viewParameters={realScale:a.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#Fe(),this.#De(),this._eventBus._off("editingaction",this.#_e),this._eventBus._off("pagechanging",this.#Be),this._eventBus._off("scalechanging",this.#Ie),this._eventBus._off("rotationchanging",this.#ke);for(const e of this.#ne.values())e.destroy();this.#ne.clear(),this.#te.clear(),this.#de.clear(),this.#ee=null,this.#fe.clear(),this.#ie.destroy(),this.#re.destroy()}get hcmFilter(){return(0,r.shadow)(this,"hcmFilter",this.#be?this.#he.addHCMFilter(this.#be.foreground,this.#be.background):"none")}get direction(){return(0,r.shadow)(this,"direction",getComputedStyle(this.#Me).direction)}editAltText(e){this.#re?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#se=e-1}focusMainContainer(){this.#Me.focus()}findParent(e,t){for(const n of this.#ne.values()){const{x:r,y:a,width:i,height:s}=n.div.getBoundingClientRect();if(e>=r&&e<=r+i&&t>=a&&t<=a+s)return n}return null}disableUserSelect(e=!1){this.#Pe.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#de.add(e)}removeShouldRescale(e){this.#de.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*a.PixelsPerInch.PDF_TO_CSS_UNITS;for(const e of this.#de)e.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){e.isEmpty()||!this.#ae||this.#ae.has(e.id)||this.#ae.setValue(e.id,e)}#Oe(){window.addEventListener("focus",this.#ye),window.addEventListener("blur",this.#Ce)}#De(){window.removeEventListener("focus",this.#ye),window.removeEventListener("blur",this.#Ce)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#fe)if(t.div.contains(e)){this.#ge=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#ge)return;const[e,t]=this.#ge;this.#ge=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),t.focus()}#Le(){window.addEventListener("keydown",this.#we,{capture:!0})}#Fe(){window.removeEventListener("keydown",this.#we,{capture:!0})}#Ne(){document.addEventListener("copy",this.#ve),document.addEventListener("cut",this.#xe),document.addEventListener("paste",this.#Ee)}#Ue(){document.removeEventListener("copy",this.#ve),document.removeEventListener("cut",this.#xe),document.removeEventListener("paste",this.#Ee)}addEditListeners(){this.#Le(),this.#Ne()}removeEditListeners(){this.#Fe(),this.#Ue()}copy(e){if(e.preventDefault(),this.#ee?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const e of this.#fe){const n=e.serialize(!0);n&&t.push(n)}0!==t.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:t}=e;for(const e of t.items)for(const t of this.#ce)if(t.isHandlingMimeForPasting(e.type))return void t.paste(e,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(e){return void(0,r.warn)(`paste: "${e.message}".`)}if(!Array.isArray(n))return;this.unselectAll();const a=this.currentLayer;try{const e=[];for(const t of n){const n=a.deserialize(t);if(!n)return;e.push(n)}const t=()=>{for(const t of e)this.#je(t);this.#ze(e)},r=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:r,mustExec:!0})}catch(e){(0,r.warn)(`paste: "${e.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||d._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#qe(e){Object.entries(e).some(([e,t])=>this.#Se[e]!==t)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Se,e)})}#He(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#Oe(),this.#Le(),this.#Ne(),this.#qe({isEditing:this.#me!==r.AnnotationEditorType.NONE,isEmpty:this.#We(),hasSomethingToUndo:this.#ie.hasSomethingToUndo(),hasSomethingToRedo:this.#ie.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#De(),this.#Fe(),this.#Ue(),this.#qe({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#ce){this.#ce=e;for(const e of this.#ce)this.#He(e.defaultPropertiesToUpdate)}}getId(){return this.#ue.getId()}get currentLayer(){return this.#ne.get(this.#se)}getLayer(e){return this.#ne.get(e)}get currentPageIndex(){return this.#se}addLayer(e){this.#ne.set(e.pageIndex,e),this.#pe?e.enable():e.disable()}removeLayer(e){this.#ne.delete(e.pageIndex)}updateMode(e,t=null){if(this.#me!==e){if(this.#me=e,e===r.AnnotationEditorType.NONE)return this.setEditingState(!1),void this.#Ye();this.setEditingState(!0),this.#Ge(),this.unselectAll();for(const t of this.#ne.values())t.updateMode(e);if(t)for(const e of this.#te.values())if(e.annotationElementId===t){this.setSelected(e),e.enterInEditMode();break}}}updateToolbar(e){e!==this.#me&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#ce)if(e!==r.AnnotationEditorParamsType.CREATE){for(const n of this.#fe)n.updateParams(e,t);for(const n of this.#ce)n.updateDefaultParams(e,t)}else this.currentLayer.addNewEditor(e)}enableWaiting(e=!1){if(this.#Ae!==e){this.#Ae=e;for(const t of this.#ne.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}#Ge(){if(!this.#pe){this.#pe=!0;for(const e of this.#ne.values())e.enable()}}#Ye(){if(this.unselectAll(),this.#pe){this.#pe=!1;for(const e of this.#ne.values())e.disable()}}getEditors(e){const t=[];for(const n of this.#te.values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return this.#te.get(e)}addEditor(e){this.#te.set(e.id,e)}removeEditor(e){this.#te.delete(e.id),this.unselect(e),e.annotationElementId&&this.#oe.has(e.annotationElementId)||this.#ae?.remove(e.id)}addDeletedAnnotationElement(e){this.#oe.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#oe.has(e)}removeDeletedAnnotationElement(e){this.#oe.delete(e.annotationElementId),e.deleted=!1}#je(e){const t=this.#ne.get(e.pageIndex);t?t.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#ee!==e&&(this.#ee=e,e&&this.#He(e.propertiesToUpdate))}toggleSelected(e){if(this.#fe.has(e))return this.#fe.delete(e),e.unselect(),void this.#qe({hasSelectedEditor:this.hasSelection});this.#fe.add(e),e.select(),this.#He(e.propertiesToUpdate),this.#qe({hasSelectedEditor:!0})}setSelected(e){for(const t of this.#fe)t!==e&&t.unselect();this.#fe.clear(),this.#fe.add(e),e.select(),this.#He(e.propertiesToUpdate),this.#qe({hasSelectedEditor:!0})}isSelected(e){return this.#fe.has(e)}unselect(e){e.unselect(),this.#fe.delete(e),this.#qe({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#fe.size}undo(){this.#ie.undo(),this.#qe({hasSomethingToUndo:this.#ie.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#We()})}redo(){this.#ie.redo(),this.#qe({hasSomethingToUndo:!0,hasSomethingToRedo:this.#ie.hasSomethingToRedo(),isEmpty:this.#We()})}addCommands(e){this.#ie.add(e),this.#qe({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#We()})}#We(){if(0===this.#te.size)return!0;if(1===this.#te.size)for(const e of this.#te.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#fe];this.addCommands({cmd:()=>{for(const t of e)t.remove()},undo:()=>{for(const t of e)this.#je(t)},mustExec:!0})}commitOrRemove(){this.#ee?.commitOrRemove()}hasSomethingToControl(){return this.#ee||this.hasSelection}#ze(e){this.#fe.clear();for(const t of e)t.isEmpty()||(this.#fe.add(t),t.select());this.#qe({hasSelectedEditor:!0})}selectAll(){for(const e of this.#fe)e.commit();this.#ze(this.#te.values())}unselectAll(){if(this.#ee)this.#ee.commitOrRemove();else if(this.hasSelection){for(const e of this.#fe)e.unselect();this.#fe.clear(),this.#qe({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#Te[0]+=e,this.#Te[1]+=t;const[r,a]=this.#Te,i=[...this.#fe];this.#Re&&clearTimeout(this.#Re),this.#Re=setTimeout(()=>{this.#Re=null,this.#Te[0]=this.#Te[1]=0,this.addCommands({cmd:()=>{for(const e of i)this.#te.has(e.id)&&e.translateInPage(r,a)},undo:()=>{for(const e of i)this.#te.has(e.id)&&e.translateInPage(-r,-a)},mustExec:!1})},1e3);for(const n of i)n.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#le=new Map;for(const e of this.#fe)this.#le.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#le)return!1;this.disableUserSelect(!1);const e=this.#le;this.#le=null;let t=!1;for(const[{x:n,y:r,pageIndex:a},i]of e)i.newX=n,i.newY=r,i.newPageIndex=a,t||=n!==i.savedX||r!==i.savedY||a!==i.savedPageIndex;if(!t)return!1;const n=(e,t,n,r)=>{if(this.#te.has(e.id)){const a=this.#ne.get(r);a?e._setParentAndPosition(a,t,n):(e.pageIndex=r,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:r,newY:a,newPageIndex:i}]of e)n(t,r,a,i)},undo:()=>{for(const[t,{savedX:r,savedY:a,savedPageIndex:i}]of e)n(t,r,a,i)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#le)for(const n of this.#le.keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#ee===e}getActive(){return this.#ee}getMode(){return this.#me}get imageManager(){return(0,r.shadow)(this,"imageManager",new s)}}t.AnnotationEditorUIManager=d},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getColorValues=function(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const n of e.keys()){t.style.color=n;const r=window.getComputedStyle(t).color;e.set(n,b(r))}t.remove()},t.getCurrentTransform=function(e){const{a:t,b:n,c:r,d:a,e:i,f:s}=e.getTransform();return[t,n,r,a,i,s]},t.getCurrentTransformInverse=function(e){const{a:t,b:n,c:r,d:a,e:i,f:s}=e.getTransform().invertSelf();return[t,n,r,a,i,s]},t.getFilenameFromUrl=function(e,t=!1){return t||([e]=e.split(/[#?]/,1)),e.substring(e.lastIndexOf("/")+1)},t.getPdfFilenameFromUrl=function(e,t="document.pdf"){if("string"!=typeof e)return t;if(g(e))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let i=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(i&&(i=i[0],i.includes("%")))try{i=n.exec(decodeURIComponent(i))[0]}catch{}return i||t},t.getRGB=b,t.getXfaPageViewport=function(e,{scale:t=1,rotation:n=0}){const{width:r,height:a}=e.attributes.style,i=[0,0,parseInt(r),parseInt(a)];return new p({viewBox:i,scale:t,rotation:n})},t.isDataScheme=g,t.isPdfFile=function(e){return"string"==typeof e&&/\.pdf$/i.test(e)},t.isValidFetchUrl=m,t.loadScript=function(e,t=!1){return new Promise((n,r)=>{const a=document.createElement("script");a.src=e,a.onload=function(e){t&&a.remove(),n(e)},a.onerror=function(){r(new Error(`Cannot load script at: ${a.src}`))},(document.head||document.documentElement).append(a)})},t.noContextMenu=function(e){e.preventDefault()},t.setLayerDimensions=function(e,t,n=!1,r=!0){if(t instanceof p){const{pageWidth:r,pageHeight:i}=t.rawDims,{style:s}=e,o=a.FeatureTest.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,c=`var(--scale-factor) * ${i}px`,d=o?`round(${l}, 1px)`:`calc(${l})`,h=o?`round(${c}, 1px)`:`calc(${c})`;n&&t.rotation%180!=0?(s.width=h,s.height=d):(s.width=d,s.height=h)}r&&e.setAttribute("data-main-rotation",t.rotation)};var r=n(7),a=n(1);const i="http://www.w3.org/2000/svg";class s{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}t.PixelsPerInch=s;class o extends r.BaseFilterFactory{#Ve;#Xe;#t;#$e;#Ke;#Qe;#Je;#Ze;#et;#tt;#Y=0;constructor({docId:e,ownerDocument:t=globalThis.document}={}){super(),this.#t=e,this.#$e=t}get#V(){return this.#Ve||=new Map}get#nt(){if(!this.#Xe){const e=this.#$e.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#$e.createElementNS(i,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#Xe=this.#$e.createElementNS(i,"defs"),e.append(n),n.append(this.#Xe),this.#$e.body.append(e)}return this.#Xe}addFilter(e){if(!e)return"none";let t,n,r,a,i=this.#V.get(e);if(i)return i;if(1===e.length){const i=e[0],s=new Array(256);for(let e=0;e<256;e++)s[e]=i[e]/255;a=t=n=r=s.join(",")}else{const[i,s,o]=e,l=new Array(256),c=new Array(256),d=new Array(256);for(let e=0;e<256;e++)l[e]=i[e]/255,c[e]=s[e]/255,d[e]=o[e]/255;t=l.join(","),n=c.join(","),r=d.join(","),a=`${t}${n}${r}`}if(i=this.#V.get(a),i)return this.#V.set(e,i),i;const s=`g_${this.#t}_transfer_map_${this.#Y++}`,o=`url(#${s})`;this.#V.set(e,o),this.#V.set(a,o);const l=this.#rt(s);return this.#at(t,n,r,l),o}addHCMFilter(e,t){const n=`${e}-${t}`;if(this.#Qe===n)return this.#Je;if(this.#Qe=n,this.#Je="none",this.#Ke?.remove(),!e||!t)return this.#Je;const r=this.#it(e);e=a.Util.makeHexColor(...r);const i=this.#it(t);if(t=a.Util.makeHexColor(...i),this.#nt.style.color="","#000000"===e&&"#ffffff"===t||e===t)return this.#Je;const s=new Array(256);for(let e=0;e<=255;e++){const t=e/255;s[e]=t<=.03928?t/12.92:((t+.055)/1.055)**2.4}const o=s.join(","),l=`g_${this.#t}_hcm_filter`,c=this.#Ze=this.#rt(l);this.#at(o,o,o,c),this.#st(c);const d=(e,t)=>{const n=r[e]/255,a=i[e]/255,s=new Array(t+1);for(let e=0;e<=t;e++)s[e]=n+e/t*(a-n);return s.join(",")};return this.#at(d(0,5),d(1,5),d(2,5),c),this.#Je=`url(#${l})`,this.#Je}addHighlightHCMFilter(e,t,n,r){const a=`${e}-${t}-${n}-${r}`;if(this.#et===a)return this.#tt;if(this.#et=a,this.#tt="none",this.#Ze?.remove(),!e||!t)return this.#tt;const[i,s]=[e,t].map(this.#it.bind(this));let o=Math.round(.2126*i[0]+.7152*i[1]+.0722*i[2]),l=Math.round(.2126*s[0]+.7152*s[1]+.0722*s[2]),[c,d]=[n,r].map(this.#it.bind(this));l<o&&([o,l,c,d]=[l,o,d,c]),this.#nt.style.color="";const h=(e,t,n)=>{const r=new Array(256),a=(l-o)/n,i=e/255,s=(t-e)/(255*n);let c=0;for(let e=0;e<=n;e++){const t=Math.round(o+e*a),n=i+e*s;for(let e=c;e<=t;e++)r[e]=n;c=t+1}for(let e=c;e<256;e++)r[e]=r[c-1];return r.join(",")},u=`g_${this.#t}_hcm_highlight_filter`,p=this.#Ze=this.#rt(u);return this.#st(p),this.#at(h(c[0],d[0],5),h(c[1],d[1],5),h(c[2],d[2],5),p),this.#tt=`url(#${u})`,this.#tt}destroy(e=!1){e&&(this.#Je||this.#tt)||(this.#Xe&&(this.#Xe.parentNode.parentNode.remove(),this.#Xe=null),this.#Ve&&(this.#Ve.clear(),this.#Ve=null),this.#Y=0)}#st(e){const t=this.#$e.createElementNS(i,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#rt(e){const t=this.#$e.createElementNS(i,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#nt.append(t),t}#ot(e,t,n){const r=this.#$e.createElementNS(i,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)}#at(e,t,n,r){const a=this.#$e.createElementNS(i,"feComponentTransfer");r.append(a),this.#ot(a,"feFuncR",e),this.#ot(a,"feFuncG",t),this.#ot(a,"feFuncB",n)}#it(e){return this.#nt.style.color=e,b(getComputedStyle(this.#nt).getPropertyValue("color"))}}t.DOMFilterFactory=o;class l extends r.BaseCanvasFactory{constructor({ownerDocument:e=globalThis.document}={}){super(),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}async function c(e,t=!1){if(m(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);return t?new Uint8Array(await n.arrayBuffer()):(0,a.stringToBytes)(await n.text())}return new Promise((n,r)=>{const i=new XMLHttpRequest;i.open("GET",e,!0),t&&(i.responseType="arraybuffer"),i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(200===i.status||0===i.status){let e;if(t&&i.response?e=new Uint8Array(i.response):!t&&i.responseText&&(e=(0,a.stringToBytes)(i.responseText)),e)return void n(e)}r(new Error(i.statusText))}},i.send(null)})}t.DOMCanvasFactory=l;class d extends r.BaseCMapReaderFactory{_fetchData(e,t){return c(e,this.isCompressed).then(e=>({cMapData:e,compressionType:t}))}}t.DOMCMapReaderFactory=d;class h extends r.BaseStandardFontDataFactory{_fetchData(e){return c(e,!0)}}t.DOMStandardFontDataFactory=h;class u extends r.BaseSVGFactory{_createSVG(e){return document.createElementNS(i,e)}}t.DOMSVGFactory=u;class p{constructor({viewBox:e,scale:t,rotation:n,offsetX:r=0,offsetY:a=0,dontFlip:i=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=r,this.offsetY=a;const s=(e[2]+e[0])/2,o=(e[3]+e[1])/2;let l,c,d,h,u,p,A,g;switch((n%=360)<0&&(n+=360),n){case 180:l=-1,c=0,d=0,h=1;break;case 90:l=0,c=1,d=1,h=0;break;case 270:l=0,c=-1,d=-1,h=0;break;case 0:l=1,c=0,d=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}i&&(d=-d,h=-h),0===l?(u=Math.abs(o-e[1])*t+r,p=Math.abs(s-e[0])*t+a,A=(e[3]-e[1])*t,g=(e[2]-e[0])*t):(u=Math.abs(s-e[0])*t+r,p=Math.abs(o-e[1])*t+a,A=(e[2]-e[0])*t,g=(e[3]-e[1])*t),this.transform=[l*t,c*t,d*t,h*t,u-l*t*s-d*t*o,p-c*t*s-h*t*o],this.width=A,this.height=g}get rawDims(){const{viewBox:e}=this;return(0,a.shadow)(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:a})}convertToViewportPoint(e,t){return a.Util.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=a.Util.applyTransform([e[0],e[1]],this.transform),n=a.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return a.Util.applyInverseTransform([e,t],this.transform)}}t.PageViewport=p;class A extends a.BaseException{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function g(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function m(e,t){try{const{protocol:n}=t?new URL(e,t):new URL(e);return"http:"===n||"https:"===n}catch{return!1}}let f;function b(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):((0,a.warn)(`Not a valid color format: "${e}"`),[0,0,0])}t.RenderingCancelledException=A,t.StatTimer=class{started=Object.create(null);times=[];time(e){e in this.started&&(0,a.warn)(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,a.warn)(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:e}of this.times)t=Math.max(e.length,t);for(const{name:n,start:r,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-r}ms\n`);return e.join("")}},t.PDFDateString=class{static toDateObject(e){if(!e||"string"!=typeof e)return null;f||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=f.exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let i=parseInt(t[4],10);i=i>=0&&i<=23?i:0;let s=parseInt(t[5],10);s=s>=0&&s<=59?s:0;let o=parseInt(t[6],10);o=o>=0&&o<=59?o:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(i+=c,s+=d):"+"===l&&(i-=c,s-=d),new Date(Date.UTC(n,r,a,i,s,o))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var r=n(1);class a{constructor(){this.constructor===a&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addHighlightHCMFilter(e,t,n,r){return"none"}destroy(e=!1){}}t.BaseFilterFactory=a;class i{constructor(){this.constructor===i&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d")}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=i;class s{constructor({baseUrl:e=null,isCompressed:t=!0}){this.constructor===s&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":""),n=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(t,n).catch(e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}_fetchData(e,t){(0,r.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=s;class o{constructor({baseUrl:e=null}){this.constructor===o&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetchData(t).catch(e=>{throw new Error(`Unable to load font data at: ${t}`)})}_fetchData(e){(0,r.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=o;class l{constructor(){this.constructor===l&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if("string"!=typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){(0,r.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var r=n(1);const a=3285377520,i=4294901760,s=65535;t.MurmurHash3_64=class{constructor(e){this.h1=e?4294967295&e:a,this.h2=e?4294967295&e:a}update(e){let t,n;if("string"==typeof e){t=new Uint8Array(2*e.length),n=0;for(let r=0,a=e.length;r<a;r++){const a=e.charCodeAt(r);a<=255?t[n++]=a:(t[n++]=a>>>8,t[n++]=255&a)}}else{if(!(0,r.isArrayBuffer)(e))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");t=e.slice(),n=t.byteLength}const a=n>>2,o=n-4*a,l=new Uint32Array(t.buffer,0,a);let c=0,d=0,h=this.h1,u=this.h2;const p=3432918353,A=461845907,g=11601,m=13715;for(let e=0;e<a;e++)1&e?(c=l[e],c=c*p&i|c*g&s,c=c<<15|c>>>17,c=c*A&i|c*m&s,h^=c,h=h<<13|h>>>19,h=5*h+3864292196):(d=l[e],d=d*p&i|d*g&s,d=d<<15|d>>>17,d=d*A&i|d*m&s,u^=d,u=u<<13|u>>>19,u=5*u+3864292196);switch(c=0,o){case 3:c^=t[4*a+2]<<16;case 2:c^=t[4*a+1]<<8;case 1:c^=t[4*a],c=c*p&i|c*g&s,c=c<<15|c>>>17,c=c*A&i|c*m&s,1&a?h^=c:u^=c}this.h1=h,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&i|36045*e&s,t=4283543511*t&i|(2950163797*(t<<16|e>>>16)&i)>>>16,e^=t>>>1,e=444984403*e&i|60499*e&s,t=3301882366*t&i|(3120437893*(t<<16|e>>>16)&i)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var r=n(1);t.FontLoader=class{#lt=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#lt.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){if(e&&!this.#lt.has(e.loadedName)){if((0,r.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:t,src:n,style:a}=e,i=new FontFace(t,n,a);this.addNativeFontFace(i);try{await i.load(),this.#lt.add(t)}catch{(0,r.warn)(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(i)}return}(0,r.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e.systemFontInfo);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw(0,r.warn)(`Failed to load font '${t.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return(0,r.shadow)(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(r.isNodeJS||"undefined"!=typeof navigator&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for((0,r.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function a(e,t,n,r){return e.substring(0,t)+r+e.substring(t+n)}let i,s;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;const d=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=a(h,976,d.length,d);const u=1482184792;let p=n(h,16);for(i=0,s=d.length-3;i<s;i+=4)p=p-u+n(d,i)|0;i<d.length&&(p=p-u+n(d+"XXX",i)|0),h=a(h,16,4,(0,r.string32)(p));const A=`@font-face {font-family:"${d}";src:url(data:font/opentype;base64,${btoa(h)});}`;this.insertRule(A);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const t of[e.loadedName,d]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=t,g.append(e)}this._document.body.append(g),function e(t,n){if(++c>30)return(0,r.warn)("Load test font never loaded."),void n();l.font="30px "+t,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(d,()=>{g.remove(),t.complete()})}},t.FontFaceObject=class{constructor(e,{isEvalSupported:t=!0,disableFontFace:n=!1,ignoreErrors:r=!1,inspectFont:a=null}){this.compiledGlyphs=Object.create(null);for(const t in e)this[t]=e[t];this.isEvalSupported=!1!==t,this.disableFontFace=!0===n,this.ignoreErrors=!0===r,this._inspectFont=a}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}else e=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=(0,r.bytesToString)(this.data),t=`url(data:${this.mimetype};base64,${btoa(e)});`;let n;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this._inspectFont?.(this,t),n}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return(0,r.warn)(`getPathGenerator - ignoring character: "${e}".`),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){const e=[];for(const t of n){const n=void 0!==t.args?t.args.join(","):"";e.push("c.",t.cmd,"(",n,");\n")}return this.compiledGlyphs[t]=new Function("c","size",e.join(""))}return this.compiledGlyphs[t]=function(e,t){for(const r of n)"scale"===r.cmd&&(r.args=[t,-t]),e[r.cmd].apply(e,r.args)}}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var r=n(7);n(1);const a=function(e){return new Promise((t,n)=>{__webpack_require__(23237).readFile(e,(e,r)=>{!e&&r?t(new Uint8Array(r)):n(new Error(e))})})};class i extends r.BaseFilterFactory{}t.NodeFilterFactory=i;class s extends r.BaseCanvasFactory{_createCanvas(e,t){return __webpack_require__(17640).createCanvas(e,t)}}t.NodeCanvasFactory=s;class o extends r.BaseCMapReaderFactory{_fetchData(e,t){return a(e).then(e=>({cMapData:e,compressionType:t}))}}t.NodeCMapReaderFactory=o;class l extends r.BaseStandardFontDataFactory{_fetchData(e){return a(e)}}t.NodeStandardFontDataFactory=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var r=n(1),a=n(6),i=n(12),s=n(13);const o=4096,l=16;class c{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return void 0!==this.cache[e]?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function d(e,t,n,r,i,s,o,l,c,d){const[h,u,p,A,g,m]=(0,a.getCurrentTransform)(e);if(0===u&&0===p){const a=o*h+g,f=Math.round(a),b=l*A+m,C=Math.round(b),y=(o+c)*h+g,v=Math.abs(Math.round(y)-f)||1,x=(l+d)*A+m,E=Math.abs(Math.round(x)-C)||1;return e.setTransform(Math.sign(h),0,0,Math.sign(A),f,C),e.drawImage(t,n,r,i,s,0,0,v,E),e.setTransform(h,u,p,A,g,m),[v,E]}if(0===h&&0===A){const a=l*p+g,f=Math.round(a),b=o*u+m,C=Math.round(b),y=(l+d)*p+g,v=Math.abs(Math.round(y)-f)||1,x=(o+c)*u+m,E=Math.abs(Math.round(x)-C)||1;return e.setTransform(0,Math.sign(u),Math.sign(p),0,f,C),e.drawImage(t,n,r,i,s,0,0,E,v),e.setTransform(h,u,p,A,g,m),[E,v]}return e.drawImage(t,n,r,i,s,o,l,c,d),[Math.hypot(h,u)*c,Math.hypot(p,A)*d]}class h{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=r.Util.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=r.Util.applyTransform(t,e),a=r.Util.applyTransform(t.slice(2),e);this.minX=Math.min(this.minX,n[0],a[0]),this.minY=Math.min(this.minY,n[1],a[1]),this.maxX=Math.max(this.maxX,n[0],a[0]),this.maxY=Math.max(this.maxY,n[1],a[1])}updateScalingPathMinMax(e,t){r.Util.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.maxX=Math.max(this.maxX,t[1]),this.minY=Math.min(this.minY,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,a,i,s,o,l,c,d){const h=r.Util.bezierBoundingBox(t,n,a,i,s,o,l,c);if(d)return d[0]=Math.min(d[0],h[0],h[2]),d[1]=Math.max(d[1],h[0],h[2]),d[2]=Math.min(d[2],h[1],h[3]),void(d[3]=Math.max(d[3],h[1],h[3]));this.updateRectMinMax(e,h)}getPathBoundingBox(e=i.PathType.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===i.PathType.STROKE){t||(0,r.unreachable)("Stroke bounding box must include transform.");const e=r.Util.singularValueDecompose2dScale(t),a=e[0]*this.lineWidth/2,i=e[1]*this.lineWidth/2;n[0]-=a,n[1]-=i,n[2]+=a,n[3]+=i}return n}updateClipFromPath(){const e=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=i.PathType.FILL,t=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function u(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,a=t.width,i=n%l,s=(n-i)/l,o=0===i?s:s+1,c=e.createImageData(a,l);let d,h=0;const u=t.data,p=c.data;let A,g,m,f;if(t.kind===r.ImageKind.GRAYSCALE_1BPP){const t=u.byteLength,n=new Uint32Array(p.buffer,0,p.byteLength>>2),f=n.length,b=a+7>>3,C=4294967295,y=r.FeatureTest.isLittleEndian?4278190080:255;for(A=0;A<o;A++){for(m=A<s?l:i,d=0,g=0;g<m;g++){const e=t-h;let r=0;const i=e>b?a:8*e-7,s=-8&i;let o=0,l=0;for(;r<s;r+=8)l=u[h++],n[d++]=128&l?C:y,n[d++]=64&l?C:y,n[d++]=32&l?C:y,n[d++]=16&l?C:y,n[d++]=8&l?C:y,n[d++]=4&l?C:y,n[d++]=2&l?C:y,n[d++]=1&l?C:y;for(;r<i;r++)0===o&&(l=u[h++],o=128),n[d++]=l&o?C:y,o>>=1}for(;d<f;)n[d++]=0;e.putImageData(c,0,A*l)}}else if(t.kind===r.ImageKind.RGBA_32BPP){for(g=0,f=a*l*4,A=0;A<s;A++)p.set(u.subarray(h,h+f)),h+=f,e.putImageData(c,0,g),g+=l;A<o&&(f=a*i*4,p.set(u.subarray(h,h+f)),e.putImageData(c,0,g))}else{if(t.kind!==r.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);for(m=l,f=a*m,A=0;A<o;A++){for(A>=s&&(m=i,f=a*m),d=0,g=f;g--;)p[d++]=u[h++],p[d++]=u[h++],p[d++]=u[h++],p[d++]=255;e.putImageData(c,0,A*l)}}}function p(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,r=t.width,a=n%l,i=(n-a)/l,o=0===a?i:i+1,c=e.createImageData(r,l);let d=0;const h=t.data,u=c.data;for(let t=0;t<o;t++){const n=t<i?l:a;({srcPos:d}=(0,s.convertBlackAndWhiteToRGBA)({src:h,srcPos:d,dest:u,width:r,height:n,nonBlackColor:0})),e.putImageData(c,0,t*l)}}function A(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of n)void 0!==e[r]&&(t[r]=e[r]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function g(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0),!r.isNodeJS){const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}}function m(e,t,n,r){const a=e.length;for(let i=3;i<a;i+=4){const a=e[i];if(0===a)e[i-3]=t,e[i-2]=n,e[i-1]=r;else if(a<255){const s=255-a;e[i-3]=e[i-3]*a+t*s>>8,e[i-2]=e[i-2]*a+n*s>>8,e[i-1]=e[i-1]*a+r*s>>8}}}function f(e,t,n){const r=e.length,a=1/255;for(let i=3;i<r;i+=4){const r=n?n[e[i]]:e[i];t[i]=t[i]*r*a|0}}function b(e,t,n){const r=e.length;for(let a=3;a<r;a+=4){const r=77*e[a-3]+152*e[a-2]+28*e[a-1];t[a]=n?t[a]*n[r>>8]>>8:t[a]*r>>16}}function C(e,t){const n=r.Util.singularValueDecompose2dScale(e);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*a.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==t?t:n[0]<=i||n[1]<=i}const y=["butt","round","square"],v=["miter","round","bevel"],x={},E={};class w{constructor(e,t,n,r,a,{optionalContentConfig:i,markedContentStack:s=null},o,l){this.ctx=e,this.current=new h(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=s||[],this.optionalContentConfig=i,this.cachedCanvases=new c(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return"string"==typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){const i=this.ctx.canvas.width,s=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,s),this.ctx.fillStyle=o,n){const e=this.cachedCanvases.getCanvas("transparent",i,s);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...(0,a.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),g(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=(0,a.getCurrentTransform)(this.ctx)}executeOperatorList(e,t,n,a){const i=e.argsArray,s=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const c=l-o>10&&"function"==typeof n,d=c?Date.now()+15:0;let h=0;const u=this.commonObjs,p=this.objs;let A;for(;;){if(void 0!==a&&o===a.nextBreakPoint)return a.breakIt(o,n),o;if(A=s[o],A!==r.OPS.dependency)this[A].apply(this,i[o]);else for(const e of i[o]){const t=e.startsWith("g_")?u:p;if(!t.has(e))return t.get(e,n),o}if(o++,o===l)return o;if(c&&++h>10){if(Date.now()>d)return n(),o;h=0}}}#ct(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#ct(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#dt()}#dt(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width,r=e.height;let a,i,s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=n,c=r,d="prescale1";for(;s>2&&l>1||o>2&&c>1;){let t=l,n=c;s>2&&l>1&&(t=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/t),o>2&&c>1&&(n=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/n),a=this.cachedCanvases.getCanvas(d,t,n),i=a.context,i.clearRect(0,0,t,n),i.drawImage(e,0,0,l,c,0,0,t,n),e=a.canvas,l=t,c=n,d="prescale1"===d?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,o=this.current.fillColor,l=this.current.patternFill,c=(0,a.getCurrentTransform)(t);let h,u,A,g;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;u=JSON.stringify(l?c:[c.slice(0,4),o]),h=this._cachedBitmapsMap.get(t),h||(h=new Map,this._cachedBitmapsMap.set(t,h));const n=h.get(u);if(n&&!l)return{canvas:n,offsetX:Math.round(Math.min(c[0],c[2])+c[4]),offsetY:Math.round(Math.min(c[1],c[3])+c[5])};A=n}A||(g=this.cachedCanvases.getCanvas("maskCanvas",n,s),p(g.context,e));let m=r.Util.transform(c,[1/n,0,0,-1/s,0,0]);m=r.Util.transform(m,[1,0,0,1,0,-s]);const f=r.Util.applyTransform([0,0],m),b=r.Util.applyTransform([n,s],m),y=r.Util.normalizeRect([f[0],f[1],b[0],b[1]]),v=Math.round(y[2]-y[0])||1,x=Math.round(y[3]-y[1])||1,E=this.cachedCanvases.getCanvas("fillCanvas",v,x),w=E.context,_=Math.min(f[0],b[0]),B=Math.min(f[1],b[1]);w.translate(-_,-B),w.transform(...m),A||(A=this._scaleImage(g.canvas,(0,a.getCurrentTransformInverse)(w)),A=A.img,h&&l&&h.set(u,A)),w.imageSmoothingEnabled=C((0,a.getCurrentTransform)(w),e.interpolate),d(w,A,0,0,A.width,A.height,0,0,n,s),w.globalCompositeOperation="source-in";const I=r.Util.transform((0,a.getCurrentTransformInverse)(w),[1,0,0,1,-_,-B]);return w.fillStyle=l?o.getPattern(t,this,I,i.PathType.FILL):o,w.fillRect(0,0,n,s),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(u,E.canvas)),{canvas:E.canvas,offsetX:Math.round(_),offsetY:Math.round(B)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=y[e]}setLineJoin(e){this.ctx.lineJoin=v[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const i=this.ctx;i.setTransform(...(0,a.getCurrentTransform)(this.suspendedCtx)),A(this.suspendedCtx,i),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,r,a,i,s){t.transform(e,n,r,a,i,s),this.__originalTransform(e,n,r,a,i,s)},e.setTransform=function(e,n,r,a,i,s){t.setTransform(e,n,r,a,i,s),this.__originalSetTransform(e,n,r,a,i,s)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,r,a,i,s){t.bezierCurveTo(e,n,r,a,i,s),this.__originalBezierCurveTo(e,n,r,a,i,s)},e.rect=function(e,n,r,a){t.rect(e,n,r,a),this.__originalRect(e,n,r,a)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),A(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask;(function(e,t,n,r){const a=r[0],i=r[1],s=r[2]-a,o=r[3]-i;0!==s&&0!==o&&(function(e,t,n,r,a,i,s,o,l,c,d){const h=!!i,u=h?i[0]:0,p=h?i[1]:0,A=h?i[2]:0,g="Luminosity"===a?b:f,C=Math.min(r,Math.ceil(1048576/n));for(let a=0;a<r;a+=C){const i=Math.min(C,r-a),f=e.getImageData(o-c,a+(l-d),n,i),b=t.getImageData(o,a+l,n,i);h&&m(f.data,u,p,A),g(f.data,b.data,s),t.putImageData(b,o,a+l)}}(t.context,n,s,o,t.subtype,t.backdrop,t.transferMap,a,i,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())})(this.suspendedCtx,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(A(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),A(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,r,a,i){this.ctx.transform(e,t,n,r,a,i),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const i=this.ctx,s=this.current;let o,l,c=s.x,d=s.y;const h=(0,a.getCurrentTransform)(i),u=0===h[0]&&0===h[3]||0===h[1]&&0===h[2],p=u?n.slice(0):null;for(let n=0,a=0,A=e.length;n<A;n++)switch(0|e[n]){case r.OPS.rectangle:c=t[a++],d=t[a++];const e=t[a++],n=t[a++],A=c+e,g=d+n;i.moveTo(c,d),0===e||0===n?i.lineTo(A,g):(i.lineTo(A,d),i.lineTo(A,g),i.lineTo(c,g)),u||s.updateRectMinMax(h,[c,d,A,g]),i.closePath();break;case r.OPS.moveTo:c=t[a++],d=t[a++],i.moveTo(c,d),u||s.updatePathMinMax(h,c,d);break;case r.OPS.lineTo:c=t[a++],d=t[a++],i.lineTo(c,d),u||s.updatePathMinMax(h,c,d);break;case r.OPS.curveTo:o=c,l=d,c=t[a+4],d=t[a+5],i.bezierCurveTo(t[a],t[a+1],t[a+2],t[a+3],c,d),s.updateCurvePathMinMax(h,o,l,t[a],t[a+1],t[a+2],t[a+3],c,d,p),a+=6;break;case r.OPS.curveTo2:o=c,l=d,i.bezierCurveTo(c,d,t[a],t[a+1],t[a+2],t[a+3]),s.updateCurvePathMinMax(h,o,l,c,d,t[a],t[a+1],t[a+2],t[a+3],p),c=t[a+2],d=t[a+3],a+=4;break;case r.OPS.curveTo3:o=c,l=d,c=t[a+2],d=t[a+3],i.bezierCurveTo(t[a],t[a+1],c,d,c,d),s.updateCurvePathMinMax(h,o,l,t[a],t[a+1],c,d,c,d,p),a+=4;break;case r.OPS.closePath:i.closePath()}u&&s.updateScalingPathMinMax(h,p),s.setCurrentPoint(c,d)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof n&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,(0,a.getCurrentTransformInverse)(t),i.PathType.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor;let r=!1;this.current.patternFill&&(t.save(),t.fillStyle=n.getPattern(t,this,(0,a.getCurrentTransformInverse)(t),i.PathType.FILL),r=!0);const s=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==s&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(s)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=x}eoClip(){this.pendingClip=E}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(const n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const n=this.commonObjs.get(e),a=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=n.fontMatrix||r.FONT_IDENTITY_MATRIX,0!==a.fontMatrix[0]&&0!==a.fontMatrix[3]||(0,r.warn)("Invalid font matrix for font "+e),t<0?(t=-t,a.fontDirection=-1):a.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const i=n.loadedName||"sans-serif",s=n.systemFontInfo?.css||`"${i}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const l=n.italic?"italic":"normal";let c=t;t<16?c=16:t>100&&(c=100),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${s}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,r,a,i){this.current.textMatrix=[e,t,n,r,a,i],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i){const s=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,d=o.fontSize/o.fontSizeScale,h=c&r.TextRenderingMode.FILL_STROKE_MASK,u=!!(c&r.TextRenderingMode.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile;let A;(l.disableFontFace||u||p)&&(A=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p?(s.save(),s.translate(t,n),s.beginPath(),A(s,d),i&&s.setTransform(...i),h!==r.TextRenderingMode.FILL&&h!==r.TextRenderingMode.FILL_STROKE||s.fill(),h!==r.TextRenderingMode.STROKE&&h!==r.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(h!==r.TextRenderingMode.FILL&&h!==r.TextRenderingMode.FILL_STROKE||s.fillText(e,t,n),h!==r.TextRenderingMode.STROKE&&h!==r.TextRenderingMode.FILL_STROKE||s.strokeText(e,t,n)),u&&(this.pendingTextPaths||=[]).push({transform:(0,a.getCurrentTransform)(s),x:t,y:n,fontSize:d,addToPath:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let e=3;e<t.length;e+=4)if(t[e]>0&&t[e]<255){n=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(0===s)return;const o=this.ctx,l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,h=t.fontDirection,u=t.textHScale*h,p=e.length,A=n.vertical,g=A?1:-1,m=n.defaultVMetrics,f=s*t.fontMatrix[0],b=t.textRenderingMode===r.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;let C;if(o.save(),o.transform(...t.textMatrix),o.translate(t.x,t.y+t.textRise),h>0?o.scale(u,-1):o.scale(u,1),t.patternFill){o.save();const e=t.fillColor.getPattern(o,this,(0,a.getCurrentTransformInverse)(o),i.PathType.FILL);C=(0,a.getCurrentTransform)(o),o.restore(),o.fillStyle=e}let y=t.lineWidth;const v=t.textMatrixScale;if(0===v||0===y){const e=t.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;e!==r.TextRenderingMode.STROKE&&e!==r.TextRenderingMode.FILL_STROKE||(y=this.getSinglePixelWidth())}else y/=v;if(1!==l&&(o.scale(l,l),y/=l),o.lineWidth=y,n.isInvalidPDFjsFont){const n=[];let r=0;for(const t of e)n.push(t.unicode),r+=t.width;return o.fillText(n.join(""),0,0),t.x+=r*f*u,o.restore(),void this.compose()}let x,E=0;for(x=0;x<p;++x){const t=e[x];if("number"==typeof t){E+=g*t*s/1e3;continue}let r=!1;const a=(t.isSpace?d:0)+c,i=t.fontChar,u=t.accent;let p,y,v=t.width;if(A){const e=t.vmetric||m,n=-(t.vmetric?e[1]:.5*v)*f,r=e[2]*f;v=e?-e[0]:v,p=n/l,y=(E+r)/l}else p=E/l,y=0;if(n.remeasure&&v>0){const e=1e3*o.measureText(i).width/s*l;if(v<e&&this.isFontSubpixelAAEnabled){const t=v/e;r=!0,o.save(),o.scale(t,1),p/=t}else v!==e&&(p+=(v-e)/2e3*s/l)}if(this.contentVisible&&(t.isInFont||n.missingFile))if(b&&!u)o.fillText(i,p,y);else if(this.paintChar(i,p,y,C),u){const e=p+s*u.offset.x/l,t=y-s*u.offset.y/l;this.paintChar(u.fontChar,e,t,C)}E+=A?v*f-a*h:v*f+a*h,r&&o.restore()}A?t.y-=E:t.x+=E*u,o.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,a=n.font,i=n.fontSize,s=n.fontDirection,o=a.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,d=n.textHScale*s,h=n.fontMatrix||r.FONT_IDENTITY_MATRIX,u=e.length;let p,A,g,m;if(n.textRenderingMode!==r.TextRenderingMode.INVISIBLE&&0!==i){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(d,s),p=0;p<u;++p){if(A=e[p],"number"==typeof A){m=o*A*i/1e3,this.ctx.translate(m,0),n.x+=m*d;continue}const s=(A.isSpace?c:0)+l,u=a.charProcOperatorList[A.operatorListId];u?(this.contentVisible&&(this.processingType3=A,this.save(),t.scale(i,i),t.transform(...h),this.executeOperatorList(u),this.restore()),g=r.Util.applyTransform([A.width,0],h)[0]*i+s,t.translate(g,0),n.x+=g*d):(0,r.warn)(`Type3 character "${A.operatorListId}" is not available.`)}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,r,a,i){this.ctx.rect(n,r,a-n,i-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const n=e[1],r=this.baseTransform||(0,a.getCurrentTransform)(this.ctx),s={createCanvasGraphics:e=>new w(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new i.TilingPattern(e,n,this.ctx,s,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){const a=r.Util.makeHexColor(e,t,n);this.ctx.strokeStyle=a,this.current.strokeColor=a}setFillRGBColor(e,t,n){const a=r.Util.makeHexColor(e,t,n);this.ctx.fillStyle=a,this.current.fillColor=a,this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=(0,i.getShadingPattern)(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,(0,a.getCurrentTransformInverse)(t),i.PathType.SHADING);const s=(0,a.getCurrentTransformInverse)(t);if(s){const{width:e,height:n}=t.canvas,[a,i,o,l]=r.Util.getAxialAlignedBoundingBox([0,0,e,n],s);this.ctx.fillRect(a,i,o-a,l-i)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform(...e),this.baseTransform=(0,a.getCurrentTransform)(this.ctx),t)){const e=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],e,n),this.current.updateRectMinMax((0,a.getCurrentTransform)(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||(0,r.info)("TODO: Support non-isolated groups."),e.knockout&&(0,r.warn)("Knockout groups not supported.");const n=(0,a.getCurrentTransform)(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=r.Util.getAxialAlignedBoundingBox(e.bbox,(0,a.getCurrentTransform)(t));const s=[0,0,t.canvas.width,t.canvas.height];i=r.Util.intersect(i,s)||[0,0,0,0];const l=Math.floor(i[0]),c=Math.floor(i[1]);let d=Math.max(Math.ceil(i[2])-l,1),h=Math.max(Math.ceil(i[3])-c,1),u=1,p=1;d>o&&(u=d/o,d=o),h>o&&(p=h/o,h=o),this.current.startNewPathAndClipBox([0,0,d,h]);let g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(g,d,h),f=m.context;f.scale(1/u,1/p),f.translate(-l,-c),f.transform(...n),e.smask?this.smaskStack.push({canvas:m.canvas,context:f,offsetX:l,offsetY:c,scaleX:u,scaleY:p,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.scale(u,p),t.save()),A(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=(0,a.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const n=r.Util.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,i,s){if(this.#ct(),g(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(t)&&4===t.length){const i=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){(n=n.slice())[4]-=t[0],n[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=i,t[3]=o;const[s,l]=r.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(this.ctx)),{viewportScale:c}=this,d=Math.ceil(i*this.outputScaleX*c),h=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:u,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(s,0,0,-l,0,o*l),g(this.ctx)}else g(this.ctx),this.ctx.rect(t[0],t[1],i,o),this.ctx.clip(),this.endPath()}this.current=new h(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#dt(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const n=this.ctx,r=this.processingType3;if(r&&(void 0===r.compiled&&(r.compiled=function(e){const{width:t,height:n}=e;if(t>1e3||n>1e3)return null;const r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=t+1;let i,s,o,l=new Uint8Array(a*(n+1));const c=t+7&-8;let d=new Uint8Array(c*n),h=0;for(const t of e.data){let e=128;for(;e>0;)d[h++]=t&e?0:255,e>>=1}let u=0;for(h=0,0!==d[h]&&(l[0]=1,++u),s=1;s<t;s++)d[h]!==d[h+1]&&(l[s]=d[h]?2:1,++u),h++;for(0!==d[h]&&(l[s]=2,++u),i=1;i<n;i++){h=i*c,o=i*a,d[h-c]!==d[h]&&(l[o]=d[h]?1:8,++u);let e=(d[h]?4:0)+(d[h-c]?8:0);for(s=1;s<t;s++)e=(e>>2)+(d[h+1]?4:0)+(d[h-c+1]?8:0),r[e]&&(l[o+s]=r[e],++u),h++;if(d[h-c]!==d[h]&&(l[o+s]=d[h]?2:4,++u),u>1e3)return null}for(h=c*(n-1),o=i*a,0!==d[h]&&(l[o]=8,++u),s=1;s<t;s++)d[h]!==d[h+1]&&(l[o+s]=d[h]?4:8,++u),h++;if(0!==d[h]&&(l[o+s]=4,++u),u>1e3)return null;const p=new Int32Array([0,a,-1,0,-a,0,0,0,1]),A=new Path2D;for(i=0;u&&i<=n;i++){let e=i*a;const n=e+t;for(;e<n&&!l[e];)e++;if(e===n)continue;A.moveTo(e%a,i);const r=e;let s=l[e];do{const t=p[s];do{e+=t}while(!l[e]);const n=l[e];5!==n&&10!==n?(s=n,l[e]=0):(s=n&51*s>>4,l[e]&=s>>2|s<<2),A.lineTo(e%a,e/a|0),l[e]||--u}while(r!==e);--i}return d=null,l=null,function(e){e.save(),e.scale(1/t,-1/n),e.translate(0,-n),e.fill(A),e.beginPath(),e.restore()}}(e)),r.compiled))return void r.compiled(n);const a=this._createMaskCanvas(e),i=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(i,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,i=0,s,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const l=this.ctx;l.save();const c=(0,a.getCurrentTransform)(l);l.transform(t,n,i,s,0,0);const d=this._createMaskCanvas(e);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]);for(let e=0,a=o.length;e<a;e+=2){const a=r.Util.transform(c,[t,n,i,s,o[e],o[e+1]]),[h,u]=r.Util.applyTransform([0,0],a);l.drawImage(d.canvas,h,u)}l.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(const s of e){const{data:e,width:o,height:l,transform:c}=s,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),u=h.context;u.save(),p(u,this.getObject(e,s)),u.globalCompositeOperation="source-in",u.fillStyle=r?n.getPattern(u,this,(0,a.getCurrentTransformInverse)(t),i.PathType.FILL):n,u.fillRect(0,0,o,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),d(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,r.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,a){if(!this.contentVisible)return;const i=this.getObject(e);if(!i)return void(0,r.warn)("Dependent image isn't ready yet");const s=i.width,o=i.height,l=[];for(let e=0,r=a.length;e<r;e+=2)l.push({transform:[t,0,0,n,a[e],a[e+1]],x:0,y:0,w:s,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:r}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,r),i=a.context;return i.filter=this.current.transferMaps,i.drawImage(t,0,0),i.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,i=this.ctx;if(this.save(),!r.isNodeJS){const{filter:e}=i;"none"!==e&&""!==e&&(i.filter="none")}let s;if(i.scale(1/t,-1/n),e.bitmap)s=this.applyTransferMapsToBitmap(e);else if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)s=e;else{const r=this.cachedCanvases.getCanvas("inlineImage",t,n).context;u(r,e),s=this.applyTransferMapsToCanvas(r)}const o=this._scaleImage(s,(0,a.getCurrentTransformInverse)(i));i.imageSmoothingEnabled=C((0,a.getCurrentTransform)(i),e.interpolate),d(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const t=e.width,n=e.height,a=this.cachedCanvases.getCanvas("inlineImage",t,n).context;u(a,e),r=this.applyTransferMapsToCanvas(a)}for(const e of t)n.save(),n.transform(...e.transform),n.scale(1,-1),d(n,r,e.x,e.y,e.w,e.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===E?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=(0,a.getCurrentTransform)(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:r,d:a}=this.ctx.getTransform();let i,s;if(0===n&&0===r){const n=Math.abs(t),r=Math.abs(a);if(n===r)if(0===e)i=s=1/n;else{const t=n*e;i=s=t<1?1/t:1}else if(0===e)i=1/n,s=1/r;else{const t=n*e,a=r*e;i=t<1?1/t:1,s=a<1?1/a:1}}else{const o=Math.abs(t*a-n*r),l=Math.hypot(t,n),c=Math.hypot(r,a);if(0===e)i=c/o,s=l/o;else{const t=e*o;i=c>t?c/t:1,s=l>t?l/t:1}}this._cachedScaleForStroking[0]=i,this._cachedScaleForStroking[1]=s}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[r,a]=this.getScaleForStroking();if(t.lineWidth=n||1,1===r&&1===a)return void t.stroke();const i=t.getLineDash();if(e&&t.save(),t.scale(r,a),i.length>0){const e=Math.max(r,a);t.setLineDash(i.map(t=>t/e)),t.lineDashOffset/=e}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}t.CanvasGraphics=w;for(const e in r.OPS)void 0!==w.prototype[e]&&(w.prototype[r.OPS[e]]=w.prototype[e])},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=function(e){switch(e[0]){case"RadialAxial":return new l(e);case"Mesh":return new h(e);case"Dummy":return new u}throw new Error(`Unknown IR type: ${e[0]}`)};var r=n(1),a=n(6);const i={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function s(e,t){if(!t)return;const n=t[2]-t[0],r=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],n,r),e.clip(a)}t.PathType=i;class o{constructor(){this.constructor===o&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class l extends o{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const e of this._colorStops)t.addColorStop(e[0],e[1]);return t}getPattern(e,t,n,o){let l;if(o===i.STROKE||o===i.FILL){const i=t.current.getClippedPathBoundingBox(o,(0,a.getCurrentTransform)(e))||[0,0,0,0],c=Math.ceil(i[2]-i[0])||1,d=Math.ceil(i[3]-i[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,d,!0),u=h.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-i[0],-i[1]),n=r.Util.transform(n,[1,0,0,1,i[0],i[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),s(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),l=e.createPattern(h.canvas,"no-repeat");const p=new DOMMatrix(n);l.setTransform(p)}else s(e,this._bbox),l=this._createGradient(e);return l}}function c(e,t,n,r,a,i,s,o){const l=t.coords,c=t.colors,d=e.data,h=4*e.width;let u;l[n+1]>l[r+1]&&(u=n,n=r,r=u,u=i,i=s,s=u),l[r+1]>l[a+1]&&(u=r,r=a,a=u,u=s,s=o,o=u),l[n+1]>l[r+1]&&(u=n,n=r,r=u,u=i,i=s,s=u);const p=(l[n]+t.offsetX)*t.scaleX,A=(l[n+1]+t.offsetY)*t.scaleY,g=(l[r]+t.offsetX)*t.scaleX,m=(l[r+1]+t.offsetY)*t.scaleY,f=(l[a]+t.offsetX)*t.scaleX,b=(l[a+1]+t.offsetY)*t.scaleY;if(A>=b)return;const C=c[i],y=c[i+1],v=c[i+2],x=c[s],E=c[s+1],w=c[s+2],_=c[o],B=c[o+1],I=c[o+2],k=Math.round(A),S=Math.round(b);let T,R,M,P,F,D,O,L;for(let e=k;e<=S;e++){if(e<m){const t=e<A?0:(A-e)/(A-m);T=p-(p-g)*t,R=C-(C-x)*t,M=y-(y-E)*t,P=v-(v-w)*t}else{let t;t=e>b?1:m===b?0:(m-e)/(m-b),T=g-(g-f)*t,R=x-(x-_)*t,M=E-(E-B)*t,P=w-(w-I)*t}let t;t=e<A?0:e>b?1:(A-e)/(A-b),F=p-(p-f)*t,D=C-(C-_)*t,O=y-(y-B)*t,L=v-(v-I)*t;const n=Math.round(Math.min(T,F)),r=Math.round(Math.max(T,F));let a=h*e+4*n;for(let e=n;e<=r;e++)t=(T-e)/(T-F),t<0?t=0:t>1&&(t=1),d[a++]=R-(R-D)*t|0,d[a++]=M-(M-O)*t|0,d[a++]=P-(P-L)*t|0,d[a++]=255}}function d(e,t,n){const r=t.coords,a=t.colors;let i,s;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(r.length/o)-1,d=o-1;for(i=0;i<l;i++){let t=i*o;for(let i=0;i<d;i++,t++)c(e,n,r[t],r[t+1],r[t+o],a[t],a[t+1],a[t+o]),c(e,n,r[t+o+1],r[t+1],r[t+o],a[t+o+1],a[t+1],a[t+o])}break;case"triangles":for(i=0,s=r.length;i<s;i+=3)c(e,n,r[i],r[i+1],r[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}class h extends o{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const r=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),i=Math.ceil(this._bounds[2])-r,s=Math.ceil(this._bounds[3])-a,o=Math.min(Math.ceil(Math.abs(i*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(s*e[1]*1.1)),3e3),c=i/o,h=s/l,u={coords:this._coords,colors:this._colors,offsetX:-r,offsetY:-a,scaleX:1/c,scaleY:1/h},p=o+4,A=l+4,g=n.getCanvas("mesh",p,A,!1),m=g.context,f=m.createImageData(o,l);if(t){const e=f.data;for(let n=0,r=e.length;n<r;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const e of this._figures)d(f,e,u);return m.putImageData(f,2,2),{canvas:g.canvas,offsetX:r-2*c,offsetY:a-2*h,scaleX:c,scaleY:h}}getPattern(e,t,n,o){let l;if(s(e,this._bbox),o===i.SHADING)l=r.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(e));else if(l=r.Util.singularValueDecompose2dScale(t.baseTransform),this.matrix){const e=r.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*e[0],l[1]*e[1]]}const c=this._createMeshCanvas(l,o===i.SHADING?null:this._background,t.cachedCanvases);return o!==i.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class u extends o{getPattern(){return"hotpink"}}class p{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,r,a){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=r,this.baseTransform=a}createPatternCanvas(e){const t=this.operatorList,n=this.bbox,i=this.xstep,s=this.ystep,o=this.paintType,l=this.tilingType,c=this.color,d=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+l);const h=n[0],u=n[1],p=n[2],A=n[3],g=r.Util.singularValueDecompose2dScale(this.matrix),m=r.Util.singularValueDecompose2dScale(this.baseTransform),f=[g[0]*m[0],g[1]*m[1]],b=this.getSizeAndScale(i,this.ctx.canvas.width,f[0]),C=this.getSizeAndScale(s,this.ctx.canvas.height,f[1]),y=e.cachedCanvases.getCanvas("pattern",b.size,C.size,!0),v=y.context,x=d.createCanvasGraphics(v);x.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(x,o,c);let E=h,w=u,_=p,B=A;return h<0&&(E=0,_+=Math.abs(h)),u<0&&(w=0,B+=Math.abs(u)),v.translate(-b.scale*E,-C.scale*w),x.transform(b.scale,0,0,C.scale,0,0),v.save(),this.clipBbox(x,E,w,_,B),x.baseTransform=(0,a.getCurrentTransform)(x.ctx),x.executeOperatorList(t),x.endDrawing(),{canvas:y.canvas,scaleX:b.scale,scaleY:C.scale,offsetX:E,offsetY:w}}getSizeAndScale(e,t,n){e=Math.abs(e);const r=Math.max(p.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=r?a=r:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,r,i){const s=r-t,o=i-n;e.ctx.rect(t,n,s,o),e.current.updateRectMinMax((0,a.getCurrentTransform)(e.ctx),[t,n,r,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const a=e.ctx,i=e.current;switch(t){case 1:const e=this.ctx;a.fillStyle=e.fillStyle,a.strokeStyle=e.strokeStyle,i.fillColor=e.fillStyle,i.strokeColor=e.strokeStyle;break;case 2:const s=r.Util.makeHexColor(n[0],n[1],n[2]);a.fillStyle=s,a.strokeStyle=s,i.fillColor=s,i.strokeColor=s;break;default:throw new r.FormatError(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,a){let s=n;a!==i.SHADING&&(s=r.Util.transform(s,t.baseTransform),this.matrix&&(s=r.Util.transform(s,this.matrix)));const o=this.createPatternCanvas(t);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(l),c}}t.TilingPattern=p},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=a,t.convertToRGBA=function(e){switch(e.kind){case r.ImageKind.GRAYSCALE_1BPP:return a(e);case r.ImageKind.RGB_24BPP:return function({src:e,srcPos:t=0,dest:n,destPos:a=0,width:i,height:s}){let o=0;const l=e.length>>2,c=new Uint32Array(e.buffer,t,l);if(r.FeatureTest.isLittleEndian){for(;o<l-2;o+=3,a+=4){const e=c[o],t=c[o+1],r=c[o+2];n[a]=4278190080|e,n[a+1]=e>>>24|t<<8|4278190080,n[a+2]=t>>>16|r<<16|4278190080,n[a+3]=r>>>8|4278190080}for(let t=4*o,r=e.length;t<r;t+=3)n[a++]=e[t]|e[t+1]<<8|e[t+2]<<16|4278190080}else{for(;o<l-2;o+=3,a+=4){const e=c[o],t=c[o+1],r=c[o+2];n[a]=255|e,n[a+1]=e<<24|t>>>8|255,n[a+2]=t<<16|r>>>16|255,n[a+3]=r<<8|255}for(let t=4*o,r=e.length;t<r;t+=3)n[a++]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|255}return{srcPos:t,destPos:a}}(e)}return null},t.grayToRGBA=function(e,t){if(r.FeatureTest.isLittleEndian)for(let n=0,r=e.length;n<r;n++)t[n]=65793*e[n]|4278190080;else for(let n=0,r=e.length;n<r;n++)t[n]=16843008*e[n]|255};var r=n(1);function a({src:e,srcPos:t=0,dest:n,width:a,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const l=r.FeatureTest.isLittleEndian?4278190080:255,[c,d]=o?[s,l]:[l,s],h=a>>3,u=7&a,p=e.length;n=new Uint32Array(n.buffer);let A=0;for(let r=0;r<i;r++){for(const r=t+h;t<r;t++){const r=t<p?e[t]:255;n[A++]=128&r?d:c,n[A++]=64&r?d:c,n[A++]=32&r?d:c,n[A++]=16&r?d:c,n[A++]=8&r?d:c,n[A++]=4&r?d:c,n[A++]=2&r?d:c,n[A++]=1&r?d:c}if(0===u)continue;const r=t<p?e[t++]:255;for(let e=0;e<u;e++)n[A++]=r&1<<7-e?d:c}return{srcPos:t,destPos:A}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const n=Object.create(null);t.GlobalWorkerOptions=n,n.workerPort=null,n.workerSrc=""},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var r=n(1);function a(e){switch(e instanceof Error||"object"==typeof e&&null!==e||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new r.AbortException(e.message);case"MissingPDFException":return new r.MissingPDFException(e.message);case"PasswordException":return new r.PasswordException(e.message,e.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new r.UnknownErrorException(e.message,e.details);default:return new r.UnknownErrorException(e.message,e.toString())}}t.MessageHandler=class{constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#ht(t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],1===t.callback)n.resolve(t.data);else{if(2!==t.callback)throw new Error("Unexpected callback case");n.reject(a(t.reason))}return}const r=this.actionHandler[t.action];if(!r)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,i=t.sourceName;return void new Promise(function(e){e(r(t.data))}).then(function(r){n.postMessage({sourceName:e,targetName:i,callback:1,callbackId:t.callbackId,data:r})},function(r){n.postMessage({sourceName:e,targetName:i,callback:2,callbackId:t.callbackId,reason:a(r)})})}t.streamId?this.#ut(t):r(t.data)},n.addEventListener("message",this._onComObjOnMessage)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const a=this.callbackId++,i=new r.PromiseCapability;this.callbackCapabilities[a]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:a,data:t},n)}catch(e){i.reject(e)}return i.promise}sendWithStream(e,t,n,i){const s=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:n=>{const a=new r.PromiseCapability;return this.streamControllers[s]={controller:n,startCall:a,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:l,action:e,streamId:s,data:t,desiredSize:n.desiredSize},i),a.promise},pull:e=>{const t=new r.PromiseCapability;return this.streamControllers[s].pullCall=t,c.postMessage({sourceName:o,targetName:l,stream:6,streamId:s,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,r.assert)(e instanceof Error,"cancel must have a valid reason");const t=new r.PromiseCapability;return this.streamControllers[s].cancelCall=t,this.streamControllers[s].isClosed=!0,c.postMessage({sourceName:o,targetName:l,stream:1,streamId:s,reason:a(e)}),t.promise}},n)}#ut(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,o=this,l=this.actionHandler[e.action],c={enqueue(e,a=1,o){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=a,l>0&&this.desiredSize<=0&&(this.sinkCapability=new r.PromiseCapability,this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:4,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:3,streamId:t}),delete o.streamSinks[t])},error(e){(0,r.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:5,streamId:t,reason:a(e)}))},sinkCapability:new r.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,new Promise(function(t){t(l(e.data,c))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:8,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:8,streamId:t,reason:a(e)})})}#ht(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,o=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case 8:e.success?o.startCall.resolve():o.startCall.reject(a(e.reason));break;case 7:e.success?o.pullCall.resolve():o.pullCall.reject(a(e.reason));break;case 6:if(!l){s.postMessage({sourceName:n,targetName:i,stream:7,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,new Promise(function(e){e(l.onPull?.())}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:7,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:7,streamId:t,reason:a(e)})});break;case 4:if((0,r.assert)(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case 3:if((0,r.assert)(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#pt(o,t);break;case 5:(0,r.assert)(o,"error should have stream controller"),o.controller.error(a(e.reason)),this.#pt(o,t);break;case 2:e.success?o.cancelCall.resolve():o.cancelCall.reject(a(e.reason)),this.#pt(o,t);break;case 1:if(!l)break;new Promise(function(t){t(l.onCancel?.(a(e.reason)))}).then(function(){s.postMessage({sourceName:n,targetName:i,stream:2,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:2,streamId:t,reason:a(e)})}),l.sinkCapability.reject(a(e.reason)),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#pt(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=n(1);t.Metadata=class{#At;#gt;constructor({parsedData:e,rawData:t}){this.#At=e,this.#gt=t}getRaw(){return this.#gt}get(e){return this.#At.get(e)??null}getAll(){return(0,r.objectFromMap)(this.#At)}has(e){return this.#At.has(e)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var r=n(1),a=n(8);const i=Symbol("INTERNAL");class s{#mt=!0;constructor(e,t){this.name=e,this.intent=t}get visible(){return this.#mt}_setVisible(e,t){e!==i&&(0,r.unreachable)("Internal method `_setVisible` called."),this.#mt=t}}t.OptionalContentConfig=class{#ft=null;#bt=new Map;#Ct=null;#yt=null;constructor(e){if(this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,this.#yt=e.order;for(const t of e.groups)this.#bt.set(t.id,new s(t.name,t.intent));if("OFF"===e.baseState)for(const e of this.#bt.values())e._setVisible(i,!1);for(const t of e.on)this.#bt.get(t)._setVisible(i,!0);for(const t of e.off)this.#bt.get(t)._setVisible(i,!1);this.#Ct=this.getHash()}}#vt(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let a=1;a<t;a++){const t=e[a];let i;if(Array.isArray(t))i=this.#vt(t);else{if(!this.#bt.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;i=this.#bt.get(t).visible}switch(n){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return"And"===n}isVisible(e){if(0===this.#bt.size)return!0;if(!e)return(0,r.warn)("Optional content group not defined."),!0;if("OCG"===e.type)return this.#bt.has(e.id)?this.#bt.get(e.id).visible:((0,r.warn)(`Optional content group not found: ${e.id}`),!0);if("OCMD"===e.type){if(e.expression)return this.#vt(e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!this.#bt.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(this.#bt.get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!this.#bt.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(!this.#bt.get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!this.#bt.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(!this.#bt.get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!this.#bt.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(this.#bt.get(t).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,r.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){this.#bt.has(e)?(this.#bt.get(e)._setVisible(i,!!t),this.#ft=null):(0,r.warn)(`Optional content group not found: ${e}`)}get hasInitialVisibility(){return null===this.#Ct||this.getHash()===this.#Ct}getOrder(){return this.#bt.size?this.#yt?this.#yt.slice():[...this.#bt.keys()]:null}getGroups(){return this.#bt.size>0?(0,r.objectFromMap)(this.#bt):null}getGroup(e){return this.#bt.get(e)||null}getHash(){if(null!==this.#ft)return this.#ft;const e=new a.MurmurHash3_64;for(const[t,n]of this.#bt)e.update(`${t}:${n.visible}`);return this.#ft=e.hexdigest()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var r=n(1),a=n(6);t.PDFDataTransportStream=class{constructor({length:e,initialData:t,progressiveDone:n=!1,contentDispositionFilename:a=null,disableRange:i=!1,disableStream:s=!1},o){if((0,r.assert)(o,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=n,this._contentDispositionFilename=a,t?.length>0){const e=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=o,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=e,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),this._pdfDataRangeTransport.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(void 0===e)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const t=this._rangeReaders.some(function(t){return t._begin===e&&(t._enqueue(n),!0)});(0,r.assert)(t,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){void 0===e.total?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new i(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new s(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}};class i{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=(0,a.isPdfFile)(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const e of this._queuedChunks)this._loaded+=e.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class s{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var r=n(1),a=n(20);function i(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function s(e){const t=new Headers;for(const n in e){const r=e[n];void 0!==r&&t.append(n,r)}return t}function o(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:((0,r.warn)(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}t.PDFFetchStream=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new c(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class l{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=new r.PromiseCapability,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=s(this._stream.httpHeaders);const n=t.url;fetch(n,i(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,n);this._reader=e.body.getReader(),this._headersCapability.resolve();const t=t=>e.headers.get(t),{allowRangeRequests:i,suggestedLength:s}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=s||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:o(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class c{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const o=e.source;this._withCredentials=o.withCredentials||!1,this._readCapability=new r.PromiseCapability,this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController,this._headers=s(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${n-1}`);const l=o.url;fetch(l,i(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,l);this._readCapability.resolve(),this._reader=e.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:o(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&t.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+t+'".'):new r.UnexpectedResponseException(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)},t.extractFilenameFromHeader=function(e){const t=e("Content-Disposition");if(t){let e=(0,a.getFilenameFromContentDispositionHeader)(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if((0,i.isPdfFile)(e))return e}return null},t.validateRangeRequestCapabilities=function({getResponseHeader:e,isHttp:t,rangeChunkSize:n,disableRange:r}){const a={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(e("Content-Length"),10);return Number.isInteger(i)?(a.suggestedLength=i,i<=2*n||r||!t||"bytes"!==e("Accept-Ranges")||"identity"!==(e("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a):a},t.validateResponseStatus=function(e){return 200===e||206===e};var r=n(1),a=n(21),i=n(6)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){let t=!0,n=a("filename\\*","i").exec(e);if(n){n=n[1];let e=o(n);return e=unescape(e),e=l(e),e=c(e),s(e)}if(n=function(e){const t=[];let n;const r=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(e));){let[,e,r,a]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[r,a]}const i=[];for(let e=0;e<t.length&&e in t;++e){let[n,r]=t[e];r=o(r),n&&(r=unescape(r),0===e&&(r=l(r))),i.push(r)}return i.join("")}(e),n)return s(c(n));if(n=a("filename","i").exec(e),n){n=n[1];let e=o(n);return e=c(e),s(e)}function a(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function i(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const a=new TextDecoder(e,{fatal:!0}),i=(0,r.stringToBytes)(n);n=a.decode(i),t=!1}catch{}}return n}function s(e){return t&&/[\x80-\xff]/.test(e)&&(e=i("utf-8",e),t&&(e=i("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function l(e){const t=e.indexOf("'");return-1===t?e:i(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function c(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,r){if("q"===n||"Q"===n)return i(t,r=(r=r.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{r=atob(r)}catch{}return i(t,r)})}return""};var r=n(1)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var r=n(1),a=n(20);class i{constructor(e,t={}){this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){const r={begin:e,end:t};for(const e in n)r[e]=n[e];return this.request(r)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const n=this.httpHeaders[e];void 0!==n&&t.setRequestHeader(e,n)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=206):r.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const a=n.xhr;if(a.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==a.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===a.status&&this.isHttp)return void n.onError?.(a.status);const i=a.status||200;if((200!==i||206!==n.expectedStatus)&&i!==n.expectedStatus)return void n.onError?.(a.status);const s=function(e){const t=e.response;return"string"!=typeof t?t:(0,r.stringToBytes)(t).buffer}(a);if(206===i){const e=a.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);n.onDone({begin:parseInt(t[1],10),chunk:s})}else s?n.onDone({begin:0,chunk:s}):n.onError?.(a.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}t.PDFNetworkStream=class{constructor(e){this._source=e,this._manager=new i(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new s(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new o(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class s{constructor(e,t){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=new r.PromiseCapability,this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=e=>t.getResponseHeader(e),{allowRangeRequests:r,suggestedLength:i}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=i||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=(0,a.createResponseStatusError)(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class o{constructor(e,t,n){this._manager=e;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=(0,a.createResponseStatusError)(e,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var r=n(1),a=n(20);const i=/^file:\/\/\/[a-zA-Z]:\//;t.PDFNodeStream=class{constructor(e){this.source=e,this.url=function(e){const t=__webpack_require__(66671),n=t.parse(e);return"file:"===n.protocol||n.host?n:/^[a-z]:[/\\]/i.test(e)?t.parse(`file:///${e}`):(n.host||(n.protocol="file:"),n)}(e.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new h(this):new c(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new u(this,e,t):new d(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class s{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=new r.PromiseCapability,this._headersCapability=new r.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class o{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new r.PromiseCapability;const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}class c extends s{constructor(e){super(e);const t=t=>{if(404===t.statusCode){const e=new r.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=e,void this._headersCapability.reject(e)}this._headersCapability.resolve(),this._setReadableStream(t);const n=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:i,suggestedLength:s}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=s||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(n)};if(this._request=null,"http:"===this._url.protocol){const n=__webpack_require__(97492);this._request=n.request(l(this._url,e.httpHeaders),t)}else{const n=__webpack_require__(31815);this._request=n.request(l(this._url,e.httpHeaders),t)}this._request.on("error",e=>{this._storedError=e,this._headersCapability.reject(e)}),this._request.end()}}class d extends o{constructor(e,t,n){super(e),this._httpHeaders={};for(const t in e.httpHeaders){const n=e.httpHeaders[t];void 0!==n&&(this._httpHeaders[t]=n)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;const a=e=>{if(404===e.statusCode){const e=new r.MissingPDFException(`Missing PDF "${this._url}".`);return void(this._storedError=e)}this._setReadableStream(e)};if(this._request=null,"http:"===this._url.protocol){const e=__webpack_require__(97492);this._request=e.request(l(this._url,this._httpHeaders),a)}else{const e=__webpack_require__(31815);this._request=e.request(l(this._url,this._httpHeaders),a)}this._request.on("error",e=>{this._storedError=e}),this._request.end()}}class h extends s{constructor(e){super(e);let t=decodeURIComponent(this._url.path);i.test(this._url.href)&&(t=t.replace(/^\//,""));const n=__webpack_require__(23237);n.lstat(t,(e,a)=>{if(e)return"ENOENT"===e.code&&(e=new r.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=e,void this._headersCapability.reject(e);this._contentLength=a.size,this._setReadableStream(n.createReadStream(t)),this._headersCapability.resolve()})}}class u extends o{constructor(e,t,n){super(e);let r=decodeURIComponent(this._url.path);i.test(this._url.href)&&(r=r.replace(/^\//,""));const a=__webpack_require__(23237);this._setReadableStream(a.createReadStream(r,{start:t,end:n-1}))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var r=n(6),a=n(1);const i="normal",s="#000000",o=["butt","round","square"],l=["miter","round","bevel"],c=function(e,t="",n=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!n)return URL.createObjectURL(new Blob([e],{type:t}));const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let a=`data:${t};base64,`;for(let t=0,n=e.length;t<n;t+=3){const i=255&e[t],s=255&e[t+1],o=255&e[t+2];a+=r[i>>2]+r[(3&i)<<4|s>>4]+r[t+1<n?(15&s)<<2|o>>6:64]+r[t+2<n?63&o:64]}return a},d=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256);for(let e=0;e<256;e++){let n=e;for(let e=0;e<8;e++)n=1&n?3988292384^n>>1&2147483647:n>>1&2147483647;t[e]=n}function n(e,n,r,a){let i=a;const s=n.length;r[i]=s>>24&255,r[i+1]=s>>16&255,r[i+2]=s>>8&255,r[i+3]=255&s,i+=4,r[i]=255&e.charCodeAt(0),r[i+1]=255&e.charCodeAt(1),r[i+2]=255&e.charCodeAt(2),r[i+3]=255&e.charCodeAt(3),i+=4,r.set(n,i),i+=n.length;const o=function(e,n,r){let a=-1;for(let i=n;i<r;i++){const n=255&(a^e[i]);a=a>>>8^t[n]}return-1^a}(r,a+4,i);r[i]=o>>24&255,r[i+1]=o>>16&255,r[i+2]=o>>8&255,r[i+3]=255&o}function r(e){let t=e.length;const n=65535,r=Math.ceil(t/n),a=new Uint8Array(2+t+5*r+4);let i=0;a[i++]=120,a[i++]=156;let s=0;for(;t>n;)a[i++]=0,a[i++]=255,a[i++]=255,a[i++]=0,a[i++]=0,a.set(e.subarray(s,s+n),i),i+=n,s+=n,t-=n;a[i++]=1,a[i++]=255&t,a[i++]=t>>8&255,a[i++]=255&~t,a[i++]=(65535&~t)>>8&255,a.set(e.subarray(s),i),i+=e.length-s;const o=function(e,t,n){let r=1,a=0;for(let t=0;t<n;++t)r=(r+(255&e[t]))%65521,a=(a+r)%65521;return a<<16|r}(e,0,e.length);return a[i++]=o>>24&255,a[i++]=o>>16&255,a[i++]=o>>8&255,a[i++]=255&o,a}return function(t,i,s){return function(t,i,s,o){const l=t.width,d=t.height;let h,u,p;const A=t.data;switch(i){case a.ImageKind.GRAYSCALE_1BPP:u=0,h=1,p=l+7>>3;break;case a.ImageKind.RGB_24BPP:u=2,h=8,p=3*l;break;case a.ImageKind.RGBA_32BPP:u=6,h=8,p=4*l;break;default:throw new Error("invalid format")}const g=new Uint8Array((1+p)*d);let m=0,f=0;for(let e=0;e<d;++e)g[m++]=0,g.set(A.subarray(f,f+p),m),f+=p,m+=p;if(i===a.ImageKind.GRAYSCALE_1BPP&&o){m=0;for(let e=0;e<d;e++){m++;for(let e=0;e<p;e++)g[m++]^=255}}const b=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,255&l,d>>24&255,d>>16&255,d>>8&255,255&d,h,u,0,0,0]),C=function(e){if(!a.isNodeJS)return r(e);try{const t=parseInt(process.versions.node)>=8?e:Buffer.from(e),n=__webpack_require__(82787).deflateSync(t,{level:9});return n instanceof Uint8Array?n:new Uint8Array(n)}catch(e){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return r(e)}(g),y=e.length+36+b.length+C.length,v=new Uint8Array(y);let x=0;return v.set(e,x),x+=e.length,n("IHDR",b,v,x),x+=12+b.length,n("IDATA",C,v,x),x+=12+C.length,n("IEND",new Uint8Array(0),v,x),c(v,"image/png",s)}(t,void 0===t.kind?a.ImageKind.GRAYSCALE_1BPP:t.kind,i,s)}}();class h{constructor(){this.fontSizeScale=1,this.fontWeight=i,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=s,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(e,t){this.x=e,this.y=t}}function u(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)}function p(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":`scale(${u(e[0])} ${u(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2])return`rotate(${u(180*Math.acos(e[0])/Math.PI)})`}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return`translate(${u(e[4])} ${u(e[5])})`;return`matrix(${u(e[0])} ${u(e[1])} ${u(e[2])} ${u(e[3])} ${u(e[4])} ${u(e[5])})`}let A=0,g=0,m=0;t.SVGGraphics=class{constructor(e,t,n=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new h,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const e in a.OPS)this._operatorIdMapping[a.OPS[e]]=e}getObject(e,t=null){return"string"==typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,n=e.argsArray;for(let e=0,r=t.length;e<r;e++)if(t[e]===a.OPS.dependency)for(const t of n[e]){const e=t.startsWith("g_")?this.commonObjs:this.objs,n=new Promise(n=>{e.get(t,n)});this.current.dependencies.push(n)}return Promise.all(this.current.dependencies)}transform(e,t,n,r,i,s){const o=[e,t,n,r,i,s];this.transformMatrix=a.Util.transform(this.transformMatrix,o),this.tgrp=null}getSVG(e,t){this.viewport=t;const n=this._initialize(t);return this.loadDependencies(e).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),n))}convertOpList(e){const t=this._operatorIdMapping,n=e.argsArray,r=e.fnArray,a=[];for(let e=0,i=r.length;e<i;e++){const i=r[e];a.push({fnId:i,fn:t[i],args:n[e]})}return function(e){let t=[];const n=[];for(const r of e)"save"!==r.fn?"restore"===r.fn?t=n.pop():t.push(r):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t.at(-1).items);return t}(a)}executeOpTree(e){for(const t of e){const e=t.fn,n=t.fnId,r=t.args;switch(0|n){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(r);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(r[0],r[1]);break;case a.OPS.setFont:this.setFont(r);break;case a.OPS.showText:case a.OPS.showSpacedText:this.showText(r[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(r[0],r[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(r[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(r[0]);break;case a.OPS.setHScale:this.setHScale(r[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(r[0],r[1],r[2],r[3],r[4],r[5]);break;case a.OPS.setTextRise:this.setTextRise(r[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(r[0]);break;case a.OPS.setLineWidth:this.setLineWidth(r[0]);break;case a.OPS.setLineJoin:this.setLineJoin(r[0]);break;case a.OPS.setLineCap:this.setLineCap(r[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(r[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(r[0],r[1],r[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(r[0],r[1],r[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(r);break;case a.OPS.setFillColorN:this.setFillColorN(r);break;case a.OPS.shadingFill:this.shadingFill(r[0]);break;case a.OPS.setDash:this.setDash(r[0],r[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(r[0]);break;case a.OPS.setFlatness:this.setFlatness(r[0]);break;case a.OPS.setGState:this.setGState(r[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(r[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(r[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(r[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(r[0],r[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(r[0],r[1],r[2],r[3],r[4],r[5]);break;case a.OPS.constructPath:this.constructPath(r[0],r[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,a.warn)(`Unimplemented operator ${e}`)}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,n,r,a,i){const s=this.current;s.textMatrix=s.lineMatrix=[e,t,n,r,a,i],s.textMatrixScale=Math.hypot(e,t),s.x=s.lineX=0,s.y=s.lineY=0,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${u(s.fontSize)}px`),s.tspan.setAttributeNS(null,"y",u(-s.y)),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtElement.append(s.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=a.IDENTITY_MATRIX,e.lineMatrix=a.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const n=this.current;n.x=n.lineX+=e,n.y=n.lineY+=t,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${u(n.fontSize)}px`),n.tspan.setAttributeNS(null,"y",u(-n.y))}showText(e){const t=this.current,n=t.font,r=t.fontSize;if(0===r)return;const o=t.fontSizeScale,l=t.charSpacing,c=t.wordSpacing,d=t.fontDirection,h=t.textHScale*d,A=n.vertical,g=A?1:-1,m=n.defaultVMetrics,f=r*t.fontMatrix[0];let b=0;for(const a of e){if(null===a){b+=d*c;continue}if("number"==typeof a){b+=g*a*r/1e3;continue}const e=(a.isSpace?c:0)+l,i=a.fontChar;let s,h,u=a.width;if(A){let e;const t=a.vmetric||m;e=a.vmetric?t[1]:.5*u,e=-e*f;const n=t[2]*f;u=t?-t[0]:u,s=e/o,h=(b+n)/o}else s=b/o,h=0;(a.isInFont||n.missingFile)&&(t.xcoords.push(t.x+s),A&&t.ycoords.push(-t.y+h),t.tspan.textContent+=i),b+=A?u*f-e*d:u*f+e*d}t.tspan.setAttributeNS(null,"x",t.xcoords.map(u).join(" ")),A?t.tspan.setAttributeNS(null,"y",t.ycoords.map(u).join(" ")):t.tspan.setAttributeNS(null,"y",u(-t.y)),A?t.y-=b:t.x+=b*h,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",`${u(t.fontSize)}px`),"normal"!==t.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==i&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const C=t.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(C===a.TextRenderingMode.FILL||C===a.TextRenderingMode.FILL_STROKE?(t.fillColor!==s&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),C===a.TextRenderingMode.STROKE||C===a.TextRenderingMode.FILL_STROKE){const e=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,e)}let y=t.textMatrix;0!==t.textRise&&(y=y.slice(),y[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform",`${p(y)} scale(${u(h)}, -1)`),t.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.txtElement.append(t.tspan),t.txtgrp.append(t.txtElement),this._ensureTransformGroup().append(t.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const t=c(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${t}); }\n`}setFont(e){const t=this.current,n=this.commonObjs.get(e[0]);let r=e[1];t.font=n,!this.embedFonts||n.missingFile||this.embeddedFonts[n.loadedName]||(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),t.fontMatrix=n.fontMatrix||a.FONT_IDENTITY_MATRIX;let i="normal";n.black?i="900":n.bold&&(i="bold");const s=n.italic?"italic":"normal";r<0?(r=-r,t.fontDirection=-1):t.fontDirection=1,t.fontSize=r,t.fontFamily=n.loadedName,t.fontWeight=i,t.fontStyle=s,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",u(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement?.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=o[e]}setLineJoin(e){this.current.lineJoin=l[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,n){this.current.strokeColor=a.Util.makeHexColor(e,t,n)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,n){this.current.fillColor=a.Util.makeHexColor(e,t,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const{width:t,height:n}=this.viewport,r=a.Util.inverseTransform(this.transformMatrix),[i,s,o,l]=a.Util.getAxialAlignedBoundingBox([0,0,t,n],r),c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",i),c.setAttributeNS(null,"y",s),c.setAttributeNS(null,"width",o-i),c.setAttributeNS(null,"height",l-s),c.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&c.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(c)}_makeColorN_Pattern(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],n=e[2],r=e[3]||a.IDENTITY_MATRIX,[i,s,o,l]=e[4],c=e[5],d=e[6],h=e[7],u="shading"+m++,[p,A,g,f]=a.Util.normalizeRect([...a.Util.applyTransform([i,s],r),...a.Util.applyTransform([o,l],r)]),[b,C]=a.Util.singularValueDecompose2dScale(r),y=c*b,v=d*C,x=this.svgFactory.createElement("svg:pattern");x.setAttributeNS(null,"id",u),x.setAttributeNS(null,"patternUnits","userSpaceOnUse"),x.setAttributeNS(null,"width",y),x.setAttributeNS(null,"height",v),x.setAttributeNS(null,"x",`${p}`),x.setAttributeNS(null,"y",`${A}`);const E=this.svg,w=this.transformMatrix,_=this.current.fillColor,B=this.current.strokeColor,I=this.svgFactory.create(g-p,f-A);if(this.svg=I,this.transformMatrix=r,2===h){const e=a.Util.makeHexColor(...t);this.current.fillColor=e,this.current.strokeColor=e}return this.executeOpTree(this.convertOpList(n)),this.svg=E,this.transformMatrix=w,this.current.fillColor=_,this.current.strokeColor=B,x.append(I.childNodes[0]),this.defs.append(x),`url(#${u})`}_makeShadingPattern(e){switch("string"==typeof e&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const t="shading"+m++,n=e[3];let r;switch(e[1]){case"axial":const n=e[4],a=e[5];r=this.svgFactory.createElement("svg:linearGradient"),r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"x1",n[0]),r.setAttributeNS(null,"y1",n[1]),r.setAttributeNS(null,"x2",a[0]),r.setAttributeNS(null,"y2",a[1]);break;case"radial":const i=e[4],s=e[5],o=e[6],l=e[7];r=this.svgFactory.createElement("svg:radialGradient"),r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"cx",s[0]),r.setAttributeNS(null,"cy",s[1]),r.setAttributeNS(null,"r",l),r.setAttributeNS(null,"fx",i[0]),r.setAttributeNS(null,"fy",i[1]),r.setAttributeNS(null,"fr",o);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const e of n){const t=this.svgFactory.createElement("svg:stop");t.setAttributeNS(null,"offset",e[0]),t.setAttributeNS(null,"stop-color",e[1]),r.append(t)}return this.defs.append(r),`url(#${t})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const n=this.current;let r=n.x,i=n.y,s=[],o=0;for(const n of e)switch(0|n){case a.OPS.rectangle:r=t[o++],i=t[o++];const e=r+t[o++],n=i+t[o++];s.push("M",u(r),u(i),"L",u(e),u(i),"L",u(e),u(n),"L",u(r),u(n),"Z");break;case a.OPS.moveTo:r=t[o++],i=t[o++],s.push("M",u(r),u(i));break;case a.OPS.lineTo:r=t[o++],i=t[o++],s.push("L",u(r),u(i));break;case a.OPS.curveTo:r=t[o+4],i=t[o+5],s.push("C",u(t[o]),u(t[o+1]),u(t[o+2]),u(t[o+3]),u(r),u(i)),o+=6;break;case a.OPS.curveTo2:s.push("C",u(r),u(i),u(t[o]),u(t[o+1]),u(t[o+2]),u(t[o+3])),r=t[o+2],i=t[o+3],o+=4;break;case a.OPS.curveTo3:r=t[o+2],i=t[o+3],s.push("C",u(t[o]),u(t[o+1]),u(r),u(i),u(r),u(i)),o+=4;break;case a.OPS.closePath:s.push("Z")}s=s.join(" "),n.path&&e.length>0&&e[0]!==a.OPS.rectangle&&e[0]!==a.OPS.moveTo?s=n.path.getAttributeNS(null,"d")+s:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(n.path)),n.path.setAttributeNS(null,"d",s),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(r,i)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element)return void(this.pendingClip=null);const t="clippath"+A++,n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"transform",p(this.transformMatrix));const r=e.element.cloneNode(!0);if("evenodd"===this.pendingClip?r.setAttributeNS(null,"clip-rule","evenodd"):r.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.append(r),this.defs.append(n),e.activeClipUrl){e.clipGroup=null;for(const e of this.extraStack)e.clipGroup=null;n.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,a.warn)(`Unimplemented graphic state operator ${t}`)}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,t=1){const n=this.current;let r=n.dashArray;1!==t&&r.length>0&&(r=r.map(function(e){return t*e})),e.setAttributeNS(null,"stroke",n.strokeColor),e.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",u(n.miterLimit)),e.setAttributeNS(null,"stroke-linecap",n.lineCap),e.setAttributeNS(null,"stroke-linejoin",n.lineJoin),e.setAttributeNS(null,"stroke-width",u(t*n.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",r.map(u).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",u(t*n.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,a.warn)(`Dependent image with object ID ${e} is not ready yet`)}paintInlineImageXObject(e,t){const n=e.width,r=e.height,a=d(e,this.forceDataSchema,!!t),i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width",u(n)),i.setAttributeNS(null,"height",u(r)),this.current.element=i,this.clip("nonzero");const s=this.svgFactory.createElement("svg:image");s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",u(-r)),s.setAttributeNS(null,"width",u(n)+"px"),s.setAttributeNS(null,"height",u(r)+"px"),s.setAttributeNS(null,"transform",`scale(${u(1/n)} ${u(-1/r)})`),t?t.append(s):this._ensureTransformGroup().append(s)}paintImageMaskXObject(e){const t=this.getObject(e.data,e);if(t.bitmap)return void(0,a.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");const n=this.current,r=t.width,i=t.height,s=n.fillColor;n.maskId="mask"+g++;const o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",n.maskId);const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",u(r)),l.setAttributeNS(null,"height",u(i)),l.setAttributeNS(null,"fill",s),l.setAttributeNS(null,"mask",`url(#${n.maskId})`),this.defs.append(o),this._ensureTransformGroup().append(l),this.paintInlineImageXObject(t,o)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const e=t[2]-t[0],n=t[3]-t[1],r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x",t[0]),r.setAttributeNS(null,"y",t[1]),r.setAttributeNS(null,"width",u(e)),r.setAttributeNS(null,"height",u(n)),this.current.element=r,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),n=this.svgFactory.createElement("svg:defs");t.append(n),this.defs=n;const r=this.svgFactory.createElement("svg:g");return r.setAttributeNS(null,"transform",p(e.transform)),t.append(r),this.svg=r,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",p(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class n{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};return function e(r){if(!r)return;let a=null;const i=r.name;if("#text"===i)a=r.value;else{if(!n.shouldBuildText(i))return;r?.attributes?.textContent?a=r.attributes.textContent:r.value&&(a=r.value)}if(null!==a&&t.push({str:a}),r.children)for(const t of r.children)e(t)}(e),r}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}t.XfaText=n},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=function(e){e.textContentSource||!e.textContent&&!e.textContentStream||((0,a.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),e.textContentSource=e.textContent||e.textContentStream);const{container:t,viewport:n}=e,r=getComputedStyle(t),i=r.getPropertyValue("visibility"),s=parseFloat(r.getPropertyValue("--scale-factor"));"visible"===i&&(!s||Math.abs(s-n.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new d(e);return o._render(),o},t.updateTextLayer=function({container:e,viewport:t,textDivs:n,textDivProperties:r,isOffscreenCanvasSupported:i,mustRotate:s=!0,mustRescale:l=!0}){if(s&&(0,a.setLayerDimensions)(e,{rotation:t.rotation}),l){const e=o(0,i),a={prevFontSize:null,prevFontFamily:null,div:null,scale:t.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:e};for(const e of n)a.properties=r.get(e),a.div=e,c(a)}};var r=n(1),a=n(6);const i=30,s=new Map;function o(e,t){let n;if(t&&r.FeatureTest.isOffscreenCanvasSupported)n=new OffscreenCanvas(e,e).getContext("2d",{alpha:!1});else{const t=document.createElement("canvas");t.width=t.height=e,n=t.getContext("2d",{alpha:!1})}return n}function l(e,t,n){const a=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};e._textDivs.push(a);const c=r.Util.transform(e._transform,t.transform);let d=Math.atan2(c[1],c[0]);const h=n[t.fontName];h.vertical&&(d+=Math.PI/2);const u=Math.hypot(c[2],c[3]),p=u*function(e,t){const n=s.get(e);if(n)return n;const r=o(i,t);r.font=`30px ${e}`;const a=r.measureText("");let l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);if(l){const t=l/(l+c);return s.set(e,t),r.canvas.width=r.canvas.height=0,t}r.strokeStyle="red",r.clearRect(0,0,i,i),r.strokeText("g",0,0);let d=r.getImageData(0,0,i,i).data;c=0;for(let e=d.length-1-3;e>=0;e-=4)if(d[e]>0){c=Math.ceil(e/4/i);break}r.clearRect(0,0,i,i),r.strokeText("A",0,i),d=r.getImageData(0,0,i,i).data,l=0;for(let e=0,t=d.length;e<t;e+=4)if(d[e]>0){l=i-Math.floor(e/4/i);break}if(r.canvas.width=r.canvas.height=0,l){const t=l/(l+c);return s.set(e,t),t}return s.set(e,.8),.8}(h.fontFamily,e._isOffscreenCanvasSupported);let A,g;0===d?(A=c[4],g=c[5]-p):(A=c[4]+p*Math.sin(d),g=c[5]-p*Math.cos(d));const m="calc(var(--scale-factor)*",f=a.style;e._container===e._rootContainer?(f.left=`${(100*A/e._pageWidth).toFixed(2)}%`,f.top=`${(100*g/e._pageHeight).toFixed(2)}%`):(f.left=`${m}${A.toFixed(2)}px)`,f.top=`${m}${g.toFixed(2)}px)`),f.fontSize=`${m}${u.toFixed(2)}px)`,f.fontFamily=h.fontFamily,l.fontSize=u,a.setAttribute("role","presentation"),a.textContent=t.str,a.dir=t.dir,e._fontInspectorEnabled&&(a.dataset.fontName=t.fontName),0!==d&&(l.angle=d*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(b=!0)}b&&(l.canvasWidth=h.vertical?t.height:t.width),e._textDivProperties.set(a,l),e._isReadableStream&&e._layoutText(a)}function c(e){const{div:t,scale:n,properties:r,ctx:a,prevFontSize:i,prevFontFamily:s}=e,{style:o}=t;let l="";if(0!==r.canvasWidth&&r.hasText){const{fontFamily:c}=o,{canvasWidth:d,fontSize:h}=r;i===h&&s===c||(a.font=`${h*n}px ${c}`,e.prevFontSize=h,e.prevFontFamily=c);const{width:u}=a.measureText(t.textContent);u>0&&(l=`scaleX(${d*n/u})`)}0!==r.angle&&(l=`rotate(${r.angle}deg) ${l}`),l.length>0&&(o.transform=l)}class d{constructor({textContentSource:e,container:t,viewport:n,textDivs:i,textDivProperties:s,textContentItemsStr:l,isOffscreenCanvasSupported:c}){this._textContentSource=e,this._isReadableStream=e instanceof ReadableStream,this._container=this._rootContainer=t,this._textDivs=i||[],this._textContentItemsStr=l||[],this._isOffscreenCanvasSupported=c,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=s||new WeakMap,this._canceled=!1,this._capability=new r.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:n.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:o(0,c)};const{pageWidth:d,pageHeight:h,pageX:u,pageY:p}=n.rawDims;this._transform=[1,0,0,-1,-u,p+h],this._pageWidth=d,this._pageHeight=h,(0,a.setLayerDimensions)(t,n),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(e,t){for(const n of e)if(void 0!==n.str)this._textContentItemsStr.push(n.str),l(this,n,t);else if("beginMarkedContentProps"===n.type||"beginMarkedContent"===n.type){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==n.id&&this._container.setAttribute("id",`${n.id}`),e.append(this._container)}else"endMarkedContent"===n.type&&(this._container=this._container.parentNode)}_layoutText(e){const t=this._layoutTextParams.properties=this._textDivProperties.get(e);if(this._layoutTextParams.div=e,c(this._layoutTextParams),t.hasText&&this._container.append(e),t.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this._container.append(e)}}_render(){const e=new r.PromiseCapability;let t=Object.create(null);if(this._isReadableStream){const n=()=>{this._reader.read().then(({value:r,done:a})=>{a?e.resolve():(Object.assign(t,r.styles),this._processItems(r.items,t),n())},e.reject)};this._reader=this._textContentSource.getReader(),n()}else{if(!this._textContentSource)throw new Error('No "textContentSource" parameter specified.');{const{items:t,styles:n}=this._textContentSource;this._processItems(t,n),e.resolve()}}e.promise.then(()=>{t=null,function(e){if(e._canceled)return;const t=e._textDivs,n=e._capability;if(t.length>1e5)n.resolve();else{if(!e._isReadableStream)for(const n of t)e._layoutText(n);n.resolve()}}(this)},this._capability.reject)}}t.TextLayerRenderTask=d},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var r=n(1),a=n(4),i=n(28),s=n(33),o=n(6),l=n(34);class c{#xt;#Et=!1;#wt=null;#_t=this.pointerup.bind(this);#Bt=this.pointerdown.bind(this);#It=new Map;#kt=!1;#St=!1;#Tt=!1;#Rt;static _initialized=!1;constructor({uiManager:e,pageIndex:t,div:n,accessibilityManager:r,annotationLayer:a,viewport:o,l10n:d}){const h=[i.FreeTextEditor,s.InkEditor,l.StampEditor];if(!c._initialized){c._initialized=!0;for(const e of h)e.initialize(d)}e.registerEditorTypes(h),this.#Rt=e,this.pageIndex=t,this.div=n,this.#xt=r,this.#wt=a,this.viewport=o,this.#Rt.addLayer(this)}get isEmpty(){return 0===this.#It.size}updateToolbar(e){this.#Rt.updateToolbar(e)}updateMode(e=this.#Rt.getMode()){this.#Mt(),e===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),e!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",e===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",e===r.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",e===r.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(e){if(e||this.#Rt.getMode()===r.AnnotationEditorType.INK){if(!e)for(const e of this.#It.values())if(e.isEmpty())return void e.setInBackground();this.#Pt({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(e){this.#Rt.setEditingState(e)}addCommands(e){this.#Rt.addCommands(e)}enable(){this.div.style.pointerEvents="auto";const e=new Set;for(const t of this.#It.values())t.enableEditing(),t.annotationElementId&&e.add(t.annotationElementId);if(!this.#wt)return;const t=this.#wt.getEditableAnnotations();for(const n of t){if(n.hide(),this.#Rt.isDeletedAnnotationElement(n.data.id))continue;if(e.has(n.data.id))continue;const t=this.deserialize(n);t&&(this.addOrRebuild(t),t.enableEditing())}}disable(){this.#Tt=!0,this.div.style.pointerEvents="none";const e=new Set;for(const t of this.#It.values())t.disableEditing(),t.annotationElementId&&null===t.serialize()?(this.getEditableAnnotation(t.annotationElementId)?.show(),t.remove()):e.add(t.annotationElementId);if(this.#wt){const t=this.#wt.getEditableAnnotations();for(const n of t){const{id:t}=n.data;e.has(t)||this.#Rt.isDeletedAnnotationElement(t)||n.show()}}this.#Mt(),this.isEmpty&&(this.div.hidden=!0),this.#Tt=!1}getEditableAnnotation(e){return this.#wt?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#Rt.getActive()!==e&&this.#Rt.setActiveEditor(e)}enableClick(){this.div.addEventListener("pointerdown",this.#Bt),this.div.addEventListener("pointerup",this.#_t)}disableClick(){this.div.removeEventListener("pointerdown",this.#Bt),this.div.removeEventListener("pointerup",this.#_t)}attach(e){this.#It.set(e.id,e);const{annotationElementId:t}=e;t&&this.#Rt.isDeletedAnnotationElement(t)&&this.#Rt.removeDeletedAnnotationElement(e)}detach(e){this.#It.delete(e.id),this.#xt?.removePointerInTextLayer(e.contentDiv),!this.#Tt&&e.annotationElementId&&this.#Rt.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#Rt.removeEditor(e),e.div.contains(document.activeElement)&&setTimeout(()=>{this.#Rt.focusMainContainer()},0),e.div.remove(),e.isAttachedToDOM=!1,this.#St||this.addInkEditorIfNeeded(!1)}changeParent(e){e.parent!==this&&(e.annotationElementId&&(this.#Rt.addDeletedAnnotationElement(e.annotationElementId),a.AnnotationEditor.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(this.changeParent(e),this.#Rt.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#Rt.addToAnnotationStorage(e)}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&(e._focusEventsAllowed=!1,setTimeout(()=>{e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),t.focus())},0)),e._structTreeParentId=this.#xt?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return this.#Rt.getId()}#Ft(e){switch(this.#Rt.getMode()){case r.AnnotationEditorType.FREETEXT:return new i.FreeTextEditor(e);case r.AnnotationEditorType.INK:return new s.InkEditor(e);case r.AnnotationEditorType.STAMP:return new l.StampEditor(e)}return null}pasteEditor(e,t){this.#Rt.updateToolbar(e),this.#Rt.updateMode(e);const{offsetX:n,offsetY:r}=this.#Dt(),a=this.getNextId(),i=this.#Ft({parent:this,id:a,x:n,y:r,uiManager:this.#Rt,isCentered:!0,...t});i&&this.add(i)}deserialize(e){switch(e.annotationType??e.annotationEditorType){case r.AnnotationEditorType.FREETEXT:return i.FreeTextEditor.deserialize(e,this,this.#Rt);case r.AnnotationEditorType.INK:return s.InkEditor.deserialize(e,this,this.#Rt);case r.AnnotationEditorType.STAMP:return l.StampEditor.deserialize(e,this,this.#Rt)}return null}#Pt(e,t){const n=this.getNextId(),r=this.#Ft({parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:this.#Rt,isCentered:t});return r&&this.add(r),r}#Dt(){const{x:e,y:t,width:n,height:r}=this.div.getBoundingClientRect(),a=Math.max(0,e),i=Math.max(0,t),s=(a+Math.min(window.innerWidth,e+n))/2-e,o=(i+Math.min(window.innerHeight,t+r))/2-t,[l,c]=this.viewport.rotation%180==0?[s,o]:[o,s];return{offsetX:l,offsetY:c}}addNewEditor(){this.#Pt(this.#Dt(),!0)}setSelected(e){this.#Rt.setSelected(e)}toggleSelected(e){this.#Rt.toggleSelected(e)}isSelected(e){return this.#Rt.isSelected(e)}unselect(e){this.#Rt.unselect(e)}pointerup(e){const{isMac:t}=r.FeatureTest.platform;0!==e.button||e.ctrlKey&&t||e.target===this.div&&this.#kt&&(this.#kt=!1,this.#Et?this.#Rt.getMode()!==r.AnnotationEditorType.STAMP?this.#Pt(e,!1):this.#Rt.unselectAll():this.#Et=!0)}pointerdown(e){if(this.#kt)return void(this.#kt=!1);const{isMac:t}=r.FeatureTest.platform;if(0!==e.button||e.ctrlKey&&t)return;if(e.target!==this.div)return;this.#kt=!0;const n=this.#Rt.getActive();this.#Et=!n||n.isEmpty()}findNewParent(e,t,n){const r=this.#Rt.findParent(t,n);return null!==r&&r!==this&&(r.changeParent(e),!0)}destroy(){this.#Rt.getActive()?.parent===this&&(this.#Rt.commitOrRemove(),this.#Rt.setActiveEditor(null));for(const e of this.#It.values())this.#xt?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#It.clear(),this.#Rt.removeLayer(this)}#Mt(){this.#St=!0;for(const e of this.#It.values())e.isEmpty()&&e.remove();this.#St=!1}render({viewport:e}){this.viewport=e,(0,o.setLayerDimensions)(this.div,e);for(const e of this.#Rt.getEditors(this.pageIndex))this.add(e);this.updateMode()}update({viewport:e}){this.#Rt.commitOrRemove(),this.viewport=e,(0,o.setLayerDimensions)(this.div,{rotation:e.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}}t.AnnotationEditorLayer=c},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var r=n(1),a=n(5),i=n(4),s=n(29);class o extends i.AnnotationEditor{#Ot=this.editorDivBlur.bind(this);#Lt=this.editorDivFocus.bind(this);#Nt=this.editorDivInput.bind(this);#Ut=this.editorDivKeydown.bind(this);#jt;#zt="";#qt=`${this.id}-editor`;#Ht;#Wt=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=o.prototype,t=e=>e.isEmpty(),n=a.AnnotationEditorUIManager.TRANSLATE_SMALL,i=a.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new a.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";constructor(e){super({...e,name:"freeTextEditor"}),this.#jt=e.color||o._defaultColor||i.AnnotationEditor._defaultLineColor,this.#Ht=e.fontSize||o._defaultFontSize}static initialize(e){i.AnnotationEditor.initialize(e,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case r.AnnotationEditorParamsType.FREETEXT_SIZE:o._defaultFontSize=t;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:o._defaultColor=t}}updateParams(e,t){switch(e){case r.AnnotationEditorParamsType.FREETEXT_SIZE:this.#Yt(t);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:this.#Gt(t)}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,o._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,o._defaultColor||i.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,this.#Ht],[r.AnnotationEditorParamsType.FREETEXT_COLOR,this.#jt]]}#Yt(e){const t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--scale-factor))`,this.translate(0,-(e-this.#Ht)*this.parentScale),this.#Ht=e,this.#Vt()},n=this.#Ht;this.addCommands({cmd:()=>{t(e)},undo:()=>{t(n)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#Gt(e){const t=this.#jt;this.addCommands({cmd:()=>{this.#jt=this.editorDiv.style.color=e},undo:()=>{this.#jt=this.editorDiv.style.color=t},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-o._internalPadding*e,-(o._internalPadding+this.#Ht)*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#Ut),this.editorDiv.addEventListener("focus",this.#Lt),this.editorDiv.addEventListener("blur",this.#Ot),this.editorDiv.addEventListener("input",this.#Nt))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#qt),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#Ut),this.editorDiv.removeEventListener("focus",this.#Lt),this.editorDiv.removeEventListener("blur",this.#Ot),this.editorDiv.removeEventListener("input",this.#Nt),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width?this.#Xt():(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#$t(){const e=this.editorDiv.getElementsByTagName("div");if(0===e.length)return this.editorDiv.innerText;const t=[];for(const n of e)t.push(n.innerText.replace(/\r\n?|\n/,""));return t.join("\n")}#Vt(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,r=t.style.display;t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=r}this.rotation%180==this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#zt,t=this.#zt=this.#$t().trimEnd();if(e===t)return;const n=e=>{this.#zt=e,e?(this.#Kt(),this._uiManager.rebuild(this),this.#Vt()):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#Vt()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){o._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#qt),this.enableEditing(),i.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(e=>this.editorDiv?.setAttribute("aria-label",e)),i.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(e=>this.editorDiv?.setAttribute("default-content",e)),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#Ht}px * var(--scale-factor))`,n.color=this.#jt,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this.#Wt;let[i,s]=this.getInitialTranslation();[i,s]=this.pageTranslationToScreen(i,s);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let h,u;switch(this.rotation){case 0:h=e+(a[0]-c)/o,u=t+this.height-(a[1]-d)/l;break;case 90:h=e+(a[0]-c)/o,u=t-(a[1]-d)/l,[i,s]=[s,-i];break;case 180:h=e-this.width+(a[0]-c)/o,u=t-(a[1]-d)/l,[i,s]=[-i,-s];break;case 270:h=e+(a[0]-c-this.height*l)/o,u=t+(a[1]-d-this.width*o)/l,[i,s]=[-s,i]}this.setAt(h*n,u*r,i,s)}else this.setAt(e*n,t*r,this.width*n,this.height*r);this.#Kt(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#Kt(){if(this.editorDiv.replaceChildren(),this.#zt)for(const e of this.#zt.split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){let a=null;if(e instanceof s.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:i,rotation:s,id:o},textContent:l,textPosition:c,parent:{page:{pageNumber:d}}}=e;if(!l||0===l.length)return null;a=e={annotationType:r.AnnotationEditorType.FREETEXT,color:Array.from(n),fontSize:t,value:l.join("\n"),position:c,pageIndex:d-1,rect:i,rotation:s,id:o,deleted:!1}}const i=super.deserialize(e,t,n);return i.#Ht=e.fontSize,i.#jt=r.Util.makeHexColor(...e.color),i.#zt=e.value,i.annotationElementId=e.id||null,i.#Wt=a,i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=o._internalPadding*this.parentScale,n=this.getRect(t,t),a=i.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#jt),s={annotationType:r.AnnotationEditorType.FREETEXT,color:a,fontSize:this.#Ht,value:this.#zt,pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?s:this.annotationElementId&&!this.#Qt(s)?null:(s.id=this.annotationElementId,s)}#Qt(e){const{value:t,fontSize:n,color:r,rect:a,pageIndex:i}=this.#Wt;return e.value!==t||e.fontSize!==n||e.rect.some((e,t)=>Math.abs(e-a[t])>=1)||e.color.some((e,t)=>e!==r[t])||e.pageIndex!==i}#Xt(e=!1){if(!this.annotationElementId)return;if(this.#Vt(),!e&&(0===this.width||0===this.height))return void setTimeout(()=>this.#Xt(!0),0);const t=o._internalPadding*this.parentScale;this.#Wt.rect=this.getRect(t,t)}}t.FreeTextEditor=o},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var r=n(1),a=n(6),i=n(3),s=n(30),o=n(31),l=n(32);const c=1e3,d=new WeakSet;function h(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class u{static create(e){switch(e.data.annotationType){case r.AnnotationType.LINK:return new A(e);case r.AnnotationType.TEXT:return new g(e);case r.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new f(e);case"Btn":return e.data.radioButton?new y(e):e.data.checkBox?new C(e):new v(e);case"Ch":return new x(e);case"Sig":return new b(e)}return new m(e);case r.AnnotationType.POPUP:return new E(e);case r.AnnotationType.FREETEXT:return new _(e);case r.AnnotationType.LINE:return new B(e);case r.AnnotationType.SQUARE:return new I(e);case r.AnnotationType.CIRCLE:return new k(e);case r.AnnotationType.POLYLINE:return new S(e);case r.AnnotationType.CARET:return new R(e);case r.AnnotationType.INK:return new M(e);case r.AnnotationType.POLYGON:return new T(e);case r.AnnotationType.HIGHLIGHT:return new P(e);case r.AnnotationType.UNDERLINE:return new F(e);case r.AnnotationType.SQUIGGLY:return new D(e);case r.AnnotationType.STRIKEOUT:return new O(e);case r.AnnotationType.STAMP:return new L(e);case r.AnnotationType.FILEATTACHMENT:return new N(e);default:return new p(e)}}}class p{#Jt=!1;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get hasPopupData(){return p._hasPopupData(this.data)}_createContainer(e){const{data:t,parent:{page:n,viewport:a}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof m||(i.tabIndex=c),i.style.zIndex=this.parent.zIndex++,this.data.popupRef&&i.setAttribute("aria-haspopup","dialog"),t.noRotate&&i.classList.add("norotate");const{pageWidth:s,pageHeight:o,pageX:l,pageY:d}=a.rawDims;if(!t.rect||this instanceof E){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,i),i}const{width:u,height:p}=h(t.rect),A=r.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(!e&&t.borderStyle.width>0){i.style.borderWidth=`${t.borderStyle.width}px`;const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t=`calc(${e}px * var(--scale-factor)) / calc(${n}px * var(--scale-factor))`;i.style.borderRadius=t}else if(this instanceof y){const e=`calc(${u}px * var(--scale-factor)) / calc(${p}px * var(--scale-factor))`;i.style.borderRadius=e}switch(t.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:i.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:i.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:i.style.borderBottomStyle="solid"}const a=t.borderColor||null;a?(this.#Jt=!0,i.style.borderColor=r.Util.makeHexColor(0|a[0],0|a[1],0|a[2])):i.style.borderWidth=0}i.style.left=100*(A[0]-l)/s+"%",i.style.top=100*(A[1]-d)/o+"%";const{rotation:g}=t;return t.hasOwnCanvas||0===g?(i.style.width=100*u/s+"%",i.style.height=100*p/o+"%"):this.setRotation(g,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:a,height:i}=h(this.data.rect);let s,o;e%180==0?(s=100*a/n,o=100*i/r):(s=100*i/n,o=100*a/r),t.style.width=`${s}%`,t.style.height=`${o}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const r=n.detail[e],a=r[0],i=r.slice(1);n.target.style[t]=s.ColorConverters[`${a}_HTML`](i),this.annotationStorage.setValue(this.data.id,{[t]:s.ColorConverters[`${a}_rgb`](i)})};return(0,r.shadow)(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2==1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const r of Object.keys(t.detail)){const a=e[r]||n[r];a?.(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[r,a]of Object.entries(t)){const i=n[r];i&&(i({detail:{[r]:a},target:e}),delete t[r])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,r,a]=this.data.rect;if(1===e.length){const[,{x:i,y:s},{x:o,y:l}]=e[0];if(r===i&&a===s&&t===o&&n===l)return}const{style:i}=this.container;let s;if(this.#Jt){const{borderColor:e,borderWidth:t}=i;i.borderWidth=0,s=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${e}" stroke-width="${t}">`],this.container.classList.add("hasBorder")}const o=r-t,l=a-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=c.createElement("defs");d.append(h);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),h.append(u);for(const[,{x:n,y:r},{x:i,y:d}]of e){const e=c.createElement("rect"),h=(i-t)/o,p=(a-r)/l,A=(n-i)/o,g=(r-d)/l;e.setAttribute("x",h),e.setAttribute("y",p),e.setAttribute("width",A),e.setAttribute("height",g),u.append(e),s?.push(`<rect vector-effect="non-scaling-stroke" x="${h}" y="${p}" width="${A}" height="${g}"/>`)}this.#Jt&&(s.push("</g></svg>')"),i.backgroundImage=s.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{container:e,data:t}=this;e.setAttribute("aria-haspopup","dialog");const n=new E({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(n.render())}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const a=this._fieldObjects[e];if(a)for(const{page:e,id:i,exportValues:s}of a){if(-1===e)continue;if(i===t)continue;const a="string"==typeof s?s:null,o=document.querySelector(`[data-element-id="${i}"]`);!o||d.has(o)?n.push({id:i,exportValue:a,domElement:o}):(0,r.warn)(`_getElementsByName - element not allowed: ${i}`)}return n}for(const r of document.getElementsByName(e)){const{exportValue:e}=r,a=r.getAttribute("data-element-id");a!==t&&d.has(r)&&n.push({id:a,exportValue:e,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class A extends p{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action),r=!0):e.attachment?(this._bindAttachment(n,e.attachment),r=!0):e.setOCGState?(this.#Zt(n,e.setOCGState),r=!0):e.dest?(this._bindLink(n,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}#en(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&this.#en()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#en()}_bindAttachment(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,t.content,t.filename),!1),this.#en()}#Zt(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#en()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const a=n.get(r);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#en()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#en(),!this._fieldObjects)return(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{n?.();const{fields:e,refs:a,include:i}=t,s=[];if(0!==e.length||0!==a.length){const t=new Set(a);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===i&&s.push(n)}else for(const e of Object.values(this._fieldObjects))s.push(...e);const o=this.annotationStorage,l=[];for(const e of s){const{id:t}=e;switch(l.push(t),e.type){case"text":{const n=e.defaultValue||"";o.setValue(t,{value:n});break}case"checkbox":case"radiobutton":{const n=e.defaultValue===e.exportValues;o.setValue(t,{value:n});break}case"combobox":case"listbox":{const n=e.defaultValue||"";o.setValue(t,{value:n});break}default:continue}const n=document.querySelector(`[data-element-id="${t}"]`);n&&(d.has(n)?n.dispatchEvent(new Event("resetform")):(0,r.warn)(`_bindResetFormAction - element not allowed: ${t}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}}),!1}}}class g extends p{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class m extends p{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&("CANVAS"===e.previousSibling?.nodeName&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){const{isWin:t,isMac:n}=r.FeatureTest.platform;return t&&e.ctrlKey||n&&e.metaKey}_setEventListener(e,t,n,r,a){n.includes("mouse")?e.addEventListener(n,e=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(e)}})})}_setEventListeners(e,t,n,r){for(const[a,i]of n)("Action"===i||this.data.actions?.[i])&&("Focus"!==i&&"Blur"!==i||(t||={focused:!1}),this._setEventListener(e,t,a,i,r),"Focus"!==i||this.data.actions?.Blur?"Blur"!==i||this.data.actions?.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":r.Util.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const{fontColor:t}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||9,a=e.style;let i;const s=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(r.LINE_FACTOR*n))||1);i=Math.min(n,s(t/r.LINE_FACTOR))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);i=Math.min(n,s(e/r.LINE_FACTOR))}a.fontSize=`calc(${i}px * var(--scale-factor))`,a.color=r.Util.makeHexColor(t[0],t[1],t[2]),null!==this.data.textAlignment&&(a.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class f extends m{constructor(e){super(e,{isRenderable:e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,r){const a=this.annotationStorage;for(const i of this._getElementsByName(e.name,e.id))i.domElement&&(i.domElement[t]=n),a.setValue(i.id,{[r]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let a=r.value||"";const i=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;i&&a.length>i&&(a=a.slice(0,i));let s=r.formattedValue||this.data.textContent?.join("\n")||null;s&&this.data.comb&&(s=s.replaceAll(/\s+/g,""));const o={userValue:a,formattedValue:s,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=s??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",s??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),d.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=c,this._setRequired(n,this.data.required),i&&(n.maxLength=i),n.addEventListener("input",r=>{e.setValue(t,{value:r.target.value}),this.setPropertyOnSiblings(n,"value",r.target.value,"value"),o.formattedValue=null}),n.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue??"";n.value=o.userValue=t,o.formattedValue=null});let l=e=>{const{formattedValue:t}=o;null!=t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",e=>{if(o.focused)return;const{target:t}=e;o.userValue&&(t.value=o.userValue),o.lastCommittedValue=t.value,o.commitKey=1,o.focused=!0}),n.addEventListener("updatefromsandbox",n=>{this.showElementAndHideCanvas(n.target);const r={value(n){o.userValue=n.detail.value??"",e.setValue(t,{value:o.userValue.toString()}),n.target.value=o.userValue},formattedValue(n){const{formattedValue:r}=n.detail;o.formattedValue=r,null!=r&&n.target!==document.activeElement&&(n.target.value=r),e.setValue(t,{formattedValue:r})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{const{charLimit:r}=n.detail,{target:a}=n;if(0===r)return void a.removeAttribute("maxLength");a.setAttribute("maxLength",r);let i=o.userValue;!i||i.length<=r||(i=i.slice(0,r),a.value=o.userValue=i,e.setValue(t,{value:i}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,willCommit:!0,commitKey:1,selStart:a.selectionStart,selEnd:a.selectionEnd}}))}};this._dispatchEventFromSandbox(r,n)}),n.addEventListener("keydown",e=>{o.commitKey=1;let n=-1;if("Escape"===e.key?n=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(o.commitKey=3):n=2,-1===n)return;const{value:r}=e.target;o.lastCommittedValue!==r&&(o.lastCommittedValue=r,o.userValue=r,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:n,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const r=l;l=null,n.addEventListener("blur",e=>{if(!o.focused||!e.relatedTarget)return;o.focused=!1;const{value:n}=e.target;o.userValue=n,o.lastCommittedValue!==n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:n,willCommit:!0,commitKey:o.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}),r(e)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",e=>{o.lastCommittedValue=null;const{data:n,target:r}=e,{value:a,selectionStart:i,selectionEnd:s}=r;let l=i,c=s;switch(e.inputType){case"deleteWordBackward":{const e=a.substring(0,i).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=a.substring(i).match(/^[^\w]*\w*/);e&&(c+=e[0].length);break}case"deleteContentBackward":i===s&&(l-=1);break;case"deleteContentForward":i===s&&(c+=1)}e.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,change:n||"",willCommit:!1,selStart:l,selEnd:c}})}),this._setEventListeners(n,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(l&&n.addEventListener("blur",l),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/i;n.classList.add("comb"),n.style.letterSpacing=`calc(${e}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell";return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class b extends m{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class C extends m{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"==typeof r&&(r="Off"!==r,e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return d.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=c,a.addEventListener("change",r=>{const{name:a,checked:i}=r.target;for(const r of this._getElementsByName(a,n)){const n=i&&r.exportValue===t.exportValue;r.domElement&&(r.domElement.checked=n),e.setValue(r.id,{value:n})}e.setValue(n,{value:i})}),a.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",t=>{const r={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(r,t)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class y extends m{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;"string"==typeof r&&(r=r!==t.buttonValue,e.setValue(n,{value:r}));const a=document.createElement("input");if(d.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=c,a.addEventListener("change",t=>{const{name:r,checked:a}=t.target;for(const t of this._getElementsByName(r,n))e.setValue(t.id,{value:!1});e.setValue(n,{value:a})}),a.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!=n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const r=t.buttonValue;a.addEventListener("updatefromsandbox",t=>{const a={value:t=>{const a=r===t.detail.value;for(const r of this._getElementsByName(t.target.name)){const t=a&&r.id===n;r.domElement&&(r.domElement.checked=t),e.setValue(r.id,{value:t})}}};this._dispatchEventFromSandbox(a,t)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class v extends A{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class x extends m{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");d.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=c;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const e of r.options)e.selected=e.value===t});for(const e of this.data.options){const t=document.createElement("option");t.textContent=e.displayValue,t.value=e.exportValue,n.value.includes(e.exportValue)&&(t.setAttribute("selected",!0),a=!1),r.append(t)}let i=null;if(a){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),r.prepend(e),i=()=>{e.remove(),r.removeEventListener("input",i),i=null},r.addEventListener("input",i)}const s=e=>{const t=e?"value":"textContent",{options:n,multiple:a}=r;return a?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let o=s(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",n=>{const a={value(n){i?.();const a=n.detail.value,l=new Set(Array.isArray(a)?a:[a]);for(const e of r.options)e.selected=l.has(e.value);e.setValue(t,{value:s(!0)}),o=s(!1)},multipleSelection(e){r.multiple=!0},remove(n){const a=r.options,i=n.detail.remove;a[i].selected=!1,r.remove(i),a.length>0&&-1===Array.prototype.findIndex.call(a,e=>e.selected)&&(a[0].selected=!0),e.setValue(t,{value:s(!0),items:l(n)}),o=s(!1)},clear(n){for(;0!==r.length;)r.remove(0);e.setValue(t,{value:null,items:[]}),o=s(!1)},insert(n){const{index:a,displayValue:i,exportValue:c}=n.detail.insert,d=r.children[a],h=document.createElement("option");h.textContent=i,h.value=c,d?d.before(h):r.append(h),e.setValue(t,{value:s(!0),items:l(n)}),o=s(!1)},items(n){const{items:a}=n.detail;for(;0!==r.length;)r.remove(0);for(const e of a){const{displayValue:t,exportValue:n}=e,a=document.createElement("option");a.textContent=t,a.value=n,r.append(a)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:s(!0),items:l(n)}),o=s(!1)},indices(n){const r=new Set(n.detail.indices);for(const e of n.target.options)e.selected=r.has(e.index);e.setValue(t,{value:s(!0)}),o=s(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(a,n)}),r.addEventListener("input",n=>{const r=s(!0);e.setValue(t,{value:r}),n.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,changeEx:r,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):r.addEventListener("input",function(n){e.setValue(t,{value:s(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class E extends p{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:p._hasPopupData(t)}),this.elements=n}render(){this.container.classList.add("popupAnnotation");const e=new w({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(e=>`${r.AnnotationPrefix}${e}`).join(",")),this.container}}class w{#tn=null;#nn=this.#rn.bind(this);#an=this.#in.bind(this);#sn=this.#on.bind(this);#ln=this.#cn.bind(this);#jt=null;#Me=null;#dn=null;#hn=null;#un=null;#pn=null;#An=!1;#gn=null;#mn=null;#fn=null;#bn=null;#Cn=!1;constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:i,contentsObj:s,richText:o,parent:l,rect:c,parentRect:d,open:h}){this.#Me=e,this.#bn=r,this.#dn=s,this.#fn=o,this.#un=l,this.#jt=t,this.#mn=c,this.#pn=d,this.#hn=n;const u=a.PDFDateString.toDateObject(i);u&&(this.#tn=l.l10n.get("annotation_date_string",{date:u.toLocaleDateString(),time:u.toLocaleTimeString()})),this.trigger=n.flatMap(e=>e.getElementsToTriggerPopup());for(const e of this.trigger)e.addEventListener("click",this.#ln),e.addEventListener("mouseenter",this.#sn),e.addEventListener("mouseleave",this.#an),e.classList.add("popupTriggerArea");for(const e of n)e.container?.addEventListener("keydown",this.#nn);this.#Me.hidden=!0,h&&this.#cn()}render(){if(this.#gn)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:a,pageY:i}}}=this.#un,s=this.#gn=document.createElement("div");if(s.className="popup",this.#jt){const e=s.style.outlineColor=r.Util.makeHexColor(...this.#jt);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))s.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`;else{const e=.7;s.style.backgroundColor=r.Util.makeHexColor(...this.#jt.map(t=>Math.floor(e*(255-t)+t)))}}const o=document.createElement("span");o.className="header";const c=document.createElement("h1");if(o.append(c),({dir:c.dir,str:c.textContent}=this.#bn),s.append(o),this.#tn){const e=document.createElement("span");e.classList.add("popupDate"),this.#tn.then(t=>{e.textContent=t}),o.append(e)}const d=this.#dn,h=this.#fn;if(!h?.str||d?.str&&d.str!==h.str){const e=this._formatContents(d);s.append(e)}else l.XfaLayer.render({xfaHtml:h.html,intent:"richText",div:s}),s.lastChild.classList.add("richText","popupContent");let u=!!this.#pn,p=u?this.#pn:this.#mn;for(const e of this.#hn)if(!p||null!==r.Util.intersect(e.data.rect,p)){p=e.data.rect,u=!0;break}const A=r.Util.normalizeRect([p[0],e[3]-p[1]+e[1],p[2],e[3]-p[3]+e[1]]),g=u?p[2]-p[0]+5:0,m=A[0]+g,f=A[1],{style:b}=this.#Me;b.left=100*(m-a)/t+"%",b.top=100*(f-i)/n+"%",this.#Me.append(s)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let e=0,t=r.length;e<t;++e){const a=r[e];n.append(document.createTextNode(a)),e<t-1&&n.append(document.createElement("br"))}return n}#rn(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&this.#An)&&this.#cn()}#cn(){this.#An=!this.#An,this.#An?(this.#on(),this.#Me.addEventListener("click",this.#ln),this.#Me.addEventListener("keydown",this.#nn)):(this.#in(),this.#Me.removeEventListener("click",this.#ln),this.#Me.removeEventListener("keydown",this.#nn))}#on(){this.#gn||this.render(),this.isVisible?this.#An&&this.#Me.classList.add("focused"):(this.#Me.hidden=!1,this.#Me.style.zIndex=parseInt(this.#Me.style.zIndex)+1e3)}#in(){this.#Me.classList.remove("focused"),!this.#An&&this.isVisible&&(this.#Me.hidden=!0,this.#Me.style.zIndex=parseInt(this.#Me.style.zIndex)-1e3)}forceHide(){this.#Cn=this.isVisible,this.#Cn&&(this.#Me.hidden=!0)}maybeShow(){this.#Cn&&(this.#Cn=!1,this.#Me.hidden=!1)}get isVisible(){return!1===this.#Me.hidden}}class _ extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=r.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=_;class B extends p{#yn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:n}=h(e.rect),r=this.svgFactory.create(t,n,!0),a=this.#yn=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#yn}addHighlightArea(){this.container.classList.add("highlightArea")}}class I extends p{#vn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:n}=h(e.rect),r=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,i=this.#vn=this.svgFactory.createElement("svg:rect");return i.setAttribute("x",a/2),i.setAttribute("y",a/2),i.setAttribute("width",t-a),i.setAttribute("height",n-a),i.setAttribute("stroke-width",a||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#vn}addHighlightArea(){this.container.classList.add("highlightArea")}}class k extends p{#xn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:n}=h(e.rect),r=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,i=this.#xn=this.svgFactory.createElement("svg:ellipse");return i.setAttribute("cx",t/2),i.setAttribute("cy",n/2),i.setAttribute("rx",t/2-a/2),i.setAttribute("ry",n/2-a/2),i.setAttribute("stroke-width",a||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#xn}addHighlightArea(){this.container.classList.add("highlightArea")}}class S extends p{#En=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:t,height:n}=h(e.rect),r=this.svgFactory.create(t,n,!0);let a=[];for(const t of e.vertices){const n=t.x-e.rect[0],r=e.rect[3]-t.y;a.push(n+","+r)}a=a.join(" ");const i=this.#En=this.svgFactory.createElement(this.svgElementName);return i.setAttribute("points",a),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#En}addHighlightArea(){this.container.classList.add("highlightArea")}}class T extends S{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class R extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class M extends p{#wn=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=r.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:t,height:n}=h(e.rect),r=this.svgFactory.create(t,n,!0);for(const t of e.inkLists){let n=[];for(const r of t){const t=r.x-e.rect[0],a=e.rect[3]-r.y;n.push(`${t},${a}`)}n=n.join(" ");const a=this.svgFactory.createElement(this.svgElementName);this.#wn.push(a),a.setAttribute("points",n),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),r.append(a)}return this.container.append(r),this.container}getElementsToTriggerPopup(){return this.#wn}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=M;class P extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class F extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class D extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class O extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class L extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=L;class N extends p{#_n=null;constructor(e){super(e,{isRenderable:!0});const{filename:t,content:n}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(t,!0),this.content=n,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:t,content:n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(100*t.fillAlpha)}%);`)),n.addEventListener("dblclick",this.#Bn.bind(this)),this.#_n=n;const{isMac:a}=r.FeatureTest.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(a?e.metaKey:e.ctrlKey)&&this.#Bn()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#_n}addHighlightArea(){this.container.classList.add("highlightArea")}#Bn(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}t.AnnotationLayer=class{#xt=null;#In=null;#kn=new Map;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,l10n:r,page:a,viewport:i}){this.div=e,this.#xt=t,this.#In=n,this.l10n=r,this.page=a,this.viewport=i,this.zIndex=0,this.l10n||=o.NullL10n}#Sn(e,t){const n=e.firstChild||e;n.id=`${r.AnnotationPrefix}${t}`,this.div.append(e),this.#xt?.moveElementInDOM(this.div,e,n,!1)}async render(e){const{annotations:t}=e,n=this.div;(0,a.setLayerDimensions)(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new a.DOMSVGFactory,annotationStorage:e.annotationStorage||new i.AnnotationStorage,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const e of t){if(e.noHTML)continue;const t=e.annotationType===r.AnnotationType.POPUP;if(t){const t=s.get(e.id);if(!t)continue;o.elements=t}else{const{width:t,height:n}=h(e.rect);if(t<=0||n<=0)continue}o.data=e;const n=u.create(o);if(!n.isRenderable)continue;if(!t&&e.popupRef){const t=s.get(e.popupRef);t?t.push(n):s.set(e.popupRef,[n])}n.annotationEditorType>0&&this.#kn.set(n.data.id,n);const a=n.render();e.hidden&&(a.style.visibility="hidden"),this.#Sn(a,e.id)}this.#Tn(),await this.l10n.translate(n)}update({viewport:e}){const t=this.div;this.viewport=e,(0,a.setLayerDimensions)(t,{rotation:e.rotation}),this.#Tn(),t.hidden=!1}#Tn(){if(!this.#In)return;const e=this.div;for(const[t,n]of this.#In){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;const{firstChild:a}=r;a?"CANVAS"===a.nodeName?a.replaceWith(n):a.before(n):r.append(n)}this.#In.clear()}getEditableAnnotations(){return Array.from(this.#kn.values())}getEditableAnnotation(e){return this.#kn.get(e)}}},(e,t)=>{function n(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function r(e){return Math.max(0,Math.min(255,255*e))}Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0,t.ColorConverters=class{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return[e=r(e),e,e]}static G_HTML([e]){const t=n(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(r)}static RGB_HTML(e){return`#${e.map(n).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,a]){return[r(1-Math.min(1,e+a)),r(1-Math.min(1,n+a)),r(1-Math.min(1,t+a))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const r=1-e,a=1-t,i=1-n;return["CMYK",r,a,i,Math.min(r,a,i)]}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=r;const n={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};function r(e,t){switch(e){case"find_match_count":e=`find_match_count[${1===t.total?"one":"other"}]`;break;case"find_match_count_limit":e=`find_match_count_limit[${1===t.limit?"one":"other"}]`}return n[e]||""}n.print_progress_percent="{{progress}}%";const a={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(e,t=null,n=r(e,t)){return function(e,t){return t?e.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(e,n)=>n in t?t[n]:"{{"+n+"}}"):e}(n,t)},async translate(e){}};t.NullL10n=a},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var r=n(25);t.XfaLayer=class{static setupStorage(e,t,n,r,a){const i=r.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==i.value&&(e.textContent=i.value),"print"===a)break;e.addEventListener("input",e=>{r.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(i.value===n.attributes.xfaOn?e.setAttribute("checked",!0):i.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===a)break;e.addEventListener("change",e=>{r.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==i.value&&e.setAttribute("value",i.value),"print"===a)break;e.addEventListener("input",e=>{r.setValue(t,{value:e.target.value})})}break;case"select":if(null!==i.value){e.setAttribute("value",i.value);for(const e of n.children)e.attributes.value===i.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,a=-1===n.selectedIndex?"":n[n.selectedIndex].value;r.setValue(t,{value:a})})}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:a}){const{attributes:i}=t,s=e instanceof HTMLAnchorElement;"radio"===i.type&&(i.name=`${i.name}-${r}`);for(const[t,n]of Object.entries(i))if(null!=n)switch(t){case"class":n.length&&e.setAttribute(t,n.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",n);break;case"style":Object.assign(e.style,n);break;case"textContent":e.textContent=n;break;default:(!s||"href"!==t&&"newWindow"!==t)&&e.setAttribute(t,n)}s&&a.addLinkAttributes(e,i.href,i.newWindow),n&&i.dataId&&this.setupStorage(e,i.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,a=e.xfaHtml,i=e.intent||"display",s=document.createElement(a.name);a.attributes&&this.setAttributes({html:s,element:a,intent:i,linkService:n});const o=[[a,-1,s]],l=e.div;if(l.append(s),e.viewport){const t=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=t}"richText"!==i&&l.setAttribute("class","xfaLayer xfaFont");const c=[];for(;o.length>0;){const[e,a,s]=o.at(-1);if(a+1===e.children.length){o.pop();continue}const l=e.children[++o.at(-1)[1]];if(null===l)continue;const{name:d}=l;if("#text"===d){const e=document.createTextNode(l.value);c.push(e),s.append(e);continue}const h=l?.attributes?.xmlns?document.createElementNS(l.attributes.xmlns,d):document.createElement(d);if(s.append(h),l.attributes&&this.setAttributes({html:h,element:l,storage:t,intent:i,linkService:n}),l.children&&l.children.length>0)o.push([l,-1,h]);else if(l.value){const e=document.createTextNode(l.value);r.XfaText.shouldBuildText(d)&&c.push(e),h.append(e)}}for(const e of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))e.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var r=n(1),a=n(4),i=n(29),s=n(6),o=n(5);class l extends a.AnnotationEditor{#Rn=0;#Mn=0;#Pn=this.canvasPointermove.bind(this);#Fn=this.canvasPointerleave.bind(this);#Dn=this.canvasPointerup.bind(this);#On=this.canvasPointerdown.bind(this);#Ln=new Path2D;#Nn=!1;#Un=!1;#jn=!1;#zn=null;#qn=0;#Hn=0;#Wn=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(e){super({...e,name:"inkEditor"}),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e){a.AnnotationEditor.initialize(e,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(e,t){switch(e){case r.AnnotationEditorParamsType.INK_THICKNESS:l._defaultThickness=t;break;case r.AnnotationEditorParamsType.INK_COLOR:l._defaultColor=t;break;case r.AnnotationEditorParamsType.INK_OPACITY:l._defaultOpacity=t/100}}updateParams(e,t){switch(e){case r.AnnotationEditorParamsType.INK_THICKNESS:this.#Yn(t);break;case r.AnnotationEditorParamsType.INK_COLOR:this.#Gt(t);break;case r.AnnotationEditorParamsType.INK_OPACITY:this.#Gn(t)}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,l._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,l._defaultColor||a.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*l._defaultOpacity)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||l._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||l._defaultColor||a.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??l._defaultOpacity))]]}#Yn(e){const t=this.thickness;this.addCommands({cmd:()=>{this.thickness=e,this.#Vn()},undo:()=>{this.thickness=t,this.#Vn()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#Gt(e){const t=this.color;this.addCommands({cmd:()=>{this.color=e,this.#Xn()},undo:()=>{this.color=t,this.#Xn()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#Gn(e){e/=100;const t=this.opacity;this.addCommands({cmd:()=>{this.opacity=e,this.#Xn()},undo:()=>{this.opacity=t,this.#Xn()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(this.#$n(),this.#Kn()),this.isAttachedToDOM||(this.parent.add(this),this.#Qn()),this.#Vn()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#zn.disconnect(),this.#zn=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&null===e&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,t]=this.parentDimensions,n=this.width*e,r=this.height*t;this.setDimensions(n,r)}enableEditMode(){this.#Nn||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#On))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#On))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#Jn(){const{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}#Zn(){const{ctx:e,color:t,opacity:n,thickness:r,parentScale:a,scaleFactor:i}=this;e.lineWidth=r*a/i,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${(0,o.opacityToHex)(n)}`}#er(e,t){this.canvas.addEventListener("contextmenu",s.noContextMenu),this.canvas.addEventListener("pointerleave",this.#Fn),this.canvas.addEventListener("pointermove",this.#Pn),this.canvas.addEventListener("pointerup",this.#Dn),this.canvas.removeEventListener("pointerdown",this.#On),this.isEditing=!0,this.#jn||(this.#jn=!0,this.#Qn(),this.thickness||=l._defaultThickness,this.color||=l._defaultColor||a.AnnotationEditor._defaultLineColor,this.opacity??=l._defaultOpacity),this.currentPath.push([e,t]),this.#Un=!1,this.#Zn(),this.#Wn=()=>{this.#tr(),this.#Wn&&window.requestAnimationFrame(this.#Wn)},window.requestAnimationFrame(this.#Wn)}#nr(e,t){const[n,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===r)return;const a=this.currentPath;let i=this.#Ln;if(a.push([e,t]),this.#Un=!0,a.length<=2)return i.moveTo(...a[0]),void i.lineTo(e,t);3===a.length&&(this.#Ln=i=new Path2D,i.moveTo(...a[0])),this.#rr(i,...a.at(-3),...a.at(-2),e,t)}#ar(){if(0===this.currentPath.length)return;const e=this.currentPath.at(-1);this.#Ln.lineTo(...e)}#ir(e,t){let n;if(this.#Wn=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#nr(e,t),this.#ar(),1!==this.currentPath.length)n=this.#sr();else{const r=[e,t];n=[[r,r.slice(),r.slice(),r]]}const r=this.#Ln,a=this.currentPath;this.currentPath=[],this.#Ln=new Path2D,this.addCommands({cmd:()=>{this.allRawPaths.push(a),this.paths.push(n),this.bezierPath2D.push(r),this.rebuild()},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#$n(),this.#Kn()),this.#Vn())},mustExec:!0})}#tr(){if(!this.#Un)return;this.#Un=!1,Math.ceil(this.thickness*this.parentScale);const e=this.currentPath.slice(-3),t=e.map(e=>e[0]),n=e.map(e=>e[1]),{ctx:r}=(Math.min(...t),Math.max(...t),Math.min(...n),Math.max(...n),this);r.save(),r.clearRect(0,0,this.canvas.width,this.canvas.height);for(const e of this.bezierPath2D)r.stroke(e);r.stroke(this.#Ln),r.restore()}#rr(e,t,n,r,a,i,s){const o=(t+r)/2,l=(n+a)/2,c=(r+i)/2,d=(a+s)/2;e.bezierCurveTo(o+2*(r-o)/3,l+2*(a-l)/3,c+2*(r-c)/3,d+2*(a-d)/3,c,d)}#sr(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const t=[];let n,[r,a]=e[0];for(n=1;n<e.length-2;n++){const[i,s]=e[n],[o,l]=e[n+1],c=(i+o)/2,d=(s+l)/2,h=[r+2*(i-r)/3,a+2*(s-a)/3],u=[c+2*(i-c)/3,d+2*(s-d)/3];t.push([[r,a],h,u,[c,d]]),[r,a]=[c,d]}const[i,s]=e[n],[o,l]=e[n+1],c=[r+2*(i-r)/3,a+2*(s-a)/3],d=[o+2*(i-o)/3,l+2*(s-l)/3];return t.push([[r,a],c,d,[o,l]]),t}#Xn(){if(this.isEmpty())return void this.#or();this.#Zn();const{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#or();for(const e of this.bezierPath2D)t.stroke(e)}commit(){this.#Nn||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#Nn=!0,this.div.classList.add("disabled"),this.#Vn(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){0===e.button&&this.isInEditMode()&&!this.#Nn&&(this.setInForeground(),e.preventDefault(),"mouse"!==e.type&&this.div.focus(),this.#er(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#nr(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#lr(e)}canvasPointerleave(e){this.#lr(e)}#lr(e){this.canvas.removeEventListener("pointerleave",this.#Fn),this.canvas.removeEventListener("pointermove",this.#Pn),this.canvas.removeEventListener("pointerup",this.#Dn),this.canvas.addEventListener("pointerdown",this.#On),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",s.noContextMenu)},10),this.#ir(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#$n(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",a.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(e=>this.canvas?.setAttribute("aria-label",e)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#Kn(){this.#zn=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#zn.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#Nn}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),a.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(e=>this.div?.setAttribute("aria-label",e));const[n,r,i,s]=this.#Jn();if(this.setAt(n,r,0,0),this.setDims(i,s),this.#$n(),this.width){const[n,r]=this.parentDimensions;this.setAspectRatio(this.width*n,this.height*r),this.setAt(e*n,t*r,this.width*n,this.height*r),this.#jn=!0,this.#Qn(),this.setDims(this.width*n,this.height*r),this.#Xn(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#Kn(),this.div}#Qn(){if(!this.#jn)return;const[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#or()}setDimensions(e,t){const n=Math.round(e),r=Math.round(t);if(this.#qn===n&&this.#Hn===r)return;this.#qn=n,this.#Hn=r,this.canvas.style.visibility="hidden";const[a,i]=this.parentDimensions;this.width=e/a,this.height=t/i,this.fixAndSetPosition(),this.#Nn&&this.#cr(e,t),this.#Qn(),this.#Xn(),this.canvas.style.visibility="visible",this.fixDims()}#cr(e,t){const n=this.#dr(),r=(e-n)/this.#Mn,a=(t-n)/this.#Rn;this.scaleFactor=Math.min(r,a)}#or(){const e=this.#dr()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#hr(e){const t=new Path2D;for(let n=0,r=e.length;n<r;n++){const[r,a,i,s]=e[n];0===n&&t.moveTo(...r),t.bezierCurveTo(a[0],a[1],i[0],i[1],s[0],s[1])}return t}static#ur(e,t,n){const[r,a,i,s]=t;switch(n){case 0:for(let t=0,n=e.length;t<n;t+=2)e[t]+=r,e[t+1]=s-e[t+1];break;case 90:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=e[t+1]+r,e[t+1]=n+a}break;case 180:for(let t=0,n=e.length;t<n;t+=2)e[t]=i-e[t],e[t+1]+=a;break;case 270:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=i-e[t+1],e[t+1]=s-n}break;default:throw new Error("Invalid rotation")}return e}static#pr(e,t,n){const[r,a,i,s]=t;switch(n){case 0:for(let t=0,n=e.length;t<n;t+=2)e[t]-=r,e[t+1]=s-e[t+1];break;case 90:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=e[t+1]-a,e[t+1]=n-r}break;case 180:for(let t=0,n=e.length;t<n;t+=2)e[t]=i-e[t],e[t+1]-=a;break;case 270:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=s-e[t+1],e[t+1]=i-n}break;default:throw new Error("Invalid rotation")}return e}#Ar(e,t,n,r){const a=[],i=this.thickness/2,s=e*t+i,o=e*n+i;for(const t of this.paths){const n=[],i=[];for(let r=0,a=t.length;r<a;r++){const[l,c,d,h]=t[r],u=e*l[0]+s,p=e*l[1]+o,A=e*c[0]+s,g=e*c[1]+o,m=e*d[0]+s,f=e*d[1]+o,b=e*h[0]+s,C=e*h[1]+o;0===r&&(n.push(u,p),i.push(u,p)),n.push(A,g,m,f,b,C),i.push(A,g),r===a-1&&i.push(b,C)}a.push({bezier:l.#ur(n,r,this.rotation),points:l.#ur(i,r,this.rotation)})}return a}#gr(){let e=1/0,t=-1/0,n=1/0,a=-1/0;for(const i of this.paths)for(const[s,o,l,c]of i){const i=r.Util.bezierBoundingBox(...s,...o,...l,...c);e=Math.min(e,i[0]),n=Math.min(n,i[1]),t=Math.max(t,i[2]),a=Math.max(a,i[3])}return[e,n,t,a]}#dr(){return this.#Nn?Math.ceil(this.thickness*this.parentScale):0}#Vn(e=!1){if(this.isEmpty())return;if(!this.#Nn)return void this.#Xn();const t=this.#gr(),n=this.#dr();this.#Mn=Math.max(a.AnnotationEditor.MIN_SIZE,t[2]-t[0]),this.#Rn=Math.max(a.AnnotationEditor.MIN_SIZE,t[3]-t[1]);const r=Math.ceil(n+this.#Mn*this.scaleFactor),i=Math.ceil(n+this.#Rn*this.scaleFactor),[s,o]=this.parentDimensions;this.width=r/s,this.height=i/o,this.setAspectRatio(r,i);const l=this.translationX,c=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#Qn(),this.#Xn(),this.#qn=r,this.#Hn=i,this.setDims(r,i);const d=e?n/this.scaleFactor/2:0;this.translate(l-this.translationX-d,c-this.translationY-d)}static deserialize(e,t,n){if(e instanceof i.InkAnnotationElement)return null;const s=super.deserialize(e,t,n);s.thickness=e.thickness,s.color=r.Util.makeHexColor(...e.color),s.opacity=e.opacity;const[o,c]=s.pageDimensions,d=s.width*o,h=s.height*c,u=s.parentScale,p=e.thickness/2;s.#Nn=!0,s.#qn=Math.round(d),s.#Hn=Math.round(h);const{paths:A,rect:g,rotation:m}=e;for(let{bezier:e}of A){e=l.#pr(e,g,m);const t=[];s.paths.push(t);let n=u*(e[0]-p),r=u*(e[1]-p);for(let a=2,i=e.length;a<i;a+=6){const i=u*(e[a]-p),s=u*(e[a+1]-p),o=u*(e[a+2]-p),l=u*(e[a+3]-p),c=u*(e[a+4]-p),d=u*(e[a+5]-p);t.push([[n,r],[i,s],[o,l],[c,d]]),n=c,r=d}const a=this.#hr(t);s.bezierPath2D.push(a)}const f=s.#gr();return s.#Mn=Math.max(a.AnnotationEditor.MIN_SIZE,f[2]-f[0]),s.#Rn=Math.max(a.AnnotationEditor.MIN_SIZE,f[3]-f[1]),s.#cr(d,h),s}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),t=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#Ar(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}t.InkEditor=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var r=n(1),a=n(4),i=n(6),s=n(29);class o extends a.AnnotationEditor{#mr=null;#fr=null;#br=null;#Cr=null;#yr=null;#vr=null;#zn=null;#xr=null;#Er=!1;#wr=!1;static _type="stamp";constructor(e){super({...e,name:"stampEditor"}),this.#Cr=e.bitmapUrl,this.#yr=e.bitmapFile}static initialize(e){a.AnnotationEditor.initialize(e)}static get supportedTypes(){return(0,r.shadow)(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(e=>`image/${e}`))}static get supportedTypesStr(){return(0,r.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(r.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}#_r(e,t=!1){e?(this.#mr=e.bitmap,t||(this.#fr=e.id,this.#Er=e.isSvg),this.#$n()):this.remove()}#Br(){this.#br=null,this._uiManager.enableWaiting(!1),this.#vr&&this.div.focus()}#Ir(){if(this.#fr)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#fr).then(e=>this.#_r(e,!0)).finally(()=>this.#Br());if(this.#Cr){const e=this.#Cr;return this.#Cr=null,this._uiManager.enableWaiting(!0),void(this.#br=this._uiManager.imageManager.getFromUrl(e).then(e=>this.#_r(e)).finally(()=>this.#Br()))}if(this.#yr){const e=this.#yr;return this.#yr=null,this._uiManager.enableWaiting(!0),void(this.#br=this._uiManager.imageManager.getFromFile(e).then(e=>this.#_r(e)).finally(()=>this.#Br()))}const e=document.createElement("input");e.type="file",e.accept=o.supportedTypesStr,this.#br=new Promise(t=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this.#_r(t)}else this.remove();t()}),e.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>this.#Br()),e.click()}remove(){this.#fr&&(this.#mr=null,this._uiManager.imageManager.deleteId(this.#fr),this.#vr?.remove(),this.#vr=null,this.#zn?.disconnect(),this.#zn=null),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#fr&&this.#Ir(),this.isAttachedToDOM||this.parent.add(this))):this.#fr&&this.#Ir()}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#br||this.#mr||this.#Cr||this.#yr)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#mr?this.#$n():this.#Ir(),this.width){const[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r)}return this.div}#$n(){const{div:e}=this;let{width:t,height:n}=this.#mr;const[r,a]=this.pageDimensions,i=.75;if(this.width)t=this.width*r,n=this.height*a;else if(t>i*r||n>i*a){const e=Math.min(i*r/t,i*a/n);t*=e,n*=e}const[s,o]=this.parentDimensions;this.setDims(t*s/r,n*o/a),this._uiManager.enableWaiting(!1);const l=this.#vr=document.createElement("canvas");e.append(l),e.hidden=!1,this.#kr(t,n),this.#Kn(),this.#wr||(this.parent.addUndoableEditor(this),this.#wr=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#Sr(e,t){const[n,r]=this.parentDimensions;this.width=e/n,this.height=t/r,this.setDims(e,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==this.#xr&&clearTimeout(this.#xr),this.#xr=setTimeout(()=>{this.#xr=null,this.#kr(e,t)},200)}#Tr(e,t){const{width:n,height:r}=this.#mr;let a=n,i=r,s=this.#mr;for(;a>2*e||i>2*t;){const n=a,r=i;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),i>2*t&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2));const o=new OffscreenCanvas(a,i);o.getContext("2d").drawImage(s,0,0,n,r,0,0,a,i),s=o.transferToImageBitmap()}return s}#kr(e,t){e=Math.ceil(e),t=Math.ceil(t);const n=this.#vr;if(!n||n.width===e&&n.height===t)return;n.width=e,n.height=t;const r=this.#Er?this.#mr:this.#Tr(e,t),a=n.getContext("2d");a.filter=this._uiManager.hcmFilter,a.drawImage(r,0,0,r.width,r.height,0,0,e,t)}#Rr(e){if(e){if(this.#Er){const e=this._uiManager.imageManager.getSvgUrl(this.#fr);if(e)return e}const e=document.createElement("canvas");return({width:e.width,height:e.height}=this.#mr),e.getContext("2d").drawImage(this.#mr,0,0),e.toDataURL()}if(this.#Er){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*i.PixelsPerInch.PDF_TO_CSS_UNITS),r=Math.round(this.height*t*i.PixelsPerInch.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(this.#mr,0,0,this.#mr.width,this.#mr.height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(this.#mr)}#Kn(){this.#zn=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.#Sr(t.width,t.height)}),this.#zn.observe(this.div)}static deserialize(e,t,n){if(e instanceof s.StampAnnotationElement)return null;const r=super.deserialize(e,t,n),{rect:a,bitmapUrl:i,bitmapId:o,isSvg:l,accessibilityData:c}=e;o&&n.imageManager.isValidId(o)?r.#fr=o:r.#Cr=i,r.#Er=l;const[d,h]=r.pageDimensions;return r.width=(a[2]-a[0])/d,r.height=(a[3]-a[1])/h,c&&(r.altTextData=c),r}serialize(e=!1,t=null){if(this.isEmpty())return null;const n={annotationType:r.AnnotationEditorType.STAMP,bitmapId:this.#fr,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#Er,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#Rr(!0),n.accessibilityData=this.altTextData,n;const{decorative:a,altText:i}=this.altTextData;if(!a&&i&&(n.accessibilityData={type:"Figure",alt:i}),null===t)return n;t.stamps||=new Map;const s=this.#Er?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(this.#fr)){if(this.#Er){const e=t.stamps.get(this.#fr);s>e.area&&(e.area=s,e.serialized.bitmap.close(),e.serialized.bitmap=this.#Rr(!1))}}else t.stamps.set(this.#fr,{area:s,serialized:n}),n.bitmap=this.#Rr(!1);return n}}t.StampEditor=o}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__w_pdfjs_require__),n.exports}var __nested_webpack_exports__={};return(()=>{var e=__nested_webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return s.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return r.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return l.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return n.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return n.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return n.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return c.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return n.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return n.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return r.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return a.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return a.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return n.version}});var t=__w_pdfjs_require__(1),n=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),a=__w_pdfjs_require__(26),i=__w_pdfjs_require__(27),s=__w_pdfjs_require__(5),o=__w_pdfjs_require__(29),l=__w_pdfjs_require__(14),c=__w_pdfjs_require__(32)})(),__nested_webpack_exports__})(),module.exports=root.pdfjsLib=factory()},85072:function(e){"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},s=[],o=0;o<e.length;o++){var l=e[o],c=r.base?l[0]+r.base:l[0],d=i[c]||0,h="".concat(c," ").concat(d);i[c]=d+1;var u=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var A=a(p,r);r.byIndex=o,t.splice(o,0,{identifier:h,updater:A,references:1})}s.push(h)}return s}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var i=r(e=e||[],a=a||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var o=n(i[s]);t[o].references--}for(var l=r(e,a),c=0;c<i.length;c++){var d=n(i[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}i=l}}},77659:function(e){"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},10540:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},55056:function(e,t,n){"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},97825:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},41113:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},41198:function(e){"use strict";e.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2710%27 height=%2710%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%238C8E91%27 stroke-width=%272%27%3E%3Cpolyline points=%276 9 12 15 18 9%27/%3E%3C/svg%3E"},80539:function(e,t,n){"use strict";e.exports=n.p+"assets/icon-80-v2.png"},17640:function(){},23237:function(){},97492:function(){},31815:function(){},66671:function(){},82787:function(){}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e}(),__webpack_require__.b="undefined"!=typeof document&&document.baseURI||self.location.href,__webpack_require__.nc=void 0;var __webpack_exports__={};!function(){"use strict";var e=__webpack_require__(85072),t=__webpack_require__.n(e),n=__webpack_require__(97825),r=__webpack_require__.n(n),a=__webpack_require__(77659),i=__webpack_require__.n(a),s=__webpack_require__(55056),o=__webpack_require__.n(s),l=__webpack_require__(10540),c=__webpack_require__.n(l),d=__webpack_require__(41113),h=__webpack_require__.n(d),u=__webpack_require__(93942),p={};function A(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,i){var l=r&&r.prototype instanceof o?r:o,c=Object.create(l.prototype);return g(c,"_invoke",function(n,r,a){var i,o,l,c=0,d=a||[],h=!1,u={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,o=0,l=e,u.n=n,s}};function p(n,r){for(o=n,l=r,t=0;!h&&c&&!a&&t<d.length;t++){var a,i=d[t],p=u.p,A=i[2];n>3?(a=A===r)&&(l=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=e):i[0]<=p&&((a=n<2&&p<i[1])?(o=0,u.v=r,u.n=i[1]):p<A&&(a=n<3||i[0]>r||r>A)&&(i[4]=n,i[5]=r,u.n=A,o=0))}if(a||n>1)return s;throw h=!0,r}return function(a,d,A){if(c>1)throw TypeError("Generator is already running");for(h&&1===d&&p(d,A),o=d,l=A;(t=o<2?e:l)||!h;){i||(o?o<3?(o>1&&(u.n=-1),p(o,l)):u.n=l:u.v=l);try{if(c=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=e}else if((t=(h=u.n<0)?l:n.call(r,u))!==s)break}catch(t){i=e,o=1,l=t}finally{c=1}}return{value:t,done:h}}}(n,a,i),!0),c}var s={};function o(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(g(t={},r,function(){return this}),t),h=c.prototype=o.prototype=Object.create(d);function u(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,g(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=c,g(h,"constructor",c),g(c,"constructor",l),l.displayName="GeneratorFunction",g(c,a,"GeneratorFunction"),g(h),g(h,a,"Generator"),g(h,r,function(){return this}),g(h,"toString",function(){return"[object Generator]"}),(A=function(){return{w:i,m:u}})()}function g(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}g=function(e,t,n,r){function i(t,n){g(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},g(e,t,n,r)}function m(e,t,n,r,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){m(i,r,a,s,o,"next",e)}function o(e){m(i,r,a,s,o,"throw",e)}s(void 0)})}}function b(){try{var e=localStorage.getItem("sheetcraft_llm_config");if(e)return JSON.parse(e)}catch(e){console.warn("Failed to load LLM config:",e)}return{provider:"groq",apiKey:"undefined"!=typeof process?"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":"",groqModel:"llama-3.3-70b-versatile",localModel:"llama3"}}function C(e){return new Promise(function(t){return setTimeout(t,e)})}function y(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("groq"===e.provider){if(t)return"meta-llama/llama-4-maverick-17b-128e-instruct";var n=e.groqModel||"llama-3.3-70b-versatile";return n.includes("llama-3.2")&&(n.includes("vision")||n.includes("preview"))||n.includes(":")?"llama-3.3-70b-versatile":n}return"gemini"===e.provider?e.geminiModel||"gemini-1.5-flash":"openai"===e.provider?e.openaiModel||"gpt-4o":e.localModel||e.model||"llama3"}function v(e,t,n){return x.apply(this,arguments)}function x(){return(x=f(A().m(function e(t,n,r){var a,i,s,o,l,c,d,h;return A().w(function(e){for(;;)switch(e.n){case 0:return i="https://generativelanguage.googleapis.com/v1beta/models/".concat(n,":generateContent?key=").concat(r),s=[],o="",t.forEach(function(e){if("system"===e.role){var t=Array.isArray(e.content)?e.content.map(function(e){return e.text||""}).join(""):e.content;o+=t+"\n\n"}else{var n=[];o&&"user"===e.role&&0===s.length&&(n.push({text:"SYSTEM INSTRUCTIONS:\n"+o}),o=""),"string"==typeof e.content?n.push({text:e.content}):e.content.forEach(function(e){if("text"===e.type&&n.push({text:e.text}),"image_url"===e.type&&e.image_url){var t=e.image_url.url.split(",")[1];t&&n.push({inline_data:{mime_type:"image/png",data:t}})}}),s.push({role:"assistant"===e.role?"model":"user",parts:n})}}),0===s.length&&o&&s.push({role:"user",parts:[{text:"SYSTEM INSTRUCTIONS:\n"+o}]}),e.n=1,fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:s,generationConfig:{temperature:.1}})});case 1:if((l=e.v).ok){e.n=3;break}return e.n=2,l.text();case 2:throw c=e.v,new Error("Gemini Error (".concat(l.status,"): ").concat(c));case 3:return e.n=4,l.json();case 4:if(d=e.v,h=null===(a=d.candidates)||void 0===a||null===(a=a[0])||void 0===a||null===(a=a.content)||void 0===a||null===(a=a.parts)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.text){e.n=5;break}throw new Error("Gemini returned empty response.");case 5:return e.a(2,h)}},e)}))).apply(this,arguments)}function E(e,t){return w.apply(this,arguments)}function w(){return(w=f(A().m(function e(t,n){var r,a,i,s,o,l,c,d,h,u,p,g,m,f,x,E,w,_,B;return A().w(function(e){for(;;)switch(e.n){case 0:if(r=n||b(),a=t.some(function(e){return Array.isArray(e.content)&&e.content.some(function(e){return"image_url"===e.type})}),i=y(r,a),"gemini"!==r.provider){e.n=2;break}if(r.geminiKey){e.n=1;break}throw new Error("Please enter your Google Gemini API Key in Settings.");case 1:return e.a(2,v(t,i,r.geminiKey));case 2:if("openai"!==r.provider){e.n=8;break}if(r.openaiKey){e.n=3;break}throw new Error("Please enter your OpenAI API Key in Settings.");case 3:return e.n=4,fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.openaiKey)},body:JSON.stringify({messages:t,model:i,temperature:.1,max_tokens:4096})});case 4:if((o=e.v).ok){e.n=6;break}return w=Error,_="OpenAI Error: ",e.n=5,o.text();case 5:throw B=_.concat.call(_,e.v),new w(B);case 6:return e.n=7,o.json();case 7:return l=e.v,e.a(2,(null===(s=l.choices)||void 0===s||null===(s=s[0])||void 0===s||null===(s=s.message)||void 0===s?void 0:s.content)||"");case 8:d={"Content-Type":"application/json"},"groq"===r.provider?(c="https://api.groq.com/openai/v1/chat/completions",r.apiKey&&(d.Authorization="Bearer ".concat(r.apiKey))):(c=r.baseUrl||"http://localhost:11434/v1/chat/completions",r.apiKey&&(d.Authorization="Bearer ".concat(r.apiKey))),h=JSON.stringify({messages:t,model:i,temperature:.1,max_tokens:4096}),u=0;case 9:if(!(u<=3)){e.n=20;break}return e.n=10,fetch(c,{method:"POST",headers:d,body:h});case 10:if(429!==(p=e.v).status){e.n=13;break}if(!(u<3)){e.n=12;break}return g=p.headers.get("retry-after"),m=g?1e3*parseInt(g,10):2e3*Math.pow(2,u),console.warn("Rate limited. Waiting ".concat(m,"ms (retry ").concat(u+1,"/").concat(3,")...")),e.n=11,C(m);case 11:return e.a(3,19);case 12:throw new Error("Rate limited. Please wait a moment and try again.");case 13:if(404!==p.status){e.n=14;break}throw new Error('Model "'.concat(i,'" not found. Go to Settings ⚙️ and select a valid model.'));case 14:if(p.ok){e.n=17;break}return e.n=15,p.text();case 15:if(!((f=e.v).includes("out of memory")||f.includes("cudaMalloc")||f.includes("unable to allocate"))){e.n=16;break}throw new Error("Local AI ran out of memory (RAM/VRAM). Try selecting a smaller model (e.g. 7b/8b), closing other apps, or switching to Groq (Cloud).");case 16:throw new Error("AI Error (".concat(p.status,"): ").concat(f.substring(0,120)));case 17:return e.n=18,p.json();case 18:return x=e.v,E=(E=(E=(E=(E=x.choices[0].message.content.trim()).replace(/^```(?:javascript|js|typescript|ts)?\n?/i,"")).replace(/\n?```$/i,"")).trim()).replace(/(?:const|let|var)\s+sheet\s*=\s*.*?;/g,"// sheet redeclaration removed"),e.a(2,E);case 19:u++,e.n=9;break;case 20:throw new Error("Failed after maximum retries.");case 21:return e.a(2)}},e)}))).apply(this,arguments)}function _(e){return B.apply(this,arguments)}function B(){return(B=f(A().m(function e(t){var n,r,a,i;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t||"http://localhost:11434",e.p=1,e.n=2,fetch("".concat(n,"/api/tags"),{method:"GET"});case 2:if((r=e.v).ok){e.n=3;break}throw new Error("Ollama returned ".concat(r.status));case 3:return e.n=4,r.json();case 4:return a=e.v,e.a(2,(a.models||[]).map(function(e){return{name:e.name,size:e.size||0,modified_at:e.modified_at||""}}));case 5:return e.p=5,i=e.v,console.warn("Could not fetch Ollama models:",i),e.a(2,[])}},e,null,[[1,5]])}))).apply(this,arguments)}p.styleTagTransform=h(),p.setAttributes=o(),p.insert=i().bind(null,"head"),p.domAPI=r(),p.insertStyleElement=c(),t()(u.A,p),u.A&&u.A.locals&&u.A.locals;var I='You are SheetOS AI, an Excel JavaScript API expert. Generate ONLY executable JS code.\n\n═══════════════════════════════════════════════════════════════════════════════\nENVIRONMENT (Already available — DO NOT redeclare these):\n═══════════════════════════════════════════════════════════════════════════════\n- context: Excel.RequestContext (ready to use)\n- sheet: Active worksheet (already loaded)\n- Excel: Namespace for enums (Excel.ChartType, Excel.BorderLineStyle, etc.)\n\n═══════════════════════════════════════════════════════════════════════════════\nCRITICAL RULES (MUST FOLLOW):\n═══════════════════════════════════════════════════════════════════════════════\n1. OUTPUT: Raw executable JavaScript ONLY. No markdown, no explanations.\n2. NO REDECLARATIONS: Never write "const context = ..." or "const sheet = ..."\n3. LOAD BEFORE READ: Properties like .values, .rowCount require .load() + await context.sync()\n4. 2D ARRAYS: range.values and range.formulas MUST be 2D arrays: [[value]]\n5. SYNC OFTEN: Call await context.sync() after every .load() before accessing properties\n6. SAFETY: Always check if range/data exists before operating on it\n\n═══════════════════════════════════════════════════════════════════════════════\nBANNED PATTERNS (WILL CRASH — NEVER USE):\n═══════════════════════════════════════════════════════════════════════════════\n❌ .getValues()         → Use: range.load("values"); await context.sync(); range.values\n❌ .getRowCount()       → Use: range.load("rowCount"); await context.sync(); range.rowCount\n❌ .getColumnCount()    → Use: range.load("columnCount"); await context.sync(); range.columnCount\n❌ .getAddress()        → Use: range.load("address"); await context.sync(); range.address\n❌ .getText()           → Use: range.load("text"); await context.sync(); range.text\n❌ .setValues(x)        → Use: range.values = [[x]]\n❌ .setFormula(x)       → Use: range.formulas = [["=SUM(A:A)"]]\n❌ .setValue(x)         → Use: range.values = [[x]]\n❌ range.font.bold      → Use: range.format.font.bold\n❌ range.alignment      → Use: range.format.horizontalAlignment\n❌ chart.setTitle(x)    → Use: chart.title.text = x\n❌ chart.add()          → Use: sheet.charts.add()\n❌ range.getItem()      → Use: range.getCell(row, col)\n❌ range.select()       → REMOVE (causes performance issues)\n❌ range.activate()     → REMOVE (not needed)\n❌ SpreadsheetApp       → WRONG PLATFORM (this is Google Apps Script)\n❌ Logger.log()         → REMOVE or use console.log\n❌ Browser.msgBox()     → REMOVE (not available)\n❌ alert() / confirm()  → REMOVE (blocked in add-ins)\n❌ message.alert()      → REMOVE (doesn\'t exist)\n❌ getRange("A0")       → Row 0 doesn\'t exist. Use A1 or higher.\n❌ const context = ...  → ALREADY DECLARED\n❌ const sheet = ...    → ALREADY DECLARED\n\n═══════════════════════════════════════════════════════════════════════════════\nCORRECT PATTERNS (COPY THESE):\n═══════════════════════════════════════════════════════════════════════════════\n\n// ─── Read Data from Sheet ───\nconst usedRange = sheet.getUsedRange();\nusedRange.load("values,rowCount,columnCount");\nawait context.sync();\nconst data = usedRange.values; // Now accessible\nconst rows = usedRange.rowCount;\nconst cols = usedRange.columnCount;\n\n// ─── Write Data (Single Cell) ───\nsheet.getRange("A1").values = [["Hello World"]];\n\n// ─── Write Data (Multiple Cells) ───\nsheet.getRange("A1:C2").values = [\n  ["Name", "Age", "City"],\n  ["John", 25, "NYC"]\n];\n\n// ─── Formulas ───\nsheet.getRange("D2").formulas = [["=SUM(B2:C2)"]];\n// Multiple formulas:\nsheet.getRange("D2:D5").formulas = [\n  ["=SUM(B2:C2)"],\n  ["=SUM(B3:C3)"],\n  ["=SUM(B4:C4)"],\n  ["=SUM(B5:C5)"]\n];\n\n// ─── Formatting ───\nconst r = sheet.getRange("A1:D1");\nr.format.font.bold = true;\nr.format.font.color = "#FFFFFF";\nr.format.fill.color = "#4472C4";\nr.format.horizontalAlignment = "Center";\nr.format.verticalAlignment = "Center";\nr.format.rowHeight = 28;\n\n// ─── Borders ───\nconst range = sheet.getRange("A1:D10");\nrange.format.borders.getItem("InsideHorizontal").style = "Thin";\nrange.format.borders.getItem("InsideVertical").style = "Thin";\nrange.format.borders.getItem("EdgeTop").style = "Thin";\nrange.format.borders.getItem("EdgeBottom").style = "Thin";\nrange.format.borders.getItem("EdgeLeft").style = "Thin";\nrange.format.borders.getItem("EdgeRight").style = "Thin";\n\n// ─── Charts ───\nconst chartRange = sheet.getRange("A1:B5");\nconst chart = sheet.charts.add(Excel.ChartType.columnClustered, chartRange, Excel.ChartSeriesBy.auto);\nchart.title.text = "Sales Report";\nchart.setPosition("E2", "L15");\n\n// ─── Tables ───\nconst tableRange = sheet.getRange("A1:D10");\nconst table = sheet.tables.add(tableRange, true);\ntable.name = "SalesTable";\ntable.style = "TableStyleMedium9";\n\n// ─── Conditional Formatting ───\nconst cfRange = sheet.getRange("C2:C100");\nconst cf = cfRange.conditionalFormats.add(Excel.ConditionalFormatType.cellValue);\ncf.cellValue.format.fill.color = "#92D050";\ncf.cellValue.rule = { formula1: "=50", operator: "GreaterThan" };\n\n// ─── Data Validation (Dropdown) ───\nsheet.getRange("E2:E100").dataValidation.rule = {\n  list: { inCellDropDown: true, source: "Yes,No,Maybe" }\n};\n\n// ─── Sort ───\nsheet.getUsedRange().sort.apply([{ key: 0, ascending: true }]);\n\n// ─── Filter ───\nconst filterRange = sheet.getUsedRange();\nfilterRange.autoFilter.apply(filterRange, 0);\n\n// ─── Freeze Panes ───\nsheet.freezePanes.freezeRows(1);\n\n// ─── Number Format ───\nsheet.getRange("B2:B100").numberFormat = [["$#,##0.00"]];\nsheet.getRange("C2:C100").numberFormat = [["0.0%"]];\n\n// ─── Clear Contents ───\nsheet.getUsedRange().clear(Excel.ClearApplyTo.contents);\n\n// ─── New Worksheet ───\nconst newSheet = context.workbook.worksheets.add("Report");\nnewSheet.activate();\n\n// ─── Autofit Columns (ALWAYS DO THIS AT END) ───\nsheet.getUsedRange().format.autofitColumns();\n\n═══════════════════════════════════════════════════════════════════════════════\nMANDATORY writeData HELPER (Include this for any data writing):\n═══════════════════════════════════════════════════════════════════════════════\nfunction writeData(sheet, startCell, data) {\n  if (!data || data.length === 0) return null;\n  const rows = data.length;\n  const cols = Math.max(...data.map(r => r ? r.length : 0));\n  if (cols === 0) return null;\n  const normalized = data.map(r => {\n    const row = r ? [...r] : [];\n    while (row.length < cols) row.push("");\n    return row;\n  });\n  const range = sheet.getRange(startCell).getResizedRange(rows - 1, cols - 1);\n  range.values = normalized;\n  range.format.autofitColumns();\n  return range;\n}\n\n═══════════════════════════════════════════════════════════════════════════════\nANTI-HALLUCINATION RULES (For Document/PDF Extraction):\n═══════════════════════════════════════════════════════════════════════════════\n1. EXTRACT ONLY WHAT YOU SEE: Never invent data that isn\'t in the image/PDF\n2. EMPTY IF MISSING: If a field (phone, email, etc.) isn\'t visible, use "" not "N/A"\n3. NO GUESSING: Don\'t make up names, numbers, or dates\n4. PRESERVE EXACT TEXT: Copy text exactly as shown (don\'t "fix" typos unless asked)\n5. ONE ROW PER DOCUMENT: Each PDF/resume = exactly one data row\n6. MATCH SCHEMA: If column headers exist, ONLY extract data for those columns\n\n═══════════════════════════════════════════════════════════════════════════════\nDESIGN BEST PRACTICES:\n═══════════════════════════════════════════════════════════════════════════════\n1. HEADERS: Bold, dark background (#1B4D3E or #2D6A4F), white text\n2. NUMBERS: Currency "$#,##0.00", Percentage "0.0%", Integer "#,##0"\n3. DATES: Format as "Short Date" or "YYYY-MM-DD" string\n4. COLORS: Professional muted tones — no neon, no pure red/blue\n5. ZEBRA STRIPES: White and light gray (#F5F5F5) alternating rows\n6. ROW HEIGHT: Headers 28px, Data 20px\n7. ALWAYS: End with sheet.getUsedRange().format.autofitColumns()\n\n═══════════════════════════════════════════════════════════════════════════════\nSCHEMA-AWARE EXTRACTION (When EXISTING_COLUMNS provided):\n═══════════════════════════════════════════════════════════════════════════════\nWhen given "EXISTING_COLUMNS: [...]":\n1. Extract ONLY data matching those columns\n2. Use intelligent matching: "Phone" = "Mobile No" = "Contact Number"\n3. Leave cells empty ("") if data not found — NEVER write "Not Found"\n4. Append to first empty row after existing data\n\nUser Prompt:\n',k="sheetcraft_cache",S="sheetcraft_cache_ver";function T(){try{var e=localStorage.getItem(k);return e?JSON.parse(e):[]}catch(e){return[]}}function R(e){!function(){try{localStorage.getItem(S)!==String(2)&&(localStorage.removeItem(k),localStorage.setItem(S,String(2)))}catch(e){}}();var t=T(),n=e.trim().toLowerCase(),r=t.find(function(e){return e.prompt===n});return r?Date.now()-r.timestamp>36e5?null:r.response:null}function M(e,t){var n=T(),r=e.trim().toLowerCase(),a=n.filter(function(e){return e.prompt!==r});a.push({prompt:r,response:t,timestamp:Date.now()}),function(e){var t=e.slice(-50);localStorage.setItem(k,JSON.stringify(t))}(a)}var P={Name:["Full Name","Candidate Name","Applicant Name","First Name","First","Naam"],Email:["E-mail","Email Address","E-Mail","Mail","Contact Email"],Phone:["Mobile","Mobile No","Mobile Number","Contact","Contact No","Phone Number","Tel","Telephone"],Age:["Years","DOB","Date of Birth","Birth Date"],Address:["Location","City","Current Location","Residence"],Skills:["Technical Skills","Key Skills","Skillset","Expertise","Technologies"],Experience:["Work Experience","Total Experience","Years of Experience","Professional Experience"],Education:["Qualification","Degree","Academic","Educational Qualification"],LinkedIn:["LinkedIn URL","LinkedIn Profile","Profile URL"],Company:["Current Company","Organization","Employer","Current Employer"],Position:["Role","Job Title","Designation","Current Role","Title"],Summary:["Profile Summary","About","Objective","Career Objective"]};function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function D(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(F(e)+" is not iterable")}function O(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,i){var l=r&&r.prototype instanceof o?r:o,c=Object.create(l.prototype);return L(c,"_invoke",function(n,r,a){var i,o,l,c=0,d=a||[],h=!1,u={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,o=0,l=e,u.n=n,s}};function p(n,r){for(o=n,l=r,t=0;!h&&c&&!a&&t<d.length;t++){var a,i=d[t],p=u.p,A=i[2];n>3?(a=A===r)&&(l=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=e):i[0]<=p&&((a=n<2&&p<i[1])?(o=0,u.v=r,u.n=i[1]):p<A&&(a=n<3||i[0]>r||r>A)&&(i[4]=n,i[5]=r,u.n=A,o=0))}if(a||n>1)return s;throw h=!0,r}return function(a,d,A){if(c>1)throw TypeError("Generator is already running");for(h&&1===d&&p(d,A),o=d,l=A;(t=o<2?e:l)||!h;){i||(o?o<3?(o>1&&(u.n=-1),p(o,l)):u.n=l:u.v=l);try{if(c=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=e}else if((t=(h=u.n<0)?l:n.call(r,u))!==s)break}catch(t){i=e,o=1,l=t}finally{c=1}}return{value:t,done:h}}}(n,a,i),!0),c}var s={};function o(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(L(t={},r,function(){return this}),t),h=c.prototype=o.prototype=Object.create(d);function u(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,L(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=c,L(h,"constructor",c),L(c,"constructor",l),l.displayName="GeneratorFunction",L(c,a,"GeneratorFunction"),L(h),L(h,a,"Generator"),L(h,r,function(){return this}),L(h,"toString",function(){return"[object Generator]"}),(O=function(){return{w:i,m:u}})()}function L(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}L=function(e,t,n,r){function i(t,n){L(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},L(e,t,n,r)}function N(e,t,n,r,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,a)}function U(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){N(i,r,a,s,o,"next",e)}function o(e){N(i,r,a,s,o,"throw",e)}s(void 0)})}}function j(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return z(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var q=[{pattern:/\.getColumnCount\s*\(\s*\)/g,message:"getColumnCount() doesn't exist",fix:"load('columnCount') then use .columnCount property"},{pattern:/\.getRowCount\s*\(\s*\)/g,message:"getRowCount() doesn't exist",fix:"load('rowCount') then use .rowCount property"},{pattern:/\.getAddress\s*\(\s*\)/g,message:"getAddress() doesn't exist",fix:"load('address') then use .address property"},{pattern:/\.getValues\s*\(\s*\)/g,message:"getValues() doesn't exist",fix:"load('values') then use .values property"},{pattern:/\.getText\s*\(\s*\)/g,message:"getText() doesn't exist",fix:"load('text') then use .text property"},{pattern:/\.setValues\s*\(/g,message:"setValues() doesn't exist",fix:"Use range.values = [[...]] assignment"},{pattern:/\.setFormula\s*\(/g,message:"setFormula() doesn't exist",fix:"Use range.formulas = [[...]] assignment"},{pattern:/\.setValue\s*\(/g,message:"setValue() doesn't exist",fix:"Use range.values = [[value]] assignment"},{pattern:/SpreadsheetApp/g,message:"SpreadsheetApp is Google Apps Script, not Excel",fix:"Use Excel JavaScript API (sheet, context, Excel namespace)"},{pattern:/Logger\.log/g,message:"Logger.log is Google Apps Script",fix:"Use console.log or remove logging"},{pattern:/Browser\.msgBox/g,message:"Browser.msgBox is Google Apps Script",fix:"Remove - UI dialogs not supported in Excel Add-ins"},{pattern:/Utilities\./g,message:"Utilities is Google Apps Script",fix:"Use native JavaScript methods"},{pattern:/chart\.setTitle\s*\(/g,message:"chart.setTitle() doesn't exist",fix:"Use chart.title.text = '...'"},{pattern:/chart\.add\s*\(/g,message:"chart.add() doesn't exist",fix:"Use sheet.charts.add()"},{pattern:/range\.getItem\s*\(/g,message:"range.getItem() doesn't exist",fix:"Use range.getCell(row, col)"},{pattern:/range\.select\s*\(\s*\)/g,message:"range.select() causes performance issues",fix:"Remove - selection not needed for automation"},{pattern:/range\.activate\s*\(\s*\)/g,message:"range.activate() causes performance issues",fix:"Remove - activation not needed for automation"},{pattern:/range\.font\.bold/g,message:"range.font.bold path is wrong",fix:"Use range.format.font.bold"},{pattern:/range\.alignment/g,message:"range.alignment doesn't exist",fix:"Use range.format.horizontalAlignment or range.format.verticalAlignment"},{pattern:/range\.format\.alignment/g,message:"range.format.alignment object doesn't exist",fix:"Use range.format.horizontalAlignment directly"},{pattern:/range\.horizontal/g,message:"range.horizontal doesn't exist",fix:"Use range.format.horizontalAlignment"},{pattern:/message\.alert\s*\(/g,message:"message.alert() doesn't exist in add-ins",fix:"Remove - use status messages in add-in UI instead"},{pattern:/alert\s*\(/g,message:"alert() doesn't work in add-ins",fix:"Remove - JavaScript alert blocked in Office Add-ins"},{pattern:/confirm\s*\(/g,message:"confirm() doesn't work in add-ins",fix:"Remove - JavaScript confirm blocked in Office Add-ins"},{pattern:/prompt\s*\(/g,message:"prompt() doesn't work in add-ins",fix:"Remove - JavaScript prompt blocked in Office Add-ins"},{pattern:/(?:const|let|var)\s+context\s*=/g,message:"context is already declared",fix:"Remove declaration - context is provided"},{pattern:/(?:const|let|var)\s+sheet\s*=\s*context\.workbook/g,message:"sheet is already declared",fix:"Remove declaration - sheet is provided"},{pattern:/getRange\s*\(\s*["']?[A-Z]0["']?\s*\)/gi,message:"Row 0 doesn't exist in Excel",fix:"Use row 1 or higher (e.g., A1, B1)"},{pattern:/getCell\s*\(\s*-?\d+\s*,\s*-?\d+\s*\)/g,message:"Negative cell indices are invalid",fix:"Use 0 or positive indices"},{pattern:/\.getRow\s*\(\s*\d+\s*\)\.format\.[^f]/g,message:"Using getRow without checking range first",fix:"Always load rowCount first and check if range has data"},{pattern:/usedRange\.getRow\s*\(\s*(\d+)\s*\)[^;]*(?!.*rowCount)/g,message:"Using getRow without verifying rowCount",fix:"Load rowCount and check if sheet has data before using getRow"}],H=[/context\.workbook/,/context\.sync\(\)/,/sheet\./,/Excel\./,/\.getRange\(/,/\.getUsedRange\(/,/\.getCell\(/,/\.getRow\(/,/\.getColumn\(/,/\.getResizedRange\(/,/\.getOffsetRange\(/,/\.getEntireRow\(/,/\.getEntireColumn\(/,/\.getLastCell\(/,/\.getLastRow\(/,/\.getLastColumn\(/,/\.getBoundingRect\(/,/\.getIntersection\(/,/\.load\(/,/\.values\s*=/,/\.formulas\s*=/,/\.numberFormat\s*=/,/\.format\./,/\.autofitColumns\(/,/\.autofitRows\(/,/\.tables\./,/\.charts\./,/\.sort\./,/\.autoFilter\./,/\.dataValidation\./,/\.conditionalFormats\./,/\.worksheets\./,/\.freezePanes\./,/\.clear\(/,/\.delete\(/,/\.insert\(/,/\.borders\./];function W(e){var t=[],n=[],r=[],a=e;a=(a=(a=a.replace(/^```(?:javascript|js|typescript|ts)?\n?/gi,"")).replace(/\n?```$/gi,"")).trim();var i,s=j(q);try{for(s.s();!(i=s.n()).done;){var o=i.value;a.match(o.pattern)&&(t.push({type:"banned_api",message:o.message,suggestion:o.fix}),o.pattern.source.includes("redeclare")&&(a=a.replace(o.pattern,"// [REMOVED] ")))}}catch(e){s.e(e)}finally{s.f()}var l=(a.match(/\.load\s*\(/g)||[]).length,c=(a.match(/context\.sync\s*\(\s*\)/g)||[]).length;l>0&&0===c&&t.push({type:"missing_sync",message:"Code loads properties but never calls context.sync()",suggestion:"Add 'await context.sync();' after .load() calls before accessing loaded properties"}),l>2*c&&n.push("Multiple .load() calls - consider batching with a single context.sync() for performance");try{new Function("context","sheet","Excel","return (async () => { ".concat(a," })();"))}catch(e){t.push({type:"syntax",message:e.message,suggestion:"Check for missing brackets, semicolons, or typos"})}var d,h=j(H);try{for(h.s();!(d=h.n()).done;){var u=d.value,p=a.match(u);p&&r.push(p[0])}}catch(e){h.e(e)}finally{h.f()}if(/eval\s*\(/i.test(a)&&t.push({type:"unsafe_pattern",message:"eval() is not allowed for security reasons",suggestion:"Remove eval() call"}),/Function\s*\(/i.test(a)&&!/new\s+Function/.test(a)&&n.push("Direct Function constructor usage detected - ensure it's intentional"),/formulas\s*=\s*[^[]/i.test(a)&&t.push({type:"type_error",message:"formulas must be a 2D array",suggestion:'Use range.formulas = [["=SUM(A1:A10)"]] (2D array)'}),/values\s*=\s*[^[]/i.test(a)&&!/values\s*=\s*\[\[/i.test(a)){var A=a.match(/values\s*=\s*("[^"]*"|'[^']*'|\d+)/);A&&t.push({type:"type_error",message:"values must be a 2D array",suggestion:"Use range.values = [[".concat(A[1],"]] (2D array)")})}return a=a.replace(/(?:const|let|var)\s+sheet\s*=\s*context\.workbook\.worksheets\.getActiveWorksheet\(\)\s*;?/g,"// sheet already available"),{isValid:0===t.length,errors:t,warnings:n,sanitizedCode:a,apiCallsDetected:r}}function Y(){return G.apply(this,arguments)}function G(){return G=U(O().m(function e(){var t;return O().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=U(O().m(function e(t){var n,r,a,i,s,o,l;return O().w(function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets.getActiveWorksheet()).load("name"),(r=n.getUsedRange()).load("values,rowCount,columnCount"),e.n=1,t.sync();case 1:if(0!==r.rowCount&&0!==r.columnCount){e.n=2;break}return e.a(2,{sheetName:n.name,rowCount:0,columnCount:0,headers:[],sampleData:[],dataTypes:[],hasData:!1});case 2:if(a=r.values,i=a[0].map(function(e){return String(e||"").trim()}),s=[],!(a.length>1)){e.n=5;break}o=O().m(function e(t){var n;return O().w(function(e){for(;;)switch(e.n){case 0:0===(n=a.slice(1).map(function(e){return e[t]}).filter(function(e){return null!=e&&""!==e})).length?s.push("empty"):n.every(function(e){return!isNaN(Number(e))})?s.push("number"):n.every(function(e){return/^\d{1,4}[-\/]\d{1,2}[-\/]\d{1,4}/.test(String(e))})?s.push("date"):s.push("text");case 1:return e.a(2)}},e)}),l=0;case 3:if(!(l<r.columnCount)){e.n=5;break}return e.d(D(o(l)),4);case 4:l++,e.n=3;break;case 5:return e.a(2,{sheetName:n.name,rowCount:r.rowCount,columnCount:r.columnCount,headers:i,sampleData:a.slice(0,10),dataTypes:s,hasData:!0})}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,console.error("Failed to read sheet context:",t),e.a(2,null)}},e,null,[[0,2]])})),G.apply(this,arguments)}var V=__webpack_require__(80748),X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;return'<svg width="'.concat(t,'" height="').concat(t,'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">').concat(e,"</svg>")},$={chart:X('<rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/>'),barChart:X('<line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/>'),table:X('<path d="M12 3v18"/><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M3 15h18"/>'),paintbrush:X('<path d="M18.37 2.63a2.12 2.12 0 0 1 3 3L14 13l-4 1 1-4Z"/><path d="M9 14.5A3.5 3.5 0 0 0 5.5 18H3v2h7a3 3 0 0 0 0-6"/>'),formula:X('<path d="M6 2v20"/><path d="M6 6h12l-6 6 6 6H6"/>'),sortAsc:X('<path d="M11 5h10"/><path d="M11 9h7"/><path d="M11 13h4"/><path d="M3 17l3 3 3-3"/><path d="M6 18V4"/>'),filter:X('<polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>'),checkSquare:X('<polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>'),trendUp:X('<polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/>'),eraser:X('<path d="M20 20H7L3 16l9-9 9 9-4 4"/><path d="M6.5 13.5l5-5"/>'),copy:X('<rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>'),columns:X('<rect x="3" y="3" width="18" height="18" rx="2"/><path d="M12 3v18"/>'),lock:X('<rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>'),hash:X('<line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/>'),search:X('<circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>'),snowflake:X('<line x1="2" y1="12" x2="22" y2="12"/><line x1="12" y1="2" x2="12" y2="22"/><line x1="20" y1="16" x2="4" y2="8"/><line x1="20" y1="8" x2="4" y2="16"/>'),check:X('<path d="M20 6L9 17l-5-5"/>',16),alertCircle:X('<circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>',16),arrowRight:X('<line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/>',16),settings:X('<circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c.26.6.77 1.05 1.39 1.16V10H21a2 2 0 0 1 0 4h-.09c-.62.11-1.13.56-1.39 1.16z"/>',18),helpCircle:X('<circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/>',18),refresh:X('<polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>',14),chevronDown:X('<polyline points="6 9 12 15 18 9"/>',14),fileText:X('<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M12 12v6"/><path d="M9 15h6"/>',20),messageCircle:X('<path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>',16),zap:X('<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>',16),send:X('<line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>',14),broom:X('<path d="M5 21h14"/><path d="M12 21V3"/><path d="M7 8l5-5 5 5"/><path d="M7 12l5 2 5-2"/>',14),pieChart:X('<path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/>',14),palette:X('<circle cx="13.5" cy="6.5" r="0.5" fill="currentColor"/><circle cx="17.5" cy="10.5" r="0.5" fill="currentColor"/><circle cx="8.5" cy="7.5" r="0.5" fill="currentColor"/><circle cx="6.5" cy="12" r="0.5" fill="currentColor"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/>',14),fileTemplate:X('<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="12" y2="17"/>',14),play:X('<polygon points="5 3 19 12 5 21 5 3"/>',14),trash:X('<polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>',14),sparkles:X('<path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/>',14),user:X('<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>',14),bot:X('<rect x="3" y="11" width="18" height="10" rx="2"/><circle cx="12" cy="5" r="2"/><path d="M12 7v4"/><line x1="8" y1="16" x2="8" y2="16"/><line x1="16" y1="16" x2="16" y2="16"/>',14),upload:X('<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/>',14),users:X('<path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>',14),filePlus:X('<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/>',14),calendar:X('<rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>',14),database:X('<ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>',14),clipboardList:X('<rect x="8" y="2" width="8" height="4" rx="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/>',14)};function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(e){return function(e){if(Array.isArray(e))return re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ne(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(K(e)+" is not iterable")}function Z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,i){var l=r&&r.prototype instanceof o?r:o,c=Object.create(l.prototype);return ee(c,"_invoke",function(n,r,a){var i,o,l,c=0,d=a||[],h=!1,u={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,o=0,l=e,u.n=n,s}};function p(n,r){for(o=n,l=r,t=0;!h&&c&&!a&&t<d.length;t++){var a,i=d[t],p=u.p,A=i[2];n>3?(a=A===r)&&(l=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=e):i[0]<=p&&((a=n<2&&p<i[1])?(o=0,u.v=r,u.n=i[1]):p<A&&(a=n<3||i[0]>r||r>A)&&(i[4]=n,i[5]=r,u.n=A,o=0))}if(a||n>1)return s;throw h=!0,r}return function(a,d,A){if(c>1)throw TypeError("Generator is already running");for(h&&1===d&&p(d,A),o=d,l=A;(t=o<2?e:l)||!h;){i||(o?o<3?(o>1&&(u.n=-1),p(o,l)):u.n=l:u.v=l);try{if(c=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=e}else if((t=(h=u.n<0)?l:n.call(r,u))!==s)break}catch(t){i=e,o=1,l=t}finally{c=1}}return{value:t,done:h}}}(n,a,i),!0),c}var s={};function o(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(ee(t={},r,function(){return this}),t),h=c.prototype=o.prototype=Object.create(d);function u(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ee(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=c,ee(h,"constructor",c),ee(c,"constructor",l),l.displayName="GeneratorFunction",ee(c,a,"GeneratorFunction"),ee(h),ee(h,a,"Generator"),ee(h,r,function(){return this}),ee(h,"toString",function(){return"[object Generator]"}),(Z=function(){return{w:i,m:u}})()}function ee(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}ee=function(e,t,n,r){function i(t,n){ee(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},ee(e,t,n,r)}function te(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ne(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}function ne(e,t){if(e){if("string"==typeof e)return re(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(e,t):void 0}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach(function(t){se(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function se(e,t,n){return(t=function(e){var t=function(e){if("object"!=K(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t,n,r,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,a)}function le(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){oe(i,r,a,s,o,"next",e)}function o(e){oe(i,r,a,s,o,"throw",e)}s(void 0)})}}try{V.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(V.version,"/pdf.worker.min.js")}catch(e){console.warn("PDF Worker setup failed:",e)}var ce="planning",de="cleanup",he=[],ue=[],pe=!1,Ae=[],ge={cleanup:[{icon:"eraser",label:"Smart Clean 🧹",prompt:"Analyze the used range. Perform 'Smart Cleaning': (1) Trim all whitespace. (2) Convert text-numbers to real numbers. (3) Standardize dates to Short Date format. (4) Remove completely empty rows. (5) Remove duplicate rows. (6) Convert text columns to Proper Case. Write a summary of changes in a new cell comment."},{icon:"eraser",label:"Remove Duplicates",prompt:"Find and remove duplicate rows from the data, keeping the first occurrence of each."},{icon:"eraser",label:"Trim Spaces",prompt:"Trim all leading and trailing whitespace from every cell in the used range."},{icon:"eraser",label:"Fix Empty Rows",prompt:"Find and delete all completely empty rows within the used data range."},{icon:"search",label:"Find Blanks",prompt:"Highlight all blank cells in the used range with a light yellow background color (#FFF3CD)."},{icon:"hash",label:"Fix Number Format",prompt:"Detect columns with numbers stored as text and convert them back to proper numbers."},{icon:"eraser",label:"Standardize Case",prompt:"Convert all text in column A to proper case (first letter capitalized, rest lowercase)."},{icon:"eraser",label:"Clear Formatting",prompt:"Clear all formatting from the used range while keeping data, then auto-fit all columns."},{icon:"copy",label:"Split Column",prompt:"Split the data in column A by comma delimiter into separate columns B, C, D."}],formulas:[{icon:"formula",label:"Formula Doctor 🚑",prompt:"Analyze the active cell/formula. (1) Explain the logic in a cell note. (2) If there is an error (#VALUE, #REF), FIX it and explain the fix. (3) If it's a value, suggest a formula. Expertly debug."},{icon:"formula",label:"Auto SUM",prompt:"Add a SUM formula at the bottom of each numeric column with a bold TOTAL label in column A."},{icon:"formula",label:"AVERAGE Row",prompt:"Add an AVERAGE formula at the bottom of each numeric column with a bold AVERAGE label."},{icon:"formula",label:"COUNT & COUNTA",prompt:"Add COUNT and COUNTA formulas at the bottom to count numeric and non-empty cells in each column."},{icon:"formula",label:"VLOOKUP Setup",prompt:"Analyze the data and set up a VLOOKUP section: create a lookup area to the right of the data where user can type a search value in one cell, and VLOOKUP automatically returns matching data from the table. Add labels and formatting to make it clear how to use it."},{icon:"formula",label:"SUMIF by Category",prompt:"Detect the category column (text) and numeric columns in the data. Create a summary section below the data that uses SUMIF to total each unique category. Add labels, formatting, and a bold grand total row."},{icon:"formula",label:"IF Conditional",prompt:"Add a new Status column at the end of the data. Use an IF formula to classify each row: if the last numeric column value is above the average, mark it 'Above Average', otherwise 'Below Average'. Format green for above, red for below."},{icon:"trendUp",label:"Running Total",prompt:"Add a 'Running Total' column at the end of the data that calculates a cumulative sum of the main numeric column, row by row. Format it with a subtle blue background and number format with commas."},{icon:"sortAsc",label:"Rank Values",prompt:"Add a 'Rank' column at the end of the data that ranks each row by the primary numeric column (largest = rank 1). Highlight the top 3 with gold/green backgrounds. Auto-fit all columns."}],format:[{icon:"paintbrush",label:"Make Professional",prompt:'Apply professional formatting to the sheet. Use this EXACT safe pattern:\n\n// Step 1: Get used range and load properties\nconst usedRange = sheet.getUsedRange();\nusedRange.load("values,rowCount,columnCount,address");\nawait context.sync();\n\n// Step 2: Check if sheet has data\nif (!usedRange || usedRange.rowCount < 1 || usedRange.columnCount < 1) {\n  throw new Error("Sheet appears empty. Add some data first.");\n}\n\nconst rowCount = usedRange.rowCount;\nconst colCount = usedRange.columnCount;\n\n// Step 3: Format header row (row 1)\nconst headerRow = usedRange.getRow(0);\nheaderRow.format.font.bold = true;\nheaderRow.format.font.size = 11;\nheaderRow.format.font.color = "#FFFFFF";\nheaderRow.format.fill.color = "#1B2A4A";\nheaderRow.format.horizontalAlignment = "Center";\nheaderRow.format.verticalAlignment = "Center";\nheaderRow.format.rowHeight = 28;\n\n// Step 4: Format data rows with alternating colors\nfor (let i = 1; i < rowCount; i++) {\n  const row = usedRange.getRow(i);\n  row.format.fill.color = i % 2 === 0 ? "#F4F5F7" : "#FFFFFF";\n  row.format.rowHeight = 22;\n}\n\n// Step 5: Add borders to all cells\nusedRange.format.borders.getItem("InsideHorizontal").style = "Thin";\nusedRange.format.borders.getItem("InsideVertical").style = "Thin";\nusedRange.format.borders.getItem("EdgeTop").style = "Thin";\nusedRange.format.borders.getItem("EdgeBottom").style = "Thin";\nusedRange.format.borders.getItem("EdgeLeft").style = "Thin";\nusedRange.format.borders.getItem("EdgeRight").style = "Thin";\n\n// Step 6: Add medium bottom border under header\nheaderRow.format.borders.getItem("EdgeBottom").style = "Medium";\nheaderRow.format.borders.getItem("EdgeBottom").color = "#1B2A4A";\n\n// Step 7: Freeze first row\nsheet.freezePanes.freezeRows(1);\n\n// Step 8: Auto-fit columns\nusedRange.format.autofitColumns();\nawait context.sync();'},{icon:"paintbrush",label:"Executive Style",prompt:'Apply executive presentation style using this EXACT safe pattern:\n\nconst usedRange = sheet.getUsedRange();\nusedRange.load("values,rowCount,columnCount");\nawait context.sync();\n\nif (!usedRange || usedRange.rowCount < 1) {\n  throw new Error("Sheet appears empty.");\n}\n\nconst rowCount = usedRange.rowCount;\n\n// Header styling\nconst headerRow = usedRange.getRow(0);\nheaderRow.format.font.bold = true;\nheaderRow.format.font.size = 11;\nheaderRow.format.font.color = "#FFFFFF";\nheaderRow.format.fill.color = "#34495E";\nheaderRow.format.horizontalAlignment = "Center";\nheaderRow.format.rowHeight = 30;\n\n// Data rows with subtle alternating\nfor (let i = 1; i < rowCount; i++) {\n  const row = usedRange.getRow(i);\n  row.format.fill.color = i % 2 === 0 ? "#F8F9FA" : "#FFFFFF";\n  row.format.rowHeight = 22;\n}\n\n// Light gray borders\nusedRange.format.borders.getItem("InsideHorizontal").style = "Thin";\nusedRange.format.borders.getItem("InsideHorizontal").color = "#DEE2E6";\nusedRange.format.borders.getItem("InsideVertical").style = "Thin";\nusedRange.format.borders.getItem("InsideVertical").color = "#DEE2E6";\nusedRange.format.borders.getItem("EdgeTop").style = "Thin";\nusedRange.format.borders.getItem("EdgeBottom").style = "Thin";\nusedRange.format.borders.getItem("EdgeLeft").style = "Thin";\nusedRange.format.borders.getItem("EdgeRight").style = "Thin";\n\n// Freeze header\nsheet.freezePanes.freezeRows(1);\nusedRange.format.autofitColumns();\nawait context.sync();'},{icon:"paintbrush",label:"Minimal Clean",prompt:'Apply minimal modern formatting:\n\nconst usedRange = sheet.getUsedRange();\nusedRange.load("rowCount,columnCount");\nawait context.sync();\n\nif (!usedRange || usedRange.rowCount < 1) {\n  throw new Error("Sheet appears empty.");\n}\n\n// Clear existing formatting\nusedRange.format.fill.clear();\nusedRange.format.borders.getItem("InsideHorizontal").style = "None";\nusedRange.format.borders.getItem("InsideVertical").style = "None";\nusedRange.format.borders.getItem("EdgeTop").style = "None";\nusedRange.format.borders.getItem("EdgeBottom").style = "None";\nusedRange.format.borders.getItem("EdgeLeft").style = "None";\nusedRange.format.borders.getItem("EdgeRight").style = "None";\n\n// Header: bold, dark text, bottom border only\nconst headerRow = usedRange.getRow(0);\nheaderRow.format.font.bold = true;\nheaderRow.format.font.size = 11;\nheaderRow.format.font.color = "#111827";\nheaderRow.format.borders.getItem("EdgeBottom").style = "Thin";\nheaderRow.format.borders.getItem("EdgeBottom").color = "#D1D5DB";\nheaderRow.format.rowHeight = 28;\n\n// Data rows: smaller font, gray text\nfor (let i = 1; i < usedRange.rowCount; i++) {\n  const row = usedRange.getRow(i);\n  row.format.font.size = 10;\n  row.format.font.color = "#374151";\n  row.format.rowHeight = 22;\n}\n\nusedRange.format.autofitColumns();\nawait context.sync();'},{icon:"paintbrush",label:"Dark Theme",prompt:'Apply dark theme formatting:\n\nconst usedRange = sheet.getUsedRange();\nusedRange.load("rowCount,columnCount");\nawait context.sync();\n\nif (!usedRange || usedRange.rowCount < 1) {\n  throw new Error("Sheet appears empty.");\n}\n\nconst rowCount = usedRange.rowCount;\n\n// All cells: dark background, light text\nusedRange.format.fill.color = "#1E1E1E";\nusedRange.format.font.color = "#CCCCCC";\n\n// Header: gold text\nconst headerRow = usedRange.getRow(0);\nheaderRow.format.fill.color = "#2D2D2D";\nheaderRow.format.font.bold = true;\nheaderRow.format.font.color = "#F0C75E";\nheaderRow.format.rowHeight = 28;\n\n// Alternating dark rows\nfor (let i = 1; i < rowCount; i++) {\n  const row = usedRange.getRow(i);\n  row.format.fill.color = i % 2 === 0 ? "#252525" : "#1E1E1E";\n}\n\n// Dark borders\nusedRange.format.borders.getItem("InsideHorizontal").style = "Thin";\nusedRange.format.borders.getItem("InsideHorizontal").color = "#3A3A3A";\nusedRange.format.borders.getItem("InsideVertical").style = "Thin";\nusedRange.format.borders.getItem("InsideVertical").color = "#3A3A3A";\nusedRange.format.borders.getItem("EdgeTop").style = "Thin";\nusedRange.format.borders.getItem("EdgeBottom").style = "Thin";\nusedRange.format.borders.getItem("EdgeLeft").style = "Thin";\nusedRange.format.borders.getItem("EdgeRight").style = "Thin";\n\nusedRange.format.autofitColumns();\nawait context.sync();'},{icon:"paintbrush",label:"Colorful Teal",prompt:'Apply colorful teal formatting:\n\nconst usedRange = sheet.getUsedRange();\nusedRange.load("rowCount");\nawait context.sync();\n\nif (!usedRange || usedRange.rowCount < 1) {\n  throw new Error("Sheet appears empty.");\n}\n\n// Header: teal background\nconst headerRow = usedRange.getRow(0);\nheaderRow.format.fill.color = "#0D7377";\nheaderRow.format.font.bold = true;\nheaderRow.format.font.color = "#FFFFFF";\nheaderRow.format.horizontalAlignment = "Center";\nheaderRow.format.rowHeight = 28;\n\n// Alternating light teal and white\nfor (let i = 1; i < usedRange.rowCount; i++) {\n  const row = usedRange.getRow(i);\n  row.format.fill.color = i % 2 === 0 ? "#E8F6F3" : "#FFFFFF";\n}\n\n// Thin borders\nusedRange.format.borders.getItem("InsideHorizontal").style = "Thin";\nusedRange.format.borders.getItem("InsideVertical").style = "Thin";\nusedRange.format.borders.getItem("EdgeTop").style = "Thin";\nusedRange.format.borders.getItem("EdgeBottom").style = "Thin";\nusedRange.format.borders.getItem("EdgeLeft").style = "Thin";\nusedRange.format.borders.getItem("EdgeRight").style = "Thin";\n\nsheet.freezePanes.freezeRows(1);\nusedRange.format.autofitColumns();\nawait context.sync();'},{icon:"snowflake",label:"Freeze Header",prompt:"Freeze the first row:\n\nsheet.freezePanes.freezeRows(1);\nawait context.sync();"},{icon:"table",label:"Excel Table",prompt:'Convert data to Excel Table:\n\nconst usedRange = sheet.getUsedRange();\nusedRange.load("address");\nawait context.sync();\n\nif (!usedRange) {\n  throw new Error("No data found in sheet.");\n}\n\nconst table = sheet.tables.add(usedRange, true);\ntable.style = "TableStyleMedium9";\nusedRange.format.autofitColumns();\nawait context.sync();'},{icon:"paintbrush",label:"Borders All",prompt:'Add thin borders to all cells:\n\nconst usedRange = sheet.getUsedRange();\nusedRange.format.borders.getItem("InsideHorizontal").style = "Thin";\nusedRange.format.borders.getItem("InsideVertical").style = "Thin";\nusedRange.format.borders.getItem("EdgeTop").style = "Thin";\nusedRange.format.borders.getItem("EdgeBottom").style = "Thin";\nusedRange.format.borders.getItem("EdgeLeft").style = "Thin";\nusedRange.format.borders.getItem("EdgeRight").style = "Thin";\nawait context.sync();'},{icon:"hash",label:"Currency $",prompt:"Format numeric columns as currency. First read the data to detect numeric columns, then apply $#,##0.00 format."},{icon:"hash",label:"Percentage %",prompt:"Format the last numeric column as percentage (0.00%) and auto-fit columns."}],reports:[{icon:"barChart",label:"Instant Dashboard 📊",prompt:"Analyze the dataset. Create a new sheet 'Dashboard'. Generate 3 professional charts (Bar, Line, Pie) for key trends. Add 'Big Number' cards at top for Totals. Apply modern theme. Make it executive-ready."},{icon:"barChart",label:"Sales Report",prompt:"Generate a professional monthly sales report from the existing data. Do ALL of this: (1) Add a report title row at the top: 'Monthly Sales Report' in bold, font size 14, merged across all columns. (2) Add today's date below the title, right-aligned. (3) Format the data with professional headers (dark navy background, white bold text) and alternating row colors. (4) Add SUM, AVERAGE, MAX, and MIN summary rows at the bottom with labels. (5) Create a clustered column chart from the data showing performance by category. Position it below the summary. (6) Add thin borders throughout and auto-fit all columns."},{icon:"barChart",label:"Financial Summary",prompt:"Build a financial summary report from the data. (1) Add a 'Financial Summary' title merged at top, bold, font size 14. (2) Format headers professionally with dark green (#1B4D3E) background and white text. (3) Format all currency columns as $#,##0.00. (4) Add a TOTAL row with SUM formulas, bold, with a top border. (5) Add a 'Net' or 'Difference' calculation if applicable. (6) Apply conditional formatting: positive numbers in green, negative in red. (7) Create a pie chart showing the breakdown. (8) Auto-fit columns and freeze header row."},{icon:"trendUp",label:"Performance Review",prompt:"Create a team performance report from the data. (1) Add a 'Team Performance Report' title at top, merged, bold, font size 14. (2) Professional header formatting with indigo (#2B3A67) background, white text. (3) Add RANK column based on the primary numeric metric column. (4) Add conditional formatting: top 3 rows highlighted in light green (#E6F4EA), bottom 3 in light red (#FDE8E8). (5) Add AVERAGE, MAX, MIN summary rows at bottom. (6) Create a bar chart showing individual performance, sorted high to low. (7) Auto-fit and add borders."},{icon:"barChart",label:"Inventory Report",prompt:"Generate an inventory status report from the data. (1) Title: 'Inventory Status Report', merged, bold, size 14. (2) Professional formatting with teal (#0D7377) headers. (3) If there's a quantity column, add conditional formatting: red background for items ≤ 10 (low stock), yellow for 11-50 (medium), green for 50+ (healthy). (4) Add a status column with IF formula: 'Critical' for ≤ 10, 'Low' for 11-25, 'OK' for 26-50, 'Good' for 50+. (5) Add summary showing total items, total value (if price column exists), and count by status. (6) Create a pie chart showing stock level distribution."},{icon:"barChart",label:"Attendance Summary",prompt:"Generate an attendance summary report. (1) Title: 'Attendance Summary', merged, bold, size 14. (2) Count Present (P), Absent (A), Leave (L) for each person using COUNTIF. (3) Calculate attendance percentage. (4) Format: professional headers, alternating rows, percentage column formatted as percentage. (5) Conditional formatting on attendance %: green ≥ 90%, yellow 75-89%, red < 75%. (6) Add a column chart showing attendance by person. (7) Add class/team averages at bottom."},{icon:"fileTemplate",label:"Weekly Status",prompt:"Create a weekly status report template: (1) Title: 'Weekly Status Update — Week of [Date]', merged, bold. (2) Section 1: 'Completed This Week' — 5 rows with Task, Owner, Status columns. (3) Section 2: 'In Progress' — 5 rows with Task, Owner, % Complete, ETA columns. (4) Section 3: 'Blockers & Risks' — 3 rows with Issue, Impact, Action Needed columns. (5) Section 4: 'Next Week Plans' — 4 rows. (6) Format each section with colored headers (different subtle colors), thin borders, and auto-fit."}],templates:[{icon:"fileTemplate",label:"Monthly Budget",prompt:"Create a monthly budget tracker with categories: Housing, Utilities, Food, Transport, Entertainment, Savings. Add columns for Budget, Actual, and Difference with SUM at bottom. Use professional formatting with green for under-budget and red for over-budget conditional formatting."},{icon:"fileTemplate",label:"Invoice",prompt:"Create a professional invoice template with: Company Name header, Invoice #, Date, Bill To section, items table with Description, Quantity, Unit Price, Total columns, Subtotal, Tax (10%), and Grand Total calculations. Apply clean formatting."},{icon:"fileTemplate",label:"Employee List",prompt:"Create an employee directory with 8 sample employees: Name, Department (HR/Engineering/Marketing/Sales), Email, Phone, Joining Date, Salary. Apply professional table formatting with alternating rows and currency format for salary."},{icon:"fileTemplate",label:"Project Tracker",prompt:"Create a project tracker with 6 sample tasks: Task Name, Assigned To, Priority (High/Medium/Low), Status (Not Started/In Progress/Complete), Start Date, Due Date. Add dropdown validation for Priority and Status. Use conditional formatting for status colors."},{icon:"fileTemplate",label:"Sales Dashboard",prompt:"Create a quarterly sales report with 5 products across Q1-Q4. Add Total column and row with SUM formulas. Create a column chart showing quarterly performance. Apply professional formatting."},{icon:"fileTemplate",label:"Attendance Sheet",prompt:"Create a monthly attendance sheet for 10 employees with dates as columns (1-31). Mark P for present, A for absent, L for leave. Add summary columns for Total Present, Absent, and Leave. Apply conditional formatting."},{icon:"fileTemplate",label:"Grade Book",prompt:"Create a student grade book for 8 students with 5 assignments, Midterm, Final, and Total/Grade columns. Add weighted average formulas and letter grade calculation (A/B/C/D/F). Apply professional formatting with conditional colors."},{icon:"fileTemplate",label:"Weekly Schedule",prompt:"Create a weekly schedule template with time slots from 8 AM to 6 PM (1-hour intervals) and columns for Mon-Fri. Add borders, colored header, and merge the title cell. Apply a clean, readable format."}],analysis:[{icon:"trendUp",label:"Pivot Analysis",prompt:"Create a new sheet named 'Pivot Analysis'. Select the entire current dataset. Insert a Pivot Table starting at A3. Automatically detect the categorical column for Rows and the numeric column for Values (Sum). Apply the 'PivotStyleMedium9' style."},{icon:"barChart",label:"Pareto Chart",prompt:"Create a Pareto analysis. (1) Copy the data to a new sheet 'Pareto'. (2) Sort by the numeric metric descending. (3) Calculate cumulative percentage. (4) Create a Pareto chart (combo chart: bars for values, line for cumulative %). Add data labels."},{icon:"search",label:"Find Outliers",prompt:"Analyze the numeric column. Calculate Mean and Standard Deviation. Highlight any cell that is more than 2 Standard Deviations away from the Mean in RED (#FFCCCC). Add a note to the cell 'Outlier'."},{icon:"sortAsc",label:"Correlation Matrix",prompt:"Analyze all numeric columns. Create a correlation matrix in a new sheet 'Correlations'. Calculate the correlation coefficient (CORREL) between every pair of numeric variables. Use Conditional Formatting (Color Scale) to highlight strong positive (green) and negative (red) correlations."},{icon:"calendar",label:"Date Intelligence",prompt:"Find the Date column. Insert 4 new columns to the right: Year, Quarter, Month Name, Week Number. Use formulas (=YEAR, =ROUNDUP(MONTH(.)/3,0), =TEXT(.,'mmmm'), =ISOWEEKNUM) to populate them for all rows. Copy and Paste Values to finalize."},{icon:"trendUp",label:"Forecast 12M",prompt:"Analyze the time-series data. Create a new sheet 'Forecast'. Use the FORECAST.ETS function to predict the next 12 months based on historical data. Create a Line Chart showing history (solid) and forecast (dotted) with confidence intervals."},{icon:"copy",label:"Transpose & Link",prompt:"Copy the selected table. Create a new sheet 'Transposed'. Paste the data linked/transposed (=TRANSPOSE(Original!Range)) so it updates automatically. Apply professional formatting."},{icon:"filter",label:"Advanced Filter",prompt:"Create a 'Search' area above the data. Set up a dynamic visual filter: when user types in cell B1, filter the main table rows where the text content contains that value (wildcard match). Use conditional formatting to hide non-matching rows if Filter function is not available."},{icon:"hash",label:"Frequency Dist",prompt:"Create a frequency distribution (histogram data) for the main numeric column. Create bins (groups) automatically. Count the frequency of items in each bin. Output a summary table and a Histogram chart in a new sheet."},{icon:"zap",label:"Regex Extract",prompt:"Analyze the text column. If it contains emails, extract them to a new column 'Email'. If it contains phone numbers, extract and format them. If it contains IDs (like #1234), extract them. Use Flash Fill logic or pattern matching formulas."}],extract:[{icon:"fileText",label:"📄 Import to Schema",prompt:"SCHEMA_EXTRACTION_MODE: Read the column headers in row 1 of the current sheet. For each attached PDF/resume, extract ONLY the data that matches those columns. If a column's data doesn't exist in the PDF, leave it blank. Append each candidate as a new row."},{icon:"users",label:"📋 Bulk Resume Import",prompt:"SCHEMA_EXTRACTION_MODE: Import all attached resumes/CVs. First read existing column headers. If no headers exist, create: Name, Email, Phone, Skills, Experience, Education. Extract data from each PDF and add one row per candidate. Never hallucinate — if data is missing, leave blank."},{icon:"fileTemplate",label:"📝 HR Database Setup",prompt:"Create a professional HR candidate database template with columns: Name, Email, Phone, LinkedIn, Current Company, Current Role, Skills, Years of Experience, Highest Education, Expected Salary, Notes. Apply formatting with filters and freeze header row."},{icon:"search",label:"🔍 Smart Extract",prompt:"SCHEMA_EXTRACTION_MODE: Intelligently analyze the attached documents. Read column headers from the sheet. Match document content to columns using smart aliases (e.g., 'Mobile No' matches 'Phone' column). Only extract what exists — no guessing."},{icon:"table",label:"📊 Create Schema First",prompt:"Before importing, set up your columns: Create header row with: Name, Email, Mobile No, Age, Address, Skills, Experience. Format as a proper table with filters. Now attach PDFs and click 'Import to Schema'."},{icon:"checkSquare",label:"✅ Validate & Clean",prompt:"Validate the extracted data: Check for blank required fields (Name, Email). Highlight rows with missing data in yellow. Add a 'Status' column marking 'Complete' or 'Incomplete' for each row."}]},me=[{icon:"formula",text:"Find total sales for each employee — which formula?"},{icon:"paintbrush",text:"Make my sheet look professional in one click"},{icon:"barChart",text:"Generate a monthly report with charts"},{icon:"table",text:"What's the best way to structure my data?"}];function fe(e){if(e!==ce){ce=e,document.querySelectorAll(".mode-tab").forEach(function(t){t.classList.toggle("active",t.dataset.mode===e)});var t=document.getElementById("mode-indicator");"agent"===e?t.classList.add("right"):t.classList.remove("right"),document.getElementById("planning-mode").classList.toggle("active","planning"===e),document.getElementById("agent-mode").classList.toggle("active","agent"===e),"planning"===e?setTimeout(function(){return document.getElementById("chat-input").focus()},200):setTimeout(function(){return document.getElementById("prompt-input").focus()},200)}}function be(){var e=document.getElementById("quick-actions");if(e){e.innerHTML="";var t=ge[de];t?t.forEach(function(t){var n=document.createElement("button");n.className="chip";var r=t.icon;n.innerHTML="".concat($[r]||"","<span>").concat(t.label,"</span>"),n.onclick=function(){var e=document.getElementById("prompt-input");e&&(e.value=t.prompt,e.focus())},e.appendChild(n)}):console.warn("No quick actions found for category: ".concat(de))}}function Ce(){var e=document.getElementById("chat-suggestions");e&&me.forEach(function(t){var n=document.createElement("button");n.className="suggestion-chip";var r=t.icon;n.innerHTML="".concat($[r]||"").concat(t.text),n.onclick=function(){var e=document.getElementById("chat-input");e&&(e.value=t.text,we())},e.appendChild(n)})}function ye(e){var t=function(e,t){var n=document.getElementById(e);n&&(n.style.display=t?"block":"none")};t("groq-fields","groq"===e),t("gemini-fields","gemini"===e),t("openai-fields","openai"===e),t("local-fields","local"===e)}function ve(){return xe.apply(this,arguments)}function xe(){return(xe=le(Z().m(function e(){var t,n,r,a,i,s;return Z().w(function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("setting-local-model"),r=document.getElementById("model-status"),a=(null===(t=document.getElementById("setting-base-url"))||void 0===t||null===(t=t.value)||void 0===t?void 0:t.trim())||"http://localhost:11434",n){e.n=1;break}return e.a(2);case 1:return n.innerHTML='<option value="" disabled selected>Loading...</option>',r&&(r.textContent="",r.className="model-status"),e.n=2,_(a);case 2:if(0!==(i=e.v).length){e.n=3;break}return n.innerHTML='<option value="" disabled selected>No models found</option>',r&&(r.textContent="Ollama not running or no models installed",r.className="model-status model-status-warn"),e.a(2);case 3:s=b(),n.innerHTML="",i.forEach(function(e){var t=document.createElement("option");t.value=e.name,t.textContent="".concat(e.name," (").concat((e.size/1e9).toFixed(1),"GB)"),(s.localModel||s.model)===e.name&&(t.selected=!0),n.appendChild(t)}),r&&(r.textContent="".concat(i.length," model").concat(i.length>1?"s":""," found"),r.className="model-status model-status-ok");case 4:return e.a(2)}},e)}))).apply(this,arguments)}function Ee(){var e,t,n=null===(e=document.getElementById("setting-provider"))||void 0===e?void 0:e.value,r=b(),a=function(e){var t;return(null===(t=document.getElementById(e))||void 0===t||null===(t=t.value)||void 0===t?void 0:t.trim())||""};t=ie(ie({},r),{},{provider:n,apiKey:a("setting-api-key"),groqModel:a("setting-groq-model"),geminiKey:a("setting-gemini-key"),geminiModel:a("setting-gemini-model"),openaiKey:a("setting-openai-key"),openaiModel:a("setting-openai-model"),baseUrl:a("setting-base-url")?"".concat(a("setting-base-url").replace(/\/v1.*$/,""),"/v1/chat/completions"):void 0,localModel:a("setting-local-model")||r.localModel}),localStorage.setItem("sheetcraft_llm_config",JSON.stringify(t));var i=document.getElementById("save-settings");if(i){var s=i.textContent;i.textContent="Saved ✓",setTimeout(function(){i.textContent=s||"Save"},1200)}setTimeout(function(){var e=document.getElementById("settings-panel");e&&(e.style.display="none")},600)}function we(){return _e.apply(this,arguments)}function _e(){return(_e=le(Z().m(function e(){var t,n,r,a,i,s,o,l,c,d,h,u,p,A,g,m;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!pe){e.n=1;break}return e.a(2);case 1:if(t=document.getElementById("chat-input")){e.n=2;break}return e.a(2);case 2:if(n=t.value.trim()){e.n=3;break}return e.a(2);case 3:if((r=document.querySelector(".chat-welcome"))&&r.remove(),ke("user",n),he.push({role:"user",content:n,timestamp:Date.now()}),0===ue.length&&ue.push({role:"system",content:"You are SheetOS AI — a friendly, expert Excel assistant in Planning Mode.\n\nYOUR ROLE:\n- Help users plan their spreadsheet work\n- Explain Excel concepts, formulas, and best practices\n- Suggest approaches before executing\n- Answer questions about data organization, analysis, and visualization\n- Provide formula examples and explanations\n- When given sheet context, analyze the USER'S ACTUAL DATA and give specific advice\n\nCONTEXT AWARENESS:\nWhen a message includes [SHEET CONTEXT], you have access to the user's ACTUAL Excel data!\n- Analyze the real column names, data types, and sample values\n- Give SPECIFIC suggestions based on their actual data structure\n- Reference their exact column names in your advice\n- Suggest improvements tailored to their dataset\n- Point out data quality issues you observe (empty cells, inconsistent formats, etc.)\n- You CAN see their sheet — do NOT say \"I don't have access to your sheet\"\n\nRESPONSE FORMAT RULES:\n1. Respond in natural, conversational language\n2. Use markdown-style formatting for emphasis: **bold**, *italic*, `code`\n3. When showing formulas, wrap them in backticks: `=VLOOKUP(A2, Sheet2!A:B, 2, FALSE)`\n4. Use bullet points and numbered lists for clarity\n5. Keep responses concise but thorough (aim for 2-5 paragraphs max)\n6. If the user's request would be better handled in Agent Mode (actual execution), mention that they can switch to ⚡ Agent Mode to execute it\n7. When you have sheet context, ALWAYS reference the user's actual column names and data\n\nEXCEL EXPERTISE AREAS:\n- Formula writing & debugging (VLOOKUP, INDEX/MATCH, IF, SUMIFS, etc.)\n- Data organization best practices\n- Chart type selection guidance\n- PivotTable planning\n- Data validation strategies\n- Conditional formatting approaches\n- Dashboard design principles\n- Data cleaning strategies\n- Performance optimization tips\n- Cross-sheet referencing patterns\n\nPERSONALITY:\n- Friendly and encouraging\n- Uses concrete examples when explaining\n- Proactive — suggest improvements the user might not have thought of\n- Mentions potential pitfalls or common mistakes to avoid\n\nIf the user asks you to DO something (create, format, execute), remind them:\n\"💡 Switch to ⚡ Agent Mode to execute this! I can help you plan it here first.\"\n\nUser Message:\n"}),a=/\b(this|my|current|opened?)\s+(sheet|data|table|workbook|excel|spreadsheet)|what\s+(do|can|should)|improve|analyze|suggest|help|better|optimize/i.test(n),i=n,!a){e.n=7;break}return e.p=4,e.n=5,Me();case 5:(s=e.v)&&(i="".concat(n,"\n\n[SHEET CONTEXT]\n").concat(s),(o=document.querySelector(".chat-msg.user:last-child .chat-bubble"))&&((l=document.createElement("span")).className="context-badge",l.innerHTML="📊 Sheet context loaded",o.appendChild(l))),e.n=7;break;case 6:e.p=6,g=e.v,console.warn("Could not load sheet context:",g);case 7:return ue.push({role:"user",content:i}),t.value="",t.style.height="auto",c=Se(),pe=!0,(d=document.getElementById("chat-send"))&&(d.disabled=!0),e.p=8,e.n=9,E(ue);case 9:return h=e.v,u=Te(h),p=ke("ai","",h),e.n=10,Be(p,u);case 10:c.remove(),ue.push({role:"assistant",content:h}),he.push({role:"ai",content:h,timestamp:Date.now()}),e.n=12;break;case 11:e.p=11,m=e.v,c.remove(),ke("ai",'<p style="color:var(--error)">⚠️ '.concat(m.message,"</p>"));case 12:return e.p=12,pe=!1,(A=document.getElementById("chat-send"))&&(A.disabled=!1),e.f(12);case 13:return e.a(2)}},e,null,[[8,11,12,13],[4,6]])}))).apply(this,arguments)}function Be(e,t){return Ie.apply(this,arguments)}function Ie(){return(Ie=le(Z().m(function e(t,n){var r,a,i,s,o,l,c,d,h,u,p;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:t.innerHTML="",r=n.split(/(<[^>]+>)/g),a=te(r),e.p=1,a.s();case 2:if((i=a.n()).done){e.n=11;break}if(!(s=i.value).startsWith("<")||!s.endsWith(">")){e.n=3;break}t.innerHTML+=s,e.n=10;break;case 3:if(!(s.trim().length>0)){e.n=10;break}o=s.split(/(\s+)/),l=te(o),e.p=4,l.s();case 5:if((c=l.n()).done){e.n=7;break}return d=c.value,t.innerHTML+=d,(h=document.getElementById("chat-messages"))&&(h.scrollTop=h.scrollHeight),e.n=6,new Promise(function(e){return setTimeout(e,10*Math.random()+5)});case 6:e.n=5;break;case 7:e.n=9;break;case 8:e.p=8,u=e.v,l.e(u);case 9:return e.p=9,l.f(),e.f(9);case 10:e.n=2;break;case 11:e.n=13;break;case 12:e.p=12,p=e.v,a.e(p);case 13:return e.p=13,a.f(),e.f(13);case 14:return e.a(2)}},e,null,[[4,8,9,10],[1,12,13,14]])}))).apply(this,arguments)}function ke(e,t,n){var r=document.getElementById("chat-messages");if(!r)throw new Error("Chat messages container not found.");var a=document.createElement("div");a.className="chat-msg ".concat(e);var i=document.createElement("div");i.className="chat-avatar",i.innerHTML="user"===e?$.user:$.bot;var s=document.createElement("div");if(s.className="chat-bubble",s.innerHTML=t,"ai"===e&&n){var o=document.createElement("div");o.className="chat-action-bar";var l=document.createElement("button");l.className="btn-execute-from-chat",l.innerHTML="".concat($.zap," Switch to Agent"),l.onclick=function(){var e=document.getElementById("prompt-input");e&&(e.value=function(e){var t,n=te(e.split("\n"));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.includes("=")&&r.includes("(")&&!r.startsWith("#"))return"Apply this formula: ".concat(r.trim())}}catch(e){n.e(e)}finally{n.f()}var a=e.split(/[.!?]/)[0];return a.length>120?a.substring(0,120):a}(n),fe("agent"),e.focus())},o.appendChild(l),s.appendChild(o)}return a.appendChild(i),a.appendChild(s),r.appendChild(a),r.scrollTop=r.scrollHeight,s}function Se(){var e=document.getElementById("chat-messages");if(!e)throw new Error("Chat messages container not found.");var t=document.createElement("div");t.className="chat-msg ai",t.id="typing-msg";var n=document.createElement("div");n.className="chat-avatar",n.innerHTML=$.bot;var r=document.createElement("div");return r.className="chat-bubble",r.innerHTML='\n    <div class="typing-indicator">\n      <div class="typing-dot"></div>\n      <div class="typing-dot"></div>\n      <div class="typing-dot"></div>\n    </div>\n  ',t.appendChild(n),t.appendChild(r),e.appendChild(t),e.scrollTop=e.scrollHeight,t}function Te(e){var t=e;return(t=(t=(t=(t=(t=(t=(t=t.replace(/```(\w+)?\n([\s\S]*?)```/g,'<pre style="margin:6px 0;padding:8px;background:rgba(0,0,0,0.06);border-radius:6px;font-family:var(--mono);font-size:10px;overflow-x:auto"><code>$2</code></pre>')).replace(/`([^`]+)`/g,"<code>$1</code>")).replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>")).replace(/\*([^*]+)\*/g,"<em>$1</em>")).replace(/^[-•]\s+(.+)$/gm,"<li>$1</li>")).replace(/((?:<li>[\s\S]*?<\/li>\n?)+)/g,"<ul>$1</ul>")).replace(/^\d+\.\s+(.+)$/gm,"<li>$1</li>")).split(/\n\n+/).map(function(e){return(e=e.trim())?e.startsWith("<ul>")||e.startsWith("<ol>")||e.startsWith("<pre>")||e.startsWith("<li>")||e.startsWith("<p>")?e:"<p>".concat(e.replace(/\n/g,"<br>"),"</p>"):""}).join("")}function Re(){var e=document.getElementById("chat-messages");e.innerHTML="",he.length=0,ue=[],pe=!1,e.innerHTML='\n    <div class="chat-welcome">\n      <img src="assets/icon-80-v2.png" alt="SheetOS Logo" style="width: 64px; height: 64px; margin-bottom: 16px;">\n      <h2>What are you working on?</h2>\n      <div class="welcome-suggestions" id="chat-suggestions"></div>\n    </div>\n  ',Ce()}function Me(){return Pe.apply(this,arguments)}function Pe(){return Pe=le(Z().m(function e(){var t;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=le(Z().m(function e(t){var n,r,a,i,s,o,l,c,d,h;return Z().w(function(e){for(;;)switch(e.n){case 0:return(n=t.workbook.worksheets.getActiveWorksheet()).load("name"),(r=n.getUsedRange()).load("values,rowCount,columnCount,address"),e.n=1,t.sync();case 1:if(0!==r.rowCount&&0!==r.columnCount){e.n=2;break}return e.a(2,"Sheet is empty.");case 2:if(a=r.values,i=a[0].map(function(e){return String(e||"").trim()}),s=Math.min(15,a.length),o=a.slice(0,s),l=[],!(a.length>1)){e.n=5;break}c=Z().m(function e(t){var n;return Z().w(function(e){for(;;)switch(e.n){case 0:0===(n=a.slice(1).map(function(e){return e[t]}).filter(function(e){return null!==e&&""!==e})).length?l.push("empty"):n.every(function(e){return!isNaN(Number(e))})?l.push("number"):n.every(function(e){return/^\d{1,4}[-\/]\d{1,2}[-\/]\d{1,4}/.test(String(e))})?l.push("date"):l.push("text");case 1:return e.a(2)}},e)}),d=0;case 3:if(!(d<r.columnCount)){e.n=5;break}return e.d(J(c(d)),4);case 4:d++,e.n=3;break;case 5:return h='Sheet Name: "'.concat(n.name,'"\n'),h+="Dimensions: ".concat(r.rowCount," rows × ").concat(r.columnCount," columns\n"),h+="Range: ".concat(r.address,"\n\n"),h+="COLUMNS:\n",i.forEach(function(e,t){var n=l[t]||"unknown";h+="  ".concat(t+1,'. "').concat(e||"Column".concat(t+1),'" (').concat(n,")\n")}),h+="\nDATA SAMPLE (first ".concat(s," rows):\n"),o.forEach(function(e,t){h+=0===t?"  [Headers] ".concat(e.map(function(e){return'"'.concat(e,'"')}).join(" | "),"\n"):"  Row ".concat(t,": ").concat(e.map(function(e){return null===e||""===e?"(empty)":'"'.concat(e,'"')}).join(" | "),"\n")}),a.length>s&&(h+="  ... (".concat(a.length-s," more rows not shown)\n")),e.a(2,h)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,console.error("Error reading sheet context:",t),e.a(2,null)}},e,null,[[0,2]])})),Pe.apply(this,arguments)}function Fe(){return De.apply(this,arguments)}function De(){return De=le(Z().m(function e(){return Z().w(function(e){for(;;)if(0===e.n)return e.a(2,Excel.run(function(){var e=le(Z().m(function e(t){var n,r,a;return Z().w(function(e){for(;;)switch(e.n){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),(r=n.getRange("A1:Z1")).load("values"),e.n=1,t.sync();case 1:return a=r.values[0].map(function(e){return e?String(e).trim():""}).filter(function(e){return""!==e}),e.a(2,a)}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),De.apply(this,arguments)}function Oe(){return Le.apply(this,arguments)}function Le(){return(Le=le(Z().m(function e(){var t,n,r,a,i,s;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("detect-columns-btn"),n=document.getElementById("detected-columns"),r=document.getElementById("column-chips"),a=document.getElementById("column-count"),n&&r&&a){e.n=1;break}return e.a(2);case 1:return t&&(t.innerHTML="⏳ Loading..."),e.p=2,e.n=3,Fe();case 3:0===(i=e.v).length?(r.innerHTML='<span class="column-chip empty-warning">⚠️ No headers in Row 1 — add columns first</span>',a.textContent="0",n.style.display="block"):(r.innerHTML=i.map(function(e){return'<span class="column-chip">'.concat(e,"</span>")}).join(""),a.textContent=String(i.length),n.style.display="block"),e.n=5;break;case 4:e.p=4,s=e.v,console.error("Error detecting columns:",s),r.innerHTML='<span class="column-chip empty-warning">⚠️ Error reading Excel</span>',a.textContent="0",n.style.display="block";case 5:return e.p=5,t&&(t.innerHTML="🔍 Detect"),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}))).apply(this,arguments)}function Ne(e){var t=e.map(function(e,t){return"".concat(t+1,'. "').concat(e,'"')}).join("\n"),n=function(e){var t=e.map(function(e){var t=P[e]||[],n=t.length>0?" (also look for: ".concat(t.slice(0,3).join(", "),")"):"";return'• "'.concat(e,'"').concat(n)}).join("\n");return"\nCOLUMNS TO EXTRACT:\n".concat(t,'\n\nRemember: If you cannot find data for a column, return "". Never guess or fabricate.\n')}(e);return"\n═══════════════════════════════════════════════════════════════════════════════\n🔒 SCHEMA-LOCKED EXTRACTION MODE — CRITICAL INSTRUCTIONS\n═══════════════════════════════════════════════════════════════════════════════\n\nThe user has PRE-DEFINED these columns in their Excel sheet. You MUST extract data ONLY for these columns:\n\n".concat(t,"\n\n").concat(n,'\n\nEXTRACTION RULES (MEMORIZE THESE):\n1. ONE ROW PER DOCUMENT: Each attached PDF/image represents ONE candidate/record.\n2. EXACT COLUMN MATCHING: Only fill data for the columns listed above.\n3. NO HALLUCINATION: If information for a column is NOT visible in the document, use "" (empty string).\n4. NO NEW COLUMNS: Do NOT add any columns that aren\'t in the list above.\n5. PROPER FORMATTING:\n   - Names: Proper Case (John Smith)\n   - Emails: lowercase\n   - Phones: Keep original format or +X-XXX-XXX-XXXX\n   - Skills: Comma-separated list\n\nBANNED BEHAVIORS:\n❌ Guessing email addresses (e.g., firstname@company.com)\n❌ Fabricating phone numbers\n❌ Making up skills not explicitly listed\n❌ Using "N/A", "Not Found", "Unknown" — use "" instead\n❌ Adding extra columns\n\nOUTPUT: Generate Excel JS code that writes the extracted data starting from the first empty row.\nThe code should use the writeData helper function and format the data professionally.\n\n═══════════════════════════════════════════════════════════════════════════════\n')}function Ue(){return je.apply(this,arguments)}function je(){return(je=le(Z().m(function e(){var t,n,r,a,i,s,o,l,c,d,h,u,p,A,g,m,f,b,C,y,v,x,w,_,B,k,S,T,P,F,D,O,L,N,U,j,z,q,H,G,V;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("status-message"),n=document.getElementById("debug-code"),r=document.getElementById("skeleton"),a=document.getElementById("cache-badge"),i=document.getElementById("prompt-input"),s=document.getElementById("run"),(o=i.value.trim())||0!==Ae.length){e.n=1;break}return ze(t,"info","Please enter a command or attach a file."),e.a(2);case 1:return Ae.length>0&&!o&&(o=Ae.length>1?"Analyze the ".concat(Ae.length," attached files. Extract and merge all tabular data into a single master table. Standardize headers and columns."):"Analyze the attached ".concat(Ae[0].type,". Extract all tabular data and write valid Excel JS code to populate the active sheet. Format headers and auto-fit columns.")),l=o.includes("SCHEMA_EXTRACTION_MODE")||"extract"===de,c=s.innerHTML,s.disabled=!0,s.innerHTML='<span class="btn-spinner"></span><span>Planning...</span>',t.style.display="none",r.style.display="flex",a.style.display="none",n.innerText="",e.p=2,h=!1,u=null,e.p=3,e.n=4,Y();case 4:u=e.v,null!==(p=u)&&void 0!==p&&p.hasData&&console.log("[Agent] Sheet context: ".concat(u.rowCount,"x").concat(u.columnCount)),e.n=6;break;case 5:e.p=5,q=e.v,console.warn("[Agent] Could not read sheet context:",q);case 6:if(A=[],!(l&&Ae.length>0)){e.n=11;break}return e.p=7,e.n=8,Fe();case 8:if(A=e.v,console.log("[Agent] Schema columns detected:",A),0!==A.length){e.n=9;break}return ze(t,"info","⚠️ No column headers found in Row 1. Add headers first or use 'HR Database Setup' to create them."),r.style.display="none",s.disabled=!1,s.innerHTML=c,e.a(2);case 9:s.innerHTML='<span class="btn-spinner"></span><span>Extracting ('.concat(A.length," cols)...</span>"),e.n=11;break;case 10:e.p=10,H=e.v,console.warn("[Agent] Could not read Excel headers:",H);case 11:if((g=0!==Ae.length||l?null:R(o))&&(d=g,h=!0,a.style.display="inline-block",(m=W(d)).isValid?d=m.sanitizedCode:(console.warn("[Agent] Cached code failed validation, regenerating..."),h=!1,d="")),h){e.n=16;break}return s.innerHTML='<span class="btn-spinner"></span><span>Generating...</span>',f=[{role:"system",content:I}],Ae.length>0?l&&A.length>0?(b=Ne(A),C=o.replace("SCHEMA_EXTRACTION_MODE:","").trim(),y="".concat(C,"\n\nEXISTING_COLUMNS: ").concat(JSON.stringify(A),"\n\n").concat(b),v=[{type:"text",text:y}],x=0,Ae.forEach(function(e){e.data.forEach(function(e){x<20&&(v.push({type:"image_url",image_url:{url:e}}),x++)})}),f.push({role:"user",content:v})):(w=Ae.length>1||/merge|combine|consolidate|table|database|list/i.test(o),_=[{type:"text",text:(o||"Process these files.")+"\n\n"+(w?'\nEXTREME EXTRACTION MODE:\n1. Extract EVERY significant piece of information from each document\n2. Default schema: [Name, Email, Phone, LinkedIn, Location, Summary, Experience Years, Company, Role, Skills, Education]\n3. NO HALLUCINATION: If a field isn\'t visible, leave it as "" (empty string)\n4. ONE ROW PER FILE: Each document = exactly one data row\n5. Apply professional formatting with TableStyleMedium9':"\nDOCUMENT RECREATION MODE:\n1. Recreate the ENTIRE document content in Excel\n2. Extract all Titles, Paragraphs, Lists, Tables\n3. Use merged cells for main titles, separate rows for sections\n4. Apply professional formatting matching the original")}],B=0,Ae.forEach(function(e){e.data.forEach(function(e){B<20&&(_.push({type:"image_url",image_url:{url:e}}),B++)})}),f.push({role:"user",content:_})):(S=o,null!==(k=u)&&void 0!==k&&k.hasData&&(S+='\n\n[CURRENT SHEET DATA]\nSheet: "'.concat(u.sheetName,'"\nSize: ').concat(u.rowCount," rows × ").concat(u.columnCount," columns\nHeaders: ").concat(JSON.stringify(u.headers),"\nData Types: ").concat(JSON.stringify(u.dataTypes))),f.push({role:"user",content:S})),e.n=12,E(f);case 12:d=e.v,s.innerHTML='<span class="btn-spinner"></span><span>Validating...</span>',T=W(d),P=0,F=2;case 13:if(T.isValid||!(P<F)){e.n=15;break}return console.warn("[Agent] Validation failed (attempt ".concat(P+1,"):"),T.errors),D=T.errors.map(function(e){return"".concat(e.message," → ").concat(e.suggestion)}).join("\n"),e.n=14,E([{role:"system",content:I},{role:"user",content:o},{role:"assistant",content:d},{role:"user",content:"VALIDATION ERRORS:\n".concat(D,"\n\nFix these errors. Output ONLY the corrected code.")}]);case 14:d=e.v,T=W(d),P++,e.n=13;break;case 15:d=T.sanitizedCode,T.warnings.length>0&&console.log("[Agent] Validation warnings:",T.warnings);case 16:n.innerText=d,r.style.display="none",s.innerHTML='<span class="btn-spinner"></span><span>Running...</span>',ze(t,"info",'<div class="spinner"></div><span>Executing code...</span>'),O=null,L=!1,N=0;case 17:if(!(N<=3)){e.n=23;break}return e.p=18,N>0&&(s.innerHTML='<span class="btn-spinner"></span><span>Retry '.concat(N,"/").concat(3,"...</span>"),ze(t,"info",'<div class="spinner"></div><span>Retrying ('.concat(N,"/").concat(3,")...</span>"))),e.n=19,qe(d);case 19:return L=!0,e.a(3,23);case 20:if(e.p=20,G=e.v,O=G,console.warn("[Agent] Execution attempt ".concat(N+1," failed:"),G.message),!(N<3)){e.n=22;break}return ze(t,"info",'<div class="spinner"></div><span>AI is auto-fixing...</span>'),s.innerHTML='<span class="btn-spinner"></span><span>Fixing error...</span>',U='\nRUNTIME ERROR: "'.concat(G.message,'"\n\nCOMMON FIXES:\n- "is not a function" → Check if you\'re calling .getValues() instead of .values\n- "InvalidArgument" → Check range references (no A0, valid dimensions)\n- "is not defined" → Check variable declarations and scope\n- "Cannot read property" → Add null checks or ensure .load() + await context.sync()\n\nFix the code. Output ONLY the corrected JavaScript code:'),e.n=21,E([{role:"system",content:I},{role:"user",content:o},{role:"assistant",content:d},{role:"user",content:U}]);case 21:d=e.v,j=W(d),d=j.sanitizedCode,n.innerText=d;case 22:N++,e.n=17;break;case 23:if(!L){e.n=24;break}h||0!==Ae.length||l||M(o,d),ze(t,"success","".concat($.check,"<span>Done</span>")),e.n=25;break;case 24:throw O;case 25:e.n=27;break;case 26:e.p=26,V=e.v,console.error("[Agent] Fatal error:",V),r.style.display="none",(z=V.message||String(V)).includes("Rate limited")?z="⏳ Rate limit reached. Please wait a moment and try again.":z.includes("API Key")?z="🔑 API Key issue. Check Settings → Provider configuration.":z.length>100&&(z=z.substring(0,100)+"..."),ze(t,"error","".concat($.alertCircle,"<span>").concat(z,"</span>"));case 27:return e.p=27,s.disabled=!1,s.innerHTML=c,e.f(27);case 28:return e.a(2)}},e,null,[[18,20],[7,10],[3,5],[2,26,27,28]])}))).apply(this,arguments)}function ze(e,t,n){e.innerHTML=n,e.className="status-pill ".concat(t),e.style.display="flex"}function qe(e){return He.apply(this,arguments)}function He(){return He=le(Z().m(function e(t){return Z().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Excel.run(function(){var e=le(Z().m(function e(n){var r,a,i;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),a="\n      ".concat('\nfunction writeData(sheet, startCell, data) {\n  if (!data || data.length === 0) return null;\n  const rows = data.length;\n  const cols = Math.max(...data.map(r => r ? r.length : 0));\n  if (cols === 0) return null;\n  const normalized = data.map(r => {\n    const row = r ? [...r] : [];\n    while (row.length < cols) row.push("");\n    return row;\n  });\n  try {\n    const range = sheet.getRange(startCell).getResizedRange(rows - 1, cols - 1);\n    range.values = normalized;\n    range.format.font.name = "Segoe UI";\n    range.format.font.size = 10;\n    range.format.verticalAlignment = "Center";\n    return range;\n  } catch (e) {\n    console.error("writeData error:", e);\n    return null;\n  }\n}\n',"\n      \n      try {\n        // ═══ AI Generated Code ═══\n        ").concat(t,'\n        \n        // ═══ Safety Finalization ═══\n        try {\n          sheet.getUsedRange().format.autofitColumns();\n        } catch(_) { /* Sheet might be empty */ }\n        \n      } catch(_innerErr) {\n        console.error("[Agent] Runtime Error:", _innerErr);\n        try { await context.sync(); } catch(_) {}\n        throw _innerErr;\n      }\n    '),e.p=1,e.n=2,new Function("context","sheet","Excel","return (async () => { \n          try {\n            ".concat(a,'\n            await context.sync();\n          } catch (inner) {\n            // Enhance error messages for common issues\n            if (inner.code === "InvalidArgument") {\n              const original = inner.message || "";\n              if (original.includes("A0") || original.includes("row 0")) {\n                inner.message = "Invalid range: Row 0 doesn\'t exist. Excel rows start at 1.";\n              } else if (original.includes("getResizedRange")) {\n                inner.message = "Invalid range size: Check that data dimensions match the range.";\n              } else {\n                inner.message = "Invalid argument: " + original;\n              }\n            } else if (inner.message?.includes("is not a function")) {\n              const fnMatch = inner.message.match(/(w+) is not a function/);\n              const fn = fnMatch ? fnMatch[1] : "method";\n              inner.message = "API Error: ." + fn + "() doesn\'t exist. Use correct Excel JS API methods.";\n            } else if (inner.message?.includes("is not defined")) {\n              const varMatch = inner.message.match(/(w+) is not defined/);\n              const v = varMatch ? varMatch[1] : "variable";\n              inner.message = "Undefined: \'" + v + "\' was used before being declared.";\n            } else if (inner.message?.includes("Cannot read property")) {\n              inner.message = "Null reference: Tried to read property of undefined. Add null checks or ensure .load() was called.";\n            }\n            throw inner;\n          }\n        })()'))(n,r,Excel);case 2:e.n=8;break;case 3:return e.p=3,i=e.v,console.error("[Agent] Execution Error:",i),e.p=4,e.n=5,n.sync();case 5:e.n=7;break;case 6:e.p=6,e.v;case 7:throw i;case 8:return e.n=9,n.sync();case 9:return e.a(2)}},e,null,[[4,6],[1,3]])}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),He.apply(this,arguments)}function We(e){return Ye.apply(this,arguments)}function Ye(){return Ye=le(Z().m(function e(t){var n,r,a,i,s,o,l,c,d,h,u,p=arguments;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=p.length>1&&void 0!==p[1]&&p[1],(r=t.target).files&&0!==r.files.length){e.n=1;break}return e.a(2);case 1:a=n?"agent-file-btn":"file-upload-btn",(i=document.getElementById(a))&&(i.innerHTML='<span class="btn-spinner"></span>'),e.p=2,s=[],o=0;case 3:if(!(o<r.files.length)){e.n=9;break}if("application/pdf"!==(l=r.files[o]).type){e.n=6;break}return e.n=4,l.arrayBuffer();case 4:return c=e.v,e.n=5,$e(c);case 5:d=e.v,s.push({name:l.name,type:"pdf",data:d}),e.n=8;break;case 6:if(!l.type.startsWith("image/")){e.n=8;break}return e.n=7,Xe(l);case 7:h=e.v,s.push({name:l.name,type:"image",data:[h]});case 8:o++,e.n=3;break;case 9:if(!(s.length>0)){e.n=10;break}Ae=[].concat(Q(Ae),s),Ge(!0,n),e.n=11;break;case 10:throw new Error("Unsupported file type. Please upload PDF or Image.");case 11:e.n=13;break;case 12:e.p=12,u=e.v,console.error(u),ze(document.getElementById("status-message"),"error","Error reading file: "+u.message);case 13:return e.p=13,r.value="",i&&(i.innerHTML='<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg>'),e.f(13);case 14:return e.a(2)}},e,null,[[2,12,13,14]])})),Ye.apply(this,arguments)}function Ge(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"agent-file-preview-list":"file-preview-list",r=document.getElementById(n);r&&(r.innerHTML="",0!==Ae.length&&Ae.forEach(function(e,n){var a=document.createElement("div");a.className="file-chip";var i=document.createElement("span");i.className="file-chip-icon",i.innerHTML="pdf"===e.type?"📄":"🖼️";var s=document.createElement("span");s.className="file-chip-name",s.innerText=e.name;var o=document.createElement("button");o.className="file-chip-remove",o.innerHTML="×",o.title="Remove file",o.onclick=function(e){e.stopPropagation(),function(e,t){Ae.splice(e,1),Ge(!0,t)}(n,t)},a.appendChild(i),a.appendChild(s),a.appendChild(o),r.appendChild(a)}))}function Ve(){Ae=[],Ge(!1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}function Xe(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=n,r.readAsDataURL(e)})}function $e(e){return Ke.apply(this,arguments)}function Ke(){return(Ke=le(Z().m(function e(t){var n,r,a,i,s,o,l,c;return Z().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,V.getDocument(t).promise;case 1:n=e.v,r=[],a=Math.min(n.numPages,5),i=1;case 2:if(!(i<=a)){e.n=7;break}return e.n=3,n.getPage(i);case 3:if(s=e.v,o=s.getViewport({scale:1}),l=document.createElement("canvas"),c=l.getContext("2d")){e.n=4;break}return e.a(3,6);case 4:return l.height=o.height,l.width=o.width,e.n=5,s.render({canvasContext:c,viewport:o}).promise;case 5:r.push(l.toDataURL("image/png"));case 6:i++,e.n=2;break;case 7:return e.a(2,r)}},e)}))).apply(this,arguments)}window.onerror=function(e,t,n){var r=document.getElementById("loading-status");return r&&(r.innerHTML+='<br><span style="color:#d32f2f;font-weight:bold;font-size:11px;">'.concat(e," (Line ").concat(n,")</span>"),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex"),!1},Office.onReady(function(e){var t,n=document.getElementById("sideload-msg"),r=document.getElementById("app-body");n&&(n.style.display="none"),r&&(r.style.display="flex"),e.host===Office.HostType.Excel?console.log("Running in Excel"):console.warn("Running outside Excel"),(t=function(e,t){var n=document.getElementById(e);n&&(n.innerHTML=t)})("logo-icon",$.fileText),t("settings-toggle",$.settings),t("docs-toggle",$.helpCircle),t("run-icon",$.arrowRight),t("chevron-icon",$.chevronDown),t("refresh-models",$.refresh),t("mode-planning-icon",$.messageCircle),t("mode-agent-icon",$.zap),t("chat-send-icon",$.send),t("chat-clear-icon",$.trash),t("welcome-sparkle",$.sparkles),document.querySelectorAll(".doc-icon[data-icon]").forEach(function(e){var t=e.getAttribute("data-icon");$[t]&&(e.innerHTML=$[t])}),document.querySelectorAll(".cat-icon[data-icon]").forEach(function(e){var t=e.getAttribute("data-icon");$[t]&&(e.innerHTML=$[t])}),document.getElementById("run").onclick=Ue,document.getElementById("settings-toggle").onclick=function(){var e=document.getElementById("settings-panel");e.style.display="none"===e.style.display?"block":"none",document.getElementById("docs-panel").style.display="none"},document.getElementById("docs-toggle").onclick=function(){var e=document.getElementById("docs-panel");e.style.display="none"===e.style.display?"block":"none",document.getElementById("settings-panel").style.display="none"},document.getElementById("save-settings").onclick=Ee,document.getElementById("refresh-models").onclick=ve,document.getElementById("mode-planning").onclick=function(){return fe("planning")},document.getElementById("mode-agent").onclick=function(){return fe("agent")},document.getElementById("chat-send").onclick=we;var a,i=document.getElementById("chat-clear");i&&(i.onclick=Re),(a=document.getElementById("chat-input"))&&(a.addEventListener("input",function(){a.style.height="auto",a.style.height=Math.min(a.scrollHeight,80)+"px"}),a.addEventListener("keydown",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),we())}));var s=function(e,t){var n=document.getElementById(e);n&&(n.onclick=t)},o=function(e,t){var n=document.getElementById(e);n&&(n.onchange=t)};s("file-upload-btn",function(){return document.getElementById("file-input").click()}),o("file-input",function(e){return We(e,!1)}),s("file-remove",function(){return Ve(!1)}),s("agent-file-btn",function(){return document.getElementById("agent-file-input").click()}),o("agent-file-input",function(e){return We(e,!0)}),s("agent-file-remove",function(){return Ve(!0)}),document.querySelectorAll(".category-tab").forEach(function(e){e.onclick=function(){!function(e){de=e,document.querySelectorAll(".category-tab").forEach(function(t){t.classList.toggle("active",t.dataset.category===e)});var t=document.getElementById("schema-info"),n=document.getElementById("detected-columns");t&&(t.style.display="extract"===e?"flex":"none"),n&&(n.style.display="extract"===e?n.style.display:"none"),be()}(e.dataset.category)}}),s("detect-columns-btn",Oe),be(),Ce(),function(){var e=b(),t=document.getElementById("setting-provider");t&&(t.value=e.provider,t.onchange=function(e){var t=e.target.value;ye(t),"local"===t&&ve()});var n=function(e,t){var n=document.getElementById(e);n&&(n.value=t||"")};n("setting-api-key",e.apiKey),n("setting-groq-model",e.groqModel||"llama-3.3-70b-versatile"),n("setting-gemini-key",e.geminiKey),n("setting-gemini-model",e.geminiModel||"gemini-1.5-flash"),n("setting-openai-key",e.openaiKey),n("setting-openai-model",e.openaiModel||"gpt-4o-mini"),n("setting-base-url",e.baseUrl),ye(e.provider)}()})}(),function(){"use strict";new URL(__webpack_require__(80539),__webpack_require__.b)}()})();